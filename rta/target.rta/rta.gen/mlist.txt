MASMX 7r3A Build 12
3/image.msm
STERM=.
STERM=:
*EOF*
  :                            1 
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            98 	$list		2
  :                            99 $(65:MANAGER_TABLE)
  :                            100 
  :                            101 new_dayclock	$res	2
  :                            102 energy$advise	$res	1
  :                            103 
  :                            104 .	core2core_alert	$res	24		. parameter buffers for core2core interrupts
  :                            105 
  :                            106 	.	the rest of $(65) starts with memory management and scheduler data
  :                            107 
  :                            108 $(0:0:0/$p0)
00:000000 B60040              +109 	j		engage		. normal start
00:000001 B60067              +110 	j		restart		. ISR in error restart single step
00:000002 B6006F              +111 	j		external_interrupts
00:000003 B600BF              +112 	j		fpxpo_ii
  :                            113 
00:000004 B600D2              +114 	j		i_timer		. TIMER$* incrementer overflow
00:000005 B60103              +115 	j		alert_ii	. ATTENTION$
00:000006 B6013A              +116 	j		smp_pend	. start vector smp cores ...1111 1110
  :                            117 
00:000007 7D0000              +118 	$do		63-$,	ir	0
00:000008 7D0000              +118 
00:000009 7D0000              +118 
00:00000A 7D0000              +118 
00:00000B 7D0000              +118 
00:00000C 7D0000              +118 
00:00000D 7D0000              +118 
00:00000E 7D0000              +118 
00:00000F 7D0000              +118 
00:000010 7D0000              +118 
00:000011 7D0000              +118 
00:000012 7D0000              +118 
00:000013 7D0000              +118 
00:000014 7D0000              +118 
00:000015 7D0000              +118 
00:000016 7D0000              +118 
00:000017 7D0000              +118 
00:000018 7D0000              +118 
00:000019 7D0000              +118 
00:00001A 7D0000              +118 
00:00001B 7D0000              +118 
00:00001C 7D0000              +118 
00:00001D 7D0000              +118 
00:00001E 7D0000              +118 
00:00001F 7D0000              +118 
00:000020 7D0000              +118 
00:000021 7D0000              +118 
00:000022 7D0000              +118 
00:000023 7D0000              +118 
00:000024 7D0000              +118 
00:000025 7D0000              +118 
00:000026 7D0000              +118 
00:000027 7D0000              +118 
00:000028 7D0000              +118 
00:000029 7D0000              +118 
00:00002A 7D0000              +118 
00:00002B 7D0000              +118 
00:00002C 7D0000              +118 
00:00002D 7D0000              +118 
00:00002E 7D0000              +118 
00:00002F 7D0000              +118 
00:000030 7D0000              +118 
00:000031 7D0000              +118 
00:000032 7D0000              +118 
00:000033 7D0000              +118 
00:000034 7D0000              +118 
00:000035 7D0000              +118 
00:000036 7D0000              +118 
00:000037 7D0000              +118 
00:000038 7D0000              +118 
00:000039 7D0000              +118 
00:00003A 7D0000              +118 
00:00003B 7D0000              +118 
00:00003C 7D0000              +118 
00:00003D 7D0000              +118 
00:00003E 7D0000              +118 
  :                            119 
00:00003F B6004A              +120 	j		anomaly		. analyse fault in ISR
  :                            121 
  :                            122 $(0:64)
  :                            123 
  :                            124 "$LOCK_SWITCH"	$equ	1		. thread switch under external interrupts lock
  :                            125 
00:000040 5500FC              +126 engage	lx, xi		256-4
00:000041 10008F              +127 	sx		sp_x
00:000042 10008E              +128 	sx		fp_x
  :                            129 
  :                            130 	$if	0
  :                            131 	ql	(4.5)			. to these can be switched
  :                            132 	fd	(3.0)			. to see if floating instructions
  :                            133 	fa	(6.0)			. operate correctly in interrupt mode
  :                            134 	fan	(3.0)			. although no ISR ever uses fp
  :                            135 	$endif
  :                            136 
00:000043 04007C              +137 	inA		ram$threshold
00:000044 200087              +138 	sa		FREE_BASE
Note: image.msm Line 139: this tests a_x not a
00:000045 680084              +139 	tanu, xi	1
00:000046 DD0001              +139 
00:000047 DE0049              +140 	jnzb		image_in_rom
  :                            141 
00:000048 3E0139              +142 	lcal		load_image
  :                            143 
  :                            144 			. this is an indirection literal pointing to a gate literal
  :                            145 			. pointing past the interrupt vectors in TRANSFER_PAGE
  :                            146 image_in_rom
  :                            147 
00:000049 F70143              +148 	go		(0800000++$p0(start, TRANSFER_PAGE/*12d)s)
  :                            149 
  :                            150 			. was [ go (TRANSFER_PAGE/*6) ] but an application could interrupt
  :                            151 			. to there by mistake and accidentally reinitialise the system
  :                            152 
  :                            153 			. an application can only get to page TRANSFER_PAGE with ii instruction
  :                            154 			. but this is also interrupt code and can go or call into ISR space
  :                            155 
00:00004A 4700A0              +156 anomaly	qs		32+128			. ISR faulted
00:00004B 4F0080              +157 	ql		128			. save interrupt registers [ a b 6 7 ]
00:00004C 47009C              +158 	qs		28+128			. + [ r k x y ] for restart trace
  :                            159 
00:00004D 4DFFFF              +160 	lk		-1,,xi			. see if evidently a bad service call param did this
00:00004E 60F007              +161 	la		7, sp
00:00004F AF0144              +162 	mtane		(tag_ii_user_refp) 	. bad param to ISR?
00:000050 B60052              +162 
00:000051 7D0000              +163 	ir		0			. go back and retire the process
00:000052 AF0145              +164 	mtane		(zeta_ii_user_refp)
00:000053 B60055              +164 
00:000054 7D0000              +165 	ir		0
  :                            166 
  :                            167 	$if		0
  :                            168 	mtane		(rtq_user_rfp)
  :                            169 	ir		0
  :                            170 	$endif
  :                            171 
  :                            172 	.	any more application causes of broken ISR above this line
  :                            173 	.	below this line it has been decided to restart the system
  :                            174 	.	but unknown the extent of system configuration taken place
  :                            175 	.	working set interrupt registers are saved in interrupt stack registers
  :                            176 	.	without assuming any storage assigned so to avoid nested faults
  :                            177 
00:000055 CF008E              +178 	dl		fp_x			. [ fp sp ]
00:000056 C7009A              +179 	ds		128+26
  :                            180 
00:000057 4FF000              +181 	ql		0, sp
00:000058 4700A4              +182 	qs		128+36
  :                            183 
00:000059 0C0041              +184 	inB		65			. application TCB if any already loaded
00:00005A 2800A9              +185 	sb		128+41
  :                            186 
00:00005B 040042              +187 	inA		66			. kernel vector list
00:00005C 0C0043              +188 	inB		67			. kernel storage
00:00005D C700AA              +189 	ds		128+42
  :                            190 
00:00005E 040044              +191 	inA		68			. more kernel storage 
00:00005F 0C0045              +192 	inB		69			. populated if system is large
00:000060 C700AC              +193 	ds		128+44
  :                            194 
00:000061 040046              +195 	inA		70			. or very large
00:000062 0C0047              +196 	inB		71
00:000063 C700AE              +197 	ds		128+46
  :                            198 						. deal with case interrupt frames too many
  :                            199 	$if		0
  :                            200 
  :                            201 	lr		128+24+2,,xi		. architecture corrects minimally @ sp < 0
  :                            202 	lx		sp_x			. keep it saner than that here
  :                            203 	jxge		restart			. tendency is to get here if there are
  :                            204 						. new contingencies in xrelay_reset
  :                            205 	$endif
  :                            206 
00:000064 CF0146              +207 	dl		(CHILLDOWN, REST_GRANULE:d)
00:000065 1C0067              +208 	outB		chill$down		. so cool it this much
00:000066 140066              +209 	outA		INDICATION$		. this way
  :                            210 
  :                            211 	$do	0,		j		engage			. reset without resynchronisation
  :                            212 
  :                            213 						. this is a broadcast only to core 0	
  :                            214 restart
  :                            215 	$if		1
00:000067 4D00FC              +216 	lk		252,,xi			. prevent crash in network trunk reset
00:000068 08008E              +217 	sk		fp_x			
00:000069 08008F              +218 	sk		sp_x
  :                            219 	$endif		
  :                            220 
00:00006A 4DFFFE              +221 	lk		-2,,xi			. all cores except core 0. This here must be core 0
00:00006B 650001              +222 	la		SMP_PEND$,,xi		. latent param is subvector only
00:00006C 14004F              +223 	outA		MCAST_TO$		. other cores -> powersave.powersave.powersave...
  :                            224 
00:00006D FF0148              +225 	call		(xrelay_reset)		. this is restart interrupt called from guard ISR
00:00006E B60040              +226 	j		engage			. if a system-essential process faults: restart
  :                            227 						. trace in interrupted TCB + 1024
  :                            228 external_interrupts
00:00006F 8F0084              +229 	qpush		a_x			. all external interrupts are allowed
00:000070 8F0080              +230 	qpush		r_x			. in overlapped time
00:000071 054000              +231 	on		see$1
00:000072 9F106A              +232 	dpush		ABT+WORKTANK_I
  :                            233 
00:000073 04004A              +234 	inA		XI_PENDING$
00:000074 A500FF              +235 	and		255,,xi			. only expecting 8 pins
00:000075 C600A1              +236 	jza		external_ixx
00:000076 0C004D              +237 	inB		CORE_SOCKET$		. this core index
00:000077 2E0003              +238 	sbl		3			.  positioned to OR device index
  :                            239 
00:000078 FD0001              +240 	push		1,,xi			. pending pin position biased
00:000079 FDFFFF              +241 	push		-1,,xi
00:00007A 9F0084              +242 	dpush		a_x
  :                            243 
  :                            244 external_next
00:00007B 0D0001              +245 	off		carry$			. don't roll a random 1 into 3,sp
  :                            246 						. any time around
  :                            247 						. 3,sp contains 1 pin position bit
00:00007C 17F002              +248 	inc		2, sp			. interrupt source index [-1] -> 0..7
00:00007D 3FF003              +249 	slc		3, sp			. ACK pin position biased by 1
  :                            250 						. zero is now rolled into carry
00:00007E 37F000              +251 	src		0, sp			. PENDING pin shift to carry
00:00007F 5E007B              +252 	jnc		external_next		. this won't roll 1 into 3,sp
  :                            253 	
00:000080 60F002              +254 	la		2, sp			. device index
00:000081 0CC050              +255 	inB		I$DATA, a
  :                            256 
00:000082 90F001              +257 	or		1, sp			. core index * 8
00:000083 C50001              +258 	aa		1,,xi			. make the source index relative 1
00:000084 C70086              +259 	ds		6+128			. zero is reserved
  :                            260 
00:000085 68F003              +261 	lb		3, sp			. 
00:000086 0E0001              +262 	sbr		1			. push out bias 
00:000087 1C004B              +263 	outB		XI_ACK$			. push the pending pins down
  :                            264 
00:000088 B5FFFF              +265 	xor		-1,,xi			. subtract source relative 1 from address B3
00:000089 C53001              +266 	aa		03001,,xi		. not concerned about carry here
00:00008A 053F00              +267 	on		see$all--see$1
00:00008B 60C000              +268 	la		0, a
  :                            269 
00:00008C C6009F              +270 	jza		external_ix
00:00008D 680084              +271 	lb		a_x
00:00008E B80149              +272 	xorB		(0C00001s)		. more likely this than zero. Same effect
00:00008F CE009F              +273 	jzb		external_ix
  :                            274 
00:000090 34002A              +275 	sabr		WORKTANK_I		. obtain thread descriptor from thread control block
00:000091 58814A              +276 	ly		*(WORKTANK_I*/12++TDESCRIPTOR-01000)
  :                            277 
00:000092 B0B003              +278 	xor		3, y			. the same TCB ?
00:000093 D6009E              +279 	jnza		external_zx		. does not seem to be the same thread as before
  :                            280 
00:000094 60B002              +281 	la		2, y			. flags not on the way out ?
00:000095 A0014B              +282 	and		(EXIT++TRAP)
00:000096 D6009E              +283 	jnza		external_zx		. deconfigure thread from interrupt
  :                            284 
  :                            285 
00:000097 68014C              +286 	lb		(WORKTANK_I*/12++XINTT-01000s)
00:000098 70D003              +287 	tz		3, b			. external interrupt table?
00:000099 3E00A9              +288 	lcal		write_xint_table	. yes, table the interrupt indication
  :                            289 
00:00009A 30B002              +290 	z		2, y			. action, free the target thread to schedule
00:00009B FD0001              +291 	push		1,,xi			. force running thread to timeslice
00:00009C 380094              +292 	pop		REALTIME$_CLOCK		. if it has nonzero imask it won't
00:00009D B6009F              +293 	j		external_ix		. and could be the target wake_up thread
  :                            294 
  :                            295 external_zx
00:00009E 30A000              +296 	z		0, x			. remove the thread from the kernel vector list
  :                            297 						. it is not actual
  :                            298 					. roll zero into low order position ACK flag
00:00009F 70F000              +299 external_ix	tz	0, sp
00:0000A0 B6007B              +300 		j	external_next
  :                            301 
00:0000A1 87F000              +302 external_ixx	qpop	0, sp
  :                            303 
00:0000A2 380084              +304 		pop	a_x			. put windows 42, 43 back where you found them
00:0000A3 34002A              +305 		sabr	WORKTANK_I
00:0000A4 380084              +306 		pop	a_x
00:0000A5 34002B              +307 		sabr	WORKTANK_J
  :                            308 
00:0000A6 870080              +309 		qpop	r_x
00:0000A7 870084              +310 		qpop	a_x
  :                            311 
00:0000A8 7D0000              +312 	ir		0
  :                            313 
  :                            314 	
  :                            315 $(69::,b)
45:000000                     +316 xitable	xint_table
45:000001                     +316 
45:000002                     +316 
45:000003                     +316 
  :                            317 
  :                            318 $(0)
  :                            319 
  :                            320 write_xint_table				. minimal preprocess ISR stub
00:0000A9 FD0007              +321 	push		MAX_INT_MASK,,xi	. data port read has already happened
00:0000AA 27F000              +322 	sim		0, sp			. don't get interrupted with lock on
  :                            323 
00:0000AB 07D000              +324 	ts		xitable:lock_cell	. switch to driver affinity thread is immediate
00:0000AC B600AB              +325 	j		$-1			. if interrupt source needs more I/O in realtime
  :                            326 						. then more ISR preprocess is necessary
00:0000AD F80085              +327 	push		b_x
00:0000AE 50D002              +328 	lx		xitable:wcursor		. read the write pointer
00:0000AF CF0086              +329 	dl		6+128			. relative 1 interrupt source : received data
00:0000B0 F80082              +330 	push		x_x			. save the structure-relative write pointer
00:0000B1 80F001              +331 	ax		1, sp			. rezone it to the working window + table offset
00:0000B2 C7A000              +332 	ds		0, x			. write the data
00:0000B3 380082              +333 	pop		x_x			. save the structure-relative write pointer
00:0000B4 380085              +334 	pop		b_x
  :                            335 
00:0000B5 40D003              +336 	lr		xitable:limit		. read the table limit
00:0000B6 850002              +337 	ax		2,,xi			. advance the write pointer
00:0000B7 F600B9              +338 	jxge		write_xint_wrap		. wrap if necessary
00:0000B8 B600BA              +339 	j		write_xint_wcursor
  :                            340 
  :                            341 write_xint_wrap
  :                            342 	$if		1
00:0000B9 550004              +343 	lx		4,,xi			. only the structure offet
  :                            344 	$else
  :                            345 	lx		xitable:xint,,i		. not the ea used to write
  :                            346 	$endif
  :                            347 
  :                            348 write_xint_wcursor
00:0000BA 10D002              +349 	sx		xitable:wcursor		. store updated write pointer
  :                            350 
00:0000BB 30D000              +351 	z		xitable:lock_cell	. free the structure lock
00:0000BC 27F000              +352 	sim		0, sp			. change interrupt mask back
00:0000BD 17008F              +353 	inc		sp_x
00:0000BE 350000              +354 	lret		0
  :                            355 
  :                            356 fpxpo_ii
00:0000BF 60F001              +357 	la		1, sp		. saved PSR
00:0000C0 A50008              +358 	and		fp$r,,xi	. isolate residue indication
00:0000C1 480084              +359 	lk		a_x
00:0000C2 4F014D              +360 	ql		(-0.0)		. default decision
00:0000C3 50F000              +361 	lx		0, sp		. accumulator index
  :                            362 
00:0000C4 450018              +363 	lr		24,,xi		. this cludge is for older RTA1 steppings
00:0000C5 F600C7              +364 	jxge		fpxpo_idx	. which give latent parameter auth 1
00:0000C6 550004              +365 	lx		a,,xi		. instead of accumulator index
  :                            366 
  :                            367 fpxpo_idx		
00:0000C7 78F001              +368 	tp		1, sp		. did an application do this?
00:0000C8 550084              +369 	lx		a_x,,xi		. no, mark interrupt accumulators
00:0000C9 47A000              +370 	qs		0, x		. write major result
00:0000CA 700081              +371 	tz		k_x		. 192-bit operation?
00:0000CB 47A004              +372 	qs		4, x		. write minor result
00:0000CC 78F001              +373 	tp		1, sp		. application?
00:0000CD B600D1              +374 	j		fpxpo_iix	. no, don't to anything more
  :                            375 
00:0000CE 054000              +376 	on		see$1		. look into the thread control block
00:0000CF 600151              +377 	la		(0800000s)	. flag this happened
00:0000D0 20103A              +378 	sa		FP_XPO		. in case the application likes to know
  :                            379 
  :                            380 	$if		0
  :                            381 	la		x_x		. SIMD or regular accumulators?
  :                            382 	xor		4,,xi
  :                            383 	jza		fpxpo_iix
  :                            384 	la		RDATAC
  :                            385 	sa		FP_FINAL_COUNT	. SIMD interrupted final count -> TCB
  :                            386 	la		-1,,xi		.
  :                            387 	sa		RDATAC		. force SIMD restart next rex
  :                            388 	$endif
  :                            389 
  :                            390 fpxpo_iix
00:0000D1 7D0000              +391 	ir		0
  :                            392 
  :                            393: 	$include	../timer/timer
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 
  :                            41 .	this is
  :                            42 
  :                            43 .		timer/timer.msm
  :                            44 .		in restarts page because none of it is service calls
  :                            45 
  :                            46 PER_SECOND	$equ	1000000000	. just for now the incrementer
  :                            47 					. is in nanoseconds indeed
  :                            48 
  :                            49 i_timer				. incrementer overflow
  :                            50 				. when an incrementer is added to hardware
  :                            51 				. update the dayclock in interrupt registers
  :                            52 				. DAYCLOCK$U DAYCLOCK
  :                            53 				. and multicast the new millisecond time
  :                            54 				. with an out to the I/O port that does that
  :                            55 
00:0000D2 9F0084              +56 	dpush	a_x		. may be a nested interrupt
00:0000D3 F80081              +57 	push	k_x		. and if not application are untouched
  :                            58 
  :                            59 	$if	1		. updated ms time already delivered
  :                            60 				. as in emulations
00:0000D4 CF0096              +61 	dl	DAYCLOCK$U
00:0000D5 051000              +62 	on	see$3
00:0000D6 C73000              +63 	ds	new_dayclock
  :                            64 
  :                            65 	$else			. something like this
  :                            66 				. if really maintaining MS time
  :                            67 				. from an incrementer
  :                            68 
  :                            69 	dl	DAYCLOCK$U
  :                            70 	da	(1d)
  :                            71 	ds	DAYCLOCK$U
  :                            72 	on	see$3		. kernel memory
  :                            73 	ds	new_dayclock
  :                            74 	dl	(-PER_SECOND/1000, -1d)
  :                            75 	outA	INC$START
  :                            76 
  :                            77 	$endif
  :                            78 				. the rest is the same. broadcast it
  :                            79 
00:0000D7 0C004D              +80 	inB	CORE_SOCKET$
00:0000D8 65FFFE              +81 	la	-2,,xi
00:0000D9 66D000              +82 	ral	0, b		. broadcast everyone but me
00:0000DA 480084              +83 	lk	a_x
00:0000DB 650000              +84 	la	DAYCLOCK_MCAST$,,xi
00:0000DC 14004F              +85 	outA	MCAST_TO$
  :                            86 
00:0000DD 380081              +87 	pop	k_x
00:0000DE 380084              +88 	dpop	a_x
00:0000DF 380085              +88 
00:0000E0 7D0000              +89 	ir	0
  :                            90 
  :                            91 	$if	0		. this is inline in attention broacase ISR
  :                            92 
  :                            93 dayclock_update
  :                            94 	on	see$3
  :                            95 	dl	new_dayclock	. receive the new time from multicast
  :                            96 	ds	DAYCLOCK$U
  :                            97 
  :                            98 	lret	0
  :                            99 
  :                            100 	$endif
  :                            394 
  :                            395 .	this may only be called for a thread with a core affinity
  :                            396 .	it's broadcast as a simple way of filtering
  :                            397 
  :                            398 run_device_thread
00:0000E1 500084              +399 	lx		a_x
00:0000E2 C5FFFF              +400 	aa		-1,,xi		. [ 1..192 ] change to relative 0
00:0000E3 160003              +401 	dsr		3		. 
00:0000E4 0E0015              +402 	sbr		21
00:0000E5 C70086              +403 	ds		6+128		. core index : device 0..7
00:0000E6 04004D              +404 	inA		CORE_SOCKET$	. who am I ?
00:0000E7 B00086              +405 	xor		6+128
00:0000E8 D600F4              +406 	jnza		run_device_wrongcore
  :                            407 
00:0000E9 650000              +408 	la		0,,xi
00:0000EA D00082              +409 	ana		x_x
00:0000EB 552FFF              +410 	lx		03000-1,,xi
00:0000EC 800084              +411 	ax		a_x
00:0000ED 60A000              +412 	la		0, x
  :                            413 
00:0000EE A00152              +414         and             (03FFFFF)
00:0000EF C600F4              +415         jza             run_device_nothread
00:0000F0 680084              +416         lb              a_x
00:0000F1 B80149              +417         xorB            (0C00001s)
00:0000F2 CE00F4              +418         jzb             run_device_nothread
  :                            419 
00:0000F3 3E00F6              +420 	lcal	activate_thread
  :                            421 
  :                            422 run_device_wrongcore
  :                            423 run_device_nothread
00:0000F4 30A000              +424 	z		0, x		. bad thread
00:0000F5 350000              +425 	lret		0		. good thread
  :                            426 
  :                            427 	$if		1
  :                            428 
  :                            429 	. this does not need a broadast
  :                            430 	. this is the same thing as EVENT_FREE$ event_free_ii
  :                            431 	. which does not need broadcast
  :                            432 
  :                            433 activate_thread				. any kind of thread
00:0000F6 057F00              +434 	on		see$all
  :                            435 
00:0000F7 F8106A              +436 	push		ABT+WORKTANK_I	. save whatever active thread has for window 42
00:0000F8 34002A              +437 	sabr		WORKTANK_I
  :                            438 
00:0000F9 58814A              +439 	ly		*(WORKTANK_I*/12++TDESCRIPTOR-01000)
00:0000FA B0B003              +440 	xor		3, y		. does descriptor still match TCB?
00:0000FB D60100              +441 	jnza		inactive_thread
00:0000FC 60B002              +442 	la		2, y
00:0000FD A0014B              +443 	and		(EXIT++TRAP)
00:0000FE D60100              +444 	jnza		activate_exit
  :                            445 
00:0000FF 30B002              +446 	z		2, y		. thread to run
  :                            447 					. reasons and information stored already
  :                            448 activate_exit
  :                            449 inactive_thread
00:000100 380084              +450 	pop		a_x
00:000101 34002A              +451 	sabr		WORKTANK_I
  :                            452 
00:000102 350000              +453 	lret		0
  :                            454 
  :                            455 	$endif
  :                            456 
  :                            457 
  :                            458 alert_ii				. service request[s] from other core[s]
00:000103 8F0084              +459 	qpush		a_x		. may be a nested interrupt
00:000104 8F0080              +460 	qpush		r_x
  :                            461 
00:000105 60F008              +462 	la		8, sp		. latent param contains 2-bit subvector ++ page index
  :                            463 					. or 22-bit subvector
  :                            464 
00:000106 160016              +465 	dsr		22		. bitsplit 2.22
00:000107 0E0002              +466 	sbr		2
00:000108 C6010D              +467 	jza		alert_index22
  :                            468 
00:000109 B6C109              +469 	j		$, a
00:00010A B6011A              +470 	j		device_activate	. broadcast to schedule on core of affinity
00:00010B B6011D              +471 	j		smp_activate	. broadcast to plant kernel vectors + storage on smps
00:00010C B6012E              +472 	j		thread_halt	. broadcast to arrest threads of closing processes
  :                            473 
  :                            474 
  :                            475 alert_index22
Note: image.msm Line 476: this tests b_x not b
00:00010D 600085              +476 	tanuba		__ALERTS,,xi	. check don't guess
00:00010E D50003              +476 
00:00010F 7E0136              +477 	jc		alert_iix	. subvector out of range
  :                            478 
00:000110 B6D111              +479 	j		alerts, b
  :                            480 
00:000111 B60114              +481 alerts	j		dayclock_u
00:000112 B6013A              +482 	j		smp_pend	. same as restart. Waits for core[0] to initialise system
00:000113 B60001              +483 	j		1		. core[0] requested to restart everything
  :                            484 					
  :                            485 __ALERTS $equ		$-alerts
  :                            486 
  :                            487 dayclock_u
00:000114 780098              +488 	tp		128+24		. kernel storage not yet based
00:000115 B60136              +489 	j		alert_iix	. do no try to read it
00:000116 051000              +490 	on		see$3
00:000117 CF3000              +491 	dl		new_dayclock
00:000118 C70096              +492 	ds		DAYCLOCK$U
00:000119 B60136              +493 	j		alert_iix
  :                            494 
  :                            495 device_activate
00:00011A 600085              +496 	la		b_x
00:00011B 3E00E1              +497 	lcal		run_device_thread
00:00011C B60136              +498 	j		alert_iix
  :                            499 
  :                            500 smp_activate
00:00011D 057F00              +501 	on		see$all
00:00011E 1C0042              +502 	outB		66
00:00011F 650002              +503 	la		APPLICATION_L,,xi
00:000120 682075              +504 	lb		kernel_B3	. kernel storage pointers for all cores
00:000121 140048              +505 	outA		application$L
00:000122 1C0043              +506 	outB		67
00:000123 CF2076              +507 	dl		kernel_B4
00:000124 140044              +508 	outA		68
00:000125 1C0045              +509 	outB		69
00:000126 CF2078              +510 	dl		kernel_B6
00:000127 140046              +511 	outA		70
00:000128 1C0047              +512 	outB		71
  :                            513 
00:000129 650080              +514 	la		128,,xi		. core resume needs sp_x @ 128
00:00012A 20008F              +515 	sa		sp_x
00:00012B 4500FC              +516 	lr		252,,xi		. schedule needs sp_x @ 252
00:00012C 00008E              +517 	sr		fp_x		. and fp_x now
  :                            518 
00:00012D F70155              +519         go		(0800000++$p0(core_resume, TRANSFER_PAGE/*12d)s)	. does not return
  :                            520 
  :                            521 thread_halt
  :                            522 .	lb		4, sp		. latent parameter is @ 8, sp and already in b
  :                            523 .	andB		(03FFFFF)	. thread which must halt, already trimmed
00:00012E 040041              +524 	inA		65		. I am running this thread?
00:00012F B80084              +525 	xorB		a_x
00:000130 DE0136              +526 	jnzb		alert_iix	. request from another core?
  :                            527 
00:000131 60E001              +528 	la		1, fp		. zero application interrupt mask
00:000132 A00156              +529 	and		(0807FFFs)	. or he jerst won't timeslice
00:000133 20E001              +530 	sa		1, fp		. 2nd word application interrupt frame
  :                            531 
00:000134 650001              +532 	la		1,,xi		. force thread to timeslice
00:000135 200094              +533 	sa		REALTIME$_CLOCK	. it's already marked stop
  :                            534 
  :                            535 alert_iix
00:000136 870080              +536 	qpop		r_x
00:000137 870084              +537 	qpop		a_x
00:000138 7D0000              +538 	ir		0
  :                            539 
  :                            540 load_image
  :                            541 	.	if an image is to be loaded starting at
  :                            542 	.	TRANSFER_PAGE, load it here from a local
  :                            543 	.	file system
  :                            544 
  :                            545 	.	and adjust FREE_BASE to the first page
  :                            546 	.	after the system image
  :                            547 
  :                            548 	.	otherwise a system is already in ROM
  :                            549 	.	which is larger than just this
  :                            550 	.	restart page
  :                            551 
00:000139 350000              +552 	lret		0
  :                            553 
  :                            554 smp_pend
00:00013A CF0157              +555 	dl	(CHILLDOWN, 100000d)
00:00013B 550100              +556 	lx	256,,xi
00:00013C 10008F              +557 	sx	sp_x
00:00013D 10008E              +558 	sx	fp_x
  :                            559 
  :                            560 smp_pendu
00:00013E 1C0067              +561 	outB	chill$down	. for this microsecs
00:00013F 140066              +562 	outA	INDICATION$	. powersave
00:000140 B6013E              +563 	j	smp_pendu
  :                            564 
  :                            565 	$do		$<256,$(0:256)
  :                            566 
00:000141+00008A000001
00:000143+800141
00:000144+0006D1
00:000145+000630
00:000146+0000080001F4
00:000148+[0000]18:000000
00:000149+C00001
00:00014a+02A001
00:00014b+300000
00:00014c+02A200
00:00014d+FFFFFFFFFFFFFFFFFFFFFFFF
00:000151+800000
00:000152+3FFFFF
00:000153+0002F0000001
00:000155+800153
00:000156+807FFF
00:000157+0000080186A0
  :                            567 $(0:0:TRANSFER_PAGE/$0p1)
  :                            568 
00:001000 7D0000              +569 		ir	0	.	a spare, was the entry point from restart
  :                            570 				.	but is addressable as an interrupt vector / system call
  :                            571 
00:001001 B602AB              +572 		j		yield			. YIELD$*
00:001002 B6006D              +573 		j		spawn_ii		. SPAWN$*	
00:001003 B60045              +574 		j		bank_ii			. BANK$*
00:001004 B6004E              +575 		j		array_ii		. ARRAY$*
00:001005 B60057              +576 		j		bank_free_ii		. BANK$FREE*
00:001006 B60271              +577 		j		exit_ii			. EXIT$*
00:001007 B604A9              +578 		j		thread			. THREAD$*
00:001008 B60040              +579 		j		freetotal_ii		. TOTAL$FREE*
00:001009 B606C7              +580 		j		tag_ii			. TAG$
00:00100A B605CF              +581 		j		assign_xvector_ii	. ASSIGN_XVECTOR$
00:00100B B60616              +582 		j		itable_ii		. I$TABLE
00:00100C B60622              +583 		j		affinity_ii		. AFFINITY$
00:00100D B605BC              +584 		j		write_avector_ii	. WRITE_AVECTOR$
  :                            585 
  :                            586 	$do		14-$,	ir	0
  :                            587 
00:00100E B60602              +588 		j		fpxpo_read_clear_ii	. FP_XPO$FLAG*
00:00100F B60608              +589 		j		xint_bind_ii		. XINT$BIND
00:001010 B6053F              +590 		j		handle_ii		. HANDLE$*
00:001011 B60557              +591 		j		free_handle_ii		. FREE_HANDLE$*
00:001012 B60575              +592 		j		read_handle_ii		. READ_HANDLE$*
00:001013 B605B6              +593 		j		read_xvector_ii		. READ_XVECTOR$*
00:001014 B605C6              +594 		j		write_xvector_ii	. WRITE_XVECTOR$*
00:001015 B605A7              +595 		j		read_socket_ii		. READ_SOCKET$*
00:001016 B60587              +596 		j		usocket_c_ii		. USOCKET$C*
00:001017 B605EA              +597 		j		kernel_b1_ii		. KERNEL$B1*
00:001018 B605F2              +598 		j		b1_ii			. B1$*
00:001019 B605E2              +599 		j		kernel_b1_ii_1		. KERNEL$B1_1*
00:00101A B605F6              +600 		j		dayclock_w_ii		. DAYCLOCK$W*
00:00101B B6052E              +601 		j		twait_ii		. TWAIT$*
00:00101C B60522              +602 		j		event_wait_ii		. EVENT_WAIT$*
00:00101D B60511              +603 		j		event_free_ii		. EVENT_FREE$*
00:00101E B605FD              +604 		j		switch_fp_guard_ii	. FP_GUARD$*
  :                            605 
  :                            606 	$do		31-$,	ir	0
  :                            607 
00:00101F B602A3              +608 		j		guard_ii		. GUARD$* this must stay at this address 1:31
  :                            609 
00:001020 B604F5              +610 ?	$do	XIOBASES,	j	xbase(32+?-1)
00:001021 B604FC              +610 
00:001022 B60503              +610 
00:001023 B6050A              +610 
  :                            611 
00:001024 B607EA              +612 DFRAME$*	$vector	dframe:dframe_ii
00:001025 B608A8              +613 DFRAME$FREE*	$vector	dframe:dframe_free_ii
  :                            614 
00:001026 7D0000              +615 	$do		44-$,	ir	0	
00:001027 7D0000              +615 
00:001028 7D0000              +615 
00:001029 7D0000              +615 
00:00102A 7D0000              +615 
00:00102B 7D0000              +615 
  :                            616 
00:00102C B6067B              +617 CACHE_NETB$*	$vector	cache_standard_netbuf_ii
00:00102D B60689              +618 ON_NETB$*	$vector	base_standard_netbuf_ii
00:00102E B606AF              +619 FREE_DEVB$*	$vector	unbase_deviceb_ii
00:00102F B606B2              +620 FREE_SOCKB$*	$vector	unbase_socketb_ii
00:001030 B606B5              +621 FREE_NETB$*	$vector	unbase_standard_netbuf_ii
  :                            622 
00:001031 B6063B              +623 NET2SYM$*	$vector	net2sym_ii		. encode a connection handle
  :                            624 						. and assign it to a process as stdin/out/err
00:001032 B60664              +625 THREAD$STATE*	$vector	thread_state_ii		. is thread [application a] running?
00:001033 B6066D              +626 A$IDX*		$vector	storage_block_idxa_ii	. return in a 4K word block indentifier at base_table ABT+[a]
00:001034 B60674              +627 B$IDX*		$vector	storage_block_idxb_ii	. return in b 4K word block indentifier at base_table ABT+[b]
  :                            628 						
00:001035 B606E9              +629 RESTART_EI$	$vector		restart_ei
00:001036 B606ED              +630 ONETIME_SAVE$	$vector		one_time_save_ii
00:001037 B6070B              +631 TERAFRAME$*	$vector		teraframe:array_device_claim_ii	. ir		0
  :                            632 
00:001038 B60591              +633 USOCKET$*	$vector		usocket_ii
00:001039 B606D9              +634 FO$FRAME*	$vector		file_open_frame_ii
00:00103A B606E2              +635 FO$HEAP*	$vector		files_open_heap_ii
00:00103B B60578              +636 FILE$HANDLE*	$vector		file_handle_ii
00:00103C B60627              +637 "$ZETA"*	$vector		zeta_ii
00:00103D B60703              +638 ENERGY$*	$vector		energy_ii
  :                            639 
00:00103E B606F0              +640 "$SMP"*		$vector		smp_ii
  :                            641 
  :                            642 	$do		$>64,	$flag	compress page 1 vectors
00:00103F 7D0000              +643 	$do		64-$,	ir	0
  :                            644 
  :                            645 __II_LOCK	$equ	0
  :                            646 
  :                            647 p	$proc
  :                            648 II_LOCK* $name
  :                            649 	$if	__II_LOCK
  :                            650 	push	7,,xi
  :                            651 	sim	0, sp
  :                            652 	$endif
  :                            653 	$end
  :                            654 
  :                            655 p	$proc
  :                            656 II_FREE* $name
  :                            657 	$if	__II_LOCK
  :                            658 	sim	0, sp
  :                            659 	inc	sp_x
  :                            660 	$endif
  :                            661 	$end
  :                            662 
  :                            663 freetotal_ii				. count up of all free memory banks
  :                            664 
  :                            665 STACKED_ITEST	$equ	0		. keep this at zero if you want to run
  :                            666 					. it tests what happens if an ISR faults
  :                            667 	$if	STACKED_ITEST		. ....................................
  :                            668 	$if	STACKED_ITEST=1
  :                            669 	la	*(31*/18)
  :                            670 	$else	STACKED_ITEST
  :                            671 	  $if	STACKED_ITEST=2
  :                            672 	  dl	(1, 100d)
  :                            673 	  $elseif STACKED_ITEST=3
  :                            674 	  dl	(00FFFF, 100d)
  :                            675 	  $else
  :                            676 	  dl	(03FFFFF, 100d)
  :                            677 	  $endif
  :                            678 	ds	2, sp
  :                            679 	ir	0
  :                            680 	$endif
  :                            681 	$endif				. ....................................
  :                            682 
00:001040 3E01BB              +683 	lcal		available_banks
00:001041 160018              +684 	dsr		24		. it may be larger than 24 bits
00:001042 36000C              +685 	dsl		12		. when expressed in words
00:001043 C70004              +686 	ds		4		. write to caller a:b
00:001044 7D0000              +687 	ir		0
  :                            688 	
  :                            689 bank_ii	II_LOCK
00:001045 600004              +690 	la		4
00:001046 3E01D0              +691 	lcal		bank
00:001047 200004              +692 	sa		4
  :                            693 
00:001048 C6004D              +694 	jza		nothing_gained
00:001049 054000              +695 	on		see$1
00:00104A 601004              +696 	la		BANK_CHAIN
00:00104B 20D000              +697 	sa		0, b		. descriptor pointer
00:00104C 281004              +698 	sb		BANK_CHAIN	. to front of chain
  :                            699 nothing_gained
  :                            700 	II_FREE
00:00104D 7D0000              +701 	ir		0
  :                            702 
  :                            703 array_ii
  :                            704 	II_LOCK
00:00104E 600004              +705 	la		4
00:00104F 3E01FF              +706 	lcal		array
00:001050 200004              +707 	sa		4
  :                            708 
00:001051 C60056              +709 	jza		nothing_banked
00:001052 054000              +710 	on		see$1
00:001053 601004              +711 	la		BANK_CHAIN
00:001054 20D000              +712 	sa		0, b		. descriptor pointer
00:001055 281004              +713 	sb		BANK_CHAIN	. to front of chain
  :                            714 nothing_banked
  :                            715 	II_FREE
00:001056 7D0000              +716 	ir		0
  :                            717 
  :                            718 bank_free_ii
  :                            719 	II_LOCK
00:001057 600004              +720 	la		4		. bank ID value
  :                            721 
00:001058 057F00              +722 	on		see$all		. see TCB +
  :                            723 
00:001059 4808CA              +724 	lk		(0400000)
00:00105A AF0081              +725 	mta		k_x		. either not big
00:00105B B6005F              +726 	j		bank_free_sysmem
00:00105C 4D003F              +727 	lk		63,,xi		. or not device zero = executable space
00:00105D AF08CB              +728 	mta		(0)
00:00105E B60782              +729 	j		teraframe:array_device_free
  :                            730 
  :                            731 bank_free_sysmem
00:00105F 3E0061              +732 	lcal		sysmem_free
00:001060 7D0000              +733 	ir		0
  :                            734 
  :                            735 sysmem_free
00:001061 6D1004              +736 	lb		BANK_CHAIN,,xi	. ownership chain
00:001062 4808CC              +737 	lk		(03FFFFF)	. 22-bit search mask
  :                            738 
  :                            739 	$if		0		. surely not
  :                            740 	j		bank_freewheel	. start page index match will do
  :                            741 	$endif
  :                            742 
  :                            743 bank_freewheel
00:001063 580085              +744 	ly		b_x
00:001064 68B000              +745 	lb		0, y
00:001065 CE006C              +746 	jzb		bank_freed
00:001066 AFD001              +747 	mta		1, b		. skip on equal bank ID value 
00:001067 B60063              +748 	j		bank_freewheel
  :                            749 
00:001068 600085              +750 	la		b_x		. bank free wants a -> descriptor
  :                            751 
00:001069 F8D000              +752 	push		0, b		. take it out of
00:00106A 38B000              +753 	pop		0, y		. the chain
  :                            754 					. 48-bit result page_index:*descriptor
00:00106B 3E0160              +755 	lcal		bank_free
  :                            756 bank_freed
00:00106C 350000              +757 	lret		0
  :                            758 
  :                            759 spawn_ii
  :                            760 	II_LOCK
00:00106D 054000              +761 	on		see$1	. you get here from an application
  :                            762 
00:00106E 0C0041              +763 	inB		65	. TCB in B65 and vector bank in B2
00:00106F 601042              +764 	la		ABT+2	. are constructed in situ
00:001070 9F0084              +765 	dpush		a_x	. so save the caller's environment
  :                            766 
00:001071 4F0004              +767 	ql		a	. read the 4 parameters from
  :                            768 				. the application accumulators
  :                            769 
00:001072 3E036E              +770 	lcal		spawn
00:001073 7C0084              +771 	jdz		spawn_z	. return zero		
  :                            772 
00:001074 052000              +773 	on		see$2	. read the kernel vector bank
00:001075 CF2180              +774 	dl		rx_buffers
  :                            775 
00:001076 F82185              +776 	push		tcx_v4(1)
00:001077 9F207A              +777 	dpush		NFS_MOUNTS
00:001078 0D2000              +778 	off		see$2
00:001079 38207A              +779 	pop		NFS_MOUNTS
00:00107A 38207B              +780 	pop		FILESHARE_TABLE
00:00107B 382185              +781 	pop		tcx_v4(1)
  :                            782 
00:00107C C72180              +783 	ds		rx_buffers
  :                            784 
00:00107D 380084              +785 	pop		a_x	. retrieve the caller's B2
  :                            786 	
00:00107E 0C0041              +787 	inB		65	. new B65 as result value
00:00107F 280004              +788 	sb		a	. in the application A-Register
00:001080 380085              +789 	pop		b_x
00:001081 1C0041              +790 	outB		65	. restore the caller's PCT
00:001082 340002              +791 	sabr		2	. restore the caller's B2
  :                            792 	II_FREE
00:001083 7D0000              +793 	ir		0
  :                            794 
00:001084 300004              +795 spawn_z	z		a	. only applications do ii SPAWN$
00:001085 380084              +796 	dpop		a_x	. ISRs lcal spawn instead
00:001086 380085              +796 
00:001087 1C0041              +797 	outB		65	. restore these because the point of failure
00:001088 340002              +798 	sabr		2	. may be after TCB acquire
  :                            799 	II_FREE			
00:001089 7D0000              +800 	ir		0
  :                            801 
00:00108A 650002              +802 start	la		APPLICATION_L,,xi
00:00108B 140048              +803 	outA		application$L	. lower limit application code calls
  :                            804 					. to avoid accidental jumps into interrupt code
  :                            805 					. using application registers
00:00108C 3E00E4              +806 	lcal		measure
00:00108D 3E00BF              +807 	lcal		stem_link
  :                            808 
  :                            809 			. some manager tasks will
  :                            810 			. get tabled here
  :                            811 
00:00108E 4F08CD              +812 	ql		(networks, 0, NETWORK_D, -1:q)
00:00108F 3E036E              +813 	lcal		spawn
  :                            814 
00:001090 601042              +815 	la		ABT+2			. the IP vector bank
00:001091 140042              +816 	outA		66			. is the kernel vector bank
  :                            817 						. kernel routines which need
  :                            818 						. to find kernel data
  :                            819 
00:001092 052000              +820 	on		see$2
  :                            821 
00:001093 0C0043              +822 	inB		67			. take copies for SMPs
00:001094 C72074              +823 	ds		kernel_B2
  :                            824 
00:001095 040044              +825 	inA		68
00:001096 0C0045              +826 	inB		69
  :                            827 
00:001097 C72076              +828 	ds		kernel_B4
  :                            829 
00:001098 040046              +830 	inA		70
00:001099 0C0047              +831 	inB		71
  :                            832 
00:00109A C72078              +833 	ds		kernel_B6
  :                            834 
00:00109B 6008D1              +835 	la		(APPLICATION_BASE/*12)
00:00109C 202910              +836 	sa		vpointer(17)		. start NVRAM application chain
  :                            837 
00:00109D 4F08D2              +838 	ql		(0q)
00:00109E C7207A              +839 	ds		NFS_MOUNTS		. + FILESHARE_TABLE
00:00109F 45003F              +840 	lr		256/4-1,,xi
00:0010A0 5D2080              +841 	ly		usockb(1),,xi
  :                            842 
00:0010A1 47B000              +843 unbind	qs		0, y			. remove old assignments
00:0010A2 8D0004              +844 	ay		4,,xi			. of port descriptors
00:0010A3 1E00A1              +845 	jdr		unbind
  :                            846 
00:0010A4 40008F              +847 	lr		sp_x
00:0010A5 4D0080              +848 	lk, xi		128
00:0010A6 08008F              +849 	sk		sp_x
  :                            850 
  :                            851 	$if		$LOCK_SWITCH		. prime saved interrupt mask
00:0010A7 300092              +852 	z		x$save2			. for restore at end of choose
  :                            853 	$endif
  :                            854 
00:0010A8 4D0001              +855 	lk		1,,xi			. just core[0] so far
00:0010A9 0828FD              +856 	sk		cores_active
  :                            857 
00:0010AA B602F5              +858 	j		choose
  :                            859 
  :                            860: 	$include	memory
  :                            1 DMAXINP $equ	5*4096/2
  :                            2 DMAXINB	$equ	5*262144/2
  :                            3 
  :                            4 .	returns in a # storage words needed for memory management
  :                            5 .	returns in b # 262144-word banks in memory
  :                            6 
  :                            7 management_words
00:0010AB 040080              +8 	inA	128
00:0010AC A008CC              +9         and	(03FFFFF)
00:0010AD C50001              +10 	aa, xi	1	.	pages memory
00:0010AE 680084              +11 	lb	a_x
00:0010AF 0E0006              +12 	sbr	6
00:0010B0 C4D064              +13 	aa	100,b,i	.	tuples roughly + margin
00:0010B1 C5D800              +14 	aa, xi	-DMAXINP
00:0010B2 7E00B7              +15 	jc	mabanks
00:0010B3 C52FFF              +16 	aa, xi	DMAXINP+4096/2-1
00:0010B4 06000B              +17 	sar	11
00:0010B5 26000C              +18 	sal	12	.	words = descriptors / 2
00:0010B6 350001              +19 	lret	1	.	return initialise management
  :                            20 			.	table in 1..3 * 4096 words
  :                            21 
00:0010B7 C008D6              +22 mabanks	aa	(DMAXINP-DMAXINB)
00:0010B8 7E00BD              +23 	jc	maxmabanks
00:0010B9 C008D7              +24 	aa	(DMAXINB+262144/2-1)
00:0010BA 060011              +25 	sar	17
00:0010BB 260012              +26 	sal	18	.	words = descriptors / 2
00:0010BC 350000              +27 	lret	0	.	return initialise management
  :                            28 			.	table in 1..5 * 262144 words
  :                            29 maxmabanks
00:0010BD 6008D8              +30 	la	(5*262144)
00:0010BE 350000              +31 	lret	0
  :                            32 
  :                            861 .	middle_hit	call	(1*/6)		. lcal	middle_hit
  :                            862: 	$include	measure
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 REQUIRED		$equ	128+6		
  :                            41 SIZE			$equ	REQUIRED
  :                            42 BANKS			$equ	REQUIRED
  :                            43 
  :                            44 OUTSIZE			$equ	128+7
  :                            45 . TEMP_BASE_ABSO		$equ	x$save
  :                            46 B4			$equ	128+8	
  :                            47 
  :                            48 .	measure is once-only initialisation code
  :                            49 .	called at kernel start up
  :                            50 
  :                            51 $(65)
  :                            52 
  :                            53 
  :                            54 banks_lock_cell			$res	1
  :                            55 threads_lock_cell		$res	1
  :                            56 next				$res	1	.	=next_page_descriptor
  :                            57 large_bank_descriptor_sp	$res	1
  :                            58 
  :                            59 ?	$do	64,free_chain(?) $res	1
  :                            60 
  :                            61 switch_lock_cell		$res	1
  :                            62 
  :                            63 free_tdescriptor		$res	1
  :                            64 next_tdescriptor_sp		$res	1
  :                            65 tdescriptor_high_index		$res	1
  :                            66 
  :                            67 ?	$do	7**8-($**7),tq_align(?)	$res	1
  :                            68 
  :                            69 ?	$do	PRIORITIES,stem(?)	$res	4
  :                            70 
  :                            71 ?	$do	63,device_key(?)	$res	2
  :                            72 
  :                            73 uq_head				$res	1
  :                            74 uq_tail				$res	1
  :                            75 
  :                            76 first_bdx			$equ	$
  :                            77 
  :                            78 
  :                            79 next_page_descriptor		$res	2
  :                            80 
  :                            81 .	?	$do	63,device_key(?),	$res	2	. this can't be here
  :                            82 								. first_bdx & next_page_descriptor
  :                            83 								. are the 1st + 2nd instances
  :                            84 								. of a dynamic variable table
  :                            85 $(0)
  :                            86 
  :                            87 stem_link
00:0010BF 450006              +88 	lr, xi	PRIORITIES-2
00:0010C0 553050              +89 	lx, xi	stem(1)
00:0010C1 6DFFFF              +90 	lb, xi	-1
00:0010C2 280086              +91 	sb	6+128
00:0010C3 5D306C              +92 	ly,xi	stem(PRIORITIES)
  :                            93 next_stem
00:0010C4 64A004              +94 	la, i	4, x		. next pointer
00:0010C5 180087              +95 	sy	7+128		. uplink
00:0010C6 47A000              +96 	qs	0, x
  :                            97 
00:0010C7 580082              +98 	ly	x_x		. previous
00:0010C8 850004              +99 	ax, xi	4
00:0010C9 CDFFFF              +100 	ab, xi	-1		. symbolic 1s complement
  :                            101 				. chain priority
  :                            102 
00:0010CA 1E00C4              +103 	jdr	next_stem	. and write the last
00:0010CB 653050              +104 	la, xi	stem(1)		. task queue trailing
00:0010CC 180087              +105 	sy	7+128		. link descriptor
00:0010CD 47A000              +106 	qs	0, x
  :                            107 
00:0010CE 303047              +108 	z	switch_lock_cell
00:0010CF 3030EE              +109 	z	uq_head
00:0010D0 3030EF              +110 	z	uq_tail
  :                            111 
00:0010D1 30304B              +112 ?	$do	tq_align(),	z	tq_align(?)
00:0010D2 30304C              +112 
00:0010D3 30304D              +112 
00:0010D4 30304E              +112 
00:0010D5 30304F              +112 
  :                            113 
00:0010D6 45003E              +114 	lr	63-1,,xi
00:0010D7 553070              +115 	lx	device_key(1),,xi
00:0010D8 160030              +116 	dsr	48
  :                            117 
00:0010D9 C7A000              +118 zdevice	ds	0, x
00:0010DA 850002              +119 	ax	2,,xi
00:0010DB 1E00D9              +120 	jdr	zdevice
  :                            121 
00:0010DC 350000              +122 	lret	0
  :                            123 
  :                            124 	$if	1
  :                            125 rebound75
00:0010DD 9F0084              +126 	dpush	a_x
00:0010DE CF08D9              +127 	dl	(CHILLDOWN, 30d)
00:0010DF 1C0067              +128 	outB	chill$down
00:0010E0 140066              +129 	outA	INDICATION$
00:0010E1 380084              +130 	dpop	a_x
00:0010E2 380085              +130 
00:0010E3 35FFFE              +131 	lret	-2
  :                            132 
  :                            133 REBOUND75* $proc
  :                            134 	lcal	rebound75	. ts cell locked, back off cool
  :                            135 	$end
  :                            136 
  :                            137 	$else
  :                            138 REBOUND75* $proc
  :                            139 	j	$-1		. ts cell locked, clamp on hard
  :                            140 	$end
  :                            141 
  :                            142 	$endif
  :                            143 
  :                            144 measure
  :                            145 
  :                            146 	$if	MANAGER_BANKS=5
  :                            147 
00:0010E4 051F00              +148 	on	see$3++see$4++see$5++see$6++see$7
  :                            149 
00:0010E5 6008DB              +150 	la	(0C00001s)
  :                            151 
  :                            152 	. default pointers which may stay unused
  :                            153 
00:0010E6 140043              +154 	outA	67		. large leaves lower slots unused
00:0010E7 140044              +155 	outA	68		. small leaves higher slots unused
00:0010E8 140045              +156 	outA	69
00:0010E9 140046              +157 	outA	70
00:0010EA 140047              +158 	outA	71
  :                            159 
00:0010EB 3E00AB              +160 	lcal	management_words
00:0010EC B60103              +161 	j	large_system
00:0010ED 2E0001              +162 	sbl	1
00:0010EE 280086              +163 	sb	BANKS		. save 2 * # banks of 262144 words
00:0010EF 680084              +164 	lb	a_x
00:0010F0 0E000C              +165 	sbr	12		. calculate # management pages	
00:0010F1 44D043              +166 	lr	64+3,b,i		. calculate how far
00:0010F2 550043              +167 	lx	64+3,,xi
00:0010F3 680087              +168 	lb	FREE_BASE
  :                            169 
  :                            170 base_management_page
00:0010F4 1CA000              +171 	outB	0, x		. base a page of kernel storage
00:0010F5 CD0001              +172 	ab	1,,xi
00:0010F6 850001              +173 	ax	1,,xi
  :                            174 
00:0010F7 F600F9              +175 	jxge	management_pages_based
00:0010F8 B600F4              +176 	j	base_management_page
  :                            177 
  :                            178 management_pages_based
00:0010F9 400085              +179 	lr	b_x		. save the bank index reached
00:0010FA 680086              +180 	lb	BANKS		. calculate page address highest bank + 1
00:0010FB 2E0005              +181 	sbl	5
00:0010FC DE0100              +182 	jnzb	pages_read
00:0010FD 0C0080              +183 	inB	128
00:0010FE A808CC              +184 	andB	(03FFFFF)
00:0010FF CD0001              +185 	ab, xi	1
  :                            186 pages_read
00:001100 5530F0              +187 	lx	first_bdx,,xi
00:001101 C52FFE              +188 	aa	03000-2,,xi
00:001102 B60114              +189 	j	memory_configured
  :                            190 
  :                            191 large_system
00:001103 2E0001              +192 	sbl	1
00:001104 280086              +193 	sb	BANKS		. save 2 * # banks of 262144 words
00:001105 680084              +194 	lb	a_x
00:001106 0E0012              +195 	sbr	18		. calculate # management banks
  :                            196 
00:001107 54D043              +197 	lx	64+3,b,i		. top base + 1
00:001108 450044              +198 	lr	64+3+1,,xi
00:001109 680086              +199 	lb	BANKS		. 2 * memory banks of 262144 words
00:00110A 2E0005              +200 	sbl	5		. calculate page address highest bank + 1
  :                            201 
  :                            202 base_management_bank		. where decrement is from 0400000
00:00110B 85FFFF              +203 	ax	-1,,xi
00:00110C CDFFC0              +204 	ab	-64,,xi
00:00110D 9808CA              +205 	orB	(0400000)	. now think big
00:00110E 1CA000              +206 	outB	0, x
00:00110F F6010B              +207 	jxge	base_management_bank
  :                            208 
00:001110 A808CC              +209 	andB	(03FFFFF)	. stop thinking big
  :                            210 				. This will be compared with page addresses
  :                            211 
00:001111 400087              +212 	lr	FREE_BASE
00:001112 5008DC              +213 	lx	($bank_address(first_bdx))
00:001113 C008DD              +214 	aa	($bank_address(03000)-2))
  :                            215 
  :                            216 memory_configured
00:001114 30A000              +217 	z	0, x
00:001115 00A001              +218 	sr	1, x		. store the available small pages index
00:001116 103005              +219 	sx	next
  :                            220 	
00:001117 203006              +221 	sa	large_bank_descriptor_sp
00:001118 C7C000              +222 	ds	0, a
  :                            223 
00:001119 D00086              +224 	ana	BANKS
00:00111A 203049              +225 	sa	next_tdescriptor_sp
00:00111B 20304A              +226 	sa	tdescriptor_high_index
  :                            227 
  :                            228 
  :                            229 
  :                            230 	$else
  :                            231 
  :                            232 	inB	device$flags	. read system memory configuration
  :                            233 	andB	(03fffff)	. isolate the highest page index
  :                            234 	ab, xi	1		. convert the highest index (+1)
  :                            235 				. to the number of pages
  :                            236 
  :                            237 	la	b_x
  :                            238 	and, xi	-64
  :                            239 	sar	5		. calculate and save
  :                            240 	sa	BANKS		. the # words potentially needed
  :                            241 				. for descriptors of 256K banks
  :                            242 
  :                            243 				. the big banks descriptor stack
  :                            244 				. has space for a potential two-word
  :                            245 				. descriptor for each 262144-word bank
  :                            246 				. actually present in system memory
  :                            247 
  :                            248 				. the descriptor values used for
  :                            249 				. system memory in IO-mapped
  :                            250 				. relocation registers have 6
  :                            251 				. low zero bits when
  :                            252 				. descriptor bit 22 (BIG/BANK)
  :                            253 				. is on
  :                            254 
  :                            255 				. 01xxxx xxxxxx xxxxxx 000000
  :                            256 
  :                            257 				. because when BIG/BANK is on,
  :                            258 				. LS 6 bits in the relocation
  :                            259 				. register port select devices other
  :                            260 				. than system memory (filestore arrays,
  :                            261 				. dual ported network I/F memories
  :                            262 
  :                            263 				. 01xxxx xxxxxx xxxxxx DEVICE
  :                            264 
  :                            265 				. however, when BIG/BANK is off,
  :                            266 				. the six low bits select a page
  :                            267 				. within the system memory bank
  :                            268 
  :                            269 				. 00xxxx xxxxxx xxxxxx XXXXXX
  :                            270 
  :                            271 
  :                            272 
  :                            273 				. construct the first descriptor
  :                            274 				. which describes the end of memory
  :                            275 				. at the end of OS tabler memory
  :                            276 
  :                            277 	la	b_x
  :                            278 	ana	(SCALE_THRESHOLD)
  :                            279 				. if there are not a large number of
  :                            280 				. banks of 262144 words altogether,
  :                            281 				. the management table is a page or so
  :                            282 
  :                            283 	on	see$all**(see$7*/MANAGER_BANKS)-1
  :                            284 	la	FREE_BASE
  :                            285 
  :                            286 p	$proc
  :                            287 table_page* $name	1
  :                            288 
  :                            289 	outA	72-MANAGER_BANKS+?-1
  :                            290 	aa, xi	p(0, 0)
  :                            291 	$end
  :                            292 
  :                            293 p	$proc
  :                            294 table_bank* $name	-64
  :                            295 
  :                            296 	ab, xi	p(0, 0)
  :                            297 	outB	72-?
  :                            298 	$end
  :                            299 
  :                            300 	lx	(next_page_descriptor)
  :                            301 	jc	large_system
  :                            302 
  :                            303 
  :                            304 ?	$do	MANAGER_BANKS,	table_page
  :                            305 	sa	1, x		. next_page_descriptor:pointer
  :                            306 	la, xi	4096*8-2
  :                            307 	j	memory_configured
  :                            308 
  :                            309 large_system
  :                            310 
  :                            311 				. decision to use big banks
  :                            312 				. for management
  :                            313 
  :                            314 				. so take them from high-end
  :                            315 				. memory
  :                            316 
  :                            317 				. because that's where
  :                            318 				. 256K-banks are assigned
  :                            319 				. and the system image in
  :                            320 				. low memory almost certainly
  :                            321 				. doesn't fill exact 256K-banks
  :                            322 
  :                            323 	orB	(0400000)	. think big
  :                            324 	andB,xi	-64		. make sure it really is
  :                            325 				. whole banks however at
  :                            326 				. the high end
  :                            327 
  :                            328 ?	$do	MANAGER_BANKS,	table_bank
  :                            329 
  :                            330 	andB	(03FFFFF)	. stop thinking big
  :                            331 
  :                            332 	sa	1, x		. next_page_descriptor:pointer
  :                            333 	la	(262144*8-2)
  :                            334 
  :                            335 memory_configured
  :                            336 	sx	next
  :                            337 	ds	0, a
  :                            338         sa      large_bank_descriptor_sp
  :                            339 
  :                            340         ana     BANKS
  :                            341 
  :                            342         sa      next_tdescriptor_sp
  :                            343 
  :                            344 	$endif
  :                            345 
00:00111C 303003              +346 	z	banks_lock_cell
00:00111D 303004              +347 	z	threads_lock_cell
00:00111E 303048              +348 	z	free_tdescriptor
  :                            349 
00:00111F 303007              +350 ?	$do	63,	z	free_chain(?)
00:001120 303008              +350 
00:001121 303009              +350 
00:001122 30300A              +350 
00:001123 30300B              +350 
00:001124 30300C              +350 
00:001125 30300D              +350 
00:001126 30300E              +350 
00:001127 30300F              +350 
00:001128 303010              +350 
00:001129 303011              +350 
00:00112A 303012              +350 
00:00112B 303013              +350 
00:00112C 303014              +350 
00:00112D 303015              +350 
00:00112E 303016              +350 
00:00112F 303017              +350 
00:001130 303018              +350 
00:001131 303019              +350 
00:001132 30301A              +350 
00:001133 30301B              +350 
00:001134 30301C              +350 
00:001135 30301D              +350 
00:001136 30301E              +350 
00:001137 30301F              +350 
00:001138 303020              +350 
00:001139 303021              +350 
00:00113A 303022              +350 
00:00113B 303023              +350 
00:00113C 303024              +350 
00:00113D 303025              +350 
00:00113E 303026              +350 
00:00113F 303027              +350 
00:001140 303028              +350 
00:001141 303029              +350 
00:001142 30302A              +350 
00:001143 30302B              +350 
00:001144 30302C              +350 
00:001145 30302D              +350 
00:001146 30302E              +350 
00:001147 30302F              +350 
00:001148 303030              +350 
00:001149 303031              +350 
00:00114A 303032              +350 
00:00114B 303033              +350 
00:00114C 303034              +350 
00:00114D 303035              +350 
00:00114E 303036              +350 
00:00114F 303037              +350 
00:001150 303038              +350 
00:001151 303039              +350 
00:001152 30303A              +350 
00:001153 30303B              +350 
00:001154 30303C              +350 
00:001155 30303D              +350 
00:001156 30303E              +350 
00:001157 30303F              +350 
00:001158 303040              +350 
00:001159 303041              +350 
00:00115A 303042              +350 
00:00115B 303043              +350 
00:00115C 303044              +350 
00:00115D 303045              +350 
00:00115E 303046              +351 	z	free_chain(64)
  :                            352 
  :                            353 				. management memory is 1+ pages at RAM start
  :                            354 				. or 1+ * 262144 words (banks) at high RAM
  :                            355 				. and contains measurements sensed at startup
  :                            356 				. plus 4 dynamic tables
  :                            357 
  :                            358 				. 8-word thread descriptors stack downwards
  :                            359 				. from positions reserve for descriptors of
  :                            360 				. banks assigned in groups of 256K-words
  :                            361 
  :                            362 				. the lowest big-bank pointer
  :                            363 				. is the thread descriptors stack root
  :                            364 
  :                            365 				. next_tdescriptor_sp is the top limit for the heap
  :                            366 				. of descriptors of memory assigned in groups of pages
  :                            367 
  :                            368 				. base of page group descriptor heap follows
  :                            369 				. a list of device_key(1..63) of peripheral spaces
  :                            370 				. and non-executable memory arrays
  :                            371 				. with internal organisational structures
  :                            372 
  :                            373 				. *next points to available descriptor
  :                            374 				. at pages groups heap top
  :                            375 
  :                            376 				. there are 64 free-chains by size into the
  :                            377 				. pages groups heap and one free-chain 
  :                            378 				. into the big-banks stack
  :                            379 	
  :                            380 				. small banks are assigned from low-order
  :                            381 				. locations upwards. The free chains
  :                            382 				. reassign free storage at the lowest
  :                            383 				. addresses first.
  :                            384 
  :                            385 				. Freed space above the highest
  :                            386 				. assigned small bank is recombined
  :                            387 				. as single free area between the
  :                            388 				. the stack of small banks which grows
  :                            389 				. upwards and compresses downwards, and
  :                            390 				. the stack of big banks, which grows
  :                            391 				. downwards and compresses upwards
  :                            392 
  :                            393 				. There is one large-banks free-chain
  :                            394 				. for all sizes. A big bank may combine
  :                            395 				. one to nearly 65536 adjacent physical
  :                            396 				. banks of 262144 words
  :                            397 
  :                            398 				. A single large bank may contain nearly
  :                            399 				. 1024 times the 16 Megaword Address space
  :                            400 
  :                            401 				. Arrays larger than address space
  :                            402 				. are accessed in moving address windows
  :                            403 
00:00115F 350000              +404 	lret	0		. the end of the measure subroutine
  :                            405 				. initialisation routine at startup
  :                            406 
  :                            407 
  :                            408 bank_free
00:001160 C601BA              +409 	jza	out_of_range	. when the dreaded NULL pointer strikes
  :                            410 
  :                            411 .	page_free
00:001161 051F00              +412 	on	see$all**(see$7*/MANAGER_BANKS)-1
00:001162 073003              +413 	ts	banks_lock_cell
00:001163 B60162              +414 	j	$-1			. consider cooling the waiting core
  :                            415 					. instead of spinning
  :                            416 
  :                            417 .	this is an lcal subroutine and can only be called
  :                            418 .	from interrupt code (internal interrupt, system start etc)
  :                            419 
  :                            420 .	the argument is a descriptor pointer in interrupt register A
  :                            421 .	because the routine which decided which descriptor stack
  :                            422 .	(lower/small banks or upper/big banks) already copied the
  :                            423 .	descriptor pointer from application register A, in order
  :                            424 .	to evaluate it.
  :                            425 .
  :                            426 .	This call is from other interrupt code
  :                            427 .	so registers addressed as storage operands are all
  :                            428 .	in the space 128..255
  :                            429 
  :                            430 .	test & set word banks_lock_cell is already obtained
  :                            431 
  :                            432 
Note: measure.msm Line 433: this tests a_x not a
00:001164 680084              +433 	tanu	large_bank_descriptor_sp
00:001165 D83006              +433 
00:001166 7E018C              +434 	jc	large_bank_free
  :                            435 
00:001167 683005              +436 	lb	next			. is this descriptor
00:001168 DCC002              +437 	anb, i	2, a			. the one below next-available
  :                            438 					. ie is it on the heap top?
00:001169 DE017E              +439 	jnzb	not_highest_bank
  :                            440 
  :                            441 spiral_again
00:00116A 203005              +442 	sa	next
  :                            443 
Note: measure.msm Line 444: this tests a_x not a
00:00116B 680084              +444 	tanu	(next_page_descriptor)
00:00116C D808DE              +444 
  :                            445 
  :                            446 	$if	1
00:00116D CE01B9              +447 	jzb	bank_free_return
  :                            448 	$else
  :                            449 	jzb	out_of_spiral
  :                            450 	$endif
  :                            451 
  :                            452 	$if	0
  :                            453 	z	banks_lock_cell		. free the lock at this point
  :                            454 	ts	banks_lock_cell		. and compete for it again
  :                            455 	j	$-1			. another CPU may be looping
  :                            456 
  :                            457 	la	next			. this value may have changed
  :                            458 	$endif
  :                            459 					. see if the bank now at the
00:00116E C5FFFE              +460 	aa, xi	-2			. heap top is on its free chain
  :                            461 
  :                            462 					. calculate the bank size
  :                            463 
00:00116F 68C003              +464 	lb	3, a			. next bank address minus
00:001170 D8C001              +465 	anb	1, a			. this bank address
  :                            466 
00:001171 553006              +467 	lx, xi	free_chain(1)-1		. index of free chain head is
  :                            468 					. size in pages minus 1
00:001172 800085              +469 	ax	b_x
  :                            470 
  :                            471 					. point towards the chain head
  :                            472 
00:001173 580082              +473 spiral	ly	x_x			. copy "this" to "previous"
00:001174 68A000              +474 	lb	0, x			. copy "next" to "this
  :                            475 
  :                            476 	$if	1
00:001175 CE01B9              +477 	jzb	bank_free_return
  :                            478 	$else
  :                            479 	jzb	out_of_spiral
  :                            480 	$endif
  :                            481 
00:001176 500085              +482 	lx	b_x
  :                            483 
Note: measure.msm Line 484: this tests a_x not a
00:001177 680084              +484 	tanu	x_x			. banks (and descriptors)
00:001178 D80082              +484 
  :                            485 					. at the lower addresses
  :                            486 					. are preferred for re-use
  :                            487 
  :                            488 					. therefore the chain starts
  :                            489 					. with lowest addresses, rises
  :                            490 					. and ends with null forward
  :                            491 					. pointer
  :                            492 
  :                            493 					. if you arrive at a higher
  :                            494 					. address in B, the bank is
  :                            495 					. not in the free chain, and
  :                            496 
  :                            497 	$if	1
00:001179 5E01B9              +498 	jnc	bank_free_return
  :                            499 	$else
  :                            500 	jnc	out_of_spiral		. consolidation stops here
  :                            501 	$endif
  :                            502 					. the candidate is still at
  :                            503 					. a higher address than the
00:00117A DE0173              +504 	jnzb	spiral			. free chain sample, move on
  :                            505 
  :                            506 
  :                            507 					. you have hit equal. Pull
  :                            508 					. the bank out of the free
  :                            509 					. chain and squash the
  :                            510 					. assigned heap top
  :                            511 
  :                            512 					. a = b
  :                            513 
00:00117B 68C000              +514 	lb	0, a			. copy next pointer of candidate
00:00117C 28B000              +515 	sb	0, y			. to next of previous
  :                            516 
00:00117D B6016A              +517 	j	spiral_again		. store new next-available
  :                            518 					. descriptor pointer
  :                            519 	$if	0
  :                            520 
  :                            521 out_of_spiral
  :                            522 	z	banks_lock_cell
  :                            523 out_of_range				. descriptor == NULL
  :                            524 	lret	0
  :                            525 	$endif
  :                            526 					. the freed bank isn't at
  :                            527 					. the top of the assigned
  :                            528 					. heap, so link it into its
  :                            529 					. free chain
  :                            530 not_highest_bank
00:00117E 68C003              +531 	lb	3, a			. size = next bank address
00:00117F D8C001              +532 	anb	1, a			. minus this bank address
  :                            533 
00:001180 553006              +534 	lx, xi	free_chain(1)-1		. chain index = size in pages
00:001181 800085              +535 	ax	b_x			. minus 1
  :                            536 
  :                            537 					. point at the free chain head
  :                            538 find_higher_point
00:001182 580082              +539 	ly	x_x			. copy "this" to "previous"
00:001183 68A000              +540 	lb	0, x			. copy "next" to "this"
00:001184 500085              +541 	lx	b_x
  :                            542 
00:001185 CE0189              +543 	jzb	found_higher_point	. end of chain
  :                            544 
00:001186 D80084              +545 	anb	a_x			. presumably a_x because call is from various ISRs
00:001187 5E0182              +546 	jnc	find_higher_point	. the chain sample is lower
  :                            547 
  :                            548 	$if	1
00:001188 CE01B9              +549 	jzb	bank_free_return
  :                            550 	$else
  :                            551 	jzb	bank_is_free
  :                            552 	$endif
  :                            553 
  :                            554 found_higher_point			. link into chain
00:001189 10C000              +555 	sx	0, a			. "next" = next-pointer of "this"
00:00118A 20B000              +556 	sa	0, y			. "this" = next-pointer of "previous"
  :                            557 bank_is_free
  :                            558 	$if	1
00:00118B B601B9              +559 	j	bank_free_return
  :                            560 	$else
  :                            561 	z	banks_lock_cell
  :                            562 	lret	0
  :                            563 	$endif
  :                            564 
  :                            565 
  :                            566 large_bank_free
  :                            567 
  :                            568 .	this is branched from bank_free when the storage to free
  :                            569 .	is in the downward-expanding/upward compressing stack of
  :                            570 .	large bank collections in high-order memory
  :                            571 
  :                            572 .	the last 2 instructions before getting here were
  :                            573 
  :                            574 .	tanu	large_bank_upper_limit_dp
  :                            575 .	jc	large_bank_free
  :                            576 
00:00118C CE01A2              +577 	jzb	large_bank_at_summit
  :                            578 
00:00118D 68C003              +579 	lb	3, a
00:00118E D8C001              +580 	anb	1, a
00:00118F 280086              +581 	sb	SIZE
00:001190 553046              +582 	lx, xi	free_chain(64)
00:001191 100088              +583 fsearch	sx	B4
00:001192 68A000              +584 	lb	0, x
00:001193 500085              +585 	lx	b_x
00:001194 CE019F              +586 	jzb	chain_insert
  :                            587 
00:001195 68A003              +588 	lb	3, x
00:001196 D8A001              +589 	anb	1, x
00:001197 D80086              +590 	anb	SIZE
00:001198 CE019B              +591 	jzb	position?
00:001199 5E0191              +592 	jnc	fsearch		. next in chain is smaller
00:00119A B6019F              +593 	j	chain_insert	. next in chain is larger
  :                            594 
  :                            595 position?
Note: measure.msm Line 596: this tests a_x not a
00:00119B 680084              +596 	tanu	x_x
00:00119C D80082              +596 
  :                            597 
  :                            598 	$if	1
00:00119D CE01B9              +599 	jzb	bank_free_return
  :                            600 	$else
  :                            601 	jzb	in_freechain_already
  :                            602 	$endif
  :                            603 				. descriptors are in the
  :                            604 				. same storage order as
  :                            605 				. their buffers
  :                            606 
  :                            607 				. for big banks the
  :                            608 				. stack grows downwards
  :                            609 				. the preferred re-use
  :                            610 				. order is furthest from
  :                            611 				. the middle first
  :                            612 
  :                            613 				. chain the freed descriptor
  :                            614 				. in front of the first
  :                            615 				. which, within size subchain,
  :                            616 				. is at a lower storage address
  :                            617 
00:00119E 5E0191              +618 	jnc	fsearch
  :                            619 
  :                            620 chain_insert
00:00119F 208088              +621 	sa	*B4
00:0011A0 10C000              +622 	sx	0, a
  :                            623 in_freechain_already
  :                            624 	$if	1
00:0011A1 B601B9              +625 	j	bank_free_return
  :                            626 	$else
  :                            627 	z	banks_lock_cell
  :                            628 	lret	0
  :                            629 	$endif
  :                            630 
  :                            631 large_bank_at_summit
00:0011A2 C50002              +632 	aa, xi	2
00:0011A3 203006              +633 	sa	large_bank_descriptor_sp
  :                            634 
  :                            635 				. bank array + 1 is the
  :                            636 				. new lower edge of the
  :                            637 				. bank stack
  :                            638 
  :                            639 				. now spiral up compressing
  :                            640 				. any free banks which are now
  :                            641 				. at the stack top
  :                            642 
  :                            643 	$if	0
  :                            644 	z	banks_lock_cell	. free the lock and compete
  :                            645 	ts	banks_lock_cell	. for it again. Other CPUs
  :                            646 	j	$-1		. may be revolving on it	
  :                            647 
  :                            648 	la	large_bank_descriptor_sp
  :                            649 	$endif
  :                            650 
  :                            651 				. this may now have a new value
  :                            652 				. during the unlocked nanowindow
  :                            653 				. see if is the address of a
  :                            654 				. descriptor in the free chain
  :                            655 
00:0011A4 68C003              +656 	lb	3, a		. calculate SIZE
00:0011A5 D8C001              +657 	anb	1, a		. because it shall be compared
00:0011A6 280086              +658 	sb	SIZE
  :                            659 
00:0011A7 553046              +660 	lx, xi	free_chain(64)
  :                            661 
  :                            662 big_spiral
  :                            663 
00:0011A8 580082              +664 	ly	x_x		. copy "this" to "previous"
00:0011A9 68A000              +665 	lb	0, x
00:0011AA CE01B9              +666 	jzb	end_big_spiral
  :                            667 
00:0011AB 500085              +668 	lx	b_x		. copy "next" to "this"
  :                            669 
00:0011AC 68D003              +670 	lb	3, b		. calculate the size of next
00:0011AD D8A001              +671 	anb	1, x
  :                            672 
Note: measure.msm Line 673: this tests a_x not a
00:0011AE 680084              +673 	tanu	SIZE		. compare for size
00:0011AF D80086              +673 
  :                            674 
00:0011B0 5E01A8              +675 	jnc	big_spiral	. it's smaller than this buffer
00:0011B1 DE01B9              +676 	jnzb	end_big_spiral	. it's larger than this buffer
  :                            677 				. and the chain is in size order
  :                            678 
Note: measure.msm Line 679: this tests a_x not a
00:0011B2 680084              +679 	tanu	x_x		. if you reach lower than "you"
00:0011B3 D80082              +679 
  :                            680 				. within size
  :                            681 
  :                            682 				. then the bank/multibank
  :                            683 				. at assigned stack top
  :                            684 				. is not free and the stack
  :                            685 				. compression is over
  :                            686 
00:0011B4 5E01A8              +687 	jnc	big_spiral	. higher than you, keep going
00:0011B5 DE01B9              +688 	jnzb	end_big_spiral	. lower than you. The candidate
  :                            689 				. buffer is not free
  :                            690 				. compression is complete
  :                            691 
  :                            692 
  :                            693 				. replace the upper pointer
  :                            694 				. x = a
  :                            695 
00:0011B6 50A000              +696 	lx	0, x		. previous->next = this->next
00:0011B7 10B000              +697 	sx	0, y		. out of the chain
  :                            698 
00:0011B8 B601A2              +699 	j	large_bank_at_summit
  :                            700 
  :                            701 end_big_spiral
  :                            702 bank_free_return
00:0011B9 303003              +703 	z	banks_lock_cell
  :                            704 out_of_range
00:0011BA 350000              +705 	lret	0
  :                            706 
  :                            707 
  :                            708 available_banks
00:0011BB 051F00              +709 	on	 see$all**(see$7*/MANAGER_BANKS)-1
00:0011BC 503006              +710 	lx	large_bank_descriptor_sp
00:0011BD 60A001              +711 	la	1, x
00:0011BE 503005              +712 	lx	next		. the consolidated free space
00:0011BF D0A001              +713 	ana	1, x		. between large banks and small banks
  :                            714 
00:0011C0 553007              +715 	lx, xi	free_chain(1)
00:0011C1 453046              +716 	lr, xi	free_chain(64)
  :                            717 
  :                            718 add_chain
00:0011C2 58A000              +719 	ly	0, x
00:0011C3 700083              +720 	tz	y_x
00:0011C4 3E01C9              +721 	lcal	add_chain_total
00:0011C5 F601C8              +722 	jxge	chains_added
00:0011C6 850001              +723 	ax, xi	1
00:0011C7 B601C2              +724 	j	add_chain
  :                            725 chains_added
00:0011C8 350000              +726 	lret
  :                            727 
  :                            728 add_chain_total
00:0011C9 68B003              +729 	lb	3, y		. difference next higher bank
00:0011CA D8B001              +730 	anb	1, y		. and this bank
00:0011CB C00085              +731 	aa	b_x
00:0011CC 58B000              +732 	ly	0,y
00:0011CD 700083              +733 	tz	y_x
00:0011CE B601C9              +734 	j	add_chain_total
00:0011CF 350000              +735 	lret	0		. and of this free chain
  :                            736 
  :                            737 
00:0011D0 C5FFFF              +738 bank	aa, xi	-1
00:0011D1 5E0230              +739 	jnc	cannot_add_bank
00:0011D2 06000C              +740 	sar	12
Note: measure.msm Line 741: this tests a_x not a
00:0011D3 680084              +741 	tanu,xi	63			. decide whether < 262144 words
00:0011D4 DD003F              +741 
  :                            742 					. because big banks are in
  :                            743 					. high memory and smaller ones
  :                            744 					. in low memory
  :                            745 
00:0011D5 051F00              +746 	on	see$all**(see$7*/MANAGER_BANKS)-1
  :                            747 
00:0011D6 073003              +748 	ts	banks_lock_cell
00:0011D7 B601D6              +749         j	$-1
  :                            750 					. carry is from ANU,XI 63
  :                            751 					. if set, it means 262144+ words
  :                            752 					. have been requested
  :                            753 
  :                            754 					. free banks from 262144 words to
  :                            755 					. 16 gigawords are listed by size
  :                            756 					. and position on free_chain(64)
  :                            757 
  :                            758 					. within size, the large banks
  :                            759 					. furthest from the centre of
  :                            760 					. storage are offered first for
  :                            761 					. re-use
  :                            762 
  :                            763 					. that means free large banks at
  :                            764 					. higher addresses are prefered for
  :                            765 					. re-use, because large banks are
  :                            766 					. stacked downward from high memory
  :                            767 					. _________________________________
  :                            768 
00:0011D8 7E0204              +769 	jc	large_bank		. carry was set or cleared by the ANU
  :                            770 					. instruction
  :                            771 
  :                            772 					. the TS instruction does not touch
  :                            773 					. carry
  :                            774 					. ________________________________
  :                            775 
  :                            776 					. free banks from 4096 words to
  :                            777 					. 252K words (262144 words minus 4096)
  :                            778 					. are listed by position on
  :                            779 					. free_chain(1..63)
  :                            780 
  :                            781 					. within their one-size chains,
  :                            782 					. 4K..252K banks furthest from
  :                            783 					. the centre of memory are offered
  :                            784 					. for re-use first
  :                            785 
  :                            786 					. that means "small" banks at
  :                            787 					. lower addresses are prefered
  :                            788 					. for re-use, because they are
  :                            789 					. stacked upwards from low memory
00:0011D9 543007              +790 	lx, i	free_chain(1)
00:0011DA 800084              +791 	ax	a_x
  :                            792 
00:0011DB 68A000              +793 	lb	0, x
00:0011DC CE01E2              +794 	jzb	not_on_list		. free chain head is zero
  :                            795 
00:0011DD 60D000              +796 	la	0, b			. buffer on free chain
00:0011DE 20A000              +797 	sa	0, x
00:0011DF 60D001              +798 	la	1, b
00:0011E0 303003              +799 	z	banks_lock_cell
00:0011E1 350000              +800 	lret	0
  :                            801 
  :                            802 not_on_list
00:0011E2 5CC001              +803 	ly, i	1, a			. convert page high index in A
  :                            804 					. to size required in Y
00:0011E3 683005              +805 	lb	next
00:0011E4 603049              +806 	la	next_tdescriptor_sp	. lowest thread descriptor
  :                            807 					. = limit of small bank descriptors
  :                            808 
00:0011E5 44D002              +809 	lr, i	2, b			. this bank descriptor + 1	
00:0011E6 D4D004              +810 	ana, i	4, b			. new next bank descriptor + 1
00:0011E7 5E01F4              +811 	jnc	take_any_bank
00:0011E8 60D001              +812 	la	1, b			. the new bank handle
00:0011E9 200086              +813 	sa	128+6
00:0011EA 880084              +814 	ay	a_x			. new next bank handle
00:0011EB 603006              +815 	la	large_bank_descriptor_sp
00:0011EC 60C001              +816 	la	1, a			. lower edge of big banks
00:0011ED D00083              +817 	ana	y_x
00:0011EE 5E01F4              +818 	jnc	take_any_bank
00:0011EF 600086              +819 	la	128+6
00:0011F0 18D003              +820 	sy	3, b			. new next bank
00:0011F1 003005              +821 	sr	next
00:0011F2 303003              +822 	z	banks_lock_cell
00:0011F3 350000              +823 	lret	0
  :                            824 
  :                            825 
  :                            826 take_any_bank
  :                            827 					. here is the last resort
  :                            828 					. for an ordinary "small" bank
  :                            829 
  :                            830 					. you can have something larger
  :                            831 					. if it is free
  :                            832 
  :                            833 					. the awarded bank stays at
  :                            834 					. its larger size,
  :                            835 
  :                            836 
00:0011F4 453046              +837 	lr, xi	free_chain(64)		. as a last resort, any bank at
  :                            838 					. the front of the big bank chain,
  :                            839 					. free_chain(64), is awarded
  :                            840 
  :                            841 					. so the brakes go on to the
  :                            842 					. JXGE comparison after
  :                            843 					. free_chain(64) has been
  :                            844 					. interrogated
  :                            845 
  :                            846 					. initially you can't be
  :                            847 					. at a higher notch than
  :                            848 					. free_chain(63)
  :                            849 take_any
00:0011F5 850001              +850 	ax,xi	1
00:0011F6 68A000              +851 	lb	0, x
00:0011F7 DE01FA              +852 	jnzb	take_bank		. free bank on this chain
00:0011F8 F6022F              +853 	jxge	bank_not_obtained
00:0011F9 B601F5              +854 	j	take_any		. try the next larger
  :                            855 take_bank
00:0011FA 60D000              +856 	la	0, b			. yes there is. Promote the 2nd
00:0011FB 20A000              +857 	sa	0, x			. descriptor on the free chain to 1st
  :                            858 
00:0011FC 60D001              +859 	la	1, b			. read the bank start page handle
00:0011FD 303003              +860 	z	banks_lock_cell
00:0011FE 350000              +861 	lret	0
  :                            862 
  :                            863 
  :                            864 array					. a very large bank
  :                            865 					. > 16777215 words
  :                            866 					. the request is expressed
  :                            867 					. in pages of 4096 words
00:0011FF C5FFFF              +868 	aa, xi	-1
00:001200 5E0230              +869 	jnc	cannot_add_bank
  :                            870 
  :                            871 array_high_ix
00:001201 051F00              +872 	on	see$all**(see$7*/MANAGER_BANKS)-1
  :                            873 
00:001202 073003              +874 	ts	banks_lock_cell
00:001203 B60202              +875 	j	$-1
  :                            876 	
  :                            877 	.	make sure this falls thru
  :                            878 
  :                            879 large_bank
00:001204 060006              +880 	sar	6			. translate page high index
  :                            881 
00:001205 6CC001              +882 	lb, i	1, a			. to # banks requested
00:001206 2E0006              +883 	sbl	6
00:001207 280086              +884 	sb	REQUIRED		. = highest bank index required
  :                            885 					. + 64 pages
  :                            886 
00:001208 300087              +887 	z	OUTSIZE
  :                            888 
00:001209 553046              +889 	lx, xi	free_chain(64)		. not the pointer
  :                            890 					. but its address
00:00120A 100088              +891 bsearch	sx	B4
00:00120B 68A000              +892 	lb	0, x
00:00120C 500085              +893 	lx	b_x
  :                            894 
00:00120D CE0216              +895 	jzb	new_large_bank
  :                            896 
00:00120E 60A003              +897 	la	3, x
00:00120F 40A001              +898 	lr	1, x
Note: measure.msm Line 899: this tests a_x not a
00:001210 680084              +899 	tanu	r_x
00:001211 D80080              +899 
00:001212 D80086              +900 	anb	REQUIRED
  :                            901 
00:001213 5E020A              +902 	jnc	bsearch		. what you want is bigger than
  :                            903 				. what you found
  :                            904 
00:001214 CE0222              +905 	jzb	bfound		. you found what you want
  :                            906 
00:001215 100087              +907 	sx	OUTSIZE		. what you found is bigger than
  :                            908 				. what you want
  :                            909 
  :                            910 new_large_bank
00:001216 503006              +911 	lx	large_bank_descriptor_sp
00:001217 85FFFE              +912 	ax, xi	-2		. guaranteed space for
  :                            913 				. the descriptor itself
  :                            914 
00:001218 60A003              +915 	la	3, x
00:001219 D00086              +916 	ana	REQUIRED	. address of new big bank
00:00121A 5E022F              +917 	jnc	bank_not_obtained
  :                            918 
00:00121B 583005              +919 	ly	next		. does it overlap the
Note: measure.msm Line 920: this tests a_x not a
00:00121C 680084              +920 	tanu	1, y		. highest assigned small bank?
00:00121D D8B001              +920 
  :                            921 
00:00121E 7E0229              +922 	jc	add_large_bank
  :                            923 
00:00121F 680087              +924 	lb	OUTSIZE
00:001220 DE0223              +925 	jnzb	bfound1
00:001221 B6022F              +926 	j	bank_not_obtained
  :                            927 
00:001222 680082              +928 bfound	lb	x_x
00:001223 60D000              +929 bfound1	la	0, b		. take B out of the freechain
00:001224 208088              +930 	sa	*B4
00:001225 600080              +931 	la	r_x		. retrieve the buffer pointer
00:001226 9008CA              +932 	or	(0400000)	. turn the big flag on for the user
00:001227 303003              +933 	z	banks_lock_cell
00:001228 350000              +934 	lret	0
  :                            935 
  :                            936 add_large_bank
00:001229 680082              +937 	lb	x_x
00:00122A 103006              +938 	sx	large_bank_descriptor_sp
00:00122B 20A001              +939 	sa	1, x		. write the handle in the descriptor
00:00122C 9008CA              +940 	or	(0400000)	. turn the big flag on for the user
00:00122D 303003              +941 	z	banks_lock_cell
00:00122E 350000              +942 	lret	0
  :                            943 
  :                            944 bank_not_obtained
00:00122F 303003              +945 	z	banks_lock_cell
  :                            946 cannot_add_bank
00:001230 650000              +947 	la, xi	0
00:001231 6DFFFF              +948 	lb, xi	-1
00:001232 350000              +949 	lret	0
  :                            950 
  :                            951 .	process initial thread directly owns any more threads
  :                            952 .	even if threads start them
  :                            953 .	they are all on one chain from process initial thread
  :                            954 .	there is no hierarchy to walk on process exit
  :                            955 
  :                            956 .	individually exiting threads leave the chain
  :                            957 .	before their TCB is pooled
  :                            958 .	so that an exiting process does not try to stop
  :                            959 .	threads which are not there via TCBs which are
  :                            960 .	already re-used in some different way
  :                            961 
  :                            962 remove_thread
00:001233 040041              +963 	inA	65		. keep exiting TCB
00:001234 F80084              +964 	push	a_x		. on the stack top as comparand
00:001235 601002              +965 	la	WALKUP		. chain starts with process thread
00:001236 681007              +966 	lb	NEXT_THREAD	. next from exiting thread
00:001237 4DFFFF              +967 	lk	-1,,xi
  :                            968 
  :                            969 retrieve_thread
00:001238 140041              +970 	outA	65
00:001239 601007              +971 	la	NEXT_THREAD
00:00123A C6023E              +972 	jza	remove_threadx	. it is not there
00:00123B AFF000              +973 	mta	0, sp		. is next the exiting thread?
00:00123C B60238              +974 	j	retrieve_thread
00:00123D 281007              +975 	sb	NEXT_THREAD	. point past the exit thread	
  :                            976 	
  :                            977 remove_threadx
00:00123E 380084              +978 	pop	a_x		. retrieve the exiting TCB
00:00123F 140041              +979 	outA	65		. base it again
00:001240 350001              +980 	lret	1		. continue the thread delete
  :                            981 
  :                            982 threads_down			. mark them down
00:001241 601007              +983 	la	NEXT_THREAD
00:001242 C6024C              +984 	jza	threadx_down
  :                            985 
  :                            986 threads_next_down
00:001243 34002C              +987 	sabr	BVOLATILE_I
  :                            988 
00:001244 9008DF              +989 	or	(THREAD$HALT:s)	. broadcast halt request
  :                            990 
00:001245 4DFFFF              +991 	lk	-1,,xi		. to all cores in case thread is running
00:001246 14004F              +992 	outA	MCAST_TO$	. thread cannot run
  :                            993 				. with thread and process resources deleted
  :                            994 
00:001247 5088E0              +995 	lx	*(BVOLATILE_I*/12++TDESCRIPTOR-01000)
00:001248 6008E1              +996 	la	(EXIT)					. ?(TIME_WAIT++EXIT:s)
00:001249 20A002              +997 	sa	2, x
  :                            998 
00:00124A 6088E2              +999 	la	*(BVOLATILE_I*/12++NEXT_THREAD-01000)
00:00124B D60243              +1000 	jnza	threads_next_down
  :                            1001 
  :                            1002 threadx_down
00:00124C 350000              +1003 	lret	0
  :                            1004 
  :                            1005 tdescriptor_free
00:00124D F80082              +1006 	push	x_x
00:00124E FD0007              +1007 	push	MAX_INT_MASK,,xi
00:00124F 27F000              +1008 	sim	0, sp		. don't get interrupted in here
  :                            1009 
00:001250 073004              +1010 	ts	threads_lock_cell
00:001251 B60250              +1011 	j	$-1
00:001252 683049              +1012 	lb	next_tdescriptor_sp
00:001253 B80082              +1013 	xorB	x_x
00:001254 CE0259              +1014 	jzb	tdescriptor_sp_plus
00:001255 683048              +1015 	lb	free_tdescriptor
00:001256 28A000              +1016 	sb	0, x
00:001257 103048              +1017 	sx	free_tdescriptor
00:001258 B6025B              +1018 	j	tdescriptor_freex
  :                            1019 
  :                            1020 tdescriptor_sp_plus
00:001259 850008              +1021 	ax	TDESCRIPTOR_WORDS,,xi
00:00125A 103049              +1022 	sx	next_tdescriptor_sp
  :                            1023 
  :                            1024 tdescriptor_freex
00:00125B 303004              +1025 	z	threads_lock_cell
00:00125C 27F000              +1026 	sim	0, sp
00:00125D 17008F              +1027 	inc	sp_x
00:00125E 380082              +1028 	pop	x_x
00:00125F 350000              +1029 	lret	0
  :                            1030 
  :                            1031 
00:001260 055F00              +1032 exit	on	see$1++see$all**(see$7*/MANAGER_BANKS)-1
00:001261 501001              +1033 	lx	TDESCRIPTOR
00:001262 301001              +1034 	z	TDESCRIPTOR	. stop the TCB from looking like itself
  :                            1035 
00:001263 6008E1              +1036 	la	(EXIT)
00:001264 20A002              +1037 	sa	2, x
00:001265 3E024D              +1038 	lcal	tdescriptor_free
  :                            1039 
00:001266 701002              +1040 	tz	WALKUP		. if this is not the initial thread
00:001267 3E0233              +1041 	lcal	remove_thread	. take it out of the thread chain and return + 1
00:001268 3E0241              +1042 	lcal	threads_down	. stop threads scheduling
  :                            1043 
00:001269 601004              +1044 delete	la	BANK_CHAIN
  :                            1045 delete_another			. TCB is certainly there
00:00126A F8C000              +1046 	push	0, a
00:00126B 3E0160              +1047 	lcal	bank_free
00:00126C 380084              +1048 	pop	a_x
00:00126D D6026A              +1049 	jnza	delete_another	. if you did this see$1 is on
  :                            1050 				. and still is
  :                            1051 
00:00126E 701140              +1052 	tz	TERAFRAME_CHAIN(1)
00:00126F 3E07C8              +1053 	lcal	teraframe:free_teraframes
00:001270 350000              +1054 	lret	0
  :                            1055 
  :                            1056 exit_ii
00:001271 3E0260              +1057 	lcal	exit
  :                            1058 
00:001272 40008F              +1059 	lr	sp_x
00:001273 650080              +1060 	la	128,,xi		. core resume needs sp_x @ 128
00:001274 20008F              +1061 	sa	sp_x
  :                            1062 
00:001275 B602F0              +1063 	j	core_resume
  :                            1064 
  :                            1065 
  :                            1066 QUIET_SAVE* $proc
  :                            1067 qsave	ql	0, y
  :                            1068 	qs	0, x
  :                            1069 	ax	4,,xi
  :                            1070 	ay	4,,xi
  :                            1071 	jdr	qsave
  :                            1072 	$end
  :                            1073 
  :                            1074 write_trail
00:001276 001500              +1075 	sr	RESTART_TRACE_IREG
00:001277 081501              +1076 	sk	RESTART_TRACE_IREG+1
00:001278 101502              +1077 	sx	RESTART_TRACE_IREG+2
00:001279 181503              +1078 	sy	RESTART_TRACE_IREG+3
00:00127A 471504              +1079 	qs	RESTART_TRACE_IREG+4
  :                            1080 
00:00127B 052000              +1081 	on	see$2		. kernel vectors
00:00127C 040041              +1082 	inA	65
00:00127D 2028FC              +1083 	sa	RESTART_FRAME
  :                            1084 
00:00127E 5D0000              +1085 	ly	0,,xi
00:00127F 551480              +1086 	lx	RESTART_TRACE_AREG,,xi
00:001280 45001F              +1087 	lr	128/4-1,,xi
00:001281 4FB000              +1088 	QUIET_SAVE
00:001282 47A000              +1088 
00:001283 850004              +1088 
00:001284 8D0004              +1088 
00:001285 1E0281              +1088 
  :                            1089 
00:001286 5D0088              +1090 	ly	128+8,,xi
00:001287 551508              +1091 	lx	RESTART_TRACE_IREG+8,,xi
00:001288 45001D              +1092 	lr	128/4-1-2,,xi
00:001289 4FB000              +1093 	QUIET_SAVE
00:00128A 47A000              +1093 
00:00128B 850004              +1093 
00:00128C 8D0004              +1093 
00:00128D 1E0289              +1093 
  :                            1094 
00:00128E 5D1000              +1095 	ly	01000,,xi
00:00128F 551400              +1096 	lx	RESTART_TRACE_TCB,,xi
00:001290 45001F              +1097 	lr	128/4-1,,xi
00:001291 4FB000              +1098 	QUIET_SAVE
00:001292 47A000              +1098 
00:001293 850004              +1098 
00:001294 8D0004              +1098 
00:001295 1E0291              +1098 
  :                            1099 
00:001296 4FE000              +1100 	ql	0, fp
00:001297 47143C              +1101 	qs	RESTART_TRACE_ISTAC_FRAME
00:001298 040001              +1102 	inA	1
00:001299 201441              +1103 	sa	RESTART_TRACE_ABT+1
  :                            1104 
00:00129A 4F1180              +1105 	ql	TAG
00:00129B 471580              +1106 	qs	RESTART_TRACE_THREAD_NAME
  :                            1107 
  :                            1108 	$if	1
00:00129C 04004D              +1109 	inA	77
00:00129D C602A2              +1110 	jza	restart_go
00:00129E 4D0001              +1111 	lk	1,,xi		. core zero must do this
00:00129F 650002              +1112 	la	RESTART$1,,xi	. latent parameter is the function part here
00:0012A0 14004F              +1113 	outA	MCAST_TO$	. place core zero in restart ISR
00:0012A1 F708E5              +1114 	go	(0800000++$0p1(smp_pend, 0L)s)	. restart page 0
  :                            1115 
  :                            1116 restart_go
00:0012A2 F708E8              +1117 	go	(0800000++$0p1(restart, 0L)s)	. restart page 0
  :                            1118 
  :                            1119 	$else
  :                            1120 	j	restart
  :                            1121 	$endif
  :                            1122 
  :                            1123 guard_ii
00:0012A3 78F001              +1124 	tp	1, sp		. did this happen in an ISR?
00:0012A4 75003F              +1125 	ii	63		. no return to here unless the application caused it
  :                            1126 
00:0012A5 055F00              +1127 	on	see$all--see$2
00:0012A6 781008              +1128 	tp	ERROR_RESTART	. is the thread indispensible to system run?
00:0012A7 B60276              +1129 	j	write_trail	. write trace and restart the system
  :                            1130 
00:0012A8 501001              +1131 	lx	TDESCRIPTOR
00:0012A9 6008E9              +1132 	la	(TRAP)
00:0012AA 20A002              +1133 	sa	2, x		. fall thru to immediate yield
  :                            1134 
00:0012AB 4FE000              +1135 yield	ql	0, fp		. retrieve the interrrupted application frame
  :                            1136 				. switch visibility to TCB and kernel banks
  :                            1137 
00:0012AC 055F00              +1138 	on	see$1++see$all**(see$7*/MANAGER_BANKS)-1
  :                            1139 
00:0012AD 47103C              +1140 	qs	UPACKET		. interrupt stack frame of application -> TCB
  :                            1141 
00:0012AE 783002              +1142 	tp	energy$advise
00:0012AF 3E06FF              +1143 	lcal	irespite
  :                            1144 
00:0012B0 501001              +1145 	lx	TDESCRIPTOR
00:0012B1 60A002              +1146 	la	2, x
00:0012B2 A008E1              +1147 	and	(EXIT)
00:0012B3 D60271              +1148 	jnza	exit_ii
  :                            1149 
00:0012B4 040001              +1150 	inA	1		. relocation pointer, application private stack page
00:0012B5 201041              +1151 	sa	ABT+1		. other relocation pointers do not need saving
00:0012B6 600093              +1152 	la	fp$guard
00:0012B7 20103B              +1153 	sa	FP_FRAP
  :                            1154 
  :                            1155 	$if	$LOCK_SWITCH
00:0012B8 450007              +1156 	lr	7,,xi		. external interrupts remain pending
00:0012B9 270080              +1157 	sim	r_x		. ISR r
00:0012BA 000092              +1158 	sr	x$save2
  :                            1159 	$endif
  :                            1160 
00:0012BB 40008F              +1161 	lr	sp_x		. keep aside the value of the interrupt sp
00:0012BC 30008F              +1162 	z	sp_x		. point interrupt sp to start of user registers
  :                            1163 				. 32 stores for 128 registers
  :                            1164 
00:0012BD 8710C0              +1165 ?	$do	128/4,	qpop	RSAVE+4*?-4
00:0012BE 8710C4              +1165 
00:0012BF 8710C8              +1165 
00:0012C0 8710CC              +1165 
00:0012C1 8710D0              +1165 
00:0012C2 8710D4              +1165 
00:0012C3 8710D8              +1165 
00:0012C4 8710DC              +1165 
00:0012C5 8710E0              +1165 
00:0012C6 8710E4              +1165 
00:0012C7 8710E8              +1165 
00:0012C8 8710EC              +1165 
00:0012C9 8710F0              +1165 
00:0012CA 8710F4              +1165 
00:0012CB 8710F8              +1165 
00:0012CC 8710FC              +1165 
00:0012CD 871100              +1165 
00:0012CE 871104              +1165 
00:0012CF 871108              +1165 
00:0012D0 87110C              +1165 
00:0012D1 871110              +1165 
00:0012D2 871114              +1165 
00:0012D3 871118              +1165 
00:0012D4 87111C              +1165 
00:0012D5 871120              +1165 
00:0012D6 871124              +1165 
00:0012D7 871128              +1165 
00:0012D8 87112C              +1165 
00:0012D9 871130              +1165 
00:0012DA 871134              +1165 
00:0012DB 871138              +1165 
00:0012DC 87113C              +1165 
  :                            1166 
  :                            1167 				. interrupt SP now contains 128
  :                            1168 
00:0012DD 073047              +1169 	ts	switch_lock_cell
00:0012DE 3E00DD              +1170 	REBOUND75		. j	$-1
  :                            1171 
  :                            1172 	$if	T$SLICE
00:0012DF 60A002              +1173 	la	2, x		. what's in the flags?
00:0012E0 9E02E3              +1174 	jao	qpriority	. external interrupt wait: schedule prioritised when it happens
  :                            1175 
00:0012E1 65306C              +1176 	la	stem(PRIORITIES),,xi
00:0012E2 B602EB              +1177 	j	requeue		. schedule after timeslice or at iowait of other threads
  :                            1178 
  :                            1179 qpriority
  :                            1180 	$endif			. TSLICE
  :                            1181 
00:0012E3 600095              +1182 	la	PRIORITY$	. copy of thread priority in interrupt register 149
Note: measure.msm Line 1183: this tests a_x not a
00:0012E4 680084              +1183 	tanu,xi	PRIORITIES
00:0012E5 DD0008              +1183 
  :                            1184 
00:0012E6 5E02E9              +1185 	jnc	in_order
  :                            1186 
  :                            1187 				. surprising this this ever happens
00:0012E7 650007              +1188 	la	PRIORITIES-1,,xi
00:0012E8 20A001              +1189 	sa	1, x		. but if it does update the thread descriptor
  :                            1190 in_order
  :                            1191 
00:0012E9 260002              +1192 	sal	2		. address the 4-word priority list tail pointer
00:0012EA C53050              +1193 	aa, xi	stem(1)
  :                            1194 
00:0012EB 68C003              +1195 requeue	lb	3, a	. uplink to last in priority chain
00:0012EC 10C003              +1196 	sx	3, a	. new last <-
00:0012ED 10D000              +1197 	sx	0, b	. old_last->next
00:0012EE 20A000              +1198 	sa	0, x	. ->next = stem_post
  :                            1199 
00:0012EF B602F5              +1200 	j	choose	. lock is already locked
  :                            1201 
  :                            1202 core_resume
  :                            1203 	$if	$LOCK_SWITCH
00:0012F0 650007              +1204 	la	7,,xi
00:0012F1 200092              +1205 	sa	x$save2
00:0012F2 270092              +1206 	sim	x$save2
  :                            1207 	$endif
  :                            1208 
  :                            1209 core_resume1		. if come_from is anywhere except fall_thru from yield
00:0012F3 073047              +1210 	ts	switch_lock_cell
00:0012F4 3E00DD              +1211 	REBOUND75	. j	core_resume1
  :                            1212 
  :                            1213 choose			. now load another task
  :                            1214 			. run forward from the lowest priority chain tail
  :                            1215 			. to the first task descriptor in the highest priority chain
  :                            1216 
  :                            1217 	$if	TDESCRIPTOR_WORDS>6
  :                            1218 
00:0012F5 04004D              +1219 	inA	CORE_SOCKET$
00:0012F6 6D0001              +1220 	lb	1,,xi
00:0012F7 2EC000              +1221 	sbl	0, a
00:0012F8 480085              +1222 	lk	b_x		. k contains the log of the core-id all through choose
  :                            1223 				. for candidate threads which have an affinity mask
  :                            1224 
  :                            1225 p	$proc	*		. 2-pass proc for forward references
  :                            1226 masked_test_jump* $name
  :                            1227 	lb	p(1)
  :                            1228 	jzb	not_masked	. least costly path when there is no mask
  :                            1229 
  :                            1230 	lb	k_x		. b_x can be re-used, load 1 */ core_index 
  :                            1231 	andB	p(1)		. 2nd storage read of mask
  :                            1232 
  :                            1233 	jzb	p(2)		. this core does not match any mask bit
  :                            1234 
  :                            1235 not_masked 
  :                            1236 	$end
  :                            1237 
  :                            1238 	$endif			. TDESCRIPTOR_WORDS>6	= thread affinity supported
  :                            1239 
00:0012F9 65306C              +1240 	la,xi	stem(PRIORITIES)
00:0012FA 580084              +1241 forward	ly	a_x		. previous,,xi
00:0012FB 60C000              +1242 	la	0, a
00:0012FC 78C001              +1243 	tn	1, a		. a thread or a priority stem post?
00:0012FD B602FF              +1243 
00:0012FE B60307              +1244 	j	forward2thread	. a thread
Note: measure.msm Line 1245: this tests a_x not a
00:0012FF 680084              +1245 	tanu	stem(PRIORITIES),,xi	. are we where we started?
00:001300 DD306C              +1245 
00:001301 DE02FA              +1246 	jnzb	forward		. don't schedule the stem post. It is not a thread
  :                            1247 
00:001302 303047              +1248 	z	switch_lock_cell	. there are fewer ready threads than cores
00:001303 CF08EA              +1249 	dl	(CHILLDOWN, REST_GRANULE:d)	. core can rest substantial time
00:001304 1C0067              +1250 	outB	chill$down
00:001305 140066              +1251 	outA	INDICATION$
  :                            1252 
00:001306 B602F3              +1253 	j	core_resume1
  :                            1254 
  :                            1255 forward2thread
00:001307 68C002              +1256 	lb	2, a
00:001308 CE030F              +1257 	jzb	switch_select	. advance to check afinity
00:001309 A808E1              +1258 	andB	(EXIT)		. check asynchronously flagged EXIT
00:00130A DE0314              +1259 	jnzb	unconditionally	. deschedule / remove  whatever flags other
  :                            1260 
00:00130B 78C002              +1261 	tp	2, a		. flag 23 is timewait in descriptor words 4:5
00:00130C 3E0537              +1262 	lcal	timer_check	. leaving timewait clears all inhibit flags
00:00130D 70C002              +1263 	tz	2, a		. clear to run?
00:00130E B602FA              +1264 	j	forward		. no
  :                            1265 				. yes
  :                            1266 switch_select
  :                            1267 	$if	TDESCRIPTOR_WORDS>6		.	= thread affinity supported
00:00130F 68C006              +1268 	masked_test_jump	6, a	forward
00:001310 CE0314              +1268 
00:001311 680081              +1268 
00:001312 A8C006              +1268 
00:001313 CE02FA              +1268 
  :                            1269 	$endif
  :                            1270 
  :                            1271 unconditionally
00:001314 50C000              +1272 	lx	0, a		. ->next becomes previous->next
00:001315 10B000              +1273 	sx	0, y		. previous -> next
  :                            1274 
00:001316 78A001              +1275 	tp	1, x		. is he the stem post?
00:001317 18A003              +1276 	sy	3, x		. known by 1s complement PRIORITY
  :                            1277 				. if so, the uplink from
  :                            1278 				. stem post points to the new
  :                            1279 				. last in the priority list
  :                            1280 
00:001318 303047              +1281 	z	switch_lock_cell
  :                            1282 
00:001319 68C003              +1283 	lb	3, a	. retrieve the TCB relocation pointer from the descriptor
00:00131A 1C0041              +1284 	outB	65	. base the TCB
  :                            1285 
  :                            1286 	$if	1
00:00131B 68C002              +1287 	lb	2, a
00:00131C A808E1              +1288 	andB	(EXIT)
00:00131D CE0320              +1289 	jzb	no_xflag
00:00131E 3E0260              +1290 	lcal	exit
00:00131F B602F3              +1291 	j	core_resume1
  :                            1292 no_xflag
  :                            1293 	$endif
  :                            1294 
00:001320 68C001              +1295 	lb	1, a		. copy priority level to interrupt register 149
00:001321 280095              +1296 	sb	PRIORITY$	. for quick reference
  :                            1297 
  :                            1298 	$if	T$SLICE		. when multiple priorities begin to be used
  :                            1299 				. priorities other than RT=0 need proportional time because
  :                            1300 				. mostly all of the switch chains are walked as 1 chain
  :                            1301 				. except rare cases when only RT threads are candidates
  :                            1302 
  :                            1303 	$do	PRIORITIES>8,	$flag	time slice table < priorities
00:001322 AD0007              +1304 	andB	+(1*/T$LOG(PRIORITIES))-1,,xi
00:001323 68D8EC              +1305 	lb	(0, T$SLICE*15, T$SLICE*12, T$SLICE*10, T$SLICE*8, T$SLICE*6, T$SLICE*5, T$SLICE*4o), b
00:001324 280094              +1306 	sb	REALTIME$_CLOCK
  :                            1307 				. the quanta are an instruction ration. Thread yields on decrement<0
  :                            1308 	$endif			. PRIORITY=0=realtime=no time slice, no decrement, no automatic yield
  :                            1309 				. no decrementation takes place during interrupt code
  :                            1310 
  :                            1311 	$if	0
  :                            1312 	lb	2, a		. read the flags word again
  :                            1313 	andB	(EXIT)		. thread EXIT flagged while unswitched?
  :                            1314 	jzb	run_forward	. no
  :                            1315 	lb	1,,xi		. force yield after 1-instruction timeslice
  :                            1316 	sb	REALTIME$_CLOCK	. then EXIT flag will end the thread
  :                            1317 run_forward
  :                            1318 	$endif
  :                            1319 
00:001325 651042              +1320 	la, xi	ABT+2		. application data relocation registers
  :                            1321 				. never need saving, only loading
00:001326 240002              +1322 ?	$do	64/2-1,	reload	2*?
00:001327 240004              +1322 
00:001328 240006              +1322 
00:001329 240008              +1322 
00:00132A 24000A              +1322 
00:00132B 24000C              +1322 
00:00132C 24000E              +1322 
00:00132D 240010              +1322 
00:00132E 240012              +1322 
00:00132F 240014              +1322 
00:001330 240016              +1322 
00:001331 240018              +1322 
00:001332 24001A              +1322 
00:001333 24001C              +1322 
00:001334 24001E              +1322 
00:001335 240020              +1322 
00:001336 240022              +1322 
00:001337 240024              +1322 
00:001338 240026              +1322 
00:001339 240028              +1322 
00:00133A 24002A              +1322 
00:00133B 24002C              +1322 
00:00133C 24002E              +1322 
00:00133D 240030              +1322 
00:00133E 240032              +1322 
00:00133F 240034              +1322 
00:001340 240036              +1322 
00:001341 240038              +1322 
00:001342 24003A              +1322 
00:001343 24003C              +1322 
00:001344 24003E              +1322 
  :                            1323 
00:001345 601041              +1324 	la	ABT+1		. relocation register to application private stack page
00:001346 140001              +1325 	outA	1		. not in scope of reload instruction
  :                            1326 
00:001347 60103B              +1327 	la	FP_FRAP
00:001348 200093              +1328 	sa	fp$guard
  :                            1329 
  :                            1330 			. ISR ISP still = 128. 32 load instructions for 128 registers
  :                            1331 
00:001349 8F113C              +1332 ?	$do	128/4,	qpush	RSAVE+128-4*?
00:00134A 8F1138              +1332 
00:00134B 8F1134              +1332 
00:00134C 8F1130              +1332 
00:00134D 8F112C              +1332 
00:00134E 8F1128              +1332 
00:00134F 8F1124              +1332 
00:001350 8F1120              +1332 
00:001351 8F111C              +1332 
00:001352 8F1118              +1332 
00:001353 8F1114              +1332 
00:001354 8F1110              +1332 
00:001355 8F110C              +1332 
00:001356 8F1108              +1332 
00:001357 8F1104              +1332 
00:001358 8F1100              +1332 
00:001359 8F10FC              +1332 
00:00135A 8F10F8              +1332 
00:00135B 8F10F4              +1332 
00:00135C 8F10F0              +1332 
00:00135D 8F10EC              +1332 
00:00135E 8F10E8              +1332 
00:00135F 8F10E4              +1332 
00:001360 8F10E0              +1332 
00:001361 8F10DC              +1332 
00:001362 8F10D8              +1332 
00:001363 8F10D4              +1332 
00:001364 8F10D0              +1332 
00:001365 8F10CC              +1332 
00:001366 8F10C8              +1332 
00:001367 8F10C4              +1332 
00:001368 8F10C0              +1332 
  :                            1333 
00:001369 00008F              +1334 	sr	sp_x	. recover the interrupt stack pointer
  :                            1335 
  :                            1336 	$if	$LOCK_SWITCH
00:00136A 270092              +1337 	sim	x$save2	. allow external interrupts
  :                            1338 	$endif
  :                            1339 
  :                            1340 	$if	T$SLICE
  :                            1341 	$else
  :                            1342 	la	ULIMIT	. automatic time slice decrementer, zero = no limit
  :                            1343 	sa	REALTIME$_CLOCK
  :                            1344 	$endif
  :                            1345 
00:00136B 4F103C              +1346 	ql	UPACKET	. interrupt return stack frame of applicatiom
00:00136C 47E000              +1347 	qs	0, fp	. interrupt fp = interrupt sp at application interrupt
00:00136D 7D0000              +1348 	ir	0	. if we got here from another interrupt
  :                            1349 			. we shall return to there first
  :                            1350 
00:00136E 9F0084              +1351 spawn	dpush	a_x
00:00136F EE0470              +1352 	jnb	priority_out_of_range
00:001370 DD0008              +1353 	anb,xi	PRIORITIES
00:001371 7E0470              +1354 	jc	priority_out_of_range
  :                            1355 
00:001372 CF0086              +1356 	dl	6+128
00:001373 EE0376              +1357 	jnb	b1_stack_given
00:001374 6DFFFF              +1358 	lb, xi	-1
  :                            1359 				. B1 stack pages
00:001375 280087              +1360 	sb	7+128
  :                            1361 b1_stack_given
00:001376 2E000C              +1362 	sbl	12		. this much more storage
00:001377 D00085              +1363 	ana	b_x
  :                            1364 
00:001378 C52000              +1365 	aa,xi	4096*2		. TCB + vector page
00:001379 3E01D0              +1366 	lcal	bank
00:00137A C60470              +1367 	jza	no_new_task
  :                            1368 
00:00137B F8D003              +1369 	push	3, b		. next higher buffer . acquired storage pointer [ a_x ]
  :                            1370 
00:00137C 30D000              +1371 	z	0, b		. ensure forward pointer
  :                            1372 				. of descriptor is zero
  :                            1373 
00:00137D 054000              +1374 	on	see$1
00:00137E 0D2000              +1375 	off	see$2
  :                            1376 				. subtract is add because
  :                            1377 				. the B1 stack size is a
  :                            1378 				. minus value in 7
  :                            1379 
00:00137F D00087              +1380 	ana	7+128		. above the B1 stack
00:001380 140041              +1381 	outA	65		. we have a TCB
  :                            1382 
00:001381 301002              +1383 	z	WALKUP		. primary thread
00:001382 301003              +1384 	z	ULIMIT		. default no time slice
00:001383 281004              +1385 	sb	BANK_CHAIN	. this initial bank
  :                            1386 				. complex is the last
  :                            1387 				. thing on our
  :                            1388 				. ownership chain
  :                            1389 
00:001384 301140              +1390 	z	TERAFRAME_CHAIN(1)	. none of 61 possible chains populated
00:001385 6DFFFF              +1391 	lb, xi	-1		. B1 stack page 1
  :                            1392 
00:001386 2810D4              +1393 	sb	RSAVE+RDATAC	. default settings -> SIMD configuration
00:001387 3010D5              +1394 	z	RSAVE+RDATA	. held in b$stream registers
00:001388 3010D6              +1395 	z	RSAVE+WDATAC
00:001389 3010D7              +1396 	z	RSAVE+WDATA
  :                            1397 				. and b still contains -1
00:00138A C80084              +1398 	ab	a_x		. for calculating initial B1 page index
00:00138B 281041              +1399 	sb	ABT+1
  :                            1400 
00:00138C 64D002              +1401 	la, i	2, b		. vector page
00:00138D 340002              +1402 	sabr	2
  :                            1403 .	sa	ABT+2
  :                            1404 
  :                            1405 				. push	TEMP_BASE_ABSO
00:00138E 38207E              +1406 	pop	BASE_UPPER	. limit of B3... was BASE_VECTOR = containing start page
  :                            1407 
00:00138F C50001              +1408 	aa, xi	1		. first data page
00:001390 20207F              +1409 	sa	VECTOR_D
  :                            1410 
00:001391 652073              +1411 	la, xi	VECTOR_B1(1)
00:001392 201005              +1412 	sa	B1_P		. B1 array stack pointer
  :                            1413 
00:001393 30207C              +1414 	z	FILE_OPEN_HEAP	. process is not qualified for automatic file open blocks
00:001394 30207D              +1415 	z	FILE_OPEN_HEAPU	. until it is
  :                            1416 
00:001395 28C000              +1417 set_b1	sb	0, a
00:001396 C5FFFF              +1418 	aa, xi	-1
00:001397 CDFFFF              +1419 	ab, xi	-1
00:001398 170087              +1420 	inc	128+7
00:001399 700087              +1421 	tz	128+7
00:00139A B60395              +1422 	j	set_b1
  :                            1423 
00:00139B 4F08F4              +1424 	ql	(0C00001C00001C00001C00001q)
00:00139C 281043              +1425 	sb	ABT+3			. close application data windows
00:00139D 471044              +1426 ?	$do	15,	qs	ABT+4*?	. application opens  windows it needs
00:00139E 471048              +1426 
00:00139F 47104C              +1426 
00:0013A0 471050              +1426 
00:0013A1 471054              +1426 
00:0013A2 471058              +1426 
00:0013A3 47105C              +1426 
00:0013A4 471060              +1426 
00:0013A5 471064              +1426 
00:0013A6 471068              +1426 
00:0013A7 47106C              +1426 
00:0013A8 471070              +1426 
00:0013A9 471074              +1426 
00:0013AA 471078              +1426 
00:0013AB 47107C              +1426 
  :                            1427 
00:0013AC 301203              +1428 	z	XINTT+3		. start without an interrupts table because
  :                            1429 				. most threads don't get external interrupts
00:0013AD 60F000              +1430 	la	0, sp
00:0013AE E603B2              +1431 	jna	gate		. bit 23 = indirectly over a stored gate
  :                            1432 
00:0013AF 160006              +1433 	dsr	6
  :                            1434 
00:0013B0 0E0012              +1435 	sbr	18
00:0013B1 B603B8              +1436 	j	store_upacket
  :                            1437 
00:0013B2 A008F8              +1438 gate	and	(07FFFFF)	. leave bit 23 behind
00:0013B3 0D7F00              +1439 	off	see$all		. 48-bit gate descriptor is anywhere
00:0013B4 CFC000              +1440 	dl	0, a		. in calling application address space
00:0013B5 055F00              +1441 	on	see$all--see$2	. but you need TCB + kernel store again here
  :                            1442 
00:0013B6 360006              +1443 	dsl	6		. frame page high index
  :                            1444 				. is not in interrupt return frame
00:0013B7 760012              +1445 	drl	18		. but 1 must be in bit 47
  :                            1446 
  :                            1447 
  :                            1448 store_upacket
00:0013B8 C7103E              +1449 	ds	UPACKET+2	. set thread transfer
  :                            1450 
00:0013B9 60F000              +1451 	la	0, sp		. read bank name again
00:0013BA A5FFC0              +1452 	and, xi	-64		. beginning with vector 0
  :                            1453 				. write the 64 entry points
  :                            1454 				. into the vector bank
  :                            1455 
  :                            1456 p	$proc
  :                            1457 v64*	$name
  :                            1458 	sa	VECTOR(?)
  :                            1459 	aa, xi	1
  :                            1460 	$end
  :                            1461 
00:0013BB 202000              +1462 ?	$do	64,	v64
00:0013BC C50001              +1462 
00:0013BD 202001              +1462 
00:0013BE C50001              +1462 
00:0013BF 202002              +1462 
00:0013C0 C50001              +1462 
00:0013C1 202003              +1462 
00:0013C2 C50001              +1462 
00:0013C3 202004              +1462 
00:0013C4 C50001              +1462 
00:0013C5 202005              +1462 
00:0013C6 C50001              +1462 
00:0013C7 202006              +1462 
00:0013C8 C50001              +1462 
00:0013C9 202007              +1462 
00:0013CA C50001              +1462 
00:0013CB 202008              +1462 
00:0013CC C50001              +1462 
00:0013CD 202009              +1462 
00:0013CE C50001              +1462 
00:0013CF 20200A              +1462 
00:0013D0 C50001              +1462 
00:0013D1 20200B              +1462 
00:0013D2 C50001              +1462 
00:0013D3 20200C              +1462 
00:0013D4 C50001              +1462 
00:0013D5 20200D              +1462 
00:0013D6 C50001              +1462 
00:0013D7 20200E              +1462 
00:0013D8 C50001              +1462 
00:0013D9 20200F              +1462 
00:0013DA C50001              +1462 
00:0013DB 202010              +1462 
00:0013DC C50001              +1462 
00:0013DD 202011              +1462 
00:0013DE C50001              +1462 
00:0013DF 202012              +1462 
00:0013E0 C50001              +1462 
00:0013E1 202013              +1462 
00:0013E2 C50001              +1462 
00:0013E3 202014              +1462 
00:0013E4 C50001              +1462 
00:0013E5 202015              +1462 
00:0013E6 C50001              +1462 
00:0013E7 202016              +1462 
00:0013E8 C50001              +1462 
00:0013E9 202017              +1462 
00:0013EA C50001              +1462 
00:0013EB 202018              +1462 
00:0013EC C50001              +1462 
00:0013ED 202019              +1462 
00:0013EE C50001              +1462 
00:0013EF 20201A              +1462 
00:0013F0 C50001              +1462 
00:0013F1 20201B              +1462 
00:0013F2 C50001              +1462 
00:0013F3 20201C              +1462 
00:0013F4 C50001              +1462 
00:0013F5 20201D              +1462 
00:0013F6 C50001              +1462 
00:0013F7 20201E              +1462 
00:0013F8 C50001              +1462 
00:0013F9 20201F              +1462 
00:0013FA C50001              +1462 
00:0013FB 202020              +1462 
00:0013FC C50001              +1462 
00:0013FD 202021              +1462 
00:0013FE C50001              +1462 
00:0013FF 202022              +1462 
00:001400 C50001              +1462 
00:001401 202023              +1462 
00:001402 C50001              +1462 
00:001403 202024              +1462 
00:001404 C50001              +1462 
00:001405 202025              +1462 
00:001406 C50001              +1462 
00:001407 202026              +1462 
00:001408 C50001              +1462 
00:001409 202027              +1462 
00:00140A C50001              +1462 
00:00140B 202028              +1462 
00:00140C C50001              +1462 
00:00140D 202029              +1462 
00:00140E C50001              +1462 
00:00140F 20202A              +1462 
00:001410 C50001              +1462 
00:001411 20202B              +1462 
00:001412 C50001              +1462 
00:001413 20202C              +1462 
00:001414 C50001              +1462 
00:001415 20202D              +1462 
00:001416 C50001              +1462 
00:001417 20202E              +1462 
00:001418 C50001              +1462 
00:001419 20202F              +1462 
00:00141A C50001              +1462 
00:00141B 202030              +1462 
00:00141C C50001              +1462 
00:00141D 202031              +1462 
00:00141E C50001              +1462 
00:00141F 202032              +1462 
00:001420 C50001              +1462 
00:001421 202033              +1462 
00:001422 C50001              +1462 
00:001423 202034              +1462 
00:001424 C50001              +1462 
00:001425 202035              +1462 
00:001426 C50001              +1462 
00:001427 202036              +1462 
00:001428 C50001              +1462 
00:001429 202037              +1462 
00:00142A C50001              +1462 
00:00142B 202038              +1462 
00:00142C C50001              +1462 
00:00142D 202039              +1462 
00:00142E C50001              +1462 
00:00142F 20203A              +1462 
00:001430 C50001              +1462 
00:001431 20203B              +1462 
00:001432 C50001              +1462 
00:001433 20203C              +1462 
00:001434 C50001              +1462 
00:001435 20203D              +1462 
00:001436 C50001              +1462 
00:001437 20203E              +1462 
00:001438 C50001              +1462 
00:001439 20203F              +1462 
00:00143A C50001              +1462 
  :                            1463 
00:00143B 650080              +1464 	la, xi	128
  :                            1465 	
00:00143C 2010CF              +1466         sa	 RSAVE+sp	. set user SP
  :                            1467 
  :                            1468 	$if	1
00:00143D 30103C              +1469 	z	UPACKET
00:00143E 30103D              +1470 	z	UPACKET+1	. default thirdword-sensitive
  :                            1471 	$else
  :                            1472 
  :                            1473 	dl	(080:d)		. default halfword-sensitive
  :                            1474 				. just for now
  :                            1475 	ds	UPACKET
  :                            1476 	$endif
  :                            1477 
  :                            1478 
00:00143F 3E0474              +1479 	lcal	tdescriptor
00:001440 B6046E              +1480 	j	no_new_task_descriptor
  :                            1481 
  :                            1482 
00:001441 68F001              +1483 	lb	1, sp
00:001442 28A001              +1484 	sb	1, x
  :                            1485 
00:001443 101001              +1486 	sx	TDESCRIPTOR
  :                            1487 
00:001444 F808F9              +1488 	push	('TCB')
00:001445 381000              +1489 	pop	TCB
  :                            1490 
00:001446 040041              +1491 	inA	65
00:001447 20A003              +1492 	sa	3, x
00:001448 20F000              +1493 	sa	0, sp
  :                            1494 
00:001449 30A002              +1495 	z	2, x		. clear tdescriptor flags
  :                            1496 
00:00144A 30A006              +1497 ?	$do	TDESCRIPTOR_WORDS-6,	z	6-1+?, x
00:00144B 30A007              +1497 
  :                            1498 				. clear affinity mask
00:00144C 2E0002              +1499 	sbl	2
  :                            1500 
00:00144D 073047              +1501 	ts	switch_lock_cell
00:00144E 3E00DD              +1502 	REBOUND75		. j	$-1
  :                            1503 
00:00144F CD3050              +1504 	ab, xi	stem(1)
00:001450 60D003              +1505 	la	3, b		. trailing uplink
00:001451 10C000              +1506 	sx	0, a		. new is last->next
00:001452 28A000              +1507 	sb	0, x		. stem is new->next
00:001453 10D003              +1508 	sx	3, b		. new is stem->uplink
  :                            1509 
00:001454 303047              +1510 	z	switch_lock_cell
  :                            1511 
00:001455 553000              +1512 	lx	$VECTOR_HIGH,,xi
00:001456 452920              +1513 	lr	vpointer(33),,xi
00:001457 4F08F4              +1514 	ql	(0C00001C00001C00001C00001q)
  :                            1515 seal32vectors
00:001458 85FFE0              +1516 	ax	-32,,xi
00:001459 47A01C              +1517 ?	$do	32/4,	qs	32-?*4, x
00:00145A 47A018              +1517 
00:00145B 47A014              +1517 
00:00145C 47A010              +1517 
00:00145D 47A00C              +1517 
00:00145E 47A008              +1517 
00:00145F 47A004              +1517 
00:001460 47A000              +1517 
00:001461 F60458              +1518 	jxge	seal32vectors
  :                            1519 
  :                            1520 	$if	0			. exclusive to kernel vector list
  :                            1521 	la	(APPLICATION_BASE/*12)	. constructed in launch of procedure ip
  :                            1522 	sa	vpointer(17)
  :                            1523 	$endif				. applications have use of all vectors
  :                            1524 					. [ vpointer(1) .. vpointer(1792) ]
  :                            1525 					. for managing data arrays
  :                            1526 
00:001462 65218E              +1527 	la, xi	handle(4)	. good, reserve handle(1..3)
00:001463 202187              +1528 	sa	handles
00:001464 302186              +1529 	z	free_handle
  :                            1530 
00:001465 301007              +1531 	z	NEXT_THREAD
00:001466 301180              +1532 	z	TAG		. clear optional thread name
  :                            1533 
00:001467 6008DF              +1534 	la	(0C00000:s)
00:001468 20103B              +1535 	sa	FP_FRAP		. default rounding pattern
00:001469 30103A              +1536 	z	FP_XPO		. no floating overflow yet
00:00146A 301008              +1537 	z	ERROR_RESTART	. process cat activate restart on fault
  :                            1538 				. if it is essential to system running
  :                            1539 				. ii RESTART_EI$ with bit 23 of a asserted
  :                            1540 
00:00146B 380084              +1541 	dpop	a_x
00:00146C 380085              +1541 
  :                            1542 
00:00146D 350000              +1543 	lret	0
  :                            1544 
  :                            1545 no_new_task_descriptor
00:00146E 601004              +1546 	la	BANK_CHAIN
00:00146F 3E0160              +1547 	lcal	bank_free
  :                            1548 
  :                            1549 no_new_task
  :                            1550 priority_out_of_range
00:001470 380084              +1551 	dpop	a_x
00:001471 380085              +1551 
00:001472 160030              +1552 	dsr	48
00:001473 350000              +1553 	lret	0
  :                            1554 
  :                            1555 tdescriptor
00:001474 073004              +1556 	ts	threads_lock_cell
00:001475 3E003A              +1557 	lcal	REBOUND75
  :                            1558 
00:001476 503048              +1559 	lx	free_tdescriptor
00:001477 700082              +1560 	tz	x_x
00:001478 B60482              +1561 	j	found_tdescriptor
00:001479 503049              +1562 	lx	next_tdescriptor_sp
00:00147A 85FFF8              +1563 	ax, xi	-TDESCRIPTOR_WORDS
00:00147B 403005              +1564 	lr	next
00:00147C F6047F              +1565 	jxge	new_tdescriptor
00:00147D 303004              +1566 	z	threads_lock_cell
00:00147E 350000              +1567 	lret	0
  :                            1568 
  :                            1569 new_tdescriptor
00:00147F 103049              +1570 	sx	next_tdescriptor_sp
00:001480 303004              +1571 	z	threads_lock_cell
00:001481 350001              +1572 	lret	1
  :                            1573 
  :                            1574 found_tdescriptor
00:001482 F8A000              +1575 	push	0, x
00:001483 383048              +1576 	pop	free_tdescriptor
00:001484 303004              +1577 	z	threads_lock_cell
00:001485 350001              +1578 	lret	1
  :                            1579 
[$zenith][0000000000000000000000000000000000000000000008fa]
  :                            1580 	$trace	$zenith
  :                            863: 	$include	threadp
  :                            1 
  :                            2 replicate_abt
00:001486 1C0041              +3 	outB		65
00:001487 8F107C              +4 ?	$do	64/4,	qpush		ABT+64-?*4
00:001488 8F1078              +4 
00:001489 8F1074              +4 
00:00148A 8F1070              +4 
00:00148B 8F106C              +4 
00:00148C 8F1068              +4 
00:00148D 8F1064              +4 
00:00148E 8F1060              +4 
00:00148F 8F105C              +4 
00:001490 8F1058              +4 
00:001491 8F1054              +4 
00:001492 8F1050              +4 
00:001493 8F104C              +4 
00:001494 8F1048              +4 
00:001495 8F1044              +4 
00:001496 8F1040              +4 
00:001497 140041              +5 	outA		65
00:001498 871040              +6 ?	$do	64/4,	qpop		ABT+?*4-4
00:001499 871044              +6 
00:00149A 871048              +6 
00:00149B 87104C              +6 
00:00149C 871050              +6 
00:00149D 871054              +6 
00:00149E 871058              +6 
00:00149F 87105C              +6 
00:0014A0 871060              +6 
00:0014A1 871064              +6 
00:0014A2 871068              +6 
00:0014A3 87106C              +6 
00:0014A4 871070              +6 
00:0014A5 871074              +6 
00:0014A6 871078              +6 
00:0014A7 87107C              +6 
00:0014A8 350000              +7 	lret		0
  :                            8 
  :                            9 thread	II_LOCK
00:0014A9 600005              +10 	la		b		. priority of new thread, application b
00:0014AA E604F3              +11 	jna		no_new_thread	. you can't
00:0014AB C5FFF8              +12 	aa, xi		-PRIORITIES
00:0014AC 7E04F3              +13 	jc		no_new_thread	. you still can't
  :                            14 					. OK maybe you can
00:0014AD 054000              +15 	on		see$1		. see calling TCB
  :                            16 
00:0014AE 651000              +17 	la, xi		4096		. assign new TCB
00:0014AF 3E01D0              +18 	lcal		bank
00:0014B0 C604F3              +19 	jza		no_new_thread	. you can't
  :                            20 
00:0014B1 3E0474              +21 	lcal		tdescriptor
00:0014B2 B604F1              +22 	j		no_new_thread_descriptor	. you can't
  :                            23 
  :                            24 	.		the new thread is now a certainty
  :                            25 
  :                            26 					. a -> new tcb page
  :                            27 					. b -> memory management descriptor of that
  :                            28 					. x -> 6-word switching descriptor in kernel store
  :                            29 
00:0014B3 30D000              +30 	z		0, b		. forward pointer of new TCB page
  :                            31 					. in memory management chain
00:0014B4 401002              +32 	lr		WALKUP		. TCB of initial thread
  :                            33 					. unless the initial thread is calling
00:0014B5 F81008              +34 	push		ERROR_RESTART	
00:0014B6 F80085              +35 	push		b_x		. new TCB descriptor pointer
00:0014B7 F81005              +36 	push		B1_P		. calling thread B1 list pointer
00:0014B8 F81007              +37 	push		NEXT_THREAD	. next of caller, base pointer
  :                            38 
00:0014B9 0C0041              +39 	inB		65		. calling thread TCB
00:0014BA 201007              +40 	sa		NEXT_THREAD	. new TCB base pointer next of calling thread
00:0014BB 140041              +41 	outA		65		. new thread TCB
  :                            42 
00:0014BC 381007              +43 	pop		NEXT_THREAD	. old next of caller is next of new
00:0014BD 381005              +44 	pop		B1_P		. b1 list pointer from calling thread
00:0014BE 381004              +45 	pop		BANK_CHAIN	. only storage block of new thread
00:0014BF 381008              +46 	pop		ERROR_RESTART	. new threads must resstart on error
  :                            47 					. if the process initial thread does
  :                            48 
00:0014C0 30A002              +49 	z		2, x		. construct thread descriptor
00:0014C1 20A003              +50 	sa		3, x		. with TCB
00:0014C2 30A006              +51 ?	$do		TDESCRIPTOR_WORDS-6,	z	6-1+?, x	. clear affinity mask
00:0014C3 30A007              +51 
00:0014C4 101001              +52 	sx		TDESCRIPTOR
  :                            53 
00:0014C5 F808F9              +54 	push		('TCB')
00:0014C6 381000              +55 	pop		TCB
  :                            56 
00:0014C7 3E0486              +57 	lcal		replicate_abt
  :                            58 
00:0014C8 301203              +59 	z		XINTT+3		. start without an interrupts table because
  :                            60 					. most threads don't get external interrupts
00:0014C9 301003              +61 	z		ULIMIT
  :                            62 
00:0014CA 9F0084              +63 	dpush		a_x		. new and calling TCBs
  :                            64 
00:0014CB 680004              +65 	lb		a		. thread transfer address from application a
00:0014CC 60E002              +66 	la		2, fp		. calling thread B0
  :                            67 
00:0014CD C7103E              +68 	ds		UPACKET+2
00:0014CE 650000              +69 	la, xi		0
00:0014CF 68E001              +70 	lb		1, fp		. calling thread PSR
00:0014D0 AD0080              +71 	andB, xi	080
00:0014D1 C7103C              +72 	ds		UPACKET		. thread switch packet complete
  :                            73 
00:0014D2 650080              +74 	la, xi		128
00:0014D3 2010CF              +75 	sa		RSAVE+sp	. new thread internal stack pointer
  :                            76 
00:0014D4 600093              +77 	la		fp$guard	. copy caller's rounding guard bits
00:0014D5 20103B              +78 	sa		FP_FRAP
00:0014D6 30103A              +79 	z		FP_XPO		. no exponent overflow yet
  :                            80 
00:0014D7 8F08FA              +81 	qpush		(-1, 0, 0, 0q)	. default SIMD configuration
00:0014D8 8710D4              +82 	qpop		RSAVE+RDATAC	. held in b$stream registers
  :                            83 
00:0014D9 073047              +84 	ts		switch_lock_cell
00:0014DA B604D9              +85 	j		$-1
  :                            86 	
00:0014DB 680005              +87 	lb		b		. priority in application register b
00:0014DC 28A001              +88 	sb		1, x		. 2nd word switching descriptor 
  :                            89 
  :                            90 	$if		1		. all done with just 1 queue now
00:0014DD 6D306C              +91 	lb		stem(PRIORITIES),,xi
  :                            92 	$else
  :                            93 	sbl		2		. 
  :                            94 	ab, xi		stem(1)		. thread descriptor into switch list
  :                            95 	$endif
  :                            96 
00:0014DE 60D003              +97 	la		3, b		. trailing uplink
00:0014DF 10C000              +98 	sx		0, a		. new is last->next
00:0014E0 28A000              +99 	sb		0, x		. stem is new->next
00:0014E1 10D003              +100 	sx		3, b		. new is stem->uplink
  :                            101 
00:0014E2 303047              +102 	z		switch_lock_cell
  :                            103 
00:0014E3 380084              +104 	dpop		a_x		. retrieve new TCB : calling TCB
00:0014E4 380085              +104 
  :                            105 
00:0014E5 500006              +106 	lx		6		. from application mantissa2
00:0014E6 1010C4              +107 	sx		RSAVE+a		. parameter for thread
00:0014E7 500007              +108 	lx		7		. from application mantissa3
00:0014E8 1010CE              +109 	sx		RSAVE+fp	. external stack pointer if needed
  :                            110 
00:0014E9 281002              +111 	sb		WALKUP		. caller TCB
00:0014EA 700080              +112 	tz		r_x		. but if caller was not initial thread
00:0014EB 001002              +113 	sr		WALKUP		. initial thread TCB
  :                            114 					. initial thread owns all threads
00:0014EC 301180              +115 	z		TAG		. clear optional thread name
00:0014ED 301140              +116 	z		TERAFRAME_CHAIN(1)	
00:0014EE 1C0041              +117 	outB		65		. caller TCB
00:0014EF 200004              +118 	sa		a		. result TCB ID in caller a
00:0014F0 B604F4              +119 	j		thread_final	. return to caller
  :                            120 
  :                            121 no_new_thread_descriptor
00:0014F1 600085              +122 	la		b_x		. descriptor TCB bank, not used
00:0014F2 3E0160              +123 	lcal		bank_free	. because thread descriptor not assigned
  :                            124 
  :                            125 no_new_thread
00:0014F3 300004              +126 	z		a		. result no TCB ID in caller a
  :                            127 
  :                            128 thread_final
  :                            129 	II_FREE
00:0014F4 7D0000              +130 	ir		0
  :                            864 
  :                            865 .	xbase_u	j		guard_ii	. a bit unnecessary?
  :                            866 
  :                            867: 	$include	xiobase
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 "$xbase"* $proc
  :                            41 	$ii_ringfest1	2 4 7 10
  :                            42 	la	4
  :                            43 	sabr	$xbase(1, 1)
  :                            44 	ir	0
  :                            45 	$end
  :                            46 
00:0014F5 CF08FE              +47 ?	 $do	XIOBASES,xbase(?+32-1)	$xbase	?+32-1
00:0014F6 58F002              +47 
00:0014F7 36B000              +47 
00:0014F8 A602A3              +47 
00:0014F9 600004              +47 
00:0014FA 340020              +47 
00:0014FB 7D0000              +47 
00:0014FC CF08FE              +47 
00:0014FD 58F002              +47 
00:0014FE 36B000              +47 
00:0014FF A602A3              +47 
00:001500 600004              +47 
00:001501 340021              +47 
00:001502 7D0000              +47 
00:001503 CF08FE              +47 
00:001504 58F002              +47 
00:001505 36B000              +47 
00:001506 A602A3              +47 
00:001507 600004              +47 
00:001508 340022              +47 
00:001509 7D0000              +47 
00:00150A CF08FE              +47 
00:00150B 58F002              +47 
00:00150C 36B000              +47 
00:00150D A602A3              +47 
00:00150E 600004              +47 
00:00150F 340023              +47 
00:001510 7D0000              +47 
  :                            868: 	$include	events
  :                            1 .
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 
  :                            41 event_free_ii
00:001511 CF0004              +42 	dl	a			. you can't be running while event-wait-flagged
  :                            43 					. but if you are, get your own TCB first: inA 65
00:001512 34002C              +44 	sabr	BVOLATILE_I		. your're doing this to another thread usually
  :                            45 
00:001513 B80900              +46 	xorB	(08FFFFFs)		. make an AND mask
00:001514 980901              +47 	orB	(0700000s)		. don't turn off delete or halted flags
  :                            48 					. but turn off timewait if requested
  :                            49 
00:001515 5088E0              +50 	lx	*(BVOLATILE_I*/12++TDESCRIPTOR-01000)
00:001516 055F00              +51 	on	see$1++(see$7*/MANAGER_BANKS)-see$7
  :                            52 
00:001517 A8A002              +53 	andB	2, x			. keep event flags not specified for clear
00:001518 28A002              +54 	sb	2, x
  :                            55 
00:001519 6008DB              +56 	la	(0C00001s)		. close the window
00:00151A 34002C              +57 	sabr	BVOLATILE_I
  :                            58 
  :                            59 					. just assume the thread did not
  :                            60 					. make this call for itself
  :                            61 					. there would be no need
00:00151B 600005              +62 	la	b
00:00151C A50001              +63 	and	XINT,,xi		. preemptive event ?
00:00151D C60521              +64 	jza	event_free_iix		. no it it's normal scheduling
00:00151E 60E001              +65 	la	1, fp			. interrupted application PSR
00:00151F A00902              +66 	and	(070000)		. interrupts masked ?
00:001520 C602AB              +67 	jza	yield			. none at all, switch
  :                            68 					. this is more work if SMPs
  :                            69 	
  :                            70 event_free_iix
00:001521 7D0000              +71 	ir	0
  :                            72 
  :                            73 event_wait_ii
00:001522 CF0004              +74 	dl	a			. load flags, optional timeout up to 4.66 hours
00:001523 055F00              +75 	on	see$1++(see$7*/MANAGER_BANKS)-see$7
00:001524 501001              +76 	lx	TDESCRIPTOR
00:001525 90A002              +77 	or	2, x			. add new flags
00:001526 20A002              +78 	sa	2, x			. and save
00:001527 780004              +79 	tp	a			. was TIME_WAIT added? (application a)
00:001528 3E052A              +80 	lcal	event_time_limit	. set new wait time target
00:001529 B602AB              +81 	j	yield
  :                            82 
  :                            83 event_time_limit
00:00152A 650000              +84 	la	0,,xi			. zero extend the wait time
00:00152B D70096              +85 	da	DAYCLOCK$U		. add to make a target time
00:00152C C7A004              +86 	ds	4, x			. last 2 words thread descriptor
00:00152D 350000              +87 	lret	0
  :                            88 
  :                            869: 	$include	timer	. rta.gen/timer contains ISR TWAIT$
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 
  :                            41 .	this is
  :                            42 
  :                            43 .		rta.gen/timer.msm
  :                            44 .		contains service call TWAIT$
  :                            45 
  :                            46 twait_ii
00:00152E CF0096              +47 	dl	DAYCLOCK$U
00:00152F D70004              +48 	da	a
00:001530 055F00              +49 	on	see$1++see$3++see$4++see$5++see$6++see$7
00:001531 501001              +50 	lx	TDESCRIPTOR
00:001532 C7A004              +51 	ds	4, x
00:001533 600903              +52 	la	(0800000s)	. TIME_WAIT -> schedule flags
00:001534 90A002              +53 	or	2, x
00:001535 20A002              +54 	sa	2, x
00:001536 B602AB              +55 	j	yield
  :                            56 
  :                            57 timer_check
00:001537 8F0082              +58 	qpush	x_x
00:001538 500084              +59 	lx	a_x
  :                            60 
  :                            61 	$if	0		. deadly. replaced
  :                            62 	la	2, a		. an asynchronously cancelled thread?
  :                            63 	and	(EXIT)
  :                            64 	jza	timer_cheq	. no, check for time wait expired
  :                            65 				. yes, manoeuvre the descriptor
  :                            66 				. out of the switch list
  :                            67 	la	0, x		. next to pop back from stack
  :                            68 	sa	2, sp		. as resulting actual
  :                            69 	sa	0, y		. and is new next of prior
  :                            70 	tp	1, a		. prior may become new last in its priority
  :                            71 	sy	3, a		. if so it's the new uplink of the stem
  :                            72 
  :                            73 	la	3, x
  :                            74 
  :                            75 	outA	65		. base the thread control block
  :                            76 	lcal	exit		. the exit routine expects it
  :                            77 
  :                            78 	j	timer_chex
  :                            79 
  :                            80 timer_cheq
  :                            81 	$endif
  :                            82 
00:001539 CF0096              +83 	dl	DAYCLOCK$U	. a time wait expired?
00:00153A DFA004              +84 	dan	4, x
00:00153B E6053D              +85 	jna	timer_chex
00:00153C 30A002              +86 	z	2, x		. the clock > my deadline
  :                            87 
  :                            88 timer_chex
00:00153D 870082              +89 	qpop	x_x
00:00153E 350000              +90 	lret	0
  :                            91 
  :                            870 
  :                            871 .	each handle integer corresponds to a 48-bit encoding
  :                            872 .	starting at handle(1)
  :                            873 
  :                            874 .	the index corresponds to a port number or to a
  :                            875 .	TCP connection and is the encoded offset of the
  :                            876 .	control block in the containing bank
  :                            877 
  :                            878 .	47	40 39		     24	 23				0
  :                            879 .	_________________________________________________________________
  :                            880 .	|hndl type|	 index 16 bits	| descriptor of containing bank	|
  :                            881 .	|_________|_____________________|_______________________________|
  :                            882 
  :                            883 handle_ii
00:00153F 502186              +884 	lx		free_handle
00:001540 700082              +885 	tnz		x_x
00:001541 B60543              +885 
00:001542 B60546              +886 	j		new_handle	
00:001543 58A001              +887 	ly		1, x			. chain link is 2nd word
00:001544 182186              +888 	sy		free_handle
00:001545 B6054B              +889 	j		encode_handle
  :                            890 
  :                            891 new_handle
00:001546 502187              +892 	lx		handles			. add a new 48-bit encoding
00:001547 4528FC              +893 	lr, xi		HANDLES_MAX		. at the list end
00:001548 F60554              +894 	jxge		no_handle		. if you can
00:001549 5CA002              +895 	ly		2,x,i			. increment handle obtain pointer
00:00154A 182187              +896 	sy		handles
  :                            897 
  :                            898 encode_handle
00:00154B 600004              +899 	la		a			. read application register a
00:00154C A00904              +900 	and		(255*/16s)		. only allowed parameter = type
00:00154D 20A000              +901 	sa		0, x
00:00154E 30A001              +902 	z		1, x			. encoding complete
  :                            903 
00:00154F 85DE78              +904 	ax		-handle(1),,xi		. make handle # from encoding address
00:001550 600082              +905 	la		x_x
00:001551 060001              +906 	sar		1
00:001552 200004              +907 	sa		a			. write handle # to application register a
00:001553 7D0000              +908 	ir		0
  :                            909 
  :                            910 no_handle
00:001554 65FFFF              +911 	la, xi		-1			. write regrets to application register a
00:001555 200004              +912 	sa		a
00:001556 7D0000              +913 	ir		0
  :                            914 
  :                            915 free_handle_ii
00:001557 3E056B              +916 	lcal		check_handle
00:001558 E6056A              +917 	jna		not_a_handle
00:001559 30A000              +918 	z		0, x			. encode it off
00:00155A 30A001              +919 	z		1, x			. it shall be free chain last
  :                            920 						. unless it's already in the chain
00:00155B 600082              +921 	la		x_x			. address of encoding
00:00155C 4DFFFF              +922 	lk		-1,,xi			. as search argument
  :                            923 
00:00155D 502186              +924 	lx		free_handle
00:00155E 700082              +925 	tz		x_x
00:00155F B60562              +926 	j		free_handle_test
00:001560 202186              +927 	sa		free_handle
00:001561 7D0000              +928 	ir		0			. chain link is 2nd word
  :                            929 						. handle empty chain differently
  :                            930 free_handle_test
00:001562 AF0082              +931 	mtane		x_x
00:001563 B60565              +931 
00:001564 B6056A              +932 	j		handle_free_already
  :                            933 
00:001565 580082              +934 	ly		x_x			. previous <- this
00:001566 50A001              +935 	lx		1, x			. this <- next
  :                            936 
00:001567 700082              +937 	tz		x_x
00:001568 B60562              +938 	j		free_handle_test
00:001569 20B001              +939 	sa		1, y			. add to end of chain
  :                            940 
  :                            941 handle_free_already
  :                            942 not_a_handle
00:00156A 7D0000              +943 	ir		0
  :                            944 
  :                            945 check_handle
00:00156B 600004              +946 	la		a
00:00156C 552188              +947 	lx, xi		handle(1)
00:00156D 260001              +948 	sal		1
00:00156E 800084              +949 	ax		a_x
  :                            950 .	on		see$1		not any more. handles are in vector list
00:00156F 402187              +951 	lr		handles
00:001570 F60573              +952 	jxge		handle_out_of_range
00:001571 60A000              +953 	la		0, x
00:001572 350000              +954 	lret		0
  :                            955 handle_out_of_range
00:001573 65FFFF              +956 	la, xi		-1
00:001574 350000              +957 	lret		0
  :                            958 
  :                            959 read_handle_ii
00:001575 3E056B              +960 	lcal		check_handle
00:001576 200004              +961 	sa		a
00:001577 7D0000              +962 	ir		0
  :                            963 
  :                            964 file_handle_ii
00:001578 3E056B              +965 	lcal		check_handle
00:001579 E605A4              +966 	jna		usocket_nane
  :                            967 
00:00157A 480904              +968 	lk		(255*/16s)
00:00157B AF0905              +969 	mtane		(AF_INET*/16s)	. more file types go here
00:00157C B6057E              +969 
00:00157D B60584              +970 	j		fhandle_add_pointer
00:00157E AF0906              +971 	mtane		(FS$DEVICE$ARRAY*/16)
00:00157F B60581              +971 
00:001580 B60584              +972 	j		fhandle_add_pointer
  :                            973 
00:001581 65FFF7              +974 	la		-NO_FILE_TYPE,,xi
00:001582 200004              +975 	sa		a		. tell caller what happened
00:001583 7D0000              +976 	ir		0
  :                            977 
  :                            978 fhandle_add_pointer
00:001584 680002              +979 	lb		x		. application x -> file open descriptor
00:001585 28A001              +980 	sb		1, x
00:001586 7D0000              +981 	ir		0
  :                            982 
  :                            983 usocket_c_ii
00:001587 3E056B              +984 	lcal		check_handle
00:001588 E605A4              +985 	jna		usocket_nane
  :                            986 					. a_a = 1st handle word, x_x -> encoding tuple
00:001589 480904              +987 	lk		(255*/16s)
00:00158A AF0907              +988 	mta		(IPPROTO_TCP*/16s) . encoding must be TCP handle bound or not
00:00158B B605A4              +989 	j		usocket_nane
00:00158C 680002              +990 	lb		x		. application x -> TCB
  :                            991 					. value policed in kernel call routines or trouble
00:00158D A80908              +992 	andB		(0FF8)
00:00158E A00909              +993 	and		(00FFFF)
00:00158F 90090A              +994 	or		(TCP_TCB*/16s)
00:001590 B6059F              +995 	j		usocket
  :                            996 
  :                            997 usocket_ii
00:001591 3E056B              +998 	lcal		check_handle
00:001592 E605A4              +999 	jna		usocket_nane
  :                            1000 
00:001593 680005              +1001 	lb		b		. port number in application b
00:001594 A80909              +1002 	andB		(00FFFF)	. value policed in kernel call routines
  :                            1003 					. or trouble
00:001595 4DFFFF              +1004 	lk		-1,,xi		. handle must be a socket type
00:001596 AF090B              +1005 	mtane		(IPPROTO_UDP*/16s)
00:001597 B60599              +1005 
00:001598 B6059F              +1006 	j		usocket
00:001599 AF0907              +1007 	mtane		(IPPROTO_TCP*/16s)
00:00159A B6059C              +1007 
00:00159B B6059F              +1008 	j		usocket
  :                            1009 
  :                            1010 usocket_no_protocol
00:00159C 65FFD6              +1011 	la		-NO_PROTOCOL,,xi
00:00159D 200004              +1012 	sa		a
00:00159E 7D0000              +1013 	ir		0
  :                            1014 
00:00159F 900085              +1015 usocket	or		b_x
00:0015A0 054000              +1016 	on		see$1		. look in the thread control block
00:0015A1 68106F              +1017 	lb		ABT+BSOCKET	. the connections block must be based there
00:0015A2 C7A000              +1018 	ds		0, x
00:0015A3 7D0000              +1019 	ir		0
  :                            1020 
  :                            1021 usocket_nane
00:0015A4 65FFEA              +1022 	la		-NO_HANDLE,,xi
00:0015A5 200004              +1023 	sa		a
00:0015A6 7D0000              +1024 	ir		0
  :                            1025 
  :                            1026 read_socket_ii
00:0015A7 3E056B              +1027 	lcal		check_handle
00:0015A8 E605AC              +1028 	jna		socket_out_of_range
  :                            1029 
00:0015A9 CFA000              +1030 	dl		0, x
00:0015AA C70004              +1031 	ds		a
00:0015AB 7D0000              +1032 	ir		0		. return the whole 48-bit encoding
  :                            1033 					. and let application code verify it
  :                            1034 
  :                            1035 
  :                            1036 socket_out_of_range
00:0015AC 300004              +1037 	z		a
00:0015AD 7D0000              +1038 	ir		0
  :                            1039 				
  :                            1040 
  :                            1041 
  :                            1042 .	these are here to read or write
  :                            1043 .	a pointer in the kernel vector bank
  :                            1044 
  :                            1045 .	from routines which might be called
  :                            1046 .	from either a kernel task or an
  :                            1047 .	application
  :                            1048 
  :                            1049 .	see$2 makes the kernel vector bank
  :                            1050 .	visible instead of the application
  :                            1051 .	vector bank
  :                            1052 
  :                            1053 .	on return from ISR, see$2 is on or off
  :                            1054 .	whichever it was before
  :                            1055 
  :                            1056 
  :                            1057 xvector_in_range
00:0015AE 500002              +1058 	lx		x
00:0015AF 452000              +1059 	lr		02000,,xi
00:0015B0 F605B2              +1060 	jxge		xvector_low_threshold	. test 1 passed
  :                            1061 xvector_outwith_range
00:0015B1 350000              +1062 	lret		0
  :                            1063 xvector_low_threshold
00:0015B2 453000              +1064 	lr		03000,,xi
00:0015B3 F605B1              +1065 	jxge		xvector_outwith_range	. test 2 not passed
00:0015B4 052000              +1066 	on		see$2			. kernel vector list
00:0015B5 350001              +1067 	lret		1			. test 2 passed
  :                            1068 
  :                            1069 
  :                            1070 read_xvector_ii
00:0015B6 300004              +1071 	z		a			. default answer no pointer
00:0015B7 3E05AE              +1072 	lcal		xvector_in_range
00:0015B8 7D0000              +1073 	ir		0
00:0015B9 60A000              +1074 	la		0, x
00:0015BA 200004              +1075 	sa		a
00:0015BB 7D0000              +1076 	ir		0
  :                            1077 
  :                            1078 write_avector_ii
00:0015BC CF090C              +1079 	$ii_ringfest1	7
00:0015BD 58F002              +1079 
00:0015BE 36B000              +1079 
00:0015BF A602A3              +1079 
00:0015C0 3E05AE              +1080 	lcal		xvector_in_range
00:0015C1 7D0000              +1081 	ir		0			. out of range
00:0015C2 0D2000              +1082 	off		see$2			. application vector write
00:0015C3 600004              +1083 	la		a
00:0015C4 20A000              +1084 	sa		0, x
00:0015C5 7D0000              +1085 	ir		0
  :                            1086 
  :                            1087 write_xvector_ii
00:0015C6 CF090E              +1088 	$ii_ringfest1	2 5
00:0015C7 58F002              +1088 
00:0015C8 36B000              +1088 
00:0015C9 A602A3              +1088 
00:0015CA 3E05AE              +1089 	lcal		xvector_in_range
  :                            1090 
00:0015CB 7D0000              +1091 	ir		0
00:0015CC 600004              +1092 	la		a
00:0015CD 20A000              +1093 	sa		0, x
00:0015CE 7D0000              +1094 	ir		0
  :                            1095 
  :                            1096 assign_xvector_ii
00:0015CF CF0910              +1097 	$ii_ringfest1	2 7
00:0015D0 58F002              +1097 
00:0015D1 36B000              +1097 
00:0015D2 A602A3              +1097 
00:0015D3 600004              +1098 	la		a			. read request words
00:0015D4 300004              +1099 	z		a			. default answer no pointer
  :                            1100 
00:0015D5 700002              +1101 	tz		x
00:0015D6 B605DA              +1102 	j		named_vector
00:0015D7 3E01D0              +1103 	lcal		bank			. not for writing any vector
00:0015D8 200004              +1104 	sa		a			. for placing in another kernel structure
00:0015D9 7D0000              +1105 	ir		0
  :                            1106 
  :                            1107 named_vector
00:0015DA 3E05AE              +1108 	lcal		xvector_in_range
00:0015DB 7D0000              +1109 	ir		0
  :                            1110 .	la		a
00:0015DC F80082              +1111 	push		x_x
00:0015DD 3E01D0              +1112 	lcal		bank
00:0015DE 380082              +1113 	pop		x_x
00:0015DF 20A000              +1114 	sa		0, x			. write storage block index to vector
00:0015E0 200004              +1115 	sa		a			. report it to application
00:0015E1 7D0000              +1116 	ir		0			. but not in application memory estate list
  :                            1117 
  :                            1118 kernel_b1_ii_1
00:0015E2 CF0912              +1119 	$ii_ringfest1	2 7 5 4 10
00:0015E3 58F002              +1119 
00:0015E4 36B000              +1119 
00:0015E5 A602A3              +1119 
  :                            1120 
00:0015E6 052000              +1121 	on		see$2
00:0015E7 602073              +1122 	la		VECTOR_B1(1)
00:0015E8 140001              +1123 	outA		1
00:0015E9 7D0000              +1124 	ir		0
  :                            1125 
  :                            1126 kernel_b1_ii
00:0015EA CF0910              +1127 	$ii_ringfest1	2 7
00:0015EB 58F002              +1127 
00:0015EC 36B000              +1127 
00:0015ED A602A3              +1127 
  :                            1128 
00:0015EE 052000              +1129 	on		see$2
00:0015EF 608004              +1130 	la		*a	. read the bank sought via user A register
00:0015F0 140001              +1131 	outA		1
00:0015F1 7D0000              +1132 	ir		0
  :                            1133 
00:0015F2 054000              +1134 b1_ii	on		see$1	. ++see$2
00:0015F3 609005              +1135 	la		*B1_P
00:0015F4 140001              +1136 	outA		1
00:0015F5 7D0000              +1137 	ir		0
  :                            1138 
  :                            1139 dayclock_w_ii
00:0015F6 CF0914              +1140 	$ii_ringfest1	2
00:0015F7 58F002              +1140 
00:0015F8 36B000              +1140 
00:0015F9 A602A3              +1140 
  :                            1141 
00:0015FA CF0004              +1142 	dl		a
00:0015FB C70096              +1143 	ds		DAYCLOCK$U
00:0015FC 7D0000              +1144 	ir		0
  :                            1145 
  :                            1146 switch_fp_guard_ii
00:0015FD F80093              +1147 	push		fp$guard
00:0015FE F80004              +1148 	push		a
00:0015FF 380093              +1149 	pop		fp$guard
00:001600 380004              +1150 	pop		a
00:001601 7D0000              +1151 	ir		0
  :                            1152 
  :                            1153 fpxpo_read_clear_ii
00:001602 054000              +1154 	on		see$1		. look into the thread control block
00:001603 78103A              +1155 	tn		FP_XPO
00:001604 B60606              +1155 
00:001605 7D0001              +1156 	ir		1		. indicate clear
00:001606 30103A              +1157 	z		FP_XPO		. clear underflow / overflow flag
  :                            1158 
  :                            1159 	$if		0
  :                            1160 	la		FP_FINAL_COUNT
  :                            1161 	sa		r		. for restarting SIMD operation
  :                            1162 	$endif
  :                            1163 
00:001607 7D0000              +1164 	ir		0		. indicate not clear until here
  :                            1165 
  :                            1166 xint_bind_ii
00:001608 056000              +1167 	on		see$1++see$2	. kernel vector list
00:001609 500004              +1168 	lx		a		. read external interrupt number
00:00160A 780082              +1169 	tp		x_x		. minus means free it
00:00160B B60633              +1170 	j		xint_free	
00:00160C 4500C1              +1171 	lr		X$INTERRUPTS+1,,xi
00:00160D F60615              +1172 	jxge		xint_out	. interrupt source number too high
00:00160E 650000              +1173 	la		0,,xi		. negative displacement from vector list end
00:00160F D00004              +1174 	ana		a		. must be [  1 .. X$INTERRUPTS  ]
00:001610 A60615              +1175 	jpa		xint_out	. must be [ -1 .. -X$INTERRUPTS ]
00:001611 553000              +1176 	lx		03000,,xi
00:001612 800084              +1177 	ax		a_x
00:001613 040041              +1178 	inA		65		. thread control block
00:001614 20A000              +1179 	sa		0, x		. claim this interrupt source
00:001615 7D0000              +1180 xint_out	ir	0
  :                            1181 
  :                            1182 
00:001616 054000              +1183 itable_ii	on	see$1
00:001617 301204              +1184 	z		XINTT+4		. turn 1st entry off
00:001618 4F0916              +1185 	ql		(0, 4, 4, 4+XINT_TABLE*2q)
00:001619 471200              +1186 	qs		XINTT		. unlocked, r/w pointers initial, wrap limit
00:00161A 160030              +1187 	dsr		48
00:00161B C70086              +1188 	ds		6+128
00:00161C 4500FE              +1189 	lr		XINT_TABLE/2-1,,xi
00:00161D 551204              +1190 	lx		XINTT+4,,xi
  :                            1191 
  :                            1192 itable_write
00:00161E 47A000              +1193 	qs		0, x
00:00161F 850004              +1194 	ax		4,,xi
00:001620 1E061E              +1195 	jdr		itable_write
00:001621 7D0000              +1196 	ir		0
  :                            1197 
  :                            1198 affinity_ii
  :                            1199 
  :                            1200 	$if		TDESCRIPTOR_WORDS>6	. = affinity supported
00:001622 055F00              +1201 	on		see$all--see$2
00:001623 600004              +1202 	la		a
00:001624 681001              +1203 	lb		TDESCRIPTOR
00:001625 20D006              +1204 	sa		6, b
  :                            1205 	$endif
  :                            1206 
00:001626 7D0000              +1207 	ir		0
  :                            1208 
  :                            1209 zeta_ii	II_LOCK
00:001627 600004              +1210 	la	a
00:001628 3E064E              +1211 	lcal	thread_actual?
00:001629 B60630              +1212 	j	zeta_ii_no_op		. no thread
  :                            1213 					. thread_actual? opens TCB in window
  :                            1214 
00:00162A 60891A              +1215 	la	*(BVOLATILE_I*/12++TAG-01000)	. 1st word of thread name
00:00162B 060010              +1216 	sar	$word-$byte		. protected?
00:00162C C5FFD6              +1217 	aa	-'*',,xi
00:00162D C60630              +1218 	jza	zeta_ii_no_op		. protected, don't force exit
  :                            1219 
00:00162E 60091B              +1220 	la	(TIME_WAIT++EXIT:s)	. force exit
00:00162F 20A002              +1221 	sa	2, x
  :                            1222 
  :                            1223 zeta_ii_user_refp			. get-out point for fault on [ sa 2,x ]
  :                            1224 zeta_ii_no_op				. get-out point for no thread / protected
00:001630 6008DB              +1225 	la	(0C00001s)		. thread_actual? opens window BVOLATILE_I
00:001631 34002C              +1226 	sabr	BVOLATILE_I		. on target TCB, but does not close window
  :                            1227 	II_FREE
00:001632 7D0000              +1228 	ir	0
  :                            1229 
  :                            1230 	$if	0
  :                            1231 
  :                            1232 send_alert_ii
  :                            1233 	inA	CORE_SOCKET$
  :                            1234 	lx	core2core_alert,,xi
  :                            1235 	ax	a_x
  :                            1236 	on	see$3
  :                            1237 	dl	a
  :                            1238 	sa	0, x
  :                            1239 	outB	MCAST_TO$
  :                            1240 	ir	0
  :                            1241 
  :                            1242 	$endif
  :                            1243 
  :                            1244 xint_free
00:001633 853000              +1245 	ax		03000,,xi	. negative displacement from here
00:001634 453000              +1246 	lr		03000,,xi	. must not be as high as this
00:001635 F60638              +1247 	jxge		xint_free_out
00:001636 452F40              +1248 	lr		X_INTERRUPT(X$INTERRUPTS),,xi	. or any lower than this
00:001637 F60639              +1249 	jxge		xint_free_in
00:001638 7D0000              +1250 xint_free_out	ir	0
00:001639 30A000              +1251 xint_free_in	z	0, x		. free this external interrupt
00:00163A 7D0000              +1252 	ir		0		. whoever had claimed it 
  :                            1253 
  :                            1254 net2sym_ii				. first address the destination
00:00163B 600004              +1255 	la		a		. primary threadcb is in application a
00:00163C 34002C              +1256 	sabr		BVOLATILE_I	. that window is treated as volatile
00:00163D 60891C              +1257 	la		*(BVOLATILE_I*/12++ABT-01000+2) . vector window of the target thread
00:00163E 34002C              +1258 	sabr		BVOLATILE_I
  :                            1259 					. 6:12 address of transmission CB is in
00:00163F 600002              +1260 	la		x		. application x
00:001640 6D0000              +1261 	lb		0,,xi
00:001641 76000C              +1262 	drl		12		. base tag in b, offset in a
00:001642 06000F              +1263 	sar		12+3		. isolate 9 bits
00:001643 260003              +1264 	sal		3		. multiplied by 8
00:001644 90090A              +1265 	or		(TCP_TCB*/16s)	. transmission CB is exactly 24 words
00:001645 054000              +1266 	on		see$1		. read your own ABT+BSOCKET
00:001646 68106F              +1267 	lb		ABT+BSOCKET	. read the bank ID of connection CBs
  :                            1268 
00:001647 50091D              +1269 	lx		(BVOLATILE_I*/12)
00:001648 C7A188              +1270 	ds		handle(1)**0FFF,x	. stdin
00:001649 C7A18A              +1271 	ds		handle(2)**0FFF,x	. stdout
00:00164A C7A18C              +1272 	ds		handle(3)**0FFF,x	. stderr. process start should have reserved thse
  :                            1273 
00:00164B 6008DB              +1274 	la		(0C00001s)		. close the gate
00:00164C 34002C              +1275 	sabr		BVOLATILE_I
00:00164D 7D0000              +1276 	ir		0
  :                            1277 
  :                            1278 thread_actual?			. subroutine called from ISR
00:00164E 34002C              +1279 	sabr	BVOLATILE_I	. thread control block index must be in interrupt a
  :                            1280 				. ISRs calling here either directly or over thread_current?
  :                            1281 				. must themselves close address space window BVOLATILE_I
  :                            1282 				. before return
  :                            1283 
00:00164F 055F00              +1284 	on	see$1++see$all**(see$7*/MANAGER_BANKS)-1
  :                            1285 
00:001650 68106C              +1286 	lb	ABT+BVOLATILE_I		. did the requested block get into window
00:001651 B808DB              +1287 	xorB	(0C00001s)		. BVOLATILE_I ?
00:001652 CE065C              +1288 	jzb	thread_not_actual	. no storage in window, don't try reading
  :                            1289 
00:001653 5088E0              +1290 	lx	*(BVOLATILE_I*/12++TDESCRIPTOR-01000)
  :                            1291 
00:001654 403049              +1292 	lr	next_tdescriptor_sp	. this changes
00:001655 F60657              +1293 	jxge	threads_threshold
00:001656 B6065C              +1294 	j	thread_not_actual
  :                            1295 
  :                            1296 threads_threshold
00:001657 40304A              +1297 	lr	tdescriptor_high_index	. this is fixed
  :                            1298 				. descriptor stack is dynamic but check possible ranges
  :                            1299 				. or following tests could crash within ISR = inconvenient
  :                            1300 
00:001658 F6065C              +1301 	jxge	thread_not_actual . thread control block does not correspond
  :                            1302 				. to a thread descriptor
  :                            1303 	
00:001659 B0A003              +1304 	xor	3, x		. does descriptor point to this thread CB?
00:00165A D6065C              +1305 	jnza	thread_not_actual
  :                            1306 
00:00165B 350001              +1307 	lret	1		. thread seems real
  :                            1308 
  :                            1309 thread_not_actual
00:00165C 350000              +1310 	lret	0
  :                            1311 
  :                            1312 
  :                            1313 thread_current?
00:00165D 3E064E              +1314 	lcal	thread_actual?
00:00165E 350000              +1315 	lret	0		. no thread
  :                            1316 
00:00165F 60A002              +1317 	la	2, x
00:001660 A0091E              +1318 	and	(TRAP++EXIT)	. and is the thread running?
00:001661 D60663              +1319 	jnza	thread_stopped
  :                            1320 
00:001662 350001              +1321 	lret	1		. thread seems OK
  :                            1322 
  :                            1323 thread_stopped
00:001663 350000              +1324 	lret	0		. thread seems gone
  :                            1325 
  :                            1326 thread_state_ii			. general purpose ISR is thread [application a] running?
00:001664 600004              +1327 	la	a
00:001665 3E065D              +1328 	lcal	thread_current?
00:001666 B6066A              +1329 	j	thread_state_stopped	. no
  :                            1330 
00:001667 6008DB              +1331 	la	(0C00001s)	. thread_current? opens window BVOLATILE_I
00:001668 34002C              +1332 	sabr	BVOLATILE_I	. on TCB but does not close the window
00:001669 7D0001              +1333 	ir	1
  :                            1334 
  :                            1335 thread_state_stopped
00:00166A 6008DB              +1336 	la	(0C00001s)	. thread_current? opens window BVOLATILE_I
00:00166B 34002C              +1337 	sabr	BVOLATILE_I	. on TCB but does not close the window
00:00166C 7D0000              +1338 	ir	0
  :                            1339 
  :                            1340 storage_block_idxa_ii		. return the storage block index at window [a]
00:00166D 680004              +1341 	lb	a
00:00166E 054000              +1342 	on	see$1		. address the thread control block
00:00166F AD003F              +1343 	andB	63,,xi
00:001670 9D1040              +1344 	orB	ABT,,xi
00:001671 60D000              +1345 	la	0, b
00:001672 200004              +1346 	sa	a
00:001673 7D0000              +1347 	ir	0
  :                            1348 
  :                            1349 storage_block_idxb_ii		. return the storage block index at window [b]
00:001674 680005              +1350 	lb	b
00:001675 054000              +1351 	on	see$1		. address the thread control block
00:001676 AD003F              +1352 	andB	63,,xi
00:001677 9D1040              +1353 	orB	ABT,,xi
00:001678 60D000              +1354 	la	0, b
00:001679 200005              +1355 	sa	b
00:00167A 7D0000              +1356 	ir	0
  :                            1357 
  :                            1358 cache_netb* $proc
  :                            1359 	ql	ABT+48+4*?-4
  :                            1360 	qs	$NETB+4*?-4
  :                            1361 	$end
  :                            1362 
  :                            1363 cache_standard_netbuf_ii
00:00167B CF0914              +1364 	$ii_ringfest1	2	. none but page 2 may make this service call
00:00167C 58F002              +1364 
00:00167D 36B000              +1364 
00:00167E A602A3              +1364 
  :                            1365 
00:00167F 056000              +1366 	on	see$1++see$2
00:001680 4F1070              +1367 ?	$do	4,	cache_netb
00:001681 472900              +1367 
00:001682 4F1074              +1367 
00:001683 472904              +1367 
00:001684 4F1078              +1367 
00:001685 472908              +1367 
00:001686 4F107C              +1367 
00:001687 47290C              +1367 
00:001688 7D0000              +1368 	ir	0
  :                            1369 
  :                            1370 retrieve_netb* $proc
  :                            1371 	la	$NETB+?-1
  :                            1372 	sabr	48+?-1
  :                            1373 	$end
  :                            1374 
  :                            1375 base_standard_netbuf_ii
00:001689 CF091F              +1376 	$ii_ringfest1	2 4 7
00:00168A 58F002              +1376 
00:00168B 36B000              +1376 
00:00168C A602A3              +1376 
  :                            1377 
00:00168D 052000              +1378 	on	see$2
00:00168E 602900              +1379 ?	$do	16,	retrieve_netb
00:00168F 340030              +1379 
00:001690 602901              +1379 
00:001691 340031              +1379 
00:001692 602902              +1379 
00:001693 340032              +1379 
00:001694 602903              +1379 
00:001695 340033              +1379 
00:001696 602904              +1379 
00:001697 340034              +1379 
00:001698 602905              +1379 
00:001699 340035              +1379 
00:00169A 602906              +1379 
00:00169B 340036              +1379 
00:00169C 602907              +1379 
00:00169D 340037              +1379 
00:00169E 602908              +1379 
00:00169F 340038              +1379 
00:0016A0 602909              +1379 
00:0016A1 340039              +1379 
00:0016A2 60290A              +1379 
00:0016A3 34003A              +1379 
00:0016A4 60290B              +1379 
00:0016A5 34003B              +1379 
00:0016A6 60290C              +1379 
00:0016A7 34003C              +1379 
00:0016A8 60290D              +1379 
00:0016A9 34003D              +1379 
00:0016AA 60290E              +1379 
00:0016AB 34003E              +1379 
00:0016AC 60290F              +1379 
00:0016AD 34003F              +1379 
00:0016AE 7D0000              +1380 	ir	0
  :                            1381 
  :                            1382 unbase_deviceb_ii
00:0016AF 6008DB              +1383 	la	(0C00001s)
00:0016B0 340020              +1384 	sabr	32
00:0016B1 7D0000              +1385 	ir	0
  :                            1386 
  :                            1387 unbase_socketb_ii
00:0016B2 6008DB              +1388 	la	(0C00001s)
00:0016B3 34002F              +1389 	sabr	BSOCKET
00:0016B4 7D0000              +1390 	ir	0
  :                            1391 
  :                            1392 unbase_standard_netbuf_ii
00:0016B5 6008DB              +1393 	la	(0C00001s)
00:0016B6 340030              +1394 ?	$do	16,	sabr	48+?-1
00:0016B7 340031              +1394 
00:0016B8 340032              +1394 
00:0016B9 340033              +1394 
00:0016BA 340034              +1394 
00:0016BB 340035              +1394 
00:0016BC 340036              +1394 
00:0016BD 340037              +1394 
00:0016BE 340038              +1394 
00:0016BF 340039              +1394 
00:0016C0 34003A              +1394 
00:0016C1 34003B              +1394 
00:0016C2 34003C              +1394 
00:0016C3 34003D              +1394 
00:0016C4 34003E              +1394 
00:0016C5 34003F              +1394 
00:0016C6 7D0000              +1395 	ir	0
  :                            1396 
00:0016C7 600004              +1397 tag_ii	la	a			. optional thread name
00:0016C8 D606CA              +1398 	jnza	$+2			. this thread if no other
00:0016C9 040041              +1399 	inA	65
00:0016CA 34002C              +1400 	sabr	BVOLATILE_I
  :                            1401 
00:0016CB 4D00FF              +1402 	lk	255,,xi
00:0016CC 580005              +1403 	ly	b			. name string must be in caller address space
00:0016CD 50091A              +1404 	lx	(BVOLATILE_I*/12++TAG-4096)
00:0016CE 44A024              +1405 	lr	36, x, i		. restrict to 100 characters or so
  :                            1406 
00:0016CF F606D6              +1407 tag_iiw	jxge	tag_iiz
00:0016D0 60B000              +1408 	la	0, y
  :                            1409 
  :                            1410 tag_ii_user_refp
00:0016D1 20A000              +1411 	sa	0, x
00:0016D2 850001              +1412 	ax	1,,xi
00:0016D3 8D0001              +1413 	ay	1,,xi
00:0016D4 AF08CB              +1414 	mta	(0)			. was at least 1 low-order octet of that word zero?
00:0016D5 B606CF              +1415 	j	tag_iiw			. not yet
  :                            1416 
00:0016D6 6008DB              +1417 tag_iiz	la	(0C00001s)		. prevent accidental access
00:0016D7 34002C              +1418 	sabr	BVOLATILE_I
00:0016D8 7D0000              +1419 	ir	0
  :                            1420 
  :                            1421 
  :                            1422 file_open_frame_ii
00:0016D9 CF090C              +1423 	$ii_ringfest1	7		. fs routines only to add to openfile blocks heap
00:0016DA 58F002              +1423 
00:0016DB 36B000              +1423 
00:0016DC A602A3              +1423 
  :                            1424 
00:0016DD 500004              +1425 	lx	a
00:0016DE 0D2000              +1426 	off	see$2
00:0016DF 70207D              +1427 	tz	FILE_OPEN_HEAPU
00:0016E0 10207D              +1428 	sx	FILE_OPEN_HEAPU
00:0016E1 7D0000              +1429 	ir	0
  :                            1430 
  :                            1431 files_open_heap_ii			. necessarily application callable
00:0016E2 500004              +1432 	lx	a
00:0016E3 0D2000              +1433 	off	see$2
00:0016E4 3E06E6              +1434 	lcal	file_open_heap
00:0016E5 7D0000              +1435 	ir	0
  :                            1436 
  :                            1437 file_open_heap
00:0016E6 10207C              +1438 	sx	FILE_OPEN_HEAP
00:0016E7 10207D              +1439 	sx	FILE_OPEN_HEAPU
00:0016E8 350000              +1440 	lret	0
  :                            1441 
  :                            1442 restart_ei
00:0016E9 600004              +1443 	la	a			. read application a into interrupt a
00:0016EA 054000              +1444 	on	see$1			. look in app TCB
00:0016EB 201008              +1445 	sa	ERROR_RESTART
00:0016EC 7D0000              +1446 	ir	0			. that's it done
  :                            1447 
  :                            1448 one_time_save_ii			. frame save for IP RX
00:0016ED 50000F              +1449 	lx	sp
00:0016EE 100091              +1450 	sx	ONE_TIME_SAVE1
00:0016EF 7D0000              +1451 	ir	0
  :                            1452 
00:0016F0 CF090E              +1453 smp_ii	$ii_ringfest1	2 5
00:0016F1 58F002              +1453 
00:0016F2 36B000              +1453 
00:0016F3 A602A3              +1453 
00:0016F4 052000              +1454 	on	see$2
00:0016F5 6028FD              +1455 	la	cores_active
00:0016F6 A00001              +1456 	and	k			. cores mask in application k. Any already active?
00:0016F7 B00001              +1457 	xor	k			. just the cores not yet active thanks
00:0016F8 480084              +1458 	lk	a_x
00:0016F9 9028FD              +1459 	or	cores_active		. add to so-far string
00:0016FA 2028FD              +1460 	sa	cores_active
00:0016FB 040042              +1461 	inA	66			. kernel vector table
00:0016FC 900903              +1462 	or	(SMP_ACTIVATE$:s)
00:0016FD 14004F              +1463 	outA	MCAST_TO$
00:0016FE 7D0000              +1464 	ir	0
  :                            1465 
  :                            1466 irespite
00:0016FF CF08EA              +1467 	dl	(CHILLDOWN, REST_GRANULE:d)
00:001700 1C0067              +1468 	outB	chill$down
00:001701 140066              +1469 	outA	INDICATION$
00:001702 350000              +1470 	lret	0
  :                            1471 
  :                            1472 energy_ii
00:001703 CF0914              +1473 	$ii_ringfest1	2
00:001704 58F002              +1473 
00:001705 36B000              +1473 
00:001706 A602A3              +1473 
  :                            1474 
00:001707 051000              +1475 	on	see$3
00:001708 600004              +1476 	la	a
00:001709 203002              +1477 	sa	energy$advise
  :                            1478 	
00:00170A 7D0000              +1479 	ir	0
  :                            1480 
  :                            1481: 	$include	../teraframe/device1a
  :                            1 teraframe	$tree
  :                            2 
  :                            3 $(67::,y)
  :                            4 device_k	$array_key
  :                            5 
  :                            6 $(67::,y)
  :                            7 canister	$array_index
  :                            8 
  :                            9 $(66::,x)
  :                            10 cluster		$cluster_descriptor
  :                            11 
  :                            12 $(0)
  :                            13 
  :                            14 array_device_claim_ii
00:00170B 600004              +15 	la	a			. pages desired - 1 in application a
00:00170C 3E070F              +16 	lcal	array_device_claim
00:00170D 200004              +17 	sa	a			. application accumulator
00:00170E 7D0000              +18 	ir	0
  :                            19 
  :                            20 array_device_claim
00:00170F FD0000              +21 	$head_near	scalars(device_index,	int)
  :                            22 
00:001710 051000              +23 	on	see$3
00:001711 A00921              +24 	and	(03FFFC0)		. banks sought - 1
00:001712 200087              +25 	sa	7+128			
  :                            26 
00:001713 5D30EC              +27 	ly	device_key(63),,xi	. highest device access descriptor
00:001714 6D003F              +28 	lb	63,,xi			. highest port number
00:001715 4808DF              +29 	lk	(0C00000:s)
  :                            30 
00:001716 28F000              +31 claim?	sb	device_index
00:001717 04D080              +32 	inA	128, b			. device port
00:001718 AF0903              +33 	mta	(0800000:s)		. memory array device?
00:001719 B60757              +34 	j	claim_next		. no
00:00171A 07B000              +35 	ts	device_k:ts_cell
00:00171B B6071A              +36 	j	$-1
  :                            37 
00:00171C 180086              +38 	sy	6+128			. save pointer to key
00:00171D 70B001              +39 	tz	device_k:index
00:00171E B60730              +40 	j	index_constructed
  :                            41 	
00:00171F A00921              +42 	and	(03FFFC0)		. bank high index from device port
00:001720 9008CA              +43 	or	(0400000)		. device flag
00:001721 900085              +44 	or	b_x			. device index
00:001722 20B001              +45 	sa	device_k:index		. configured
  :                            46 
00:001723 34002C              +47 	sabr	BVOLATILE_I
00:001724 580922              +48 	ly	(BVOLATILE_I*/18:s)	. canister start address
  :                            49 
00:001725 400923              +50 	lr	(__TERA_BANKS-1)
00:001726 54B001              +51 	lx	canister:free(1),,i
  :                            52 
00:001727 30A000              +53 zchain	z	0, x
00:001728 850001              +54 	ax	1,,xi
00:001729 1E0727              +55 	jdr	zchain
  :                            56 					. currently based highest device bank
00:00172A 9808CA              +57 	orB	(0400000)		. 0400000++device = 1st bank of device
00:00172B 650000              +58 	la	0,,xi
  :                            59 
00:00172C 500924              +60 	lx	(BVOLATILE_I*/18++262144-DESC2:s)	. -> 1st descriptor at top of canister
00:00172D C7A000              +61 	ds	0, x
00:00172E 10B000              +62 	sx	canister:next
  :                            63 .	sb	canister:next		. 1st available for assignment
00:00172F 580086              +64 	ly	6+128
  :                            65 
  :                            66 index_constructed
00:001730 60B001              +67 	la	device_k:index		. bank name of canister
00:001731 44C040              +68 	lr	64, a, i		. and bank limit + 1 for assigment
00:001732 34002C              +69 	sabr	BVOLATILE_I
00:001733 580922              +70 	ly	(BVOLATILE_I*/18:s)	. canister start address
  :                            71 
00:001734 54B001              +72 	lx	canister:free(1),,i	. index into free chains. ie lx y
00:001735 600087              +73 	la	7+128			. banks desired - 1 from application a
  :                            74 
00:001736 060006              +75 	sar	6
  :                            76 .	sal	2
00:001737 800084              +77 	ax	a_x
  :                            78 
00:001738 68A000              +79 	lb	0, x			. read chain head
00:001739 CE073E              +80 	jzb	claim_new		. if none ready for use
  :                            81 
00:00173A F8D000              +82 	push	0, b			. next pointer
00:00173B 38A000              +83 	pop	0, x			. to freelist head
00:00173C 60D001              +84 	la	1, b
00:00173D B60749              +85 	j	return_buffer
  :                            86 
  :                            87 claim_new
  :                            88 
00:00173E 68B000              +89 	lb	canister:next
00:00173F 60D001              +90 	la	1, b			. ultimate result
  :                            91 
00:001740 54C040              +92 	lx	64, a, i		. construct new next bank name
00:001741 800087              +93 	ax	7+128			. banks required */ 6
00:001742 F60755              +94 	jxge	key_free		. higher than control tables
  :                            95 
00:001743 9F0084              +96 	dpush	a_x			. after jump decision
  :                            97 
  :                            98 	$if	1
00:001744 CDFFFE              +99 	ab	-DESC2,,xi		. new next descriptor
00:001745 10D001              +100 	sx	1, b			. new heap top
00:001746 28B000              +101 	sb	canister:next		. new stack top
  :                            102 	$else
  :                            103 	sx	canister:next
  :                            104 	lb	x_x
  :                            105 	la	x_x
  :                            106 
  :                            107 	sbr	6-2
  :                            108 	andB	(00FFFF*/2)
  :                            109 	xorB	-4,,xi			. descriptor address
  :                            110 	lx	(BVOLATILE_I+1*/18s)		
  :                            111 	ax	0, b, i			. as a function of buffer address
  :                            112 	sx	canister:next+1
  :                            113 	sa	cluster:bank, x
  :                            114 	lb	x_x
  :                            115 	$endif
  :                            116 
  :                            117 
  :                            118 .	can't use macro [ c lc ] in ISRs
  :                            119 .	because it finishes by popping application sp
  :                            120 
  :                            121 
  :                            122 	$if	0
  :                            123 	la	0, sp			. update basis
  :                            124 	lr	4, x, i			. lower limit of intermediate space update
  :                            125 	lx	1, sp			. descriptor of new buffer
  :                            126 	
  :                            127 	lcal	intermediate_space
  :                            128 	$endif
  :                            129 
00:001747 380084              +130 	dpop	a_x			. this is the buffer getting delivered
00:001748 380085              +130 
  :                            131 
  :                            132 return_buffer
00:001749 580086              +133 	ly	128+6			. reload device key address
00:00174A 30B000              +134 	z	device_k:ts_cell	. free device
  :                            135 
00:00174B 054000              +136 	on	see$1			. 
  :                            137 
00:00174C 551140              +138 	lx	TERAFRAME_CHAIN(1),,xi
00:00174D 80F000              +139 	ax	device_index		. 1 chain per process per device
00:00174E 701140              +140 	tnz	TERAFRAME_CHAIN(1)
00:00174F B60751              +140 
00:001750 3E0769              +141 	lcal	teraframes_initial
  :                            142 	
  :                            143 	$if	1
  :                            144 
00:001751 F8A000              +145 	push	0, x
00:001752 38D000              +146 	pop	0, b
00:001753 28A000              +147 	sb	0, x
  :                            148 
  :                            149 	$else
  :                            150 
  :                            151 	sx	cluster:reverse, b	. this is back pointer 1st in chain
  :                            152 	ly	0, x			. old 1st in chain
  :                            153 	sy	cluster:next, b		. next of new 1st in chain
  :                            154 	sb	0, x			. new object -> chain head
  :                            155 	tz	y_x			. not the 1st time thru here
  :                            156 	sb	cluster:reverse, y	. back pointer from 2nd in chain to 1st
  :                            157 
  :                            158 	$endif
  :                            159 
00:001754 B60764              +160 	j	deliver
  :                            161 
  :                            162 key_free
00:001755 580086              +163 	ly	128+6			. reload device key address
00:001756 30B000              +164 	z	device_k:ts_cell
  :                            165 
  :                            166 claim_next
00:001757 8DFFFE              +167 	ay	-2,,xi
  :                            168 
  :                            169 .	lb	r_x			. copy limit encoding from r
  :                            170 .	andB	63,,xi			. and isolate device index in it
  :                            171 
00:001758 68F000              +172 	lb	device_index	
00:001759 1F0085              +173 	dec	b_x
00:00175A 453074              +174 	lr	device_key(3),,xi
00:00175B FE0716              +175 	jyge	claim?
  :                            176 					. high index page request
00:00175C 600087              +177 	la	7+128
00:00175D 3E0201              +178 	lcal	array_high_ix
00:00175E C60764              +179 	jza	deliver
  :                            180 
00:00175F 054000              +181 	on	see$1			. last choice, preference was array devices
00:001760 F81004              +182 	push	BANK_CHAIN
00:001761 38D000              +183 	pop	0, b
00:001762 281004              +184 	sb	BANK_CHAIN		. add to thread memory estate chain
00:001763 9008CA              +185 	or	(0400000)		. it's big
  :                            186 
00:001764 20F000              +187 deliver	sa	device_index		. overwrite dynamic variable
00:001765 6008DB              +188 	la	(0C00001:s)
00:001766 34002C              +189 	sabr	BVOLATILE_I
00:001767 380084              +190 	pop	a_x			. result is buffer:descriptor in [ a_x b_x ]
  :                            191 
00:001768 350000              +192 	lret	0	
  :                            193 
  :                            194 	$if	1
  :                            195 
  :                            196 teraframes_initial
00:001769 101140              +197 	sx	TERAFRAME_CHAIN(1)	. record at least 1 of TERAFRAME_CHAIN(3..63)
00:00176A F80082              +198 	push	x_x			. is populated
00:00176B 55117F              +199 	lx	TERAFRAME_CHAIN(63+1),,xi
00:00176C 451143              +200 	lr	TERAFRAME_CHAIN(3+1),,xi
  :                            201 
  :                            202 teraframe_reset
00:00176D 30A000              +203 	z	0, x
00:00176E 85FFFF              +204 	ax	-1,,xi
00:00176F F6076D              +205 	jxge	teraframe_reset
00:001770 380082              +206 	pop	x_x
00:001771 350000              +207 	lret	0
  :                            208 
  :                            209 chain_relink
  :                            210 
00:001772 054000              +211 	on	see$1
00:001773 680084              +212 	lb	a_x
00:001774 AD003F              +213 	andB	63,,xi
00:001775 551140              +214 	lx	TERAFRAME_CHAIN(1),,xi
00:001776 800085              +215 	ax	b_x
  :                            216 
00:001777 4DFFFF              +217 	lk	-1,,xi
  :                            218 
  :                            219 chain_chase
00:001778 680082              +220 	lb	x_x			. previous
00:001779 50A000              +221 	lx	0, x			. into chain
00:00177A 700002              +222 	tnz	x			. nane?
00:00177B B6077D              +222 
00:00177C 350000              +223 	lret	0
00:00177D AFA001              +224 	mta	1, x			. hit ?
00:00177E B60778              +225 	j	chain_chase		. not yet
00:00177F F8A000              +226 	push	0, x			. previous -> next = this -> next
00:001780 38D000              +227 	pop	0, b
00:001781 350001              +228 	lret	1			. result in x_x
  :                            229 
  :                            230 .	final leaf of BANK$FREE
  :                            231 
  :                            232 .	a <- bank start index
  :                            233 .	device zero system memory does not get here
  :                            234 .	only device types 800000 OR page_high_index
  :                            235 .	system memory type outside executable space
  :                            236 
  :                            237 array_device_free
  :                            238 	
00:001782 B80085              +239 	xorB	b_x			. caller does not have the descriptor
  :                            240 					. just bank index in application register a
00:001783 3E0785              +241 	lcal	array_cluster_free
00:001784 7D0000              +242 	ir	0
  :                            243 
  :                            244 array_cluster_free
                                	$head_near	scalars(indication,	int,	b_x	;
                                				bank_index,	int,	a_x	;
                                				tuple_p,	int		;
00:001785 F80085              +248 				caller_x,	int,	x_x	)
00:001786 F80084              +248 
00:001787 FD0000              +248 
00:001788 F80082              +248 
  :                            249 
  :                            250 .	1st job find the descriptor in the device memory table
  :                            251 .	if it's not leading edge of a cluster it doesn't get freed
  :                            252 .	and result in b is zero =  "no banks are actually pooled"
  :                            253 .	calling ISR can use that result to cancel vectors or not
  :                            254 
00:001789 051000              +255 	on	see$3			. some lookups about array devices
  :                            256 					. cached in kernel memory
  :                            257 
00:00178A A5003F              +258 	and	63,,xi			. index 2-word information cell
00:00178B 260001              +259 	sal	1
00:00178C 5D306E              +260 	ly	device_key(1)-2,,xi
00:00178D 880084              +261 	ay	a_x
  :                            262 
00:00178E 480921              +263 	lk	(03FFFC0)
00:00178F 60B001              +264 	la	device_k:index		. we want bank at high index = management pool
00:001790 AFF002              +265 	mtane	bank_index		. that aint the page we're fixin to pool ?
00:001791 B60793              +265 
00:001792 B607C4              +266 	j	array_cluster_leave	. we might not wish to pool the pool controls
  :                            267 
00:001793 07B000              +268 	ts	device_k:ts_cell	. lock target a moment or 2
00:001794 B60793              +269 	j	$-1
  :                            270 
00:001795 18F001              +271 	sy	tuple_p			. best not forget that part
00:001796 580922              +272 	ly	(BVOLATILE_I*/18s)
00:001797 34002C              +273 	sabr	BVOLATILE_I		. remember hee? the device control page
00:001798 60F002              +274 	la	bank_index		. and hee? the one we want to free
  :                            275 
00:001799 50B000              +276 	lx	canister:next
00:00179A 5CA002              +277 	ly	DESC2, x, i		. buffer below heap top
00:00179B 40A001              +278 	lr	1, x			. heap top
00:00179C 500084              +279 	lx	a_x			. bank index for delete
00:00179D F607C2              +280 	jxge	array_device_release	.
  :                            281 
00:00179E 500085              +282 	lx	b_x			. this caller max be...
00:00179F DE07A3              +283 	jnzb	indicated		. ...working the front of the owner chain
00:0017A0 3E0772              +284 	lcal	chain_relink		. obtain descriptor pointer from owner chain
00:0017A1 B607C2              +285 	j	array_device_release	. no
00:0017A2 10F003              +286 	sx	indication		. will return to caller in b_x
  :                            287 
  :                            288 indicated
00:0017A3 AFB001              +289 	mta	1, y			. k is still -1
00:0017A4 B607AE              +290 	j	array_into_list
  :                            291 
00:0017A5 400925              +292 	lr	(BVOLATILE_I+1*/18s)
  :                            293 
  :                            294 array_heap_compress
00:0017A6 580922              +295 	ly	(BVOLATILE_I*/18:s)	. point to canister again
00:0017A7 10B000              +296 	sx	canister:next
  :                            297 
  :                            298 	.	is the next buffer on its freelist[SIZE] ?
  :                            299 
00:0017A8 60A001              +300 	la	1, x			. the buffer above
00:0017A9 850002              +301 	ax	DESC2,,xi		. the next buffer
00:0017AA F607C2              +302 	jxge	array_device_release	. heap empty next -> heap
  :                            303 
00:0017AB 3E07B4              +304 	lcal	find_in_freelist
00:0017AC B607C2              +305 	j	array_device_release	. not found do not free
00:0017AD B607A6              +306 	j	array_heap_compress	. 
  :                            307 
  :                            308 array_into_list
00:0017AE 3E07B4              +309 	lcal	find_in_freelist
00:0017AF B607B1              +310 	j	found_list_position	. not found so insert
00:0017B0 B607C2              +311 	j	array_device_release	. was found, is already there
  :                            312 
  :                            313 found_list_position
00:0017B1 10D000              +314 	sx	0, b			. insert in chain
00:0017B2 18A000              +315 	sy	0, x
00:0017B3 B607C2              +316 	j	array_device_release	. clear lock
  :                            317 
  :                            318 find_in_freelist
  :                            319 
00:0017B4 680084              +320 	lb	a_x			. buffer + 1
00:0017B5 D8A001              +321 	anb	1, x			. minus buffer
00:0017B6 0E0006              +322 	sbr	6			. = size
00:0017B7 580922              +323 	ly	(BVOLATILE_I*/18:s)	. still at canister?
  :                            324 					. size is 1+ banks, so list[-1]
00:0017B8 880085              +325 	ay	b_x
  :                            326 					. so clusters > zero start at entry 1+
00:0017B9 400082              +327 	lr	x_x			. comparand for y_x
  :                            328 
  :                            329 freelist_search
00:0017BA 680083              +330 	lb	y_x
00:0017BB 58B000              +331 	ly	0, y
  :                            332 
00:0017BC FE07BE              +333 	jyge	list_descriptor_high	. therefore list buffer low
00:0017BD 350000              +334 	lret	0			. therefore y -> insert
  :                            335 
  :                            336 list_descriptor_high			. k_x still trusted as = -1
00:0017BE 600083              +337 	la	y_x
00:0017BF AF0080              +338 	mta	r_x
00:0017C0 B607BA              +339 	j	freelist_search		. not in chain
00:0017C1 350001              +340 	lret	1			. in chain
  :                            341 
  :                            342 
  :                            343 array_device_release
00:0017C2 58F001              +344 	ly	tuple_p
00:0017C3 30B000              +345 	z	device_k:ts_cell	. free thayum control tuple
  :                            346 
  :                            347 array_cluster_leave
00:0017C4 6008DB              +348 	la	(0C00001s)
00:0017C5 34002C              +349 	sabr	BVOLATILE_I		. close the gate
00:0017C6 870082              +350 	qpop	x_x			. [ caller_x | device_tuple | bank_index | descriptor ]
00:0017C7 350000              +351 	lret	0
  :                            352 
  :                            353 .	at process & thread  exit
  :                            354 .	no need to cancel the vector pointers
  :                            355 .	or to drop system memory blocks. That happens anyway
  :                            356 .	just pool any memory array device-nonzero blocks
  :                            357 
  :                            358 	$if	0			. these three instructions go inline in exit_ii
  :                            359 dframes_cancel
  :                            360 	on	see$1
  :                            361 	tz	TERAFRAME_CHAIN(1)	. indicates some of TERAFRAME_CHAIN() are populated
  :                            362 	lcal	teraframe:free_teraframes
  :                            363 	lret	0
  :                            364 	$endif
  :                            365 
  :                            366 free_teraframes				. see$1 is on
00:0017C8 55117F              +367 	lx	TERAFRAME_CHAIN(63+1),,xi	. label #s are relative 1 not zero
  :                            368 free_next_chain
00:0017C9 70A000              +369 	tz	0, x
00:0017CA 3E07CF              +370 	lcal	free_owner_chain	. if this call is made...
00:0017CB 85FFFF              +371 	ax	-1,,xi			. ... x_x is saved and restored
00:0017CC 451143              +372 	lr	TERAFRAME_CHAIN(3+1),,xi	. no array device may be device [ 0 1 2 ]
00:0017CD F607C9              +373 	jxge	free_next_chain
00:0017CE 350000              +374 	lret	0
  :                            375 
  :                            376 free_owner_chain
00:0017CF F80082              +377 	push	x_x
00:0017D0 85EEC0              +378 	ax	-TERAFRAME_CHAIN(1),,xi	. get the device instance 
00:0017D1 5D306E              +379 	ly	device_key(1)-2,,xi	. management tuple in kernel store
00:0017D2 880082              +380 	ay	x_x
00:0017D3 880082              +381 	ay	x_x			. 2-word management tuples
  :                            382 
00:0017D4 60B001              +383 	la	device_k:index		. base index of highest block
  :                            384 					. = management block
00:0017D5 0CA080              +385 	inB	128, x			. read the corresponding device port
00:0017D6 A80921              +386 	andB	(03FFFC0)		. isolate block high index
00:0017D7 9808CA              +387 	orB	(0400000)		. zone it with big flag
00:0017D8 980082              +388 	orB	x_x			. and device index
00:0017D9 B80084              +389 	xorB	a_x			. does it tally?
00:0017DA DE07DC              +390 	jnzb	free_owner_chain_out	. management structure compromised, or owner chain
  :                            391 
00:0017DB 3E07DE              +392 	lcal	owner_chain_walk
  :                            393 
  :                            394 free_owner_chain_out
00:0017DC 380082              +395 	pop	x_x
00:0017DD 350000              +396 	lret	0
  :                            397 					. note it's very costly if array_cluster_free
  :                            398 					. is allowed to hunt the owner chain for the
  :                            399 					. descriptor which is already supplied from here
  :                            400 					. especially as a resource is locked
  :                            401 					. so array_cluster_free is not allowed to do that
  :                            402 
  :                            403 owner_chain_walk			. no need to update chain headers
00:0017DE 851140              +404 	ax      TERAFRAME_CHAIN(1),,xi	. recover chain head address in TCB
00:0017DF 68A000              +405 	lb	0, x
00:0017E0 CE07E9              +406 	jzb	owner_chain_walk_thru	. shouldn't happen but...
  :                            407 					. 1-time check we're not here by mistake
  :                            408 
  :                            409 owner_chain_walk_on			. array_cluster_free closes window each pass
00:0017E1 34002C              +410 	sabr	BVOLATILE_I		. all descriptor pointers relate this window
00:0017E2 F80084              +411 	push	a_x			. save control block index
00:0017E3 F8D000              +412 	push	0, b			. save next in case it's cleaned off descriptor
00:0017E4 60D001              +413 	la	1, b			. storage block index 
00:0017E5 3E0785              +414 	lcal	array_cluster_free	. b_x = descriptor
  :                            415 					. both returned unchanged
  :                            416 					. array_cluster_free regenerates y_x
00:0017E6 380085              +417 	pop	b_x			. retrieve next		
00:0017E7 380084              +418 	pop	a_x			. retrieve control page
00:0017E8 DE07E1              +419 	jnzb	owner_chain_walk_on
  :                            420 					. array_cluster_free has already closed window
  :                            421 owner_chain_walk_thru			. to the same as it is and hands it back
00:0017E9 350000              +422 	lret	0
  :                            423 
  :                            424 	$root
  :                            1482: 	$include	../teraframe/dframe
  :                            1 dframe	$tree
  :                            2 
  :                            3 .		 47	 42						       0
  :                            4 .		_________________________________________________________________
  :                            5 .		|*window|			word offset			|
  :                            6 .		|_______|_______________________________________________________|
  :                            7 .		|		vector		|yx|_log|  		    |www|			
  :                            8 .		|_______________________________|__|____|___________________|___|
  :                            9 .		 47			      24|  |			    |  0
  :                            10 .						|  |21..18 cluster log	    |	
  :                            11 .						|  |22 banks / pages	    |2..0 address windows 	
  :                            12 .						|23 cluster log present	    |	base 1..8 granules
  :                            13 
  :                            14 .	these routines populate referenced parts of application arrays
  :                            15 .	via the application vector list which is read-only to the application
  :                            16 .
  :                            17 .	note these routines update application vectors in the range
  :                            18 .
  :                            19 .				002900 hex to 002FFF
  :                            20 .
  :                            21 .	and may use all of them to populate array parts which the application references
  :                            22 .	these routines never touch kernel vectors
  :                            23 .
  :                            24 .	kernel vectors within parts of the same range have special uses for serving the system
  :                            25 
  :                            26 .	these routines routinely support uniquely applications using uniquely application vectors
  :                            27 
  :                            28 .			vector 002900 hex is named vpointer(1)
  :                            29 .			vector 002FFF hex is named vpointer(1792)
  :                            30 .
  :                            31 
  :                            32 dframe_ii
00:0017EA 0D2000              +33 	off	see$2
00:0017EB 4F0004              +34 	ql	a			. 4-word request block in [ a b 6 7 ] 
  :                            35 
00:0017EC 3F0087              +36 	slc	7+128			. get the big bit of bank range to view
00:0017ED 7E082C              +37 	jc	dframe_cluster
00:0017EE 3F0087              +38 	slc	7+128			. into carry$
00:0017EF 7E080F              +39 	jc	dframe_large		. think big instead of page
  :                            40 
00:0017F0 452900              +41 	lr	vpointer(1),,xi		. address of vector list start
00:0017F1 56000C              +42 	drr	12			. get 24 bits of page displacent in array
00:0017F2 500086              +43 	lx	6+128			. address of 1st vector in array
00:0017F3 800085              +44 	ax	b_x			. plus offset page
00:0017F4 F607F6              +45 	jxl	dframe_zero		. may not be < vpointer(1)
00:0017F5 B6085D              +45 
  :                            46 
00:0017F6 680087              +47 	lb	7+128			. how many pages to pull up - 1
00:0017F7 0E0002              +48 	sbr	2			. normalise after rolling into carry
00:0017F8 580082              +49 	ly	x_x			. sum high index in y
00:0017F9 880085              +50 	ay	b_x			. get y to top of desired range
  :                            51 
  :                            52 .	lr	03000,,xi		. 
  :                            53 
00:0017FA 400000              +54 	lr	r			. page / bank limit 
00:0017FB F6085D              +55 	jxge	dframe_zero		. check at least 1 page is in range
  :                            56 					. no so buy no memory return no pointer
  :                            57 
00:0017FC 16000C              +58 	dsr	12			. change 12.window.6 to z12.12 | window.?18
00:0017FD 0E0006              +59 	sbr	6			.				 z6.window.?18
00:0017FE A80926              +60 	andB	(31*/12)
00:0017FF 900085              +61 	or	b_x			. z6.window.12
00:001800 200004              +62 	sa	a			. result in application register
00:001801 0E000C              +63 	sbr	12			. window
  :                            64 
00:001802 400083              +65 	lr	y_x			. propose limit highest in cluster
00:001803 580000              +66 	ly	r			. is array limit at least as high?
00:001804 FE0806              +67 	jyge	dframe_sample_p1	. yes
00:001805 400000              +68 	lr	r			. no: read from application r again
  :                            69 
  :                            70 dframe_sample_p1
00:001806 60A000              +71 	la	0, x			. sample the stored vector
00:001807 A6080A              +72 	jpa	dframe_p1_base		. storage already, give that to the caller
00:001808 3E085F              +73 	lcal	dframe_range		. obtain storage for the gap
00:001809 C6085D              +74 	jza	dframe_zero		. or try to
  :                            75 
  :                            76 dframe_p1_base
00:00180A 34D000              +77 	sabr	0, b			. get a page of buffer into address window
00:00180B F6085E              +78 	jxge	dframe_complete		. enough?
  :                            79 
00:00180C 6CD001              +80 	lb	1, b, i			. advance 1 window
00:00180D 850001              +81 	ax	1,,xi			. and 1 vector
00:00180E B60806              +82 	j	dframe_sample_p1
  :                            83 
  :                            84 dframe_large
00:00180F 560012              +85 	drr	18			. pull 24 bits of bank offset into b
00:001810 500086              +86 	lx	6+128			. start of vectors range
00:001811 800085              +87 	ax	b_x			. sum in x
00:001812 452900              +88 	lr	vpointer(1),,xi		. lowest advisable vector to use
00:001813 F60815              +89 	jxl	dframe_zero		. lower than that is rejected
00:001814 B6085D              +89 
00:001815 680087              +90 	lb	7+128			. number of banks requested in view - 1
00:001816 0E0002              +91 	sbr	2			. renormalise after shifting 2 bits to carry
00:001817 580085              +92 	ly	b_x			. add to start of range
00:001818 880082              +93 	ay	x_x			. vector + bank offset + banks - 1
  :                            94 
  :                            95 .	lr	03000,,xi		. last useable vector location + 1
  :                            96 
00:001819 400000              +97 	lr	r			. array limit from application r 
00:00181A F6085D              +98 	jxge	dframe_zero		. not even 1st window served
  :                            99 					. buy no memory return no pointer
  :                            100 
00:00181B A5FFDF              +101 	and	-64++31,,xi		. 18 bits of offset and 5 bits of window
00:00181C 460006              +102 	rar	6			. window.offset
00:00181D 200004              +103 	sa	a			. result in application accumulator
00:00181E 16002A              +104 	dsr	48-6			. window in b
  :                            105 
00:00181F 400083              +106 	lr	y_x			. propose top of cluster for top of frame
00:001820 580000              +107 	ly	r			. is array at least that large?
00:001821 FE0823              +108 	jyge	dframe_sample_b1	. yes
00:001822 400000              +109 	lr	r			. no: replace with top of array
  :                            110 
  :                            111 dframe_sample_b1
00:001823 60A000              +112 	la	0, x			. read vector
00:001824 A60827              +113 	jpa	dframe_b1_base		. storage already resourced, hand to caller
00:001825 3E087A              +114 	lcal	dframe_resource		. measure the gap and request storage
00:001826 C6085D              +115 	jza	dframe_zero		. request can't be met
  :                            116 
  :                            117 dframe_b1_base
00:001827 34D000              +118 	sabr	0, b			. place in address window
00:001828 F6085E              +119 	jxge	dframe_complete		. if that was all ...
00:001829 850001              +120 	ax	1,,xi			. ... otherwise next vector
00:00182A 6CD001              +121 	lb	1, b, i
00:00182B B60823              +122 	j	dframe_sample_b1
  :                            123 
  :                            124 __CLUSTER_LOG	$equ	8+128
  :                            125 __BASE		$equ	9+128
  :                            126 __CLUSTER_LOG_PLUS_6 $equ 10+128
  :                            127 __CLUSTER_MASK	$equ	11+128
  :                            128 
  :                            129 dframe_cluster
00:00182C 3F0087              +130 	slc	7+128
00:00182D 5E085D              +131 	jnc	dframe_zero		. not worth doing gigantic stuff in pages
  :                            132 
00:00182E 500086              +133 	lx	6+128
00:00182F 452900              +134 	lr	vpointer(1),,xi
00:001830 F60832              +135 	jxl	dframe_zero
00:001831 B6085D              +135 
  :                            136 
00:001832 400000              +137 	lr	r			. assembly makes array-limit (application r)
  :                            138 					. the only remaining necessary  check
  :                            139 
00:001833 560012              +140 	drr	18			. isolate array-relative bank index in b
00:001834 500085              +141 	lx	b_x
00:001835 F6085D              +142 	jxge	dframe_zero		. outside array. buy no memory, return no pointer
  :                            143 
00:001836 460006              +144 	rar	6
00:001837 200004              +145 	sa	a			. write result window.offset			
00:001838 16002A              +146 	dsr	42
  :                            147 .	sa	BASE
  :                            148 
00:001839 600087              +149 	la	7+128
00:00183A 060014              +150 	sar	18+2			. two flag bits were pulled into carry$
00:00183B A5000F              +151 	and	15,,xi
  :                            152 
00:00183C C70088              +153 	ds	__CLUSTER_LOG		. and __BASE in next register
00:00183D 64C006              +154 	la	6, a, i			. comes in handy
00:00183E 20008A              +155 	sa	__CLUSTER_LOG_PLUS_6	. once or twice
00:00183F 65FFFF              +156 	la	-1,,xi
00:001840 268088              +157 	sal	*__CLUSTER_LOG
00:001841 480084              +158 	lk	a_x			. mask of cluster index field
00:001842 08008B              +159 	sk	__CLUSTER_MASK
00:001843 0F008B              +160 	n	__CLUSTER_MASK
  :                            161 	
00:001844 600087              +162 	la	7+128			. calculate highest requested 
00:001845 060002              +163 	sar	2			. two flag bits were pulled into carry$
00:001846 A50007              +164 	and	7,,xi
00:001847 580084              +165 	ly	a_x
00:001848 880082              +166 	ay	x_x
  :                            167 
00:001849 400083              +168 	lr	y_x
00:00184A 580000              +169 	ly	r			. yes application r = array high index bank
00:00184B FE084D              +170 	jyge	cluster_granules	. array contains all requested granules?
00:00184C 400000              +171 	lr	r			. no, only the starting one[s]
  :                            172 
  :                            173 cluster_granules
00:00184D 600082              +174 	la	x_x
00:00184E 6D0000              +175 	lb	0,,xi
00:00184F 568088              +176 	drr	*__CLUSTER_LOG
00:001850 6E808A              +177 	rbl	*__CLUSTER_LOG_PLUS_6
00:001851 580084              +178 	ly	a_x
00:001852 880086              +179 	ay	6+128			. from start of vectors
00:001853 60B000              +180 	la	0, y			. read out the vector
00:001854 A60857              +181 	jpa	cluster_loaded		. it's not C00001 whatever it is 
00:001855 3E0893              +182 	lcal	dframe_cluster_request
00:001856 C6085D              +183 	jza	dframe_zero
  :                            184 
  :                            185 cluster_loaded
00:001857 C00085              +186 	aa	b_x
00:001858 348089              +187 	sabr	*__BASE
00:001859 F6085E              +188 	jxge	dframe_complete
00:00185A 170089              +189 	inc	__BASE
00:00185B 850001              +190 	ax	1,,xi
00:00185C B6084D              +191 	j	cluster_granules
  :                            192 
  :                            193 dframe_zero
00:00185D 300004              +194 	z	a			. squersh the result
  :                            195 
  :                            196 dframe_complete
00:00185E 7D0000              +197 	ir	0
  :                            198 
  :                            199 					. measure gap in requested vectors
  :                            200 dframe_range				. and request storage
00:00185F 8F0084              +201 	qpush	a_x			. memory routines use a lot of registers
00:001860 8F0080              +202 	qpush	r_x
  :                            203 
00:001861 651000              +204 	la	4096,,xi		. start the bidding at one page
  :                            205 
00:001862 F60869              +206 bid	jxge	bidden			. end of gap already?
00:001863 850001              +207 	ax	1,,xi			. next vector otherwise
00:001864 78A000              +208 	tn	0, x			. already loaded ?
00:001865 B60867              +208 
00:001866 B60869              +209 	j	bidden			. don't overload, that's the storage in use
00:001867 C51000              +210 	aa	4096,,xi		. otherwise up the bidding
00:001868 B60862              +211 	j	bid
  :                            212 
00:001869 3E01D0              +213 bidden	lcal	bank			. ask for storage = gap
00:00186A 20F004              +214 	sa	4, sp			. store the result in stacked accumulator
00:00186B C60877              +215 	jza	wan			. if none no more to do
00:00186C 054000              +216 	on	see$1
00:00186D F81004              +217 	push	BANK_CHAIN
00:00186E 38D000              +218 	pop	0, b
00:00186F 281004              +219 	sb	BANK_CHAIN
00:001870 50F002              +220 	lx	2, sp			. retrieve start-of-gap pointer
00:001871 40F000              +221 	lr	0, sp			. and limits pointer
  :                            222 	
00:001872 20A000              +223 win	sa	0, x			. populate a vector
00:001873 F60877              +224 	jxge	won			. is that all?
00:001874 64C001              +225 	la	1, a, i			. next page pointer
00:001875 850001              +226 	ax	1,,xi			. next vector
00:001876 B60872              +227 	j	win			. and do it again
  :                            228 wan
00:001877 870080              +229 won	qpop	r_x			. stacked info includes the first page pointer
00:001878 870084              +230 	qpop	a_x			. and cursor / limit in vector list
00:001879 350000              +231 	lret	0
  :                            232 
  :                            233 dframe_resource				. same thing for big pages called banks
00:00187A 8F0084              +234 	qpush	a_x
00:00187B 8F0080              +235 	qpush	r_x
  :                            236 
00:00187C 650040              +237 	la	64,,xi			. start the bidding at one bank
  :                            238 dframe_bid
00:00187D F60884              +239 	jxge	dframe_bidden		. is that the end of the range?
00:00187E 850001              +240 	ax	1,,xi			. no, sample the next vector
00:00187F 78A000              +241 	tn	0, x			. if it has storage don't overload
00:001880 B60882              +241 
00:001881 B60884              +242 	j	dframe_bidden		. the gap is covered
00:001882 C50040              +243 	aa	64,,xi			. otherwise up the bidding by one bank
00:001883 B6087D              +244 	j	dframe_bid
  :                            245 
  :                            246 dframe_bidden
00:001884 C5FFFF              +247 	aa	-1,,xi			. request teraframe:array_device_claim
  :                            248 					. is pages - 1
00:001885 3E070F              +249 	lcal	teraframe:array_device_claim	. get the banks cluster wherever it is
00:001886 20F004              +250 	sa	4, sp			. store result in stacked accumulator
  :                            251 
00:001887 C60890              +252 	jza	dframe_distributed	. if that result is zero do no more
  :                            253 .	la	b_x
00:001888 68F005              +254 	lb	5, sp
00:001889 50F002              +255 	lx	2, sp			. otherwise seed the storage pointer into vectors
00:00188A 40F000              +256 	lr	0, sp
  :                            257 
  :                            258 dframe_distribute
00:00188B 20A000              +259 	sa	0, x			. write a vector
00:00188C F60890              +260 	jxge	dframe_distributed	. an it be the last
00:00188D 64C040              +261 	la	64, a, i		. or advance in the cluster
00:00188E 850001              +262 	ax	1,,xi			. and in the vector list
00:00188F B6088B              +263 	j	dframe_distribute
  :                            264 
  :                            265 dframe_distributed			. results and running parameters
00:001890 870080              +266 	qpop	r_x			. are in the stacked registers
00:001891 870084              +267 	qpop	a_x
00:001892 350000              +268 	lret	0
  :                            269 
  :                            270 dframe_cluster_request
00:001893 8F0088              +271 	qpush	8+128
00:001894 8F0084              +272 	qpush	a_x
00:001895 8F0080              +273 	qpush	r_x
  :                            274 
00:001896 600000              +275 	la	r			. array size in banks in application r
00:001897 AF0082              +276 	mta	x_x			. requested cluster = highest cluster in array?
00:001898 B6089C              +277 	j	dframe_cluster_all	. no so get the big cluster
00:001899 A0008B              +278 	and	__CLUSTER_MASK		. yes, request is the remainder of array / cluster
00:00189A 260006              +279 	sal	6
00:00189B B6089E              +280 	j	dframe_cluster_part	. does not need last cluster so large
  :                            281 
  :                            282 dframe_cluster_all
00:00189C 650001              +283 	la	1,,xi
00:00189D 26808A              +284 	sal	*__CLUSTER_LOG_PLUS_6	. 64 * BANKS = PAGES
  :                            285 
  :                            286 dframe_cluster_part
00:00189E C5FFFF              +287 	aa	-1,,xi			. request teraframe:array_device_claim
  :                            288 					. is pages - 1
00:00189F 3E070F              +289 	lcal	teraframe:array_device_claim		
00:0018A0 20F004              +290 	sa	4, sp			. result
00:0018A1 68F003              +291 	lb	3, sp			. pointer to vector
00:0018A2 C608A4              +292 	jza	$+2
00:0018A3 20D000              +293 	sa	0, b
00:0018A4 870080              +294 	qpop	r_x
00:0018A5 870084              +295 	qpop	a_x
00:0018A6 870088              +296 	qpop	8+128
00:0018A7 350000              +297 	lret	0
  :                            298 
  :                            299 
  :                            300 .	called from applications
  :                            301 .	drop clusters in a range of space
  :                            302 .	application registers [ a b ] are the start, end + 1
  :                            303 
  :                            304 dframe_free_ii
00:0018A8 500004              +305 	lx	a			. lowest vector in range
00:0018A9 452900              +306 	lr	vpointer(1),,xi		. lowest not < $vpointer(1)
00:0018AA F608AC              +307 	jxl	dframes_freed
00:0018AB B608B9              +307 
00:0018AC 580005              +308 	ly	b			. highest vector in range 
00:0018AD 453000              +309 	lr	03000,,xi		. higest not > $vpointer(1792)
00:0018AE F608B9              +310 	jxge	dframes_freed
00:0018AF 44B001              +311 	lr	1, y, i			. lowest must be <= highest
00:0018B0 F608B9              +312 	jxge	dframes_freed		. or else nothing to do
  :                            313 
  :                            314 free_dframe
00:0018B1 60A000              +315 	la	0, x
00:0018B2 E608B6              +316 	jna	next_vector
00:0018B3 3E08BA              +317 	lcal	dframe_cancel
00:0018B4 6008DB              +318 	la	(0C00001s)		. vector now void
00:0018B5 20A000              +319 	sa	0, x			. an available for re-use
  :                            320 
  :                            321 next_vector
00:0018B6 850001              +322 	ax	1,,xi
00:0018B7 F608B9              +323 	jxge	dframes_freed		. r = highest + 1
00:0018B8 B608B1              +324 	j	free_dframe
  :                            325 
  :                            326 dframes_freed
00:0018B9 7D0000              +327 	ir	0
  :                            328 
  :                            329 .	following is a simplified prototype
  :                            330 .	suitable mostly for fixed-cluster arrays as in very vast arrays
  :                            331 .	there is not a cluster per vector entry in the default free format
  :                            332 .	but instead a storage granule (page or bank) per vector
  :                            333 .	so quite a few delete calls are no-op
  :                            334 .	where the pointer is not the leading edge of an assigned buffer
  :                            335  
  :                            336 dframe_cancel
  :                            337 
00:0018BA F80082              +338 	push	x_x			. save fixed parameter
00:0018BB F80080              +339 	push	r_x			. save running parameter
  :                            340 
00:0018BC 4808CA              +341 	lk	(0400000)		. big?
00:0018BD AF0081              +342 	mta	k_x
00:0018BE B608C2              +343 	j	dframe_cancel_sysmem	. not big therefore system memory
00:0018BF 4D003F              +344 	lk	63,,xi			. system memory large bank?
00:0018C0 AF08CB              +345 	mta	(0)
00:0018C1 B608C6              +346 	j	dframe_cancel_arraymem	. no, another bank
  :                            347 
  :                            348 dframe_cancel_sysmem			. storage in executable space
00:0018C2 057F00              +349 	on	see$all
00:0018C3 0D2000              +350 	off	see$2
00:0018C4 3E0061              +351 	lcal	sysmem_free
00:0018C5 B608C7              +352 	j	dframe_cancelled
  :                            353 
  :                            354 dframe_cancel_arraymem			. storage outwith executable space
00:0018C6 3E0785              +355 	lcal	teraframe:array_cluster_free
  :                            356 
  :                            357 dframe_cancelled
00:0018C7 380080              +358 	pop	r_x
00:0018C8 380082              +359 	pop	x_x
00:0018C9 350000              +360 	lret	0
  :                            361 
  :                            362 	$root
  :                            1483 
  :                            1484 TRANSFER_PAGE_HIGH
  :                            1485 
[TRANSFER_PAGE_HIGH][0000000000000000000000000000000000000000000008ca]
  :                            1486 	$trace		TRANSFER_PAGE_HIGH
  :                            1487 	$do	$zenith>4096,	$flag	kernel page oversize
  :                            1488 
  :                            1489 	$path		../t77.4
  :                            1490: 	$include	t77
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40: 	$include	dq.def
  :                            41: 	$include	ll.def
  :                            42: 	$include	networks.def
  :                            43: 	$include	i_f.def
  :                            44: 	$include	net_buff.def
  :                            45: 	$include	net_bank.def
  :                            46: 	$include	arp.def
  :                            47: 	$include	ip.def
  :                            48: 	$include	ipv4.def
  :                            49: 	$include	route.def
  :                            50: 	$include	icmp.def
  :                            51: 	$include	socket.def
  :                            52: 	$include	udp.def
  :                            53: 	$include	tcp.def
  :                            54: 	$include	window.def
  :                            55 .	$include	xdr.def
  :                            56 .	$include	protran.def
  :                            57: 	$include	lockfree.def
  :                            58: 	$include	pointers.def
  :                            59: 	$include	../mib/mib-II.def
  :                            60: 	$include	../mib/template.def
  :                            61: 	$include	../mib/ber.def
  :                            62: 	$include	../drivers/ifconfig.def
  :                            63: 	$include	../drivers/routecfg.def
  :                            64: 	$include	../fs/response.def
  :                            65 .	$include	b1_view.def
  :                            66 
  :                            67 	$list		7
  :                            68 
  :                            69: 	$include	networks
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40: 	$include	a_protos.def
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 p	$proc
  :                            41 APPLICATION_PROTOCOLS*	$name
  :                            42 ?	$do	p(),	call	(p(?, 1))
  :                            43 	$end
  :                            44 
  :                            41 
  :                            42 IPV4_DINITIAL_BANK      $equ    3*/12
  :                            43 SIGALERT		$equ	0
  :                            44 QSIMULTANEOUS		$equ	1
  :                            45 NET_ATTENTION_PORT	$equ	121
  :                            46 
  :                            47 NETWORK_D		$equ	12*1024
  :                            48 D0_WORDS		$equ	NETWORK_D
  :                            49 
  :                            50 .	$include	t77.def
  :                            51 
  :                            52 . networks 		$equ	IPV4_BANK/*6
  :                            53 
  :                            54 $(67::,y)
43:000000                     +55 sbind	$socket
43:000002                     +55 
43:000004                     +55 
43:000005                     +55 
43:000006                     +55 
43:000007                     +55 
43:000005                     +55 
43:000006                     +55 
43:000007                     +55 
  :                            56 
  :                            57 $(67::,y)
  :                            58 axw	acw
  :                            59 
  :                            60 .	$(1:4096:IPV4_DINITIAL_BANK/$1)
  :                            61 
  :                            62 $(1:*1/$1)
  :                            63 $(3:*1/$3)
  :                            64 
00:0018ca+400000
00:0018cb+000000
00:0018cc+3FFFFF
00:0018cd+000080000000003000FFFFFF
00:0018d1+00000A
00:0018d2+000000000000000000000000
00:0018d6+F62800
00:0018d7+0BFFFF
00:0018d8+140000
00:0018d9+00000800001E
00:0018db+C00001
00:0018dc+0C00F0
00:0018dd+0BFFFE
00:0018de+0030F0
00:0018df+C00000
00:0018e0+02C001
00:0018e1+200000
00:0018e2+02C007
00:0018e3+00013A000000
00:0018e5+8008E3
00:0018e6+000067000000
00:0018e8+8008E6
00:0018e9+100000
00:0018ea+0000080001F4
00:0018ec+0000000493E003A980030D4002710001D4C00186A0013880
00:0018f4+C00001C00001C00001C00001
00:0018f8+7FFFFF
00:0018f9+544342
00:0018fa+FFFFFF000000000000000000
00:0018fe+292000000000
00:001900+8FFFFF
00:001901+700000
00:001902+070000
00:001903+800000
00:001904+FF0000
00:001905+020000
00:001906+030000
00:001907+060000
00:001908+000FF8
00:001909+00FFFF
00:00190a+3F0000
00:00190b+110000
00:00190c+010000000000
00:00190e+240000000000
00:001910+210000000000
00:001912+2D2000000000
00:001914+200000000000
00:001916+000000000004000004000400
00:00191a+02C180
00:00191b+A00000
00:00191c+02C042
00:00191d+02C000
00:00191e+300000
00:00191f+290000000000
00:001921+3FFFC0
00:001922+B00000
00:001923+00FFFE
00:001924+B3FFFE
00:001925+B40000
00:001926+01F000
  :                            65 $(0::IPV4_BANK)
00:002000 B60040              +66 networks	$vector		networks_start
00:002001 B6006B              +67 __socket*	$vector		network_socket
00:002002 B60EE6              +68 __bind*		$vector		$bind:autobind
00:002003 B60A6E              +69 __connect*	$vector		$sockif:active_connect
00:002004 B60A1B              +70 connect*	$vector		$sockif:socket_connect
00:002005 B60ED7              +71 bind*		$vector		$bind:network_bind
00:002006 B60A0E              +72 tcp_rx_ready*	$vector		tcp_rx_far
  :                            73 .	tfer_dgram*	$vector		net_pass_xcall
00:002007 B604E3              +74 release_udgram*	$vector		udp_drop_dgram
00:002008 B6012E              +75 __route*		$vector		ip_route_advance
  :                            76 
00:002009 B60B9D              +77 recv*		$vector		socket_receive
00:00200A B60BCE              +78 send*		$vector		socket_send
00:00200B B6013B              +79 ipsend*		$vector		ip_send
00:00200C B606FD              +80 __tcp_connect*	$vector		tcp_send_syn
00:00200D B60702              +81 tcp_accept*	$vector		tcp_respond_syn_ack
  :                            82 .	tcp_send_push*	$vector		tcp_send_i
00:00200E B60707              +83 tcp_ack_fin	$vector		tcp_respond_fin_ack
00:00200F B60AEE              +84 __accept*	$vector		$sockif:tcp_await_connection
00:002010 B60B81              +85 sense_data*	$vector		socket_sense
00:002011 B60B20              +86 __net_disengage*  $vector	$sockif:net_disengage
00:002012 B60B4B              +87 __port_disengage* $vector	$sockif:port_disengage		. ports without message q: TCP
00:002013 B60B47              +88 __port_disengage_udp* $vector	$sockif:port_disengage_udp	. ports with message q: UDP
00:002014 B60B4F              +89 __free_tcp_port* $vector	$sockif:free_tcp_port
00:002015 B60B4E              +90 __disconnect_free_tcp* $vector	$sockif:disconnect_free
00:002016 B60B67              +91 __tcp_socket*	$vector		$sockif:tcp_port_socket		. far call tcp port encoding
00:002017 B60F28              +92 ack_request*	$vector		far_ack				. ack requsted from 
  :                            93 								. another instruction frame
  :                            94 	$do	24-$,	fret	0
  :                            95 
  :                            96 		$if		DRIVERS_BANK1
  :                            97 
Note: ../t77.4/networks.msm Line 98: external drivers
  :                            98 		$note		external drivers
  :                            99 
00:002018 B600A5              +100 frame_to_protocol* $vector	frame2p
00:002019 B600BB              +101 far_initpool*	$vector		if_initpool
  :                            102 
  :                            103 .	if_dualport_txwrite* $vector	if_dportw	. moved to drivers
  :                            104 
00:00201A B600BD              +105 if_sell1*	$vector		ifsellmsg
00:00201B B600BF              +106 if_buy1*	$vector		ifbuy
00:00201C B600C1              +107 far_readq*	$vector		ifrq
00:00201D B600C3              +108 far_q2*		$vector		ifq2
00:00201E B600C5              +109 if_q2ifree*	$vector		ifq2ifree
  :                            110 
00:00201F B600C7              +111 if_tx_nocheck*	$vector		iftx_nocheck
  :                            112 if_rx_nocheck*	$equ		if_tx_nocheck
  :                            113 
00:002020 B60234              +114 ipv4_4us?*	$vector		ipv44us?
00:002021 B60237              +115 ipv4_this_if?*	$vector		ipv4thisif?
00:002022 B6023A              +116 ipv4_this_host?* $vector	ipv4thishost?
  :                            117 
  :                            118 		$else
  :                            119 
  :                            120 .	jump pad for interface drivers included in this bank
  :                            121 
  :                            122 		$note		internal drivers
  :                            123 
  :                            124 "$rxtx_lo"*	$vector		rxtx_softwareloopback
  :                            125 
  :                            126 "$rxtx_ift1"*	$vector		ift1_rxtx
  :                            127 "$initial_ift1"* $vector	start_ift1
  :                            128 
  :                            129 		$endif
  :                            130 
  :                            131 		$if	0
  :                            132 dlt_null*	$vector		ifw_dlt_null		. moved to drivers
  :                            133 dlt_loop*	$vector		ifw_dlt_loop
  :                            134 dlt_e10mb*	$vector		ifw_dlt_e10mb
  :                            135 		$endif
  :                            136 
00:002023 3D0000              +137 	$do	40-$,	fret	0
00:002024 3D0000              +137 
00:002025 3D0000              +137 
00:002026 3D0000              +137 
00:002027 3D0000              +137 
  :                            138 
00:002028 B605FA              +139 xaccept*	$vector		tcp_xaccept
00:002029 B60897              +140 xdisco*		$vector		tcp_xdisco
00:00202A 3D0000              +141 		fret		0			. xdecline*	$vector		tcp_refuse
  :                            142 
00:00202B B60871              +143 tcpr*		$vector		tcp_rsegment		. far calls for message take from rx queue
00:00202C B60875              +144 tcpz*		$vector		tcp_zsegment		. and message drop
  :                            145 
00:00202D B6087A              +146 tcp_release_rxline* $vector	tcp_textline_release	. message drop from rx queue
  :                            147 
00:00202E B60882              +148 tcp_hash_localsocket* $vector	tcp_hashlocal
00:00202F B60880              +149 tcp_hash_connection* $vector	tcp_hash_connect
  :                            150 
00:002030 B60D8C              +151 tcp_rx*		$vector		tcp_read
00:002031 B60C11              +152 tcp_tx*		$vector		tcp_add
00:002032 B60C17              +153 tcp_addx*	$vector		tcp_add:__x		. DIY PSR stream settings, otherwise same as tcp_tx
  :                            154 
  :                            155 		$if		0
  :                            156 tcp_addbyte*	$vector		tcp_add1byte		. nothing has called this	rwsocket.msm
  :                            157 tcp_pushbytes*	$vector		tcp_pushline		. nothing has called this	rwsocket.msm
  :                            158 
  :                            159 udgram_rx*	$vector		udgram_read		. changed to an internal routine in rwsocket.msm
  :                            160 . udgram_tx*	$vector		udgram_transmit		. did nothing call this either?
  :                            161 		$endif
  :                            162 
00:002033 B603F9              +163 udgram_acw_send_nocheck* $vector udp_txaw_nocheck
00:002034 B6040A              +164 udp_rtxbuffer*	$vector		udp_response_buffer
00:002035 B60F72              +165 udp_send*	$vector		(ii	GUARD$)		. udp_tx
00:002036 B603D2              +166 udp_txbuffer*	$vector		udp_buy_txaw
00:002037 B603E0              +167 udp_acw_send*	$vector		udp_txaw
  :                            168 
  :                            169 	$do	$>64,	$flag IPV4_BANK please pack vectors
00:002038 3D0000              +170 	$do	64-$,	fret	0
00:002039 3D0000              +170 
00:00203A 3D0000              +170 
00:00203B 3D0000              +170 
00:00203C 3D0000              +170 
00:00203D 3D0000              +170 
00:00203E 3D0000              +170 
00:00203F 3D0000              +170 
  :                            171 
  :                            172 networks_start
00:002040 60207F              +173 	$base_d	NETWORK_D
00:002041 340003              +173 
00:002042 64C001              +173 
00:002043 340004              +173 
00:002044 64C001              +173 
00:002045 340005              +173 
00:002046 600F73              +173 
Note: ../t77.4/networks.msm Line 173: add 2nd $base_d argument if printf is required
Note: ../t77.4/networks.msm Line 173: space for automatic file-open frames not guaranteed add external stack argument
00:002047 75007A              +173 
00:002048 656000              +173 
00:002049 20000E              +173 
00:00204A 9F0F74              +174 	c	(seg$load)	3,,xi	(minimald.seg:d),,long
00:00204B FD0003              +174 
00:00204C FCF003              +174 
00:00204D FF0F76              +174 
00:00204E 38000F              +174 
  :                            175 
00:00204F CF0F77              +176 	dl	(0, $3("*ip":0)d)
00:002050 750049              +177 	ii	TAG$
  :                            178 
  :                            179 	$do	$TEST_WPROTECT,	lcal	test_wprotect
  :                            180 
  :                            181 	$if	1
00:002051 CF0096              +182         dl      DAYCLOCK$U		. initialise energy monitoring
00:002052 D70F79              +183         da      (ACTIVITY_SPACE:d)
(+03)0f
00:002053 C70004              +184         ds      activity_revision
  :                            185 	$endif
  :                            186 
  :                            187 NET_ADAPTING	$equ	1
  :                            188 
  :                            189 	$if	NET_ADAPTING
00:002054 3E00CD              +190 	lcal	net_buffers
  :                            191 	$else
  :                            192 	lcal	net_bank
  :                            193 	$endif
  :                            194 
00:002055 FF0F7B              +195 	call	(app_threads)
  :                            196 
00:002056 75006C              +197 	ii	CACHE_NETB$
00:002057 FF0F7C              +198 	call	(locate_interfaces)
00:002058 3E05C2              +199 	lcal	tcp4_construct_connections_bank
  :                            200 
00:002059 552185              +201 	lx	tcx_v4(1),,xi
00:00205A 750054              +202 	ii	WRITE_XVECTOR$
00:00205B 85FFFF              +203 	ax	-1,,xi			. 2nd block is at 1st block - 1
00:00205C 650000              +204 	la	0,,xi			. and isn't populated or used
00:00205D 750054              +205 	ii	WRITE_XVECTOR$
  :                            206 
00:00205E 65FFFF              +207 	la	-1,,xi			. restart the system with trace in TCB + 1024
00:00205F 750075              +208 	ii	RESTART_EI$		. if a thread of this process faults anywhere
  :                            209 
  :                            210 .	call	(app_threads)
  :                            211 
  :                            212 	$if	TCP_STATES_BEAT
00:002060 3E04ED              +213 	lcal	tcp_states_step
  :                            214 	$endif
  :                            215 
  :                            216 	$if	1
  :                            217 	$else
  :                            218 	la	2,,xi
  :                            219 	ii	$SMP
  :                            220 	$endif
  :                            221 
  :                            222 network
  :                            223 	.	push	fp	**************** no need, can even make problems
  :                            224 
00:002061 3E0075              +225 	lcal	frames
  :                            226 
  :                            227 .	$do	IPV4_OVERHAUL^=0,	lcal	icapsule
  :                            228 
  :                            229 	$if	SIGALERT
  :                            230 	la, xi	0
  :                            231 	outA	NET_ATTENTION_PORT
  :                            232 	$endif
  :                            233 
00:002062 3E0F66              +234 	lcal	xarp			. exists because it has timers
00:002063 3E011E              +235 	lcal	ipv4			. exists for timing fragments out
00:002064 3E032D              +236 	lcal	icmp			.
00:002065 3E034F              +237 	lcal	udp4			. arbitrates socket RX queues with socket owners
  :                            238 					. input to common udpq needs no arbitration
  :                            239 					. so interface buffers may be released
  :                            240 					. immediately and unconditionally
00:002066 3E04F1              +241 	lcal	xtcp4
  :                            242 
00:002067 FF0F7D              +243 	call	(app_protos)
  :                            244 
00:002068 FF0F7E              +245 	$do	1,	call	(rasm_time)
  :                            246 
  :                            247 .	$do	IPV4_OVERHAUL=0,	lcal	icapsule
00:002069 3E0F3B              +248 	lcal	icapsule
  :                            249 
  :                            250 	.	pop	fp	**************** no need, can even make problems
  :                            251 
00:00206A B60061              +252 	j	network
  :                            253 
  :                            254 network_socket
00:00206B 680004              +255 	anu	(IPPROTO_UDP*/16)
00:00206C D80F7F              +255 
00:00206D CE0073              +256 	jzb	srequest
00:00206E 680004              +257 	anu	(IPPROTO_TCP*/16)
00:00206F D80F80              +257 
00:002070 CE0073              +258 	jzb	srequest
00:002071 65FFFE              +259 	la, xi	-2
00:002072 3D0000              +260 	fret	0
  :                            261 srequest
00:002073 750050              +262 	ii	HANDLE$
00:002074 3D0000              +263 	fret	0
  :                            264 
  :                            265 
  :                            266 .	    A	    B	    6	    7
  :                            267 .	_________________________________
  :                            268 .	| socket|   0	|  address:port	|
  :                            269 .	|_______|_______|_______________|
  :                            270 
  :                            271 .	the kernel vector bank is read and
  :                            272 .	written with internal interrupts
  :                            273 
  :                            274 .		ii	READ_XVECTOR
  :                            275 .		ii	WRITE_XVECTOR
  :                            276 
  :                            277 .	because this routine is available
  :                            278 .	to threads of IP process which has
  :                            279 .	kernel vector bank, and application
  :                            280 .	processes which have their own vector
  :                            281 .	bank
  :                            282 
  :                            283 .	thos ISRs switch to the kernel
  :                            284 .	vector bank
  :                            285 
  :                            286 .		on	see$2
  :                            287 
  :                            288 .	return from any ISR restores all PSR
  :                            289 .	flags to what they were on II
  :                            290 
  :                            291 
  :                            292 	$if	0
  :                            293 
  :                            294 network_bind
  :                            295 	ds	d$save
  :                            296 	ii	READ_HANDLE$
  :                            297 	jna	network_bind_x
  :                            298 
  :                            299 	anu	(IPPROTO_UDP*/16)
  :                            300 	jzb	bind_udp
  :                            301 	anu	(IPPROTO_TCP*/16)
  :                            302 	jzb	bind_tcp
  :                            303 
  :                            304 	la, xi	-2	. protocol unknown
  :                            305 			. or socket already bound
  :                            306 			. (lower 16 bits nonzero)
  :                            307 
  :                            308 network_bind_x
  :                            309 	fret	0
  :                            310 
  :                            311 bind_udp
  :                            312 	lx, xi	usockb(1)
  :                            313 	j	protocol_bind
  :                            314 bind_tcp
  :                            315 	lx, xi	tsockb(1)
  :                            316 protocol_bind
  :                            317 	sa	d$save2
  :                            318 	la	7
  :                            319 	and	(65535)
  :                            320 	sa	8
  :                            321 	jnza	selected_bind
  :                            322         la	7
  :                            323 	or, xi	1024
  :                            324 	sa	7
  :                            325 selected_bind
  :                            326 
  :                            327 	$if	1
  :                            328 	lcal	protocol_socket
  :                            329 	$else
  :                            330 
  :                            331 	lb, xi	BSOCKET*/9
  :                            332 	dsr	9
  :                            333 	and, xi	127
  :                            334 
  :                            335 	ax	a
  :                            336 	ii	READ_XVECTOR$
  :                            337 
  :                            338 	$endif
  :                            339 
  :                            340 	rbr	12
  :                            341 	ly	b
  :                            342 
  :                            343 	jza	new_bind_bank
  :                            344 
  :                            345 	sabr	BSOCKET
  :                            346 	ii	UHANDLE$
  :                            347 	ds	10		. return also the long
  :                            348 				. virtual address of 
  :                            349 				. the port control block
  :                            350 
  :                            351 	dl	sbind:socket_address
  :                            352 	jdz	bind_clear_to_add
  :                            353 
  :                            354 	tz	8
  :                            355 	j	bind_e3
  :                            356 
  :                            357 	inc	7
  :                            358 	la	7
  :                            359 	lb	7
  :                            360 	andB,xi 2048
  :                            361 	jzb	selected_bind
  :                            362 bind_e3
  :                            363 	la, xi	-3	. port number already claimed
  :                            364 	fret	0
  :                            365 
  :                            366 new_bind_bank
  :                            367 	la, xi	4096
  :                            368 	ii	BANK$
  :                            369 	jnza	bind_bank_granted
  :                            370 
  :                            371 	la, xi	-4	. cannot resource the bind
  :                            372 	fret	0
  :                            373 
  :                            374 bind_bank_granted
  :                            375 	ds	10	. save the long virtual address
  :                            376 			. of the port control block
  :                            377 
  :                            378 	ii	WRITE_XVECTOR$
  :                            379 	sabr	BSOCKET
  :                            380 	ii	UHANDLE$
  :                            381 
  :                            382 	qpush	a
  :                            383 	dsr	48
  :                            384 	ds	6
  :                            385 
  :                            386 	lx	(BSOCKET*/12)
  :                            387 	lr, xi	512/2-1		. initialise 2 8-word
  :                            388 				. port blocks per loop
  :                            389 bind_bank_prepare
  :                            390 ?	$do	4,	qs	?*4-4, x
  :                            391 	ax, xi	16
  :                            392 	jdr	bind_bank_prepare
  :                            393 
  :                            394 	qpop	a
  :                            395 
  :                            396 bind_clear_to_add
  :                            397 	dl	6
  :                            398 	ds	sbind:socket_address
  :                            399 
  :                            400 				. TCP bind, place a
  :                            401 				. connections bank pointer
  :                            402 				. in the port socket
  :                            403 				. structure
  :                            404 
  :                            405 	la	d$save2
  :                            406 	ana	(IPPROTO_TCP*/16)
  :                            407 	jnza	bind_complete
  :                            408 
  :                            409 	lx, xi	tcx_v4(1)
  :                            410 	ii	READ_XVECTOR$
  :                            411 
  :                            412 	jza	bind_failed_cbank
  :                            413 	sa	sbind:tcp:tbase
  :                            414 	z	sbind:tcp:tbase+1
  :                            415 
  :                            416 bind_complete
  :                            417 	la, xi	0
  :                            418 	fret	0
  :                            419 
  :                            420 bind_failed_cbank
  :                            421 	z	sbind:socket_address+1
  :                            422 	la, xi	-19
  :                            423 	fret	0
  :                            424 
  :                            425 	$endif
  :                            426 
  :                            70 	$list		7
  :                            71 
  :                            72: 	$include	i_f
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 
  :                            41 . Interfaces multiplex on two circular buffers of 16-bit words
  :                            42 . one for receive and one for transmit
  :                            43 
  :                            44 . 16-bit device array words read out to RTA1 as 24 bits  with 8 high-order zeros
  :                            45 . and are written from the low-order 16 bits of RTA1 registers
  :                            46 
  :                            47 . These 16-bit buffers are in device array space and consist
  :                            48 . of an array of uniformly 1024-word (2048 octet) frame buffers 
  :                            49 
  :                            50 
  :                            51 .		_________________________________
  :                            52 .	>------>|1st receive buffer		|
  :                            53 .	|	|2nd				|
  :                            54 .	|	|				|
  :                            55 .	^
  :                            56 .	|
  :                            57 .	<-------|last receive buffer		|
  :                            58 .		|_______________________________|
  :                            59 .	>------>|1st transmit buffer		|
  :                            60 .	|	|2nd				|
  :                            61 .	|	|				|
  :                            62 .	^
  :                            63 .	|
  :                            64 .	<-------|last transmit buffer		|
  :                            65 .		|_______________________________|
  :                            66 
  :                            67 
  :                            68 . Five 16-bit words at the start of each frame buffer contain information
  :                            69 . for RTA1 on receive and for interfaces on transmit
  :                            70 
  :                            71 . The five-word preamble is
  :                            72 
  :                            73 .	_________________________________________________________________________________
  :                            74 .	| flag 8000/0000|  frame octets	|link hdr octets|interface index|protocol family|
  :                            75 .	|_______________|_______________|_______________|_______________|_______________|
  :                            76 
  :                            77 
  :                            78 . The first word flagged 8000 hex to indicated a frame completely received
  :                            79 . or a frame ready for transmission
  :                            80 
  :                            81 . The fixed preamble contains a Link Header length which is usually zero on receive
  :                            82 
  :                            83 . Link Layer headers are not usually included in received frames because
  :                            84 . no protocol layer in RTA1 extracts any information from Link Layer headers
  :                            85 . The fixed preamble contains a protocol discriminator
  :                            86 
  :                            87 . Complex protocol discriminators like SNAP header would make the inclusion of 
  :                            88 . received Link Layer headers necessary
  :                            89 
  :                            90 . Link Layer headers are always constructed by RTA1 for transmission
  :                            91 
  :                            92 
  :                            93 . Notes. Note 1
  :                            94 
  :                            95 . To avoid accidental damage, device banks (as distinct from system memory
  :                            96 . banks) may only be based by interrupt code. This avoids inadvertant
  :                            97 . traversal of array accesses across all the devices
  :                            98 
  :                            99 . At their simplest,
  :                            100 . the internal interrupts (system calls II 64+32 .. II 64+43) only need
  :                            101 . to copy the bank handle from user-A register, base it, and return:
  :                            102 
  :                            103 .		la	A
  :                            104 .		sabr	32
  :                            105 .		ir	0
  :                            106 
  :                            107 		.
  :                            108 		.
  :                            109 
  :                            110 .		la	A
  :                            111 .		sabr	63
  :                            112 .		ir	0
  :                            113 
  :                            114 . these service call ISRs discard calls which do not come from kernel iframes
  :                            115 
  :                            116 .	[ IP device_drivers file_systems loader ]
  :                            117 
  :                            118 . by using the $ringfest exclusion macro
  :                            119 
  :                            120 . credential checking can be added to these ISRs
  :                            121 
  :                            122 . Once the storage area is based, the application can access it at will.
  :                            123 
  :                            124 . The alternative would be that interrupt code itself must carry out required
  :                            125 . operations and unbase the storage area before return
  :                            126 
  :                            127 
  :                            128 . Note 2
  :                            129 
  :                            130 . the interface handler here will offer each frame to the protocol family
  :                            131 . (mostly IPv4 or similar), which must decide immediately whether to take
  :                            132 . the frame and place it in storage visible to the application.
  :                            133 
  :                            134 . This means IP will check IP correctness, and call ICMP, UDP or TCP which
  :                            135 . must checksum as necessary while copying the datagram to socket storage.
  :                            136 
  :                            137 . Datagrams are checksummed during transfer from interface buffers (device array space)
  :                            138 . to socket buffers (protocol space)
  :                            139 
  :                            140 . Some network applications which are threads of IP have zero-copy access to socket buffers
  :                            141 
  :                            142 . The socket or XDR interface will otherwise format the data when the application
  :                            143 . subsequently receives it over the socket API.
  :                            144 
  :                            145 . on return from the call to the protocol family, the interface buffer is freed
  :                            146 
  :                            147 
  :                            148 
  :                            149 RX_LL_HL $equ	d$save
  :                            150 
  :                            151 
  :                            152 
  :                            153 $(1)
  :                            154 
  :                            155 .	pointer array to the network interface descriptors
  :                            156 .	these are numbered starting from one as in MIB-II
  :                            157 .	interfaces table
  :                            158 
  :                            159 .	word zero of this table is a count of the number of
  :                            160 .	interface descriptors in use
  :                            161 
  :                            162 .	the initial value 1 indicates that there is one
  :                            163 .	interface so far, interface(1) = internal loopback,
  :                            164 .	and the next to be configured ought to be interface(2)
  :                            165 
  :                            166 .	to obtain a descriptor for a new interface, increment
  :                            167 .	the counter in the first word of the array and select
  :                            168 .	the pointer at
  :                            169 
  :                            170 .	i_f_pointer_array[i_f_pointer_array[0]]
  :                            171 
  :                            172 .	for example
  :                            173 .
  :                            174 .		lx		i_f_pointer_array
  :                            175 .		ax, xi		1
  :                            176 .		sx		i_f_pointer_array
  :                            177 .		lx		0, x
  :                            178 
  :                            179 
  :                            180 i_f_pointer_array	. who wants to go multiplying subscripts?
01:000000 000001              +181 	+	1
(+01)18
01:000001 00000A              +182 ?	$do	INTERFACES,ifxpointer(?)	+	interface(?)
(+01)18
01:000002 000050              +182 
(+01)18
01:000003 000096              +182 
(+01)18
01:000004 0000DC              +182 
(+01)18
01:000005 000122              +182 
(+01)18
01:000006 000168              +182 
(+01)18
01:000007 0001AE              +182 
(+01)18
01:000008 0001F4              +182 
  :                            183 
  :                            184 "$if0p"*	$equ	i_f_pointer_array
  :                            185 "$if2p"*	$equ	ifxpointer(2)		. 1st external interface pointer
  :                            186 						. exported for self-configuring
  :                            187 						. device drivers
  :                            188 "$ifzp"*	$equ	i_f_last		. this is the address of a variable
  :                            189 						. pointer to actual last
  :                            190 
  :                            191 INTERFACES_HIGH_INDEX*	$equ	interface(INTERFACES)
  :                            192 
  :                            193 
(+01)18
01:000009 00000A              +194 i_f_last +	interface(1)
  :                            195 
                                ?	$do	INTERFACES,interface(?)	i_f	net_address(1),16384+64,softwareLoopback,	;
                                						0, $rxtx_lo, *					;
                                												;
                                				net_address(2),2048-14-10,platform_relay,			;
                                				$initial_ift1, $rxtx_ift1, *					;
                                												;
                                				net_address(3), 1500, ethernet_relay, 0, $light_flight, *	;
                                												;
                                				net_address(4), 1500, ethernet_relay, 0, $light_flight,	*	;
                                												;
                                				net_address(5), 2048-10-14, platform_relay2,			;
01:00000A 000001              +207 				__initial_ift2, __rxtx_ift2, *
01:00000B 000001              +207 
(+01)18
01:00000C 000330              +207 
01:00000D 000018              +207 
01:00000E 004040              +207 
01:00000F 000001              +207 
01:000010 00E8D4A51000        +207 
01:000012 000000000000        +207 
01:000014 000000000000        +207 
01:000016 000000000000        +207 
01:000018 000000000000        +207 
01:00001A 000000000000        +207 
01:00001C 000000000000        +207 
01:00001E 000000000000        +207 
01:000020 000000000000        +207 
01:000022 000000000000        +207 
01:000024 000000000000        +207 
01:000026 000000000000        +207 
01:000028 000000000000        +207 
01:00002A 000000000000        +207 
01:00002C 005DC0              +207 
01:00002D 005DC0              +207 
01:00002E 000000              +207 
(+01)18
01:00002F 0005D8              +207 
01:000030 000010              +207 
01:000031 000000              +207 
01:000032 000000              +207 
01:000033 000000              +207 
01:000034 800000              +207 
01:000035 000000              +207 
01:000036 000000              +207 
01:000037 000000              +207 
01:000038 000000              +207 
01:000039 000000              +207 
01:00003A 000000              +207 
01:00003B 000000              +207 
01:00003C 000000              +207 
01:00003D 000000              +207 
01:00003E 000000              +207 
01:00003F 000000              +207 
[+0006]18
01:000040 000000              +207 
01:000041 000000              +207 
01:000042 000000              +207 
01:000043 000000              +207 
01:000044 000000              +207 
01:000045 000000              +207 
01:000046 000000              +207 
01:000047 000000              +207 
01:000048 000000              +207 
01:000049 000000              +207 
01:00004A 000000              +207 
01:00004B 000000              +207 
01:00004C 000000              +207 
01:00004D 800000              +207 
01:00004E 000000              +207 
01:00004F 820000              +207 
01:000050 000002              +207 
01:000051 000000              +207 
(+01)18
01:000052 000339              +207 
01:000053 000064              +207 
01:000054 0007E8              +207 
01:000055 000001              +207 
01:000056 00E8D4A51000        +207 
01:000058 000000000000        +207 
01:00005A 000000000000        +207 
01:00005C 000000000000        +207 
01:00005E 000000000000        +207 
01:000060 000000000000        +207 
01:000062 000000000000        +207 
01:000064 000000000000        +207 
01:000066 000000000000        +207 
01:000068 000000000000        +207 
01:00006A 000000000000        +207 
01:00006C 000000000000        +207 
01:00006E 000000000000        +207 
01:000070 000000000000        +207 
01:000072 005DC0              +207 
01:000073 005DC0              +207 
01:000074 000000              +207 
(+01)18
01:000075 0005DE              +207 
01:000076 00000E              +207 
01:000077 000000              +207 
01:000078 000000              +207 
01:000079 000000              +207 
01:00007A 800000              +207 
01:00007B 000000              +207 
01:00007C 000000              +207 
01:00007D 000000              +207 
01:00007E 000000              +207 
01:00007F 000000              +207 
01:000080 000000              +207 
01:000081 000000              +207 
01:000082 000000              +207 
01:000083 000000              +207 
01:000084 000000              +207 
[+0007]18
01:000085 000000              +207 
[+0008]18
01:000086 000000              +207 
01:000087 000000              +207 
01:000088 000000              +207 
01:000089 000000              +207 
01:00008A 000000              +207 
01:00008B 000000              +207 
01:00008C 000000              +207 
01:00008D 000000              +207 
01:00008E 000000              +207 
01:00008F 000000              +207 
01:000090 000000              +207 
01:000091 000000              +207 
01:000092 000000              +207 
01:000093 800000              +207 
01:000094 000000              +207 
01:000095 820000              +207 
01:000096 000003              +207 
01:000097 000000              +207 
(+01)18
01:000098 000342              +207 
01:000099 000006              +207 
01:00009A 0005DC              +207 
01:00009B 000001              +207 
01:00009C 00E8D4A51000        +207 
01:00009E 000000000000        +207 
01:0000A0 000000000000        +207 
01:0000A2 000000000000        +207 
01:0000A4 000000000000        +207 
01:0000A6 000000000000        +207 
01:0000A8 000000000000        +207 
01:0000AA 000000000000        +207 
01:0000AC 000000000000        +207 
01:0000AE 000000000000        +207 
01:0000B0 000000000000        +207 
01:0000B2 000000000000        +207 
01:0000B4 000000000000        +207 
01:0000B6 000000000000        +207 
01:0000B8 005DC0              +207 
01:0000B9 005DC0              +207 
01:0000BA 000000              +207 
(+01)18
01:0000BB 0005E3              +207 
01:0000BC 00000E              +207 
01:0000BD 000000              +207 
01:0000BE 000000              +207 
01:0000BF 000000              +207 
01:0000C0 800000              +207 
01:0000C1 000000              +207 
01:0000C2 000000              +207 
01:0000C3 000000              +207 
01:0000C4 000000              +207 
01:0000C5 000000              +207 
01:0000C6 000000              +207 
01:0000C7 000000              +207 
01:0000C8 000000              +207 
01:0000C9 000000              +207 
01:0000CA 000000              +207 
01:0000CB 000000              +207 
[+0009]18
01:0000CC 000000              +207 
01:0000CD 000000              +207 
01:0000CE 000000              +207 
01:0000CF 000000              +207 
01:0000D0 000000              +207 
01:0000D1 000000              +207 
01:0000D2 000000              +207 
01:0000D3 000000              +207 
01:0000D4 000000              +207 
01:0000D5 000000              +207 
01:0000D6 000000              +207 
01:0000D7 000000              +207 
01:0000D8 000000              +207 
01:0000D9 800000              +207 
01:0000DA 000000              +207 
01:0000DB 820000              +207 
01:0000DC 000004              +207 
01:0000DD 000000              +207 
(+01)18
01:0000DE 00034B              +207 
01:0000DF 000006              +207 
01:0000E0 0005DC              +207 
01:0000E1 000001              +207 
01:0000E2 00E8D4A51000        +207 
01:0000E4 000000000000        +207 
01:0000E6 000000000000        +207 
01:0000E8 000000000000        +207 
01:0000EA 000000000000        +207 
01:0000EC 000000000000        +207 
01:0000EE 000000000000        +207 
01:0000F0 000000000000        +207 
01:0000F2 000000000000        +207 
01:0000F4 000000000000        +207 
01:0000F6 000000000000        +207 
01:0000F8 000000000000        +207 
01:0000FA 000000000000        +207 
01:0000FC 000000000000        +207 
01:0000FE 005DC0              +207 
01:0000FF 005DC0              +207 
01:000100 000000              +207 
(+01)18
01:000101 0005E3              +207 
01:000102 00000E              +207 
01:000103 000000              +207 
01:000104 000000              +207 
01:000105 000000              +207 
01:000106 800000              +207 
01:000107 000000              +207 
01:000108 000000              +207 
01:000109 000000              +207 
01:00010A 000000              +207 
01:00010B 000000              +207 
01:00010C 000000              +207 
01:00010D 000000              +207 
01:00010E 000000              +207 
01:00010F 000000              +207 
01:000110 000000              +207 
01:000111 000000              +207 
[+0009]18
01:000112 000000              +207 
01:000113 000000              +207 
01:000114 000000              +207 
01:000115 000000              +207 
01:000116 000000              +207 
01:000117 000000              +207 
01:000118 000000              +207 
01:000119 000000              +207 
01:00011A 000000              +207 
01:00011B 000000              +207 
01:00011C 000000              +207 
01:00011D 000000              +207 
01:00011E 000000              +207 
01:00011F 800000              +207 
01:000120 000000              +207 
01:000121 820000              +207 
01:000122 000005              +207 
01:000123 000000              +207 
(+01)18
01:000124 000354              +207 
01:000125 000065              +207 
01:000126 0007E8              +207 
01:000127 000001              +207 
01:000128 00E8D4A51000        +207 
01:00012A 000000000000        +207 
01:00012C 000000000000        +207 
01:00012E 000000000000        +207 
01:000130 000000000000        +207 
01:000132 000000000000        +207 
01:000134 000000000000        +207 
01:000136 000000000000        +207 
01:000138 000000000000        +207 
01:00013A 000000000000        +207 
01:00013C 000000000000        +207 
01:00013E 000000000000        +207 
01:000140 000000000000        +207 
01:000142 000000000000        +207 
01:000144 005DC0              +207 
01:000145 005DC0              +207 
01:000146 000000              +207 
(+01)18
01:000147 0005E8              +207 
01:000148 00000F              +207 
01:000149 000000              +207 
01:00014A 000000              +207 
01:00014B 000000              +207 
01:00014C 800000              +207 
01:00014D 000000              +207 
01:00014E 000000              +207 
01:00014F 000000              +207 
01:000150 000000              +207 
01:000151 000000              +207 
01:000152 000000              +207 
01:000153 000000              +207 
01:000154 000000              +207 
01:000155 000000              +207 
01:000156 000000              +207 
[+000a]18
01:000157 000000              +207 
[+000b]18
01:000158 000000              +207 
01:000159 000000              +207 
01:00015A 000000              +207 
01:00015B 000000              +207 
01:00015C 000000              +207 
01:00015D 000000              +207 
01:00015E 000000              +207 
01:00015F 000000              +207 
01:000160 000000              +207 
01:000161 000000              +207 
01:000162 000000              +207 
01:000163 000000              +207 
01:000164 000000              +207 
01:000165 800000              +207 
01:000166 000000              +207 
01:000167 820000              +207 
01:000168 000006              +207 
01:000169 000000              +207 
(+01)18
01:00016A 00035D              +207 
01:00016B 000000              +207 
01:00016C 0005DC              +207 
01:00016D 000001              +207 
01:00016E 00E8D4A51000        +207 
01:000170 000000000000        +207 
01:000172 000000000000        +207 
01:000174 000000000000        +207 
01:000176 000000000000        +207 
01:000178 000000000000        +207 
01:00017A 000000000000        +207 
01:00017C 000000000000        +207 
01:00017E 000000000000        +207 
01:000180 000000000000        +207 
01:000182 000000000000        +207 
01:000184 000000000000        +207 
01:000186 000000000000        +207 
01:000188 000000000000        +207 
01:00018A 005DC0              +207 
01:00018B 005DC0              +207 
01:00018C 000000              +207 
(+01)18
01:00018D 0005ED              +207 
01:00018E 000000              +207 
01:00018F 000000              +207 
01:000190 000000              +207 
01:000191 000000              +207 
01:000192 000000              +207 
01:000193 000000              +207 
01:000194 000000              +207 
01:000195 000000              +207 
01:000196 000000              +207 
01:000197 000000              +207 
01:000198 000000              +207 
01:000199 000000              +207 
01:00019A 000000              +207 
01:00019B 000000              +207 
01:00019C 000000              +207 
01:00019D 000000              +207 
01:00019E 000000              +207 
01:00019F 000000              +207 
01:0001A0 000000              +207 
01:0001A1 000000              +207 
01:0001A2 000000              +207 
01:0001A3 000000              +207 
01:0001A4 000000              +207 
01:0001A5 000000              +207 
01:0001A6 000000              +207 
01:0001A7 000000              +207 
01:0001A8 000000              +207 
01:0001A9 000000              +207 
01:0001AA 000000              +207 
01:0001AB 800000              +207 
01:0001AC 000000              +207 
01:0001AD 820000              +207 
01:0001AE 000007              +207 
01:0001AF 000000              +207 
(+01)18
01:0001B0 000366              +207 
01:0001B1 000000              +207 
01:0001B2 0005DC              +207 
01:0001B3 000001              +207 
01:0001B4 00E8D4A51000        +207 
01:0001B6 000000000000        +207 
01:0001B8 000000000000        +207 
01:0001BA 000000000000        +207 
01:0001BC 000000000000        +207 
01:0001BE 000000000000        +207 
01:0001C0 000000000000        +207 
01:0001C2 000000000000        +207 
01:0001C4 000000000000        +207 
01:0001C6 000000000000        +207 
01:0001C8 000000000000        +207 
01:0001CA 000000000000        +207 
01:0001CC 000000000000        +207 
01:0001CE 000000000000        +207 
01:0001D0 005DC0              +207 
01:0001D1 005DC0              +207 
01:0001D2 000000              +207 
(+01)18
01:0001D3 0005ED              +207 
01:0001D4 000000              +207 
01:0001D5 000000              +207 
01:0001D6 000000              +207 
01:0001D7 000000              +207 
01:0001D8 000000              +207 
01:0001D9 000000              +207 
01:0001DA 000000              +207 
01:0001DB 000000              +207 
01:0001DC 000000              +207 
01:0001DD 000000              +207 
01:0001DE 000000              +207 
01:0001DF 000000              +207 
01:0001E0 000000              +207 
01:0001E1 000000              +207 
01:0001E2 000000              +207 
01:0001E3 000000              +207 
01:0001E4 000000              +207 
01:0001E5 000000              +207 
01:0001E6 000000              +207 
01:0001E7 000000              +207 
01:0001E8 000000              +207 
01:0001E9 000000              +207 
01:0001EA 000000              +207 
01:0001EB 000000              +207 
01:0001EC 000000              +207 
01:0001ED 000000              +207 
01:0001EE 000000              +207 
01:0001EF 000000              +207 
01:0001F0 000000              +207 
01:0001F1 800000              +207 
01:0001F2 000000              +207 
01:0001F3 820000              +207 
01:0001F4 000008              +207 
01:0001F5 000000              +207 
(+01)18
01:0001F6 00036F              +207 
01:0001F7 000000              +207 
01:0001F8 0005DC              +207 
01:0001F9 000001              +207 
01:0001FA 00E8D4A51000        +207 
01:0001FC 000000000000        +207 
01:0001FE 000000000000        +207 
01:000200 000000000000        +207 
01:000202 000000000000        +207 
01:000204 000000000000        +207 
01:000206 000000000000        +207 
01:000208 000000000000        +207 
01:00020A 000000000000        +207 
01:00020C 000000000000        +207 
01:00020E 000000000000        +207 
01:000210 000000000000        +207 
01:000212 000000000000        +207 
01:000214 000000000000        +207 
01:000216 005DC0              +207 
01:000217 005DC0              +207 
01:000218 000000              +207 
(+01)18
01:000219 0005ED              +207 
01:00021A 000000              +207 
01:00021B 000000              +207 
01:00021C 000000              +207 
01:00021D 000000              +207 
01:00021E 000000              +207 
01:00021F 000000              +207 
01:000220 000000              +207 
01:000221 000000              +207 
01:000222 000000              +207 
01:000223 000000              +207 
01:000224 000000              +207 
01:000225 000000              +207 
01:000226 000000              +207 
01:000227 000000              +207 
01:000228 000000              +207 
01:000229 000000              +207 
01:00022A 000000              +207 
01:00022B 000000              +207 
01:00022C 000000              +207 
01:00022D 000000              +207 
01:00022E 000000              +207 
01:00022F 000000              +207 
01:000230 000000              +207 
01:000231 000000              +207 
01:000232 000000              +207 
01:000233 000000              +207 
01:000234 000000              +207 
01:000235 000000              +207 
01:000236 000000              +207 
01:000237 800000              +207 
01:000238 000000              +207 
01:000239 820000              +207 
  :                            208 
  :                            209 $(66::,x)
42:000000                     +210 this_if	i_f
42:000001                     +210 
Note: ../t77.4/i_f.msm Line 210: void section: discarding relocation tuple
42:000002                     +210 
42:000003                     +210 
42:000004                     +210 
42:000005                     +210 
42:000006                     +210 
42:000008                     +210 
42:00000A                     +210 
42:00000C                     +210 
42:00000E                     +210 
42:000010                     +210 
42:000012                     +210 
42:000014                     +210 
42:000016                     +210 
42:000018                     +210 
42:00001A                     +210 
42:00001C                     +210 
42:00001E                     +210 
42:000020                     +210 
42:000022                     +210 
42:000023                     +210 
42:000024                     +210 
42:000025                     +210 
42:000026                     +210 
42:000027                     +210 
42:000028                     +210 
42:000029                     +210 
42:00002A                     +210 
42:00002B                     +210 
42:00002C                     +210 
42:00002D                     +210 
42:00002E                     +210 
42:00002F                     +210 
42:000030                     +210 
42:000031                     +210 
42:000032                     +210 
42:000033                     +210 
42:000034                     +210 
42:000035                     +210 
42:000036                     +210 
42:000037                     +210 
42:000038                     +210 
42:000039                     +210 
42:00003A                     +210 
42:00003B                     +210 
42:00003C                     +210 
42:00003D                     +210 
42:00003E                     +210 
42:00003F                     +210 
42:000040                     +210 
42:000041                     +210 
42:000042                     +210 
42:000043                     +210 
42:000044                     +210 
42:000045                     +210 
  :                            211 IF_WORDS
  :                            212 
  :                            213 $(0)
  :                            214 
  :                            215 
(+01)10
00:002075 55000A              +216 frames	lx, xi	interface(1)
00:002076 70A001              +217 test_if	tz	this_if:flags
00:002077 FFA036              +218 	call	this_if:rxtx_interface
(+01)0f
00:002078 400009              +219 	lr	i_f_last
00:002079 F6007C              +220 	jxge	i_f_leave
00:00207A 850046              +221 	ax, xi	interface(2)-interface(1)
00:00207B B60076              +222 	j	test_if
  :                            223 i_f_leave
00:00207C 350000              +224 	lret	0
  :                            225 
  :                            226 						. i_f should be x->
  :                            227 						. acw should be a->
  :                            228 q2ifoq	$if	0
  :                            229 	lb	x
  :                            230 	ab	-interface(2),,xi
  :                            231 	jzb	ok1
  :                            232 	ab	interface(3)-interface(2),,xi
  :                            233 	jzb	ok1
  :                            234 	ab	interface(4)-interface(3),,xi
  :                            235 	jzb	ok1
  :                            236 	ab	interface(5)-interface(4),,xi
  :                            237 	jzb	ok1
  :                            238 	ii	GUARD$
  :                            239 ok1
  :                            240 	$endif
  :                            241 
00:00207D 70A03C              +242 	tnz	this_if:arp_resolve
00:00207E B60080              +242 
00:00207F B60087              +243 	j	q2ifreel			. interface does not use ARP
  :                            244 
00:002080 600008              +245 	la	8				. the descriptor
  :                            246 	$if	0
  :                            247 	lb	descriptor:frame, a		. practical measure. set the delivery pointer
  :                            248 	sb	TX_FRAME			. for the target physical address
  :                            249 	$elseif	0
  :                            250 	lb	descriptor:frame, a		. diagnostic: test the delivery pointer
  :                            251 	xorB	TX_FRAME			. for the target physical address
  :                            252 	jzb	$+2
  :                            253 	ii	GUARD$
  :                            254 	$endif
  :                            255 
00:002081 FFA03C              +256 	call	this_if:arp_resolve		. interface uses ARP
00:002082 C60087              +257 	jza	q2ifreel			. dropped or pending
00:002083 600008              +258 	la	8				. descriptor
00:002084 68C001              +259 	lb	descriptor:frame, a
00:002085 30D00D              +260 	z	nframe:stack_index, b		. void stacked ip header
00:002086 350000              +261 	lret	0				. to signal not-queued
  :                            262 
00:002087 600008              +263 q2ifreel la	8				. recover the descriptor
  :                            264 q2ifree						. called from ARP a -> acw x -> i_f
  :                            265 
00:002088 70A039              +266 	tz	this_if:write_llh		. link layer header to write?
00:002089 FFA039              +267 	call	this_if:write_llh
  :                            268 
00:00208A F8A000              +269 	push	this_if:id
  :                            270 
  :                            271 	$if	1
00:00208B 70F000              +272 	tz	0, sp
00:00208C 78F000              +273 	tp	0, sp
00:00208D 75005F              +274 	ii	GUARD$
  :                            275 	$endif
  :                            276 
00:00208E 38C002              +277 	pop	descriptor:i_f, a
  :                            278 
  :                            279 	$if	HVSOCKET
00:00208F 480F81              +280 	lk	(63*/18:s)
00:002090 AF0F82              +281 	mta	(BSOCKET*/18:s)
00:002091 B6009A              +282 	j	q2ifoq1
  :                            283 
00:002092 68C004              +284 	lb	descriptor:dgram, a
00:002093 68D000              +285 	lb	dgram:vers_ihl_tos, b
00:002094 AD0004              +286 	andB	4,,xi
00:002095 CE0098              +287 	jzb	q2ifoq_low
00:002096 FF0F83              +288 	call	(write_ifqlist_head)
00:002097 350000              +289 	lret	0	
  :                            290 
  :                            291 q2ifoq_low
00:002098 FF0F84              +292 	call	(write_ifqlist)
  :                            293 
00:002099 350000              +294 	lret	0
  :                            295 	$endif
  :                            296 
  :                            297 q2ifoq1
  :                            298 	$if	1
00:00209A 680011              +299 	lb	MTU
00:00209B D8000B              +300 	anb	11
  :                            301 
00:00209C 7E00A3              +302 	jc	q2if_unit_datagram
  :                            303 
00:00209D F80002              +304 	c	(jumboq2)	a	x
00:00209E F80004              +304 
00:00209F FCF002              +304 
00:0020A0 FF0F85              +304 
00:0020A1 38000F              +304 
00:0020A2 350000              +305 	lret	0
  :                            306 	$endif
  :                            307 
  :                            308 q2if_unit_datagram
00:0020A3 FF0F86              +309 	call	(write_ifq)
  :                            310 						. FREE	this_if:lock_cell_q1
00:0020A4 350000              +311 q2ifreex lret	0
  :                            312 
  :                            313 frame2p		. vector name is frame_to_protocol
00:0020A5 3E00A7              +314 	lcal	frame2proto
00:0020A6 3D0000              +315 	fret	0
  :                            316 
  :                            317 frame2proto
00:0020A7 68A000              +318 	lb	this_if:id
00:0020A8 28000A              +319 	sb	I_F_IDX
00:0020A9 100008              +320 	sx	I_F_P
  :                            321 
00:0020AA C5F800              +322 	aa	-IP,,xi			. the most requiring speed
00:0020AB C60165              +323 	jza	ipv4_rx
00:0020AC C5FFFA              +324 	aa	IP-ARP,,xi
00:0020AD C60F6F              +325 	jza	arp_rx
00:0020AE C59E9D              +326 	aa	ARP-IFCONFIG,,xi	. the least requiring speed
00:0020AF C600B7              +327 	jza	call_ifconfig
00:0020B0 C50202              +328 	aa	IFCONFIG-ROUTE_CONFIG,,xi
00:0020B1 C600B9              +329 	jza	call_route_config
  :                            330 
  :                            331 	$if	0		. anu is a 2-instruction macro so a bit slower
  :                            332 	anu, xi	IP
  :                            333 	jzb	ipv4_rx		.  ipv4_rx does lret back into frame2p
  :                            334 	anu, xi	ARP
  :                            335 	jzb	arp_rx		.   arp_rx does lret back into frame2p
  :                            336 
  :                            337 	anu, xi	IFCONFIG
  :                            338         jzb	call_ifconfig	. call_ifconfig does lret back into frame2p
  :                            339 	anu, xi	ROUTE_CONFIG
  :                            340 	jzb	call_route_config . call_route_config does lret back into frame2p
  :                            341 	$endif
  :                            342 
00:0020B2 FD0001              +343 	MIB_ICOUNT48	this_if:inoproto
00:0020B3 2FA021              +343 
00:0020B4 5E00B6              +343 
00:0020B5 17A020              +343 
00:0020B6 350000              +344 	lret	0
  :                            345 
  :                            346 call_ifconfig
00:0020B7 FF0F87              +347 	call	(__ifconfig)
00:0020B8 350000              +348 	lret	0
  :                            349 
  :                            350 call_route_config
00:0020B9 FF0F88              +351 	call	(__route_config)
00:0020BA 350000              +352 	lret	0
  :                            353 
  :                            354 	$if	0	. moved to ../drivers/queue.msm
  :                            355 
  :                            356 if_rq1		. vector name is if_readq1
  :                            357 	LOCK	this_if:lock_cell_q1
  :                            358 	ly, i	this_if:oq
  :                            359 	lcal	readqif
  :                            360 	FREE	this_if:lock_cell_q1
  :                            361 	fret	0
  :                            362 
  :                            363 	$endif
  :                            364 
  :                            365 if_initpool			. vector name far_initpool
00:0020BB 3E0E0A              +366 	lcal	init_pool	. called from other iframes wanting
00:0020BC 3D0000              +367 	fret	0		. a message buffer initialised
  :                            368 
  :                            369 
  :                            370 ifsellmsg	. vector name is if_sell1
00:0020BD 3E0E49              +371 	lcal	sell1
00:0020BE 3D0000              +372 	fret	0
  :                            373 
00:0020BF 3E0E20              +374 ifbuy	lcal	buy1	. vector name is if_buy
00:0020C0 3D0000              +375 	fret	0
  :                            376 
00:0020C1 3E0EA1              +377 ifrq	lcal	readq	. vector name is far_readq
00:0020C2 3D0000              +378 	fret	0
  :                            379 
00:0020C3 3E0E96              +380 ifq2	lcal	q2	. vector name is far_q2
00:0020C4 3D0000              +381 	fret	0
  :                            382 
  :                            383 ifq2ifree	. vector name is if_q2ifree
00:0020C5 3E0088              +384 	lcal	q2ifree
00:0020C6 3D0000              +385 	fret	0
  :                            386 
  :                            387 
  :                            388 iftx_nocheck	. vector name is if_tx_nocheck
00:0020C7 3E0469              +389 	lcal	tx_nocheck
00:0020C8 3D0000              +390 	fret	0
  :                            391 
  :                            73 
  :                            74 	$if		DRIVERS_BANK1=0
  :                            75 	$include	irelay
  :                            76 	$include	xrelay
  :                            77 	$endif
  :                            78 
  :                            79: 	$include	net_bank
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 	$if	NET_ADAPTING=0
  :                            41 
  :                            42 	$do	RX_BANKS<NET_BANKS/2,	$exit NET_BANKS too few and TX_BANKS too many
  :                            43 
  :                            44 base_netpage* $proc
  :                            45 	sabr	NET_BASE+?-1
  :                            46 	aa, xi	1
  :                            47 	$end
  :                            48 
  :                            49 base_netbank* $proc
  :                            50 	sabr	NET_BASE+?-1
  :                            51 	aa, xi	64
  :                            52 	$end
  :                            53 
  :                            54 
  :                            55 $(0)
  :                            56 net_bank
  :                            57 	inA	device$flags
  :                            58 	aa, xi	1
  :                            59 	anu	(SCALE_THRESHOLD)
  :                            60 
  :                            61 	jc	large_netbank
  :                            62 
  :                            63 small_netbank
  :                            64 	la	(4096*NET_BANKS)
  :                            65 	ii	BANK$
  :                            66 	jza	emergency_netbank
  :                            67 
  :                            68 	lx	(NET_BASE*/12)
  :                            69 .	sx	rx_buffers
  :                            70 
  :                            71 ?	$do	NET_BANKS,	base_netpage
  :                            72 
  :                            73 	la	(4096*RX_BANKS)
  :                            74 	lcal	init_pool
  :                            75 
  :                            76 	lx	(NET_BASE+RX_BANKS*/12)
  :                            77 .	sx	tx_buffers
  :                            78 	la	(4096*TX_BANKS)
  :                            79 	lcal	init_pool
  :                            80 
  :                            81 	lret	0
  :                            82 
  :                            83 large_netbank
  :                            84 	la	(262144*NET_BANKS)
  :                            85 	ii	BANK$
  :                            86 	jza	small_netbank
  :                            87 
  :                            88 	lx	(NET_BASE*/18:s)
  :                            89 .	sx	rx_buffers
  :                            90 
  :                            91 ?	$do	NET_BANKS,	base_netbank
  :                            92 
  :                            93 	la	(262144*RX_BANKS)
  :                            94 	lcal	init_pool
  :                            95 
  :                            96 	lx	(NET_BASE+RX_BANKS*/18:s)
  :                            97 .	sx	tx_buffers
  :                            98 	la	(262144*TX_BANKS)
  :                            99 	lcal	init_pool
  :                            100 
  :                            101 	lret	0
  :                            102 
  :                            103 emergency_netbank
  :                            104 
  :                            105 	.	can we get 16K then?
  :                            106 
  :                            107 	la, xi	4096*4
  :                            108 	ii	BANK$
  :                            109 	jza	minimal_emergency_netbank
  :                            110 
  :                            111 	lx	(NET_BASE*/12:s)
  :                            112 .	sx	rx_buffers
  :                            113 
  :                            114 ?	$do	3,	base_netpage
  :                            115 	sabr	NET_BASE+RX_BANKS	. keep 60*/18 as a reliable
  :                            116 					. pointer to transmission buffers
  :                            117 	la, xi	3*4096
  :                            118 	lcal	init_pool
  :                            119 
  :                            120 	lx	(NET_BASE+RX_BANKS*/12)
  :                            121 .	sx	tx_buffers
  :                            122 
  :                            123 	la, xi	4096
  :                            124 	lcal	init_pool
  :                            125 	lret	0
  :                            126 
  :                            127 
  :                            128 minimal_emergency_netbank
  :                            129 
  :                            130 	.	can we get 8K then?
  :                            131 
  :                            132 	la, xi	4096*2
  :                            133 	ii	BANK$
  :                            134 	jza	nowhere_to_go_netbank
  :                            135 
  :                            136 	lx	(NET_BASE*/12:s)
  :                            137 .	sx	rx_buffers
  :                            138 
  :                            139 	base_netpage
  :                            140 	sabr	NET_BASE+RX_BANKS
  :                            141 
  :                            142 	la, xi	4096
  :                            143 	lcal	init_pool
  :                            144 
  :                            145 	lx	(NET_BASE+RX_BANKS*/12)
  :                            146 .	sx	tx_buffers
  :                            147 
  :                            148 	la, xi	4096
  :                            149 	lcal	init_pool
  :                            150 	lret	0
  :                            151 
  :                            152 
  :                            153 nowhere_to_go_netbank
  :                            154 
  :                            155 .	if we couldn't get 8K for network buffers
  :                            156 .	then we won't start any new tasks either
  :                            157 
  :                            158 .	we should maybe set an LED pattern
  :                            159 .	and exit the IP process
  :                            160 
  :                            161 .	otherwise
  :                            162 .	we could program a flash to say it's always full
  :                            163 .	and no buffer is ever available in it
  :                            164 
  :                            165 	lret	0
  :                            166 
  :                            167 	$endif		.	not NET_ADAPTING
  :                            168 
  :                            169 net_free
00:0020C9 502180              +170 	lx	rx_buffers
00:0020CA B60E49              +171 	j	sell1
  :                            172 
  :                            173 net_free_txb
00:0020CB 502181              +174 	lx	tx_buffers
00:0020CC B60E49              +175 	j	sell1
  :                            176 
  :                            177 	$if	RX_FRAGMENTS
  :                            178 net_transfer
  :                            179 .	from q is y
  :                            180 .	to q is a
  :                            181 .	strictly from head of fromq
  :                            182 .	to tail of 2q
  :                            183 
  :                            184 	push	a
  :                            185 
  :                            186 net_transfer1
  :                            187 	lcal	readq
  :                            188 	jza	net_transferx
  :                            189 	lb	descriptor:dgram, a
  :                            190 	push	dgram:flags_fragment, b
  :                            191 	push	y
  :                            192 	ly	2, sp
  :                            193 	lcal	q2
  :                            194 	pop	y
  :                            195 	pop	a
  :                            196 	and, xi	IP_MORE
  :                            197 	jnza	net_transfer1
  :                            198 
  :                            199 net_transferx
  :                            200 	pop	a
  :                            201 	lret	0
  :                            202 
  :                            203 
  :                            204 net_drop
  :                            205 .	from queue is	y
  :                            206 
  :                            207 	push	x
  :                            208 
  :                            209 net_drop1
  :                            210 	lcal	readq
  :                            211 	jza	net_dropx
  :                            212 	lb	descriptor:dgram, a
  :                            213 	push	dgram:flags_fragment, b
  :                            214 	push	y
  :                            215 	lcal	net_free
  :                            216 	pop	y
  :                            217 	pop	a
  :                            218 	and,xi	IP_MORE
  :                            219 	jnza	net_drop1
  :                            220 net_dropx
  :                            221 	pop	x
  :                            222 	lret	0
  :                            223 
  :                            224 	$elseif	0	.	RX_FRAGMENTS
  :                            225 
  :                            226 net_transfer
  :                            227 	push	a
  :                            228 	lcal	readq
  :                            229 	jza	net_transferx
  :                            230 	push	y
  :                            231 	ly	1, sp
  :                            232 	lcal	q2
  :                            233 	pop	y
  :                            234 net_transferx
  :                            235 	pop	a
  :                            236 	lret	0
  :                            237 
  :                            238 net_drop
  :                            239 	push	x
  :                            240 	lcal	readq
  :                            241 	jza	net_dropx
  :                            242 	push	y
  :                            243 	lcal	net_free
  :                            244 	pop	y
  :                            245 net_dropx
  :                            246 	pop	x
  :                            247 	lret	0
  :                            248 
  :                            249 net_free_txdatagram
  :                            250 	dpush	x
  :                            251 	lcal	readq
  :                            252 	jza	net_free_txdatagramx
  :                            253 	lcal	net_free_txb
  :                            254 net_free_txdatagramx
  :                            255 
  :                            256 	dpop	x
  :                            257 	lret	0
  :                            258 
  :                            259 	$endif		.	not RX_FRAGMENTS
  :                            260 
  :                            261 	$if	0
  :                            262 net_pass_xcall
  :                            263 	lcal	net_transfer
  :                            264 	fret	0
  :                            265 	$endif
  :                            266 
  :                            267 
  :                            80: 	$include	net_buff
  :                            1 .	acquire storage for initial socket buffers
  :                            2 .	one quarter of executable space
  :                            3 .	maximum 16 address windows
  :                            4 
  :                            5 
  :                            6 NET_BUFFER_THRESHOLD	$equ	2*64
  :                            7 
  :                            8 net_buffers
00:0020CD 750048              +9 	ii	TOTAL$FREE	. total words all free banks
00:0020CE 16000D              +10 	dsr	12+1		. translate to half of free pages
00:0020CF 400005              +11 	lr	b
  :                            12 
00:0020D0 040080              +13 	inA	128		. index highest page in memory
00:0020D1 A00F89              +14 	and	(03FFFFF)
00:0020D2 C50004              +15 	aa, xi	1+3		. # pages + rounding
00:0020D3 060002              +16 	sar	2		. calculate a quarter
  :                            17 
00:0020D4 D80004              +18 	anb	a		
00:0020D5 7E00D7              +19 	jc	net_request_allowable
00:0020D6 600000              +20 	la	r		. change the initial request
  :                            21 				. to half the remaining available
  :                            22 net_request_allowable
  :                            23 
00:0020D7 680000              +24 	lb	r		. are < 1.5 banks free?
00:0020D8 CDFFD0              +25 	ab, xi	-96/2		. if so this request should be 0.25 banks
  :                            26 
00:0020D9 C5FFE0              +27 	aa, xi	-NET_BUFFER_THRESHOLD/4	. 2 banks or less ?
00:0020DA EE00DC              +28 	jnb	net_buffer_pages
00:0020DB 7E00ED              +29 	jc	net_buffer_banks
  :                            30 
  :                            31 .	acquisition will be in pages up to 64Kwords
  :                            32 
  :                            33 net_buffer_pages
00:0020DC C5001F              +34 	aa, xi	NET_BUFFER_THRESHOLD/4-1
00:0020DD A5000F              +35 	and, xi	15
00:0020DE 400004              +36 	lr	a
00:0020DF C50001              +37 	aa, xi	1
00:0020E0 26000C              +38 	sal	12
  :                            39 
  :                            40 net_buffer_request_pages
00:0020E1 3E0114              +41 	lcal	net_buffer_requestP
00:0020E2 D600E4              +42 	jnza	net_buffer_base_pages
00:0020E3 750046              +43 	ii	EXIT$
  :                            44 
  :                            45 net_buffer_base_pages
  :                            46 
00:0020E4 F80005              +47 	push	b
00:0020E5 6D0030              +48 	lb	48,,xi
  :                            49 
  :                            50 net_buffer_page
00:0020E6 34D000              +51 	sabr	0, b
00:0020E7 CD0001              +52 	ab, xi	1
00:0020E8 C50001              +53 	aa, xi	1
00:0020E9 1E00E6              +54 	jdr	net_buffer_page
  :                            55 
00:0020EA 380005              +56 	pop	b
00:0020EB 500F8A              +57 	lx	(NET_BASE*/12)
  :                            58 
00:0020EC B60100              +59 	j	netpool_initial
  :                            60 
  :                            61 .	acquisition will be in banks up to 4 MWords
  :                            62 	
  :                            63 net_buffer_banks
00:0020ED C5001F              +64 	aa, xi	NET_BUFFER_THRESHOLD/4-1
00:0020EE A503C0              +65 	and, xi	15*/6
00:0020EF 680004              +66 	lb	a
00:0020F0 0E0006              +67 	sbr	6
00:0020F1 400005              +68 	lr	b
00:0020F2 C50040              +69 	aa, xi	64
00:0020F3 26000C              +70 	sal	12
  :                            71 
00:0020F4 3E0112              +72 	lcal	net_buffer_requestB
00:0020F5 D600F8              +73 	jnza	net_buffer_base_banks
  :                            74 
00:0020F6 600F8B              +75 	la	(16*4096)			. did not get banks
00:0020F7 B600E1              +76 	j	net_buffer_request_pages	. ask for less
  :                            77 
  :                            78 net_buffer_base_banks
00:0020F8 F80005              +79 	push	b
  :                            80 
00:0020F9 6D0030              +81 	lb, xi	48
  :                            82 net_buffer_bank
00:0020FA 34D000              +83 	sabr	0, b
00:0020FB CD0001              +84 	ab, xi	1
00:0020FC C50040              +85 	aa, xi	64
00:0020FD 1E00FA              +86 	jdr	net_buffer_bank
  :                            87 
00:0020FE 380005              +88 	pop	b
00:0020FF 500F8C              +89 	lx	(NET_BASE*/18:s)
  :                            90 
  :                            91 netpool_initial
00:002100 600005              +92 	la	b			. size of granted memory request
  :                            93 
  :                            94 	$if	NETSERVER_INTENSIVE$	. expecting more transmission than reception
00:002101 0E0001              +95 	sbr	1			. calculate one half for txbuffers
  :                            96 	$else
  :                            97 	sbr	2			. calculate one quarter for txbuffers
  :                            98 	$endif
  :                            99 
00:002102 D00005              +100 	ana	b			. calculate three quarters for rxbuffers
  :                            101 
00:002103 8F0002              +102 	qpush	x
00:002104 600002              +103 	la	x			. rx_buffers address
  :                            104 
00:002105 552180              +105 	lx	rx_buffers,,xi		. destination in vectors
00:002106 750054              +106 	ii	WRITE_XVECTOR$
00:002107 C0F002              +107 	aa	2, sp			. + size of rx buffers
00:002108 552181              +108 	lx	tx_buffers,,xi		. = tx_buffers address
00:002109 750054              +109 	ii	WRITE_XVECTOR$
  :                            110 
00:00210A 60F002              +111 	la	2, sp			. rxbuffers size
00:00210B 50F000              +112 	lx	0, sp			. = rx_buffers pointer in vectors
00:00210C 3E0E0A              +113 	lcal	init_pool		. initialise rxbuffers
00:00210D 502181              +114 	lx	tx_buffers
00:00210E 60F003              +115 	la	3, sp			. retrieve txbuffers size
00:00210F 3E0E0A              +116 	lcal	init_pool
  :                            117 
00:002110 870002              +118 	qpop	x
  :                            119 
00:002111 350000              +120 	lret	0
  :                            121 
  :                            122 					. this request is made before others
  :                            123 					. except the area containing instructions plus
  :                            124 					. static data / TCB / B1 frames / vector bank
  :                            125 					. which may make a quarter too much to ask
  :                            126 net_buffer_requestB
00:002112 480F81              +127 	lk	(-262144)
00:002113 B60115              +128 	j	net_buffer_request
  :                            129 
  :                            130 net_buffer_requestP
00:002114 4DF000              +131 	lk	-4096,,xi
  :                            132 
  :                            133 net_buffer_request
00:002115 F80004              +134 	push	a
00:002116 750043              +135 	ii	BANK$
00:002117 380005              +136 	pop	b
00:002118 D6011D              +137 	jnza	net_buffer_acquired	. really needs very few net buffers
00:002119 0E0001              +138 	sbr	1			. so reduce request drastically
00:00211A 600005              +139 	la	b			. so applications can have memory
00:00211B AF0F8D              +140 	mta	(0)
00:00211C B60115              +141 	j	net_buffer_request
  :                            142 
  :                            143 net_buffer_acquired			. or not
00:00211D 350000              +144 	lret	0
  :                            145 
  :                            81: 	$include	ipv4
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40: 	$include	k.def
  :                            1 ONE_TIME_SAVE1	$equ	x$save1
  :                            2 __SOCHECK	$equ	1
  :                            3 
  :                            41 
  :                            42 . HEADER_LONGWORDS $equ	d$save	. 16 used in receive			. moved to ../t77.4/pointers.def
  :                            43 . TP_HEADER	$equ	d$save1	. 17 used in receive and transmit	. moved to ../t77.4/pointers.def
  :                            44 
  :                            45 I_F_IDX		$equ	10	.   used in receive
  :                            46 UPROTOCOL_BYTES	$equ	11	.   used in receive
  :                            47 
  :                            48 I_F_P		$equ	8	. used in receive
  :                            49 FLAGS_FRAGMENT	$equ	8	. used in receive
  :                            50 
  :                            51 . TX_AXW		$equ	8	. used in transmit
  :                            52 . TX_FRAME	$equ	9	. used in receive and transmit
  :                            53 
  :                            54 HEADER_BYTES	$equ	d$save	. 16 used in transmit
  :                            55 . MTU		$equ	d$save1	. 17 used in transmit
  :                            56 I_F		$equ	d$save2	. 19 used in transmit
  :                            57 
  :                            58 TX_FLAG_OFFSET	$equ	10	. used in tranmsit
  :                            59 . TX_DATAGRAML	$equ	11	. used in transmit = unfragmented datagram
  :                            60 				. generated in interfaces = xmitted frame
  :                            61 
  :                            62 DYNAMIC_IP_HEADER $equ	0
  :                            63 		. if IP header length cannot be known at socket layer
  :                            64 		. then make this a multiple of 4 > 20 and < 64
  :                            65 		. to give a fixed large space for IP to add header
  :                            66 		. options
  :                            67 
  :                            68 		. otherwise IP header size is fixed when the socket
  :                            69 		. layer acquires a buffer
  :                            70 
  :                            71 $(71::,sp)
47:000000                     +72 dgram	datagram
47:000001                     +72 
47:000002                     +72 
47:000003                     +72 
47:000004                     +72 
47:000005                     +72 
47:000006                     +72 
47:000008                     +72 
  :                            73 
  :                            74 $(70::,fp)
  :                            75 descriptor acw
  :                            76 
  :                            77 $(66::,x)
42:000000                     +78 ifaddr  netv4
42:000001                     +78 
42:000002                     +78 
42:000003                     +78 
42:000005                     +78 
42:000007                     +78 
  :                            79 
  :                            80 $(66::, x)
42:000000                     +81 ro	route
42:000001                     +81 
42:000002                     +81 
42:000003                     +81 
42:000005                     +81 
42:000007                     +81 
42:000009                     +81 
  :                            82 
  :                            83 $(66::, x)
  :                            84 nframe	netframe
  :                            85 
  :                            86 $(1)
  :                            87 
  :                            88 
  :                            89: 	$include	routes
(+01)18
01:00023A 000265              +1 route_list*	+	route_(5)	. search chain head, RTA1 <-> emulator platform point2point
(+01)18
01:00023B 000279              +2 route_free*	+	route_(7)	. available storage new routes chain head
(+01)18
01:00023C 00023D              +3 route_lexical*	+	route_(1)	. MIB-II display order chain head
  :                            4 
  :                            5 .			dest	   	mask		gateway		i_f[:indirect]	  next_search	next_lexical
  :                            6 .			____		____		_______		______________	  ___________	____________
  :                            7 
01:00023D 000000              +8 route_(1)	route	0.0.0.0		0.0.0.0         192.168.0.254	IFGW:RELAY_ROUTE  0		route_(2)
(+01)18
01:00023E 000247              +8 
01:00023F 800004              +8 
01:000240 000000000000        +8 
01:000242 000000000000        +8 
01:000244 00C0A80000FE        +8 
01:000246 000000              +8 
(+01)18
01:000247 00023D              +9 route_(2)	route	127.0.0.0	255.0.0.0       127.0.0.1  	1    		  route_(1)	route_(3)
(+01)18
01:000248 000251              +9 
01:000249 000001              +9 
01:00024A 007F00000000        +9 
01:00024C 00FF00000000        +9 
01:00024E 007F00000001        +9 
01:000250 000008              +9 
(+01)18
01:000251 00025B              +10 route_(3)	route	169.254.0.0	255.255.0.0	169.254.0.0	ANYNET		  route_(4)	route_(4)
(+01)18
01:000252 00025B              +10 
01:000253 000000              +10 
01:000254 00A9FE000000        +10 
01:000256 00FFFF000000        +10 
01:000258 00A9FE000000        +10 
01:00025A 000010              +10 
(+01)18
01:00025B 000247              +11 route_(4)	route	172.16.0.0	255.240.0.0	172.29.7.66 	IFGW 		  route_(2)	route_(5)
(+01)18
01:00025C 000265              +11 
01:00025D 000004              +11 
01:00025E 00AC10000000        +11 
01:000260 00FFF0000000        +11 
01:000262 00AC1D000742        +11 
01:000264 00000C              +11 
(+01)18
01:000265 00026F              +12 route_(5)	route	172.29.7.0	255.255.255.192	172.29.7.8	3    		  route_(6)	route_(6)
(+01)18
01:000266 00026F              +12 
01:000267 000003              +12 
01:000268 00AC1D000700        +12 
01:00026A 00FFFF00FFC0        +12 
01:00026C 00AC1D000708        +12 
01:00026E 00001A              +12 
  :                            13 . route_(6)	route	172.29.7.6	255.255.255.255	172.29.7.7	2    		  route_(5)	route_(7)
(+01)18
01:00026F 000251              +14 route_(6)	route	192.168.0.0	255.255.0.0	172.29.7.8	IFGW 		  route_(3)
01:000270 000000              +14 
01:000271 000004              +14 
01:000272 00C0A8000000        +14 
01:000274 00FFFF000000        +14 
01:000276 00AC1D000708        +14 
01:000278 000010              +14 
  :                            15 
  :                            16 
                                ?	$do	ROUTES-6,;
(+01)18
01:000279 000283              +18 route_(?+6)	route	0.0.0.0   0.0.0.0   0.0.0.0   0   route_(?+7)
01:00027A 000000              +18 
01:00027B 000000              +18 
01:00027C 000000000000        +18 
01:00027E 000000000000        +18 
01:000280 000000000000        +18 
01:000282 000000              +18 
(+01)18
01:000283 00028D              +18 
01:000284 000000              +18 
01:000285 000000              +18 
01:000286 000000000000        +18 
01:000288 000000000000        +18 
01:00028A 000000000000        +18 
01:00028C 000000              +18 
(+01)18
01:00028D 000297              +18 
01:00028E 000000              +18 
01:00028F 000000              +18 
01:000290 000000000000        +18 
01:000292 000000000000        +18 
01:000294 000000000000        +18 
01:000296 000000              +18 
(+01)18
01:000297 0002A1              +18 
01:000298 000000              +18 
01:000299 000000              +18 
01:00029A 000000000000        +18 
01:00029C 000000000000        +18 
01:00029E 000000000000        +18 
01:0002A0 000000              +18 
(+01)18
01:0002A1 0002AB              +18 
01:0002A2 000000              +18 
01:0002A3 000000              +18 
01:0002A4 000000000000        +18 
01:0002A6 000000000000        +18 
01:0002A8 000000000000        +18 
01:0002AA 000000              +18 
(+01)18
01:0002AB 0002B5              +18 
01:0002AC 000000              +18 
01:0002AD 000000              +18 
01:0002AE 000000000000        +18 
01:0002B0 000000000000        +18 
01:0002B2 000000000000        +18 
01:0002B4 000000              +18 
(+01)18
01:0002B5 0002BF              +18 
01:0002B6 000000              +18 
01:0002B7 000000              +18 
01:0002B8 000000000000        +18 
01:0002BA 000000000000        +18 
01:0002BC 000000000000        +18 
01:0002BE 000000              +18 
(+01)18
01:0002BF 0002C9              +18 
01:0002C0 000000              +18 
01:0002C1 000000              +18 
01:0002C2 000000000000        +18 
01:0002C4 000000000000        +18 
01:0002C6 000000000000        +18 
01:0002C8 000000              +18 
(+01)18
01:0002C9 0002D3              +18 
01:0002CA 000000              +18 
01:0002CB 000000              +18 
01:0002CC 000000000000        +18 
01:0002CE 000000000000        +18 
01:0002D0 000000000000        +18 
01:0002D2 000000              +18 
(+01)18
01:0002D3 0002DD              +18 
01:0002D4 000000              +18 
01:0002D5 000000              +18 
01:0002D6 000000000000        +18 
01:0002D8 000000000000        +18 
01:0002DA 000000000000        +18 
01:0002DC 000000              +18 
(+01)18
01:0002DD 0002E7              +18 
01:0002DE 000000              +18 
01:0002DF 000000              +18 
01:0002E0 000000000000        +18 
01:0002E2 000000000000        +18 
01:0002E4 000000000000        +18 
01:0002E6 000000              +18 
(+01)18
01:0002E7 0002F1              +18 
01:0002E8 000000              +18 
01:0002E9 000000              +18 
01:0002EA 000000000000        +18 
01:0002EC 000000000000        +18 
01:0002EE 000000000000        +18 
01:0002F0 000000              +18 
(+01)18
01:0002F1 0002FB              +18 
01:0002F2 000000              +18 
01:0002F3 000000              +18 
01:0002F4 000000000000        +18 
01:0002F6 000000000000        +18 
01:0002F8 000000000000        +18 
01:0002FA 000000              +18 
(+01)18
01:0002FB 000305              +18 
01:0002FC 000000              +18 
01:0002FD 000000              +18 
01:0002FE 000000000000        +18 
01:000300 000000000000        +18 
01:000302 000000000000        +18 
01:000304 000000              +18 
(+01)18
01:000305 00030F              +18 
01:000306 000000              +18 
01:000307 000000              +18 
01:000308 000000000000        +18 
01:00030A 000000000000        +18 
01:00030C 000000000000        +18 
01:00030E 000000              +18 
(+01)18
01:00030F 000319              +18 
01:000310 000000              +18 
01:000311 000000              +18 
01:000312 000000000000        +18 
01:000314 000000000000        +18 
01:000316 000000000000        +18 
01:000318 000000              +18 
(+01)18
01:000319 000323              +18 
01:00031A 000000              +18 
01:00031B 000000              +18 
01:00031C 000000000000        +18 
01:00031E 000000000000        +18 
01:000320 000000000000        +18 
01:000322 000000              +18 
01:000323 000000              +18 
01:000324 000000              +18 
01:000325 000000              +18 
01:000326 000000000000        +18 
01:000328 000000000000        +18 
01:00032A 000000000000        +18 
01:00032C 000000              +18 
  :                            19 
  :                            90: 	$include	netaddr
  :                            1 
01:00032D 000000              +2 net_alock*	0
(+01)18
01:00032E 000330              +3 net_alexical* +	net_address(1)
(+01)18
01:00032F 000378              +4 net_afree* +	net_address(INTERFACES+1)
01:000330 000000              +5 net_address(1)	netv4	127.0.0.1  255.0.0.0     127.255.255.255 1 0 net_address(2)	. next is zero and lexical is linked
(+01)18
01:000331 000339              +5 
01:000332 000001              +5 
01:000333 007F00000001        +5 
01:000335 00FF00000000        +5 
01:000337 007FFF00FFFF        +5 
  :                            6 
  :                            7 . net_address(2)	netv4	172.29.7.7 255.255.255.255 172.29.15.255 2 0 net_address(3)
  :                            8 
                                ?	$do	INTERFACES-1,;
01:000339 000000              +10 net_address(?+1) netv4	0.0.0.0	0.0.0.0	0.0.0.0	?+2					. next is zero and lexical is zero
01:00033A 000000              +10 
01:00033B 000003              +10 
01:00033C 000000000000        +10 
01:00033E 000000000000        +10 
01:000340 000000000000        +10 
01:000342 000000              +10 
01:000343 000000              +10 
01:000344 000004              +10 
01:000345 000000000000        +10 
01:000347 000000000000        +10 
01:000349 000000000000        +10 
01:00034B 000000              +10 
01:00034C 000000              +10 
01:00034D 000005              +10 
01:00034E 000000000000        +10 
01:000350 000000000000        +10 
01:000352 000000000000        +10 
01:000354 000000              +10 
01:000355 000000              +10 
01:000356 000006              +10 
01:000357 000000000000        +10 
01:000359 000000000000        +10 
01:00035B 000000000000        +10 
01:00035D 000000              +10 
01:00035E 000000              +10 
01:00035F 000007              +10 
01:000360 000000000000        +10 
01:000362 000000000000        +10 
01:000364 000000000000        +10 
01:000366 000000              +10 
01:000367 000000              +10 
01:000368 000008              +10 
01:000369 000000000000        +10 
01:00036B 000000000000        +10 
01:00036D 000000000000        +10 
01:00036F 000000              +10 
01:000370 000000              +10 
01:000371 000009              +10 
01:000372 000000000000        +10 
01:000374 000000000000        +10 
01:000376 000000000000        +10 
  :                            11 
                                ?	$do	NET_ADDRESSES-INTERFACES,;
(+01)18
01:000378 000381              +13 net_address(?+INTERFACES)	netv4	0.0.0.0 0.0.0.0 0.0.0.0	0 net_address(?+INTERFACES+1)
01:000379 000000              +13 
01:00037A 000000              +13 
01:00037B 000000000000        +13 
01:00037D 000000000000        +13 
01:00037F 000000000000        +13 
(+01)18
01:000381 00038A              +13 
01:000382 000000              +13 
01:000383 000000              +13 
01:000384 000000000000        +13 
01:000386 000000000000        +13 
01:000388 000000000000        +13 
(+01)18
01:00038A 000393              +13 
01:00038B 000000              +13 
01:00038C 000000              +13 
01:00038D 000000000000        +13 
01:00038F 000000000000        +13 
01:000391 000000000000        +13 
(+01)18
01:000393 00039C              +13 
01:000394 000000              +13 
01:000395 000000              +13 
01:000396 000000000000        +13 
01:000398 000000000000        +13 
01:00039A 000000000000        +13 
(+01)18
01:00039C 0003A5              +13 
01:00039D 000000              +13 
01:00039E 000000              +13 
01:00039F 000000000000        +13 
01:0003A1 000000000000        +13 
01:0003A3 000000000000        +13 
(+01)18
01:0003A5 0003AE              +13 
01:0003A6 000000              +13 
01:0003A7 000000              +13 
01:0003A8 000000000000        +13 
01:0003AA 000000000000        +13 
01:0003AC 000000000000        +13 
(+01)18
01:0003AE 0003B7              +13 
01:0003AF 000000              +13 
01:0003B0 000000              +13 
01:0003B1 000000000000        +13 
01:0003B3 000000000000        +13 
01:0003B5 000000000000        +13 
(+01)18
01:0003B7 0003C0              +13 
01:0003B8 000000              +13 
01:0003B9 000000              +13 
01:0003BA 000000000000        +13 
01:0003BC 000000000000        +13 
01:0003BE 000000000000        +13 
(+01)18
01:0003C0 0003C9              +13 
01:0003C1 000000              +13 
01:0003C2 000000              +13 
01:0003C3 000000000000        +13 
01:0003C5 000000000000        +13 
01:0003C7 000000000000        +13 
(+01)18
01:0003C9 0003D2              +13 
01:0003CA 000000              +13 
01:0003CB 000000              +13 
01:0003CC 000000000000        +13 
01:0003CE 000000000000        +13 
01:0003D0 000000000000        +13 
(+01)18
01:0003D2 0003DB              +13 
01:0003D3 000000              +13 
01:0003D4 000000              +13 
01:0003D5 000000000000        +13 
01:0003D7 000000000000        +13 
01:0003D9 000000000000        +13 
(+01)18
01:0003DB 0003E4              +13 
01:0003DC 000000              +13 
01:0003DD 000000              +13 
01:0003DE 000000000000        +13 
01:0003E0 000000000000        +13 
01:0003E2 000000000000        +13 
(+01)18
01:0003E4 0003ED              +13 
01:0003E5 000000              +13 
01:0003E6 000000              +13 
01:0003E7 000000000000        +13 
01:0003E9 000000000000        +13 
01:0003EB 000000000000        +13 
(+01)18
01:0003ED 0003F6              +13 
01:0003EE 000000              +13 
01:0003EF 000000              +13 
01:0003F0 000000000000        +13 
01:0003F2 000000000000        +13 
01:0003F4 000000000000        +13 
(+01)18
01:0003F6 0003FF              +13 
01:0003F7 000000              +13 
01:0003F8 000000              +13 
01:0003F9 000000000000        +13 
01:0003FB 000000000000        +13 
01:0003FD 000000000000        +13 
01:0003FF 000000              +13 
01:000400 000000              +13 
01:000401 000000              +13 
01:000402 000000000000        +13 
01:000404 000000000000        +13 
01:000406 000000000000        +13 
  :                            14 											. next is linked free chain
  :                            15 											. lexical is zero
  :                            91 
  :                            92 $(0)
  :                            93 
  :                            94 ipv4
  :                            95 	$if	IPV4_FRAGMENTED_DGRAMS
  :                            96 	lcal	ipv4_fragment:timeouts
  :                            97 	$endif
  :                            98 
00:00211E 350000              +99 	lret	0
  :                            100 
  :                            101 construct_xdgram
  :                            102 			. id is obtained
  :                            103 			. the datagram is as first+final
  :                            104 			. i.e without regard to the MTU
  :                            105 			. and it might later get fragmented
  :                            106 			. on transmission and / or get
  :                            107 			. IP header options modified
  :                            108 
  :                            109 			. so it is not checksummed here
  :                            110 
  :                            111 			. in the case of dual-ported
  :                            112 			. buffer interfaces, checksum
  :                            113 			. happens as the IP headers
  :                            114 			. are transferred from interface
  :                            115 			. queues to device buffers
  :                            116 
  :                            117 			. the descriptor is in X
  :                            118 			. and the datagram is in Y
  :                            119 
(+01)0f
00:00211F CF050E              +120 	dl	ipOutRequests:i
00:002120 D70F79              +121 	da	(1:d)
(+01)0f
00:002121 C7050E              +122 	ds	ipOutRequests:i
00:002122 A80F8E              +123 	andB	(00FFFF)
00:002123 28B002              +124 	sb	dgram:id, y
00:002124 68B000              +125 	lb	dgram:vers_ihl_tos, y
00:002125 0E0006              +126 	sbr	8-2
00:002126 AD003C              +127 	andB,xi	15*/2
00:002127 280010              +128 	sb	HEADER_BYTES
00:002128 C8A003              +129 	ab	descriptor:bytes, x
00:002129 60B003              +130 	la	dgram:flags_fragment, y
00:00212A A54000              +131 	and, xi	IP_DNF
00:00212B 20B003              +132 	sa	dgram:flags_fragment, y
00:00212C 30B005              +133 	z	dgram:checksum, y
00:00212D 350000              +134 	lret	0
  :                            135 
  :                            136 .	vector name is __iproute
  :                            137 .	target address is in 6:7
  :                            138 .	return is a route at x->
  :                            139 
  :                            140 
  :                            141 .	vector name
  :                            142 
  :                            143 ip_route_advance		. the target network address is in 6:7
  :                            144 
  :                            145 				. this is called if udp sendto does not
  :                            146 				. have a from-address available, which
  :                            147 				. would prevent checksum
00:00212E 3E0130              +148 	lcal	ip_route
  :                            149 				. the from-address is the default local
  :                            150 				. address of the interface of the route
00:00212F 3D0000              +151 	fret	0
  :                            152 
  :                            153 
  :                            154 ip_route
(+01)0f
00:002130 50023A              +155 	lx	route_list
  :                            156 ip_next_route
00:002131 CFA005              +157 	dl	ro:mask
00:002132 A00006              +158 	and	6
00:002133 A80007              +159 	andB	7
00:002134 DFA003              +160 	dan	ro:net
00:002135 7C013A              +161 	jdz	ip_route_x
00:002136 50A000              +162 	lx	ro:next
00:002137 700002              +163 	tz	x
00:002138 B60131              +164 	j	ip_next_route
(+01)10
00:002139 550323              +165 	lx, xi	route_(ROUTES)	. this should not happen
  :                            166 ip_route_x
00:00213A 350000              +167 	lret	0
  :                            168 
  :                            169 .	ip_send is a far call (ipsend) to allow a raw socket interface
  :                            170 
  :                            171 
  :                            172 ip_send				. destination is already in 6:7
  :                            173 
  :                            174 				. temporary change to IP task B1
  :                            175 				. goes here
  :                            176 
00:00213B 652073              +177 	la, xi	VECTOR_B1(1)
00:00213C 750057              +178 	ii	KERNEL$B1
  :                            179 				. call before return B1$ takes B1
  :                            180 				. from caller's vector bank
  :                            181 				. so if you nest calls that both
  :                            182 				. change to a service B1
  :                            183 				. you may have to repeat KERNEL$B1
  :                            184 				. but you are not likely to do this
  :                            185 
00:00213D 3E011F              +186 	lcal	construct_xdgram
  :                            187 
  :                            188 ip$sendx*
00:00213E 180013              +189 	sy	TX_DATAGRAM
00:00213F 100008              +190 	sx	8		. the descriptor
00:002140 A80F89              +191 	andB	(03FFFFF)	. reassembled datagram length
  :                            192 				. i.e first IP header + payload
  :                            193 
  :                            194 				. a contains DNF flag or not
  :                            195 
00:002141 C7000A              +196 	ds	10		. IP_DNF:datagramreassembledlength
  :                            197 
00:002142 3E0130              +198 	lcal	ip_route
  :                            199 				. on the emulated machine routing picks
  :                            200 				. an emulated interface
  :                            201 				. but does not really choose the
  :                            202 				. the next hop. It is always as if
  :                            203 				. the route were direct
  :                            204 
00:002143 40A002              +205 	lr	ro:i_f
  :                            206 
00:002144 CF0006              +207 	dl	6		. direct route = next_hop is destination
00:002145 780000              +208 	tp	r
00:002146 CFA007              +209 	dl	ro:next_hop	. indirect route = gateway from route table
  :                            210 
  :                            211 
  :                            212 
00:002147 580008              +213 	ly	8		. the descriptor
00:002148 50B001              +214 	lx	descriptor:frame, y
  :                            215 				. route table not now visible
  :                            216 
00:002149 C7A00E              +217 	ds	nframe:next_hop, x	. that's used later
  :                            218 				. when we need to do ARP
  :                            219 				. network address of next hop
  :                            220 
00:00214A 100009              +221 	sx	TX_FRAME
  :                            222 
00:00214B 600000              +223 	la	r		. the interface #
00:00214C D60153              +224 	jnza	ip_homed_route
00:00214D 580013              +225 	ly	TX_DATAGRAM
00:00214E CFB006              +226 	dl	dgram:ipsource, y
00:00214F 3E0226              +227 	lcal	ip_source_ifidx	. the route is not homed
  :                            228 				. ifidx must be obtained from ip source address
00:002150 D60153              +229 	jnza	ip_homed_route
00:002151 6DFFBF              +230 	lb, xi	-NO_PATH	. that didn't work either. Count or bad result in b
00:002152 B60163              +231 	j	ip_send_x	. should maybe think about
  :                            232 				. freeing output buffers on send fail
  :                            233 				. when not TCP
  :                            234 ip_homed_route
  :                            235 
00:002153 A57FFF              +236 	and, xi	32767
(+01)10
00:002154 C50000              +237 	aa, xi	i_f_pointer_array
  :                            238 
00:002155 50C000              +239 	lx	0, a		. the interface pointer address
00:002156 100012              +240 	sx	I_F
  :                            241 
  :                            242 	$if	1		. do source fragmentation in advance
  :                            243 				. at datagram acquisition
00:002157 CF000A              +244 	dl	10		. DNF flag, length
00:002158 F8A004              +245 	push	this_if:mtu
00:002159 380011              +246 	pop	MTU
00:00215A C6015F              +247 	jza	ip_send_now
  :                            248 
00:00215B 600011              +249 	la	MTU
00:00215C D00005              +250 	ana	b
  :                            251 
00:00215D 600008              +252 	la	8		. the descriptor
00:00215E 7E0160              +253 	jc	ip_send_now1
  :                            254 
  :                            255 .	lcal	net_free_txbx	. leave it to source fragmentation
  :                            256 .	lb, xi	-OVERSIZE
  :                            257 .	j	ip_send_x
  :                            258 
  :                            259 	$endif
  :                            260 
  :                            261 ip_send_now
00:00215F 600008              +262 	la	8		. the descriptor
  :                            263 ip_send_now1
  :                            264 
00:002160 F8000B              +265 	push	11
00:002161 3E0295              +266 	lcal	ipq_write
  :                            267 
00:002162 380005              +268 	pop	b
  :                            269 
  :                            270 ip_send_x
  :                            271 				. call before return B1$ takes B1
  :                            272 				. from caller's vector bank
  :                            273 				. so if you nest calls that both
  :                            274 				. change to a service B1
  :                            275 				. you may have to repeat KERNEL$B1
  :                            276 				. but you are not likely to do this
  :                            277 
  :                            278 
00:002163 750058              +279 	ii	B1$		. if the caller is a protocol in this task,
00:002164 3D0000              +280 	fret	0		. the IP task, it's the same B1
  :                            281 				. otherwise it isn't
  :                            282 
  :                            283 
  :                            284 .	ipv4_rx, input driver for a system with fixed dual ported
  :                            285 .	interface buffers
  :                            286 
  :                            287 .	this is an upward call from routine frames
  :                            288 
  :                            289 .	copying to socket-visible buffers is combined with
  :                            290 .	checksumming
  :                            291 
  :                            292 .	each word in the interface buffers is read only once
  :                            293 
  :                            294 .	ipv4_rx pushes and checks the IP headers in the
  :                            295 .	internal stack, which is a register array
  :                            296 
  :                            297 .	upper protocols obtain a buffer, then pop the IP headers
  :                            298 .	into it ahead of their own protocol message for
  :                            299 .	checksumming during transfer
  :                            300 
  :                            301 
  :                            302 . ONE_TIME_SAVE1	$equ	x$save1
  :                            303 
  :                            304 ipv4_rx
  :                            305 	$if	1
00:002165 750076              +306 	ii	ONETIME_SAVE$
  :                            307 	$else
  :                            308 	lx	sp	
  :                            309 	sx	ONE_TIME_SAVE1
  :                            310 	$endif
  :                            311 
00:002166 FD0001              +312 	MIB_ICOUNT48	ipInReceives:i
(+01)0f
00:002167 2F0501              +312 
00:002168 5E016A              +312 
(+01)0f
00:002169 170500              +312 
  :                            313 	
  :                            314 	$if	IPV4_OVERHAUL
  :                            315 
00:00216A 6500A0              +316 	la	IPV4_OVERHAUL,,xi
00:00216B D00000              +317 	ana	r		. calculate internal stack load # words
  :                            318 
00:00216C 5E016F              +319 	jnc	dgram_load(IPV4_OVERHAUL/8)
00:00216D 060003              +320 	sar	3		. # blocks of 8 octets rounded up
00:00216E B6C16F              +321 	j	dgram_load(IPV4_OVERHAUL/8), a
  :                            322 
                                ?	$do	IPV4_OVERHAUL/8,dgram_load(IPV4_OVERHAUL/8-?+1)	;
00:00216F 8FB04C              +324 	qpush	IPV4_OVERHAUL/2-4*?, y
00:002170 8FB048              +324 
00:002171 8FB044              +324 
00:002172 8FB040              +324 
00:002173 8FB03C              +324 
00:002174 8FB038              +324 
00:002175 8FB034              +324 
00:002176 8FB030              +324 
00:002177 8FB02C              +324 
00:002178 8FB028              +324 
00:002179 8FB024              +324 
00:00217A 8FB020              +324 
00:00217B 8FB01C              +324 
00:00217C 8FB018              +324 
00:00217D 8FB014              +324 
00:00217E 8FB010              +324 
00:00217F 8FB00C              +324 
00:002180 8FB008              +324 
00:002181 8FB004              +324 
00:002182 8FB000              +324 
  :                            325 
00:002183 600000              +326 	la	r		. frame large enough for datagram?
00:002184 D0F001              +327 	ana	dgram:bytes
00:002185 5E01E1              +328 	jnc	ipv4_rxz
  :                            329 
00:002186 60F000              +330 	la	dgram:vers_ihl_tos
00:002187 16000C              +331 	dsr	12
00:002188 C5FFFC              +332 	aa	-4,,xi		. is the header IPv4?
00:002189 D601E1              +333 	jnza	ipv4_rxz	. otherwise forget it
  :                            334 
00:00218A 0E0014              +335 	sbr	20
00:00218B 280010              +336 	sb	HEADER_LONGWORDS
00:00218C CDFFFB              +337 	ab	-5,,xi		. does it have >= minimal IP header?
00:00218D 5E01E1              +338 	jnc	ipv4_rxz	. not much use otherwise
  :                            339 
00:00218E 680010              +340 	lb	HEADER_LONGWORDS
00:00218F 2E0001              +341 	sbl	1
  :                            342 
00:002190 C8000F              +343 	ab	sp
00:002191 280011              +344 	sb	TP_HEADER
  :                            345 
00:002192 6D000F              +346 	lb	15,,xi		 . maximum IP header words
00:002193 D80010              +347 	anb	HEADER_LONGWORDS . scratch registers are jerst wonderful
00:002194 500005              +348 	lx	b
  :                            349 
00:002195 48F005              +350 	lk	dgram:checksum
00:002196 30F005              +351 	z	dgram:checksum
00:002197 CFF000              +352 	dl	dgram:vers_ihl_tos	. addend the first
  :                            353 
00:002198 B6A199              +354 	j	ipv4_qcheckin(15-1), x
  :                            355 
                                ?	$do	15-1,;
00:002199 D7F01C              +357 ipv4_qcheckin(15-?)	da	dgram:vers_ihl_tos+15*2-?*2	. add 2 words[28..2]
00:00219A D7F01A              +357 
00:00219B D7F018              +357 
00:00219C D7F016              +357 
00:00219D D7F014              +357 
00:00219E D7F012              +357 
00:00219F D7F010              +357 
00:0021A0 D7F00E              +357 
00:0021A1 D7F00C              +357 
00:0021A2 D7F00A              +357 
00:0021A3 D7F008              +357 
00:0021A4 D7F006              +357 
00:0021A5 D7F004              +357 
00:0021A6 D7F002              +357 
  :                            358 
00:0021A7 3E026E              +359 	lcal	check_complete
  :                            360 
00:0021A8 B80001              +361 	xorB	k		. is it the same?
00:0021A9 DE01E1              +362 	jnzb	ipv4_rxz
  :                            363 
00:0021AA 08F005              +364 	sk	dgram:checksum	. put the checksum back
  :                            365 				. in case ICMP fires it all back with a DU
  :                            366 
  :                            367 
00:0021AB CFF008              +368 	dl	dgram:ipdest
00:0021AC 500008              +369 	lx	I_F_P		. interface structure pointer
00:0021AD 3E0204              +370 	lcal	ipv4_forus?
00:0021AE B601B7              +371 	j	ipv4_yesforus
(+01)0f
00:0021AF 7004FE              +372 	tz	ipForwarding:i
00:0021B0 3E0221              +373 	lcal	ipv4_forward	. don't come back from that
00:0021B1 B601B7              +374 	j	ipv4_yesforus	. unless forwarding to local host
  :                            375 
00:0021B2 FD0001              +376 	MIB_ICOUNT48	ipInAddrErrors:i
(+01)0f
00:0021B3 2F0505              +376 
00:0021B4 5E01B6              +376 
(+01)0f
00:0021B5 170504              +376 
00:0021B6 B601E1              +377 	j	ipv4_rxz
  :                            378 
  :                            379 ipv4_yesforus
  :                            380 
  :                            381 	$if	0
  :                            382 	la	dgram:flags_fragment
  :                            383 	and	IP_MORE++IP_OFFSET_MASK,,xi
  :                            384 
  :                            385 	$if	IPV4_FRAGMENTED_DGRAMS
  :                            386 	jnza	ipv4_fragment
  :                            387 	$else
  :                            388 	jnza	ipv4_rxz
  :                            389 	$endif
  :                            390 	$endif
  :                            391 
  :                            392 . ipv4_rxbuffer_rq
  :                            393 
00:0021B7 68F001              +394 	lb	dgram:bytes
00:0021B8 600010              +395 	la	HEADER_LONGWORDS
00:0021B9 260002              +396 	sal	2
00:0021BA D80004              +397 	anb	a		. upper protocol byte count
  :                            398 
00:0021BB 60F004              +399 	la	dgram:ttl_protocol
00:0021BC A500FF              +400 	and	255,,xi		. checksum seed for upper protocol
00:0021BD C70006              +401 	ds	6		. protocol:segment size for checksum in 6:7
  :                            402 
00:0021BE 28000B              +403 	sb	UPROTOCOL_BYTES
00:0021BF 60F001              +404 	la	dgram:bytes
00:0021C0 D500A0              +405 	ana	IPV4_OVERHAUL,,xi		.
00:0021C1 7E01CE              +406 	jc	ipv4_uprotocol_checksum_addresses
  :                            407 
  :                            408 ipv4_round_stack_word		. turn off non-counted octets
00:0021C2 650000              +409 	la	0,,xi		. IP payload octet count is in b
00:0021C3 560002              +410 	drr	2		. now longword count is in b
00:0021C4 2E0001              +411 	sbl	1		. 2 * longwords - 1 = words - 2
00:0021C5 060016              +412 	sar	22		. and octet remainder in a
00:0021C6 C601CE              +413 	jza	ipv4_count_check . don't look outside the last longword of dgram
  :                            414 
00:0021C7 500011              +415 	lx	TP_HEADER
00:0021C8 800005              +416 	ax	b
00:0021C9 40CF8F              +417 	lr	(0, 32, 16, 8q), a
00:0021CA CFA000              +418 	dl	0, x
00:0021CB 168000              +419 	dsr	*r		. turn off some octets
00:0021CC 368000              +420 	dsl	*r		. in the last longword in the checksum
00:0021CD C7A000              +421 	ds	0, x
  :                            422 	
  :                            423 ipv4_count_check
  :                            424 
  :                            425 . ipv4_uprotocol_checksum		. checksum all that is in the internal stack
  :                            426 ipv4_uprotocol_checksum_addresses
00:0021CE CF0006              +427 	dl	6		. payload protocol : octet count
00:0021CF D7F006              +428 	da	dgram:ipsource
00:0021D0 D7F008              +429 	da	dgram:ipdest
  :                            430 
  :                            431 . ipv4_checksum_udata_next
  :                            432 
00:0021D1 C70006              +433 	ds	6		. there may be more in the interface buffer
  :                            434 
  :                            435 ipv4_uproto_rx
00:0021D2 60F004              +436 	la	dgram:ttl_protocol
00:0021D3 A500FF              +437 	and	255,,xi
00:0021D4 500011              +438 	lx	TP_HEADER
  :                            439 
00:0021D5 3E0F4D              +440 	lcal	preport
  :                            441 
00:0021D6 C5FFEF              +442 	aa	-IPPROTO_UDP,,xi
00:0021D7 C60363              +443 	jza	udp_rxq
00:0021D8 C5000B              +444 	aa	IPPROTO_UDP-IPPROTO_TCP,,xi
00:0021D9 C60688              +445 	jza	tcp_rxq
00:0021DA C50005              +446 	aa	IPPROTO_TCP-IPPROTO_ICMP,,xi
00:0021DB C602E9              +447 	jza	icmp_rxq
  :                            448 
00:0021DC B6034D              +449 	j	icmp_noproto
  :                            450 
  :                            451 	$else			. IPV4_OVERHAUL 
  :                            452 
  :                            453 	$endif		. not IPV4_OVERHAUL
  :                            454 
  :                            455 ipv4_drop			. only jump here if a dgram > 160 bytes
00:0021DD 60000E              +456 	la	fp		. has been buffered and is then wrong
00:0021DE 502180              +457 	lx	rx_buffers	. for example checksum fail
00:0021DF 700002              +458 	tz	x		. nothing gets socket-buffered if not addressed
00:0021E0 3E0E49              +459 	lcal	sell1		. to an upper protocol port which is bound
  :                            460 
  :                            461 	. when UDP / TCP / ICMP, see decisions above, want a datagram,
  :                            462 	. they take it from circular network buffers
  :                            463 	. to descriptor-controlled socket buffers
  :                            464 	. between locations: ipv4_uproto_rx ... ipv4_rxz
  :                            465 
  :                            466 . if a an upper protocol does not finish its RX scan  here
  :                            467 . if must restore sp in the same way as this
  :                            468 
  :                            469 ipv4_rxz*
00:0021E1 500091              +470 	lx	ONE_TIME_SAVE1	. in interrupt register which this code
00:0021E2 10000F              +471 	sx	sp		. cannot write by accident but can read
00:0021E3 350000              +472 	lret	0
  :                            473 
  :                            474 ip_buy_datagram
00:0021E4 502181              +475 	lx	tx_buffers
  :                            476 ip_buy_datagram_alternate	. buying in a private bank (large volume TCP)
00:0021E5 F80005              +477 	push	b
00:0021E6 0E0007              +478 	sbr	7	. version / header L / TOS word
00:0021E7 AD001E              +479 	andB,xi	30	. number of words in header
00:0021E8 400005              +480 	lr	b	. length of IP header in words
00:0021E9 C50021              +481 	aa, xi	ROUTING_HEADER*2+1	. routing buffer + rounding
00:0021EA 060001              +482 	sar	1	. number of words in IP payload
  :                            483 			. + routing header
00:0021EB C00005              +484 	aa	b	. number of words in buffer
  :                            485 
  :                            486 .	lx	tx_buffers
  :                            487 
00:0021EC 3E0E20              +488 	lcal	buy1
00:0021ED 380005              +489 	pop	b
00:0021EE C60203              +490 	jza	ip_no_txbuffer
  :                            491 
00:0021EF 50C001              +492 	lx	descriptor:frame, a
00:0021F0 30A000              +493 	z	0, x	. routing buffer
00:0021F1 30A001              +494 	z	1, x
00:0021F2 30A002              +495 	z	2, x	. default destination
  :                            496 
00:0021F3 FD0800              +497 	push,xi IP
00:0021F4 38A006              +498 	pop	nframe:llh:generic:protocol
  :                            499 
00:0021F5 30A00D              +500 	z	nframe:stack_index
  :                            501 
00:0021F6 850010              +502 	ax, xi	ROUTING_HEADER
00:0021F7 10C004              +503 	sx	descriptor:dgram, a
00:0021F8 100013              +504 	sx	TX_DATAGRAM
00:0021F9 28A000              +505 	sb	dgram:vers_ihl_tos, x
00:0021FA 30A003              +506 	z	dgram:flags_fragment, x
00:0021FB 30A006              +507 	z	dgram:ipsource, x
00:0021FC 30A007              +508 	z	dgram:ipsource+1, x
00:0021FD 30A008              +509 	z	dgram:ipdest, x
00:0021FE 30A009              +510 	z	dgram:ipdest+1, x
  :                            511 
00:0021FF 30C002              +512 	z	descriptor:i_f, a
  :                            513 
00:002200 800000              +514 	ax	r	. length of IP header in words
00:002201 10C005              +515 	sx	descriptor:uproto, a
00:002202 100011              +516 	sx	TP_HEADER
  :                            517 ip_no_txbuffer
00:002203 350000              +518 	lret	0
  :                            519 
  :                            520 	$if	0
  :                            521 net_free_txbx
  :                            522 	lk	(63*/18:s)
  :                            523 	lx	(A$TXBUFFB*/18:s)
  :                            524 	mta	x
  :                            525 	j	net_free_txb
  :                            526 	j	sell1
  :                            527 	$endif
  :                            528 
  :                            529 ipv4_forus?
00:002204 3E020B              +530 	lcal	ipv4_address_this_if?
00:002205 350000              +531 	lret	0	. yes for us
(+01)0f
00:002206 7004FE              +532 	tz	ipForwarding:i
00:002207 3E0215              +533 	lcal	ipv4_address_this_host?
00:002208 350001              +534 	lret	1	. not for us
00:002209 350000              +535 	lret	0	. yes for is
  :                            536 		
  :                            537 
  :                            538 ipv4_forus!
00:00220A 350000              +539 	lret	0	. = yesforus
  :                            540 			. ipForwarding and an address
  :                            541 			. on our interfaces? 
  :                            542 			. also queue it inward
  :                            543 
  :                            544 ipv4_address_this_if?
00:00220B C70006              +545 	ds	6
00:00220C 50A002              +546 	lx	this_if:address_list
  :                            547 ipv4_address_test
  :                            548 
  :                            549 	$if	0
  :                            550 	la	ifaddr:i_f
  :                            551 	aa, xi	-1
  :                            552 	jza	ipv4_next	. not an external i/f
  :                            553 	$endif
  :                            554 
00:00220D CFA003              +555 	dl	ifaddr:net
00:00220E DF0006              +556 	dan	6
00:00220F 7C0214              +557 	jdz	ipv4_address_hit
  :                            558 ipv4_next
00:002210 50A000              +559 	lx	ifaddr:next
00:002211 700002              +560 	tz	x
00:002212 B6020D              +561 	j	ipv4_address_test
00:002213 350001              +562 	lret	1	. not for us
  :                            563 ipv4_address_hit
00:002214 350000              +564 	lret	0	. yes for us
  :                            565 
  :                            566 ipv4_address_this_host?
(+01)0f
00:002215 50032E              +567 	lx	net_alexical
  :                            568 ipv4_test_in_list
00:002216 60A002              +569 	la	ifaddr:i_f
00:002217 C5FFFF              +570 	aa, xi	-1
00:002218 C6021C              +571 	jza	ipv4_nex	. not an external i/f
00:002219 CFA003              +572 	dl	ifaddr:net
00:00221A DF0006              +573 	dan	6
00:00221B 7C0220              +574 	jdz	ipv4_list_hit
  :                            575 ipv4_nex
00:00221C 50A001              +576 	lx	ifaddr:lexical
00:00221D 700002              +577 	tz	x
00:00221E B60216              +578 	j	ipv4_test_in_list
00:00221F 350000              +579 	lret	0	. not for us
  :                            580 ipv4_list_hit
00:002220 350001              +581 	lret	1	. yes for us
  :                            582 	
  :                            583 
  :                            584 
  :                            585 ipv4_forward		. unpacked destination is in 6:7
  :                            586 
00:002221 3E0130              +587 	lcal	ip_route
00:002222 CFA007              +588 	dl	ro:next_hop
00:002223 7C0225              +589 	jdz	ipv4_zforward	. special case
  :                            590 	
  :                            591 
  :                            592 			. we only get here if it's not
  :                            593 			. an address anywhere on this host
  :                            594 			. and ipForwarding is on
  :                            595 
  :                            596                         . first route the destination
  :                            597                         . don't route anything out 
  :                            598                         . on the interface it came in
  :                            599                         . that behaviour is loopy
  :                            600 
  :                            601 			. also do not forward stuff
  :                            602 			. to your own loopback address
  :                            603 			. or any alias which it has
  :                            604 
  :                            605 			. fine we haven't assigned it
  :                            606 			. to input space
  :                            607 
  :                            608 			. assign it to output space
  :                            609 			. instead
  :                            610 
  :                            611 .	la	dgram:bytes
  :                            612 .	aa, xi	1	. # octets to # octet pairs
  :                            613 .	sar	1
  :                            614 .	lx	tx_buffers
  :                            615 .	lcal	buy1
  :                            616 .	jza	ipv4_xforward
  :                            617 
  :                            618 ipv4_xforward		. abandon the dgram
00:002224 350001              +619 	lret	1
  :                            620 
  :                            621 ipv4_zforward		. special case
00:002225 350000              +622 	lret	0	. local destination is any address in subnet
  :                            623 			. accept on interface of arrival
  :                            624 
  :                            625 ip_source_ifidx
00:002226 9F0004              +626 	dpush	a
(+01)0f
00:002227 60032E              +627 	la	net_alexical		. this chain may be lexically ordered
  :                            628 ip_source_next				. anyway it contains all of them
00:002228 C60230              +629 	jza	ip_source_no
00:002229 580004              +630 	ly	a
00:00222A CFF000              +631 	dl	0, sp
00:00222B DFB003              +632 	dan	ifaddr:net, y
00:00222C 7C022F              +633 	jdz	ip_source_yes
00:00222D 60B001              +634 	la	ifaddr:lexical, y
00:00222E B60228              +635 	j	ip_source_next
  :                            636 ip_source_yes
00:00222F 60B002              +637 	la	ifaddr:i_f, y
  :                            638 ip_source_no
00:002230 20F000              +639 	sa	0, sp
00:002231 380004              +640 	dpop	a
00:002232 380005              +640 
00:002233 350000              +641 	lret	0
  :                            642 
  :                            643 
  :                            644 .	vector name ipv4_4us?
  :                            645 
  :                            646 ipv44us?
00:002234 3E0204              +647 	lcal	ipv4_forus?
00:002235 3D0000              +648 	fret	0
00:002236 3D0001              +649 	fret	1
  :                            650 
  :                            651 .	vector name ipv4_this_if?
  :                            652 
  :                            653 ipv4thisif?
00:002237 3E020B              +654 	lcal	ipv4_address_this_if?
00:002238 3D0000              +655 	fret	0
00:002239 3D0001              +656 	fret	1
  :                            657 
  :                            658 .	vector_name ipv4_this_host?
  :                            659 
  :                            660 ipv4thishost?
00:00223A 3E0215              +661 	lcal	ipv4_address_this_host?
00:00223B 3D0000              +662 	fret	0
00:00223C 3D0001              +663 	fret	1
  :                            82: 	$include	overhaul
  :                            1 
  :                            2 	$if	IPV4_OVERHAUL
  :                            3 
  :                            4 .	start IP payload checksum, call from TCP / UDP / ICMP
  :                            5 .	add the 2-word blocks in the internal stack
  :                            6 .	except for the IP header
  :                            7 
  :                            8 check_part1			. call for a large datagram
00:00223D 6DFFFB              +9 	lb	-5,,xi		. with maximum byte quads in stack
00:00223E B60242              +10 	j	check_part1_go	. interface buffer still contains the rest
  :                            11 
  :                            12 				. call for a short datagram <= IPV4_OVERHAUL bytes 
  :                            13 check_part1s			. a contains # datagram bytes all in stack
00:00223F 6D008C              +14 	lb	IPV4_OVERHAUL-4*5,,xi . maximum loaded - minimum IP header
00:002240 D80004              +15 	anb	a
00:002241 8E0002              +16 	sba	2		. IPV4_OVERHAUL/4 - 5 - byte quads present
  :                            17 
  :                            18 check_part1_go
00:002242 C80010              +19 	ab	HEADER_LONGWORDS . 5 or more already checked
00:002243 F80003              +20 	push	y
00:002244 580005              +21 	ly	b
00:002245 CF0006              +22 	dl	6		. contains seed: addresses + protocol + length
  :                            23 				. for ICMP contains 0
  :                            24 
00:002246 500011              +25 	lx	TP_HEADER	. pointer to IP payload
  :                            26 
00:002247 B6B248              +27 	j	check_updword(IPV4_OVERHAUL/4), y
  :                            28 
                                ?	$do	IPV4_OVERHAUL/4-5,;
00:002248 D7A044              +30 check_updword(IPV4_OVERHAUL/4-?+1)	da	IPV4_OVERHAUL/2-10-?*2, x
00:002249 D7A042              +30 
00:00224A D7A040              +30 
00:00224B D7A03E              +30 
00:00224C D7A03C              +30 
00:00224D D7A03A              +30 
00:00224E D7A038              +30 
00:00224F D7A036              +30 
00:002250 D7A034              +30 
00:002251 D7A032              +30 
00:002252 D7A030              +30 
00:002253 D7A02E              +30 
00:002254 D7A02C              +30 
00:002255 D7A02A              +30 
00:002256 D7A028              +30 
00:002257 D7A026              +30 
00:002258 D7A024              +30 
00:002259 D7A022              +30 
00:00225A D7A020              +30 
00:00225B D7A01E              +30 
00:00225C D7A01C              +30 
00:00225D D7A01A              +30 
00:00225E D7A018              +30 
00:00225F D7A016              +30 
00:002260 D7A014              +30 
00:002261 D7A012              +30 
00:002262 D7A010              +30 
00:002263 D7A00E              +30 
00:002264 D7A00C              +30 
00:002265 D7A00A              +30 
00:002266 D7A008              +30 
00:002267 D7A006              +30 
00:002268 D7A004              +30 
00:002269 D7A002              +30 
00:00226A D7A000              +30 
  :                            31 
00:00226B C70006              +32 	ds	6
00:00226C 380003              +33 	pop	y
00:00226D 350000              +34 	lret	0
  :                            35 
  :                            36 	$endif
  :                            37 
  :                            38 check_complete
00:00226E C00005              +39 	aa	b
00:00226F 160010              +40 	dsr	16
00:002270 0E0008              +41 	sbr	8
00:002271 D6026E              +42 	jnza	check_complete
00:002272 B80F8E              +43 	xorB	(00FFFF)
00:002273 350000              +44 	lret	0
  :                            45 
  :                            46 t_ibuffer
00:002274 50D006              +47 	lx	s:tcp:rxbu_p
00:002275 60D005              +48 	la	s:tcp:tbase
  :                            49 
  :                            50 	$if	HVSOCKET
00:002276 D60280              +51 	jnza	g_ibuffer
  :                            52 		
00:002277 68001B              +53 	lb	HL_FLAGS		. bound but has no storage = hvsocket
00:002278 AD0012              +54 	andB	TCP_SYN++TCP_ACK,,xi
00:002279 BD0002              +55 	xorB	TCP_SYN,,xi		. has to be an incoming connect
00:00227A 650000              +56 	la	0,,xi			. nonzero = zero
00:00227B DE0294              +57 	jnzb	ibufferx		. it's otherwise about a fictional connection
  :                            58 
00:00227C FF0F93              +59 	call	(hvsocket_storage)
00:00227D C60294              +60 	jza	ibufferx		. already based, x already loaded
00:00227E 600000              +61 	la	r			. bytes requested
00:00227F B60282              +62 	j	ibuffer
  :                            63 	$endif
  :                            64 
  :                            65 g_ibuffer
00:002280 34002F              +66 	sabr	BSOCKET			. switch moment from port to connection block
00:002281 600000              +67 	la	r
  :                            68 
00:002282 F80003              +69 ibuffer	push	y
00:002283 F80004              +70 	push	a
00:002284 C50001              +71 	aa	1,,xi
00:002285 060001              +72 	sar	1
00:002286 3E0E20              +73 	lcal	buy1
00:002287 380005              +74 	pop	b
00:002288 380003              +75 	pop	y
  :                            76 
00:002289 C60294              +77 	jza	ibufferx
  :                            78 
00:00228A 20000E              +79 	sa	fp
00:00228B CF000A              +80 	dl	I_F_IDX			. and UPROTOCOL_BYTES
00:00228C 68000B              +81 	lb	UPROTOCOL_BYTES
00:00228D C7E002              +82 	ds	descriptor:i_f		. i_f : bytes
  :                            83 
00:00228E 60E001              +84 	la	descriptor:frame
00:00228F 680010              +85 	lb	HEADER_LONGWORDS
00:002290 2E0001              +86 	sbl	1
00:002291 C80004              +87 	ab	a
00:002292 C7E004              +88 	ds	descriptor:dgram	. dgram : uproto
  :                            89 
00:002293 60000E              +90 	la	fp
  :                            91 ibufferx
00:002294 350000              +92 	lret	0
  :                            93 
  :                            83: 	$include	ip_q2
  :                            1 
  :                            2 ipq_write
  :                            3 				. a -> descriptor
  :                            4 				. 8 -> descriptor
  :                            5 				. b  = payload bytes + IP header
  :                            6 				. 10 = fragment / DNF word
  :                            7 				. 11 = payload bytes + IP header
  :                            8 				. x -> interface
  :                            9 				. MTU = d$save1 = 17
  :                            10 				. TX_DATAGRAM = d$save = 16
  :                            11 				. TX_FRAME = register 9
  :                            12 
  :                            13 
00:002295 580009              +14 	ly	TX_FRAME
00:002296 FDFFFE              +15 	push,xi	-2
00:002297 38B00D              +16 	pop	nframe:stack_index, y
00:002298 30B007              +17 	z	nframe:frame_axw(1):bytes, y
00:002299 30B009              +18         z	nframe:frame_axw(2):bytes, y
00:00229A 28B00B              +19 	sb	nframe:frame_axw(TX_DESCRIPTORS):bytes, y
00:00229B 680013              +20 	lb	TX_DATAGRAM
00:00229C 28B00C              +21 	sb	nframe:frame_axw(TX_DESCRIPTORS):word_pointer, y
  :                            22 
  :                            23 	$if	1
00:00229D 68000B              +24 	lb	TX_DATAGRAML
  :                            25 	$else
  :                            26 	lb	MTU
  :                            27 	anb	11
  :                            28 	lb	11
  :                            29 	jc	ipq_write2q
  :                            30 
  :                            31 	ii	GUARD$
  :                            32 
  :                            33 	$if	TX_FRAGMENTS
  :                            34 	lcal	ipq_source_fragment
  :                            35 	jpa	ipq_write2q
  :                            36 	$endif
  :                            37 	lret	0
  :                            38 	$endif
  :                            39 
  :                            40 ipq_write2q
00:00229E 580013              +41 	ly	TX_DATAGRAM
00:00229F 3E02A4              +42 	lcal	ipq_construct_datagram_header
  :                            43 
  :                            44 	$do	0,	c	(__recheck)	TX_DATAGRAM
  :                            45 
00:0022A0 500012              +46 	lx	I_F
00:0022A1 600008              +47 	la	TX_AXW
00:0022A2 3E007D              +48 	lcal	q2ifoq
00:0022A3 350000              +49 	lret	0
  :                            50 
  :                            51 	$if	0
  :                            52 
  :                            53 ipq_source_fragment
  :                            54 	$if	TX_FRAGMENTS=0
  :                            55 
  :                            56 .	call ipq_write2q from here with no recursion
  :                            57 .	updating his pointer / counter tuple stacklet in the front of his buffer
  :                            58 .	and his datagram header + checksum
  :                            59 .	until the payload is small enough to return and drop into ipq_write2q
  :                            60 .	run a test with a large udgram
  :                            61 
  :                            62 	$else
  :                            63 
  :                            64 	lb	*TX_DATAGRAM
  :                            65 	la, xi	0
  :                            66 
  :                            67 	lcal	ip_buy_datagram	
  :                            68 	jnza	ipq_fragment
  :                            69 
  :                            70 	la, xi	-5
  :                            71 	lret	0
  :                            72 
  :                            73 ipq_fragment
  :                            74 	sa	y		. we already dropped the
  :                            75 				. interface pointer in x
  :                            76 	lx	TX_FRAME
  :                            77 	la	descriptor:frame, y
  :                            78 	qpush	0, x
  :                            79 	qpop	0, a	
  :                            80 	qpush	4, x
  :                            81 	qpop	4, a
  :                            82 
  :                            83 	lb	MTU
  :                            84 	andB,xi	-8
  :                            85 	anb	HEADER_BYTES
  :                            86 	tz	TX_FLAG_OFFSET
  :                            87 	andB,xi	-8
  :                            88 
  :                            89 	push	b
  :                            90 	sbr	3
  :                            91 	ab	TX_FLAG_OFFSET
  :                            92 	orB	IP_MORE
  :                            93 	sb	TX_FLAG_OFFSET
  :                            94 
  :                            95 	lb	TX_DATAGRAML
  :                            96 	anb	0, sp
  :                            97 	sb	TX_DATAGRAML
  :                            98 	pop	b
  :                            99 
  :                            100 	push	b	
  :                            101 	lcal	ipq_write_channel_program
  :                            102 
  :                            103 	pop	b
  :                            104 	ab	HEADER_BYTES
  :                            105 	ly	descriptor:dgram, y
  :                            106 	lx	TX_DATAGRAM
  :                            107 	lcal	ipq_repro_datagram_header	
  :                            108 
  :                            109 	lx	I_F
  :                            110 	la	fp
  :                            111 	lcal	q2ifoq
  :                            112 
  :                            113 					. test if this is the last fraction
  :                            114 	la	TX_DATAGRAML
  :                            115 	aa	HEADER_BYTES
  :                            116 	lb	MTU
  :                            117 	anb	a
  :                            118 
  :                            119 	jnc	ipq_refraction
  :                            120 	
  :                            121 	la	TX_FRAME
  :                            122 	ly	TX_AXW
  :                            123 					. rewrite the channel program
  :                            124 	lb	TX_DATAGRAML		. of the original buffer
  :                            125 	lcal	ipq_write_channel_program
  :                            126 
  :                            127 	lb	TX_DATAGRAML
  :                            128 	ab	HEADER_BYTES
  :                            129 
  :                            130 	la	TX_FLAG_OFFSET
  :                            131 	and,xi	01FFF
  :                            132 	sa	TX_FLAG_OFFSET
  :                            133 	$endif
  :                            134 	lret	0
  :                            135 
  :                            136 	$endif
  :                            137 
  :                            138 ipq_construct_datagram_header
00:0022A4 600010              +139 	la	HEADER_BYTES
00:0022A5 060002              +140 	sar	2
00:0022A6 C5FFFB              +141 	aa, xi	-5
00:0022A7 400004              +142 	lr	a
  :                            143 
00:0022A8 60B000              +144 	la	dgram:vers_ihl_tos, y
00:0022A9 28B001              +145 	sb	dgram:bytes, y
  :                            146 
00:0022AA F8000A              +147 	push	TX_FLAG_OFFSET
00:0022AB 38B003              +148 	pop	dgram:flags_fragment, y
00:0022AC C8000A              +149 	ab	TX_FLAG_OFFSET
00:0022AD C8B004              +150 	ab	dgram:ttl_protocol, y
00:0022AE C0B002              +151 	aa	dgram:id, y
00:0022AF D7B006              +152 	da	dgram:ipsource, y
00:0022B0 D7B008              +153 	da	dgram:ipdest, y
  :                            154 
00:0022B1 780000              +155 	tp	r
00:0022B2 450000              +156 	lr, xi	0
00:0022B3 54B00A              +157 	lx, i	10, y
00:0022B4 B602B7              +158 	j	ipq_add_options?
  :                            159 
  :                            160 ipq_add_options!
00:0022B5 D7A000              +161 	da	0, x
00:0022B6 850002              +162 	ax, xi	2
  :                            163 ipq_add_options?
00:0022B7 1E02B5              +164 	jdr	ipq_add_options!
  :                            165 
  :                            166 ipq_write_sum
  :                            167 	$if	1
00:0022B8 3E026E              +168 	lcal	check_complete
  :                            169 	$else
  :                            170 	aa	b
  :                            171 	dsr	16
  :                            172 	sbr	8
  :                            173 	jnza	ipq_write_sum
  :                            174 
  :                            175 	xorB	(00FFFF)
  :                            176 	$endif
  :                            177 
00:0022B9 28B005              +178 	sb	dgram:checksum, y
  :                            179 
00:0022BA 350000              +180 	lret	0
  :                            181 
  :                            182 	$if	TX_FRAGMENTS
  :                            183 ipq_repro_datagram_header
  :                            184 	la	HEADER_BYTES
  :                            185 	sar	2
  :                            186 	aa, xi	-5
  :                            187 	lr	a
  :                            188 
  :                            189 	la	dgram:vers_ihl_tos, y
  :                            190 	ds	dgram:bytes, x
  :                            191 
  :                            192 	qpush	dgram:ipsource, y
  :                            193 	push,xi	0
  :                            194 	push	dgram:ttl_protocol, y
  :                            195 	push	TX_FLAG_OFFSET
  :                            196 	push	dgram:id, y
  :                            197 
  :                            198 	da	0, sp
  :                            199 	da	2, sp
  :                            200 	da	4, sp		. this said 3, sp before, surely some mistake
  :                            201 	da	6, sp
  :                            202 
  :                            203 	tp	r
  :                            204 	lr, xi	0
  :                            205 
  :                            206 	push	x
  :                            207 
  :                            208 	j	ipq_repro_option?
  :                            209 
  :                            210 ipq_repro_option!
  :                            211 	dpush	10, y
  :                            212 	da	0, sp
  :                            213 
  :                            214 	dpop	10, x
  :                            215 
  :                            216 	ax, xi	2
  :                            217 	ay, xi	2
  :                            218 
  :                            219 ipq_repro_option?
  :                            220 	jdr	ipq_repro_option!
  :                            221 
  :                            222 	pop	x
  :                            223 
  :                            224 ipq_repro_sum
  :                            225 	aa	b
  :                            226 	dsr	16
  :                            227 	sbr	8
  :                            228 	jnza	ipq_repro_sum
  :                            229 
  :                            230 	xorB	(00FFFF)
  :                            231 	sb	3, sp
  :                            232 
  :                            233 	qpop	2, x
  :                            234 	qpop	6, x
  :                            235 
  :                            236 	lret	0
  :                            237 	$endif		. TX_FRAGMENTS
  :                            238 
  :                            239 ipq_write_channel_program
  :                            240 					. b = payload length
  :                            241 					. a = frame buffer
  :                            242 					. y = fragment buffer descriptor
00:0022BB FDFFFC              +243         push,xi -4                  
00:0022BC 38C00D              +244         pop     nframe:stack_index, a
  :                            245 
00:0022BD F80010              +246         push    HEADER_BYTES
00:0022BE 38C009              +247         pop     nframe:frame_axw(TX_DESCRIPTORS-1):bytes, a
00:0022BF F8B004              +248         push    descriptor:dgram, y
00:0022C0 38C00A              +249         pop     nframe:frame_axw(TX_DESCRIPTORS-1):word_pointer, a
  :                            250 
00:0022C1 28C00B              +251 	sb	nframe:frame_axw(TX_DESCRIPTORS):bytes, a
  :                            252 
00:0022C2 68000A              +253         lb      10
00:0022C3 AD1FFF              +254         andB,xi 01FFF
00:0022C4 28000A              +255         sb      10
00:0022C5 2E0003              +256         sbl     3
  :                            257 
  :                            258         $if     DYNAMIC_IP_HEADER
  :                            259         ab      TP_HEADER
  :                            260         anb     HEADER_BYTES
  :                            261         $else
00:0022C6 C80013              +262         ab      TX_DATAGRAM
  :                            263         $endif
  :                            264 
00:0022C7 28C00C              +265         sb      nframe:frame_axw(TX_DESCRIPTORS):word_pointer, a
  :                            266 	
00:0022C8 350000              +267 	lret	0
  :                            84: 	$include	icmp
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 $(66::,x)
  :                            41 ping	icmp_echo
  :                            42 
  :                            43 $(1)
  :                            44 
01:000408 000000              +45 icmpq	dq
01:000409 000000              +45 
  :                            46 
  :                            47 $(0)
  :                            48 
  :                            49 . icmp
  :                            50 .	lret	0
  :                            51 
  :                            52 icmp_buy_msg
00:0022C9 6D4500              +53 	lb, xi	04500
  :                            54 icmp_buy_msg_optional
00:0022CA F80004              +55 	push	a
00:0022CB 3E01E4              +56 	lcal	ip_buy_datagram
00:0022CC 380005              +57 	pop	b
00:0022CD C602D3              +58 	jza	icmp_noreply
00:0022CE 28C003              +59 	sb	descriptor:bytes, a
00:0022CF 6D3C01              +60 	lb, xi	IP_DEFAULT_TTL++IPPROTO_ICMP
00:0022D0 500013              +61 	lx	TX_DATAGRAM
00:0022D1 28A004              +62 	sb	dgram:ttl_protocol, x
00:0022D2 350001              +63 	lret	1
  :                            64 icmp_noreply
00:0022D3 350000              +65 	lret	0
  :                            66 
  :                            67 icmp_buy_response
00:0022D4 60E003              +68 	la	descriptor:bytes
00:0022D5 3E02C9              +69 	lcal	icmp_buy_msg
00:0022D6 B602E8              +70 	j	icmp_noresponse
  :                            71 
00:0022D7 50E004              +72 	lx	descriptor:dgram
00:0022D8 9FA006              +73 	dpush	dgram:ipsource, x
00:0022D9 9FA008              +74 	dpush	dgram:ipdest, x
  :                            75 
00:0022DA 50C004              +76 	lx	descriptor:dgram, a
00:0022DB 87A006              +77 	qpop	dgram:ipsource, x
  :                            78 
00:0022DC 58E005              +79 	ly	descriptor:uproto
00:0022DD 50C005              +80 	lx	descriptor:uproto, a
00:0022DE 10C006              +81 	sx	descriptor:apdata, a
  :                            82 
00:0022DF F80004              +83 	push	a
00:0022E0 60C003              +84 	la	descriptor:bytes, a
00:0022E1 300006              +85 	z	6
00:0022E2 300007              +86 	z	7
00:0022E3 3E0419              +87 	lcal	rx_payload
00:0022E4 380002              +88 	pop	x
00:0022E5 58A006              +89 	ly	descriptor:apdata, x
00:0022E6 28B001              +90 	sb	ping:h:checksum, y
00:0022E7 350001              +91 	lret	1
  :                            92 icmp_noresponse
00:0022E8 350000              +93 	lret	0
  :                            94 
  :                            95 
  :                            96 	$if	IPV4_OVERHAUL
  :                            97 
  :                            98 icmp_rxq			.	TP_HEADER is in x
  :                            99 				. put tests for categories here
00:0022E9 60F001              +100 	la	dgram:bytes
00:0022EA 300006              +101 	z	6		. icmp does not sum
00:0022EB 300007              +102 	z	7		. network addresses / protocol / length
00:0022EC 48A001              +103 	lk	ping:h:checksum
00:0022ED 30A001              +104 	z	ping:h:checksum
00:0022EE 680004              +105 	anu	IPV4_OVERHAUL,,xi
00:0022EF DD00A0              +105 
  :                            106 
00:0022F0 C602F2              +107 	jza	icmp_exact
00:0022F1 7E0304              +108 	jc	icmp_rxqlong	. >= IPV4_OVERHAUL octets
  :                            109 icmp_exact
00:0022F2 3E023F              +110 	lcal	check_part1s
00:0022F3 3E026E              +111 	lcal	check_complete
00:0022F4 B80001              +112 	xorB	k		. b = recalculated checksum, k = received checksum
00:0022F5 DE01E1              +113 	jnzb	ipv4_rxz	. there is no buffer yet
  :                            114 
00:0022F6 60F001              +115 	la	dgram:bytes
00:0022F7 502180              +116 	lx	rx_buffers
00:0022F8 3E0282              +117 	lcal	ibuffer
00:0022F9 C601E1              +118 	jza	ipv4_rxz	. no buffer available
  :                            119 
00:0022FA 50E004              +120 	lx	descriptor:dgram
00:0022FB 68F001              +121 	lb	dgram:bytes
00:0022FC CDFFFF              +122 	ab	-1,,xi
00:0022FD 5E01DD              +123 	jnc	ipv4_drop	. might as well be ridiculous
00:0022FE 0E0003              +124 	sbr	3		. # blocks of 4 byte pairs less 1
00:0022FF 400005              +125 	lr	b
  :                            126 
  :                            127 icmp_iquick
00:002300 87A000              +128 	qpop	0, x
00:002301 850004              +129 	ax	4,,xi
00:002302 1E0300              +130 	jdr	icmp_iquick
  :                            131 
00:002303 B60325              +132 	j	icmp_rxqq	. already checksumed at this point
  :                            133 
  :                            134 icmp_rxqlong
00:002304 3E023D              +135 	lcal	check_part1
  :                            136 
00:002305 60F001              +137 	la	dgram:bytes
00:002306 502180              +138 	lx	rx_buffers
  :                            139 
00:002307 3E0282              +140 	lcal	ibuffer
00:002308 C601E1              +141 	jza	ipv4_rxz
  :                            142 
00:002309 60F001              +143 	la	dgram:bytes	. obtain the datagram second part length
  :                            144 				. while the header is in the internal stack
00:00230A 50E004              +145 	lx	descriptor:dgram
00:00230B 87A000              +146 ?	$do	IPV4_OVERHAUL/8,	qpop	?*4-4, x
00:00230C 87A004              +146 
00:00230D 87A008              +146 
00:00230E 87A00C              +146 
00:00230F 87A010              +146 
00:002310 87A014              +146 
00:002311 87A018              +146 
00:002312 87A01C              +146 
00:002313 87A020              +146 
00:002314 87A024              +146 
00:002315 87A028              +146 
00:002316 87A02C              +146 
00:002317 87A030              +146 
00:002318 87A034              +146 
00:002319 87A038              +146 
00:00231A 87A03C              +146 
00:00231B 87A040              +146 
00:00231C 87A044              +146 
00:00231D 87A048              +146 
00:00231E 87A04C              +146 
  :                            147 
00:00231F C5FF60              +148 	aa	-IPV4_OVERHAUL,,xi
00:002320 850050              +149 	ax	IPV4_OVERHAUL/2,,xi
00:002321 8D0050              +150 	ay	IPV4_OVERHAUL/2,,xi
  :                            151 
00:002322 3E0419              +152 	lcal	rx_payload
00:002323 B80001              +153 	xorB	k
00:002324 DE01DD              +154 	jnzb	ipv4_drop	. now there is a buffer to return
  :                            155 
  :                            156 icmp_rxqq
  :                            157 
00:002325 FD0001              +158 	MIB_ICOUNT48	icmpInMsgs:i
(+01)0f
00:002326 2F0524              +158 
00:002327 5E0329              +158 
(+01)0f
00:002328 170523              +158 
  :                            159 
00:002329 60000E              +160 	la	fp
(+01)10
00:00232A 5D0408              +161 	ly	icmpq,,xi
00:00232B 3E0E96              +162 	lcal	q2
00:00232C B601E1              +163 	j	ipv4_rxz
  :                            164 
  :                            165 
  :                            166 	$else	.	OVERHAUL
  :                            167 
  :                            168 	$endif		. OVERHAUL
  :                            169 
(+01)0f
00:00232D 600408              +170 icmp	la	icmpq.head
00:00232E C6034C              +171 	jza	icmpx
00:00232F 20000E              +172 	sa	fp
00:002330 58C005              +173 	ly	descriptor:uproto, a
  :                            174 	
00:002331 60B000              +175 	la	ping:h:type_code, y
00:002332 680004              +176 	anu, xi	0800
00:002333 DD0800              +176 
00:002334 DE0348              +177 	jnzb	icmp_rx_routinfo?
  :                            178 
00:002335 FD0001              +179 	MIB_ICOUNT48	icmpInEchos:i
(+01)0f
00:002336 2F0532              +179 
00:002337 5E0339              +179 
(+01)0f
00:002338 170531              +179 
00:002339 30B000              +180 	z	ping:h:type_code, y	. the value of echo response
00:00233A 3E02D4              +181 	lcal	icmp_buy_response
00:00233B B60348              +182 	j	icmp_drop		. no output buffer
  :                            183 
00:00233C FD0001              +184 	MIB_ICOUNT48	icmpInEchoReps:i
(+01)0f
00:00233D 2F0534              +184 
00:00233E 5E0340              +184 
(+01)0f
00:00233F 170533              +184 
  :                            185 
00:002340 58A004              +186 	ly	descriptor:dgram, x
00:002341 4FB006              +187 	ql	dgram:ipsource, y
  :                            188 
00:002342 FD0001              +189 	MIB_ICOUNT48	icmpOutMsgs:i
(+01)0f
00:002343 2F053E              +189 
00:002344 5E0346              +189 
(+01)0f
00:002345 17053D              +189 
  :                            190 
00:002346 FF0F94              +191 	call	(ipsend)
00:002347 B60348              +192 	j	icmp_drop
  :                            193 
  :                            194 icmp_rx_routinfo?
  :                            195 			. for receiving redirects
  :                            196 icmp_drop
(+01)10
00:002348 5D0408              +197 	ly	icmpq,,xi
00:002349 3E0EA1              +198 	lcal	readq
00:00234A 502180              +199 	lx	rx_buffers
00:00234B 3E0E49              +200 	lcal	sell1
  :                            201 
00:00234C 350000              +202 icmpx	lret	0
  :                            203 
  :                            204 icmp_du_port
  :                            205 icmp_noproto		. jumped at from ipv4_rx
  :                            206 			. should queue the problem
  :                            207 			. into icmpq, and then...
00:00234D B601E1              +208 	j	ipv4_rxz	. no buffer shall have been assigned
  :                            209 				. or memory will trap
  :                            210 
  :                            211 
  :                            212 icmp_nosocket		. called from udp
  :                            213 			. should send DU[PORT]
00:00234E 350000              +214 	lret	0	. must return
  :                            215 
  :                            216 
  :                            217 
  :                            218 	$if	RX_FRAGMENTS
  :                            219 
  :                            220 icmp_rx_rasm
  :                            221 	lx	descriptor:uproto
  :                            222 	push	ping:h:checksum
  :                            223 	lcal	rasm77_gcheck
  :                            224 	xorB	0, sp
  :                            225 	pop	ping:h:checksum
  :                            226 	la	fp
  :                            227 	jnzb	net_free_chain
  :                            228 	lx, i	icmpq
  :                            229 	j	net_add_chain
  :                            230 	
  :                            231 	$endif
  :                            85: 	$include	udp
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 
  :                            41 $(71::,sp)
47:000000                     +42 uugram udgram
47:000001                     +42 
47:000002                     +42 
47:000003                     +42 
  :                            43 
  :                            44 $(66::,b)
42:000000                     +45 s	$socket
42:000002                     +45 
42:000004                     +45 
42:000005                     +45 
42:000006                     +45 
42:000007                     +45 
42:000005                     +45 
42:000006                     +45 
42:000007                     +45 
  :                            46 
  :                            47 $(1)
01:00040A 000000              +48 udpq*	dq
01:00040B 000000              +48 
01:00040C 000000              +49 udp_nosocket_rxgrams	0		. value for controlling proliferation of DU ports
  :                            50 
01:00040D 00034D              +51 udp_ldgram_noport +	icmp_du_port	. default vector of RX large segment no port bound:
  :                            52 					. DU[PORT] without preliminary checksum. Avoids
  :                            53 					. expensive input-completion / buffering / repooling
  :                            54 
  :                            55 					. can be changed administratively to silent drop
  :                            56 					. or even to full checksum to choose whether
  :                            57 					. DU + drop or silent drop
  :                            58 $(0)
00:00234F 480F8E              +59 udp4	lk	(00FFFF)
  :                            60 .	ly, xi	udpq
  :                            61 udp_next
(+01)10
00:002350 5D040A              +62 	ly	udpq,,xi
(+01)0f
00:002351 60040A              +63 	la	udpq.head
00:002352 C60362              +64 	jza	udp4_x
00:002353 20000E              +65 	sa	fp
  :                            66 
  :                            67 	$if	IPV4_OVERHAUL
00:002354 CFE006              +68 	dl	descriptor:sobdi
  :                            69 .	dte	(000029,02f090L)
  :                            70 .	ii	GUARD$
00:002355 34002F              +71 	sabr	BSOCKET
  :                            72 	$else	. IPV4_OVERHAUL
  :                            73 	$endif	. IPV4_OVERHAUL
  :                            74 
00:002356 60D001              +75 	la	s:socket_address+1, b
00:002357 A00F8E              +76 	and	(65535)			. socket still bound since since datagram arrived?
00:002358 C6035F              +77 	jza	udp_socket_closed
  :                            78 
00:002359 60E005              +79 	la	descriptor:uproto
00:00235A C50004              +80 	aa	4,,xi
00:00235B 20E006              +81 	sa	descriptor:apdata
  :                            82 
00:00235C 500005              +83 	lx	b			. queueing uses TS cell in socket structure
00:00235D 3E04CD              +84 	lcal	udp_write_rxq
00:00235E B60350              +85 	j	udp_next
  :                            86 
  :                            87 udp_socket_closed
00:00235F 3E034E              +88 	lcal	icmp_nosocket
  :                            89 
00:002360 3E00C9              +90 	lcal	net_free		. net_drop
00:002361 B60350              +91 	j	udp_next
  :                            92 
  :                            93 udp4_x
00:002362 350000              +94 	lret	0
  :                            95 
  :                            96 
  :                            97 .	this is the direct feed to udpq from interfaces which have
  :                            98 .	fixed dual-ported buffering. Interfaces with a direct access
  :                            99 .	to system memory would not have this packet copy
  :                            100 
  :                            101 .	The packet copy is used as an occasion to checksum
  :                            102 
  :                            103 .	The packet copy places the packets in rx_buffer with
  :                            104 .	T77 descriptors which are called ACWs
  :                            105 
  :                            106 .	This routine cannot be called for fragmented datagrams
  :                            107 .	because it is instant from frame readout to UDP checksum
  :                            108 .	generation
  :                            109 
  :                            110 .	this is an upward call from ipv4_rx
  :                            111 
  :                            112 
  :                            113 	$if	IPV4_OVERHAUL
  :                            114 udp_rxq					. TP_HEADER is in x
00:002363 FD0001              +115 	MIB_ICOUNT48	udpInDatagrams:i
(+01)0f
00:002364 2F0579              +115 
00:002365 5E0367              +115 
(+01)0f
00:002366 170578              +115 
  :                            116 
00:002367 60F001              +117 	la	dgram:bytes
00:002368 48A003              +118 	lk	uugram:checksum, x
00:002369 30A003              +119 	z	uugram:checksum, x
  :                            120 
00:00236A 68A002              +121 	lb	uugram:udgraml, x
00:00236B CDFFF8              +122 	ab	-8,,xi
00:00236C 5E01E1              +123 	jnc	ipv4_rxz			. no socket buffer acquired yet
  :                            124 
00:00236D 680010              +125 	lb	HEADER_LONGWORDS
00:00236E 2E0002              +126 	sbl	2
00:00236F C8A002              +127 	ab	uugram:udgraml, x
00:002370 D00005              +128 	ana	b
00:002371 5E01E1              +129 	jnc	ipv4_rxz			. no socket buffer acquired yet
  :                            130 
00:002372 60F001              +131 	la	dgram:bytes
00:002373 680004              +132 	anu	IPV4_OVERHAUL,,xi
00:002374 DD00A0              +132 
00:002375 C60377              +133 	jza	udp_exact
00:002376 7E039F              +134 	jc	udp_rxqlong
  :                            135 
  :                            136 udp_exact
00:002377 700001              +137 	tnz	k				. rx without checksum?	
00:002378 B6037A              +137 
00:002379 B60380              +138 	j	udp_socket?			. skip checksum
00:00237A 3E023F              +139 	lcal	check_part1s
00:00237B 3E026E              +140 	lcal	check_complete
00:00237C DE037E              +141 	jnzb	$+2
00:00237D 680F8E              +142 	lb	(00FFFF)
00:00237E B80001              +143 	xorB	k
00:00237F DE01E1              +144 	jnzb	ipv4_rxz
  :                            145 
  :                            146 udp_socket?
  :                            147 	$if	__SOCHECK=0
  :                            148 	dl	SOCKET_LPOINTER
  :                            149 	jza	icmp_du_port
  :                            150 	$else
00:002380 60A001              +151 	la	uugram:destp, x
00:002381 3E04E6              +152 	lcal	udp_socket
00:002382 570012              +153 	dte	SOCKET_LPOINTER
00:002383 75005F              +154 	ii	GUARD$
00:002384 C6034D              +155 	jza	icmp_du_port			. socket structure not stored
  :                            156 	$endif
  :                            157 
00:002385 60D001              +158 	la	s:socket_address+1, b
00:002386 A00F8E              +159 	and	(65535)
00:002387 C6034D              +160 	jza	icmp_du_port			. socket not bound
  :                            161 
00:002388 60F001              +162 	la	dgram:bytes
00:002389 502180              +163 	lx	rx_buffers
00:00238A 3E0282              +164 	lcal	ibuffer
00:00238B C601E1              +165 	jza	ipv4_rxz
  :                            166 
00:00238C 50E004              +167 	lx	descriptor:dgram
00:00238D 68F001              +168 	lb	dgram:bytes			. calculate 8-byte blocks to store
00:00238E CDFFFF              +169 	ab	-1,,xi
00:00238F 5E01DD              +170 	jnc	ipv4_drop
00:002390 0E0003              +171 	sbr	3
00:002391 400005              +172 	lr	b
  :                            173 
  :                            174 udp_iquick
00:002392 87A000              +175 	qpop	0, x
00:002393 850004              +176 	ax	4,,xi
00:002394 1E0392              +177 	jdr	udp_iquick
  :                            178 
  :                            179 udp_rxqthru
00:002395 60E005              +180 	la	descriptor:uproto
00:002396 60C002              +181 	la	uugram:udgraml, a
00:002397 C5FFF8              +182 	aa	-8,,xi				. application data byte count
00:002398 20E003              +183 	sa	descriptor:bytes
00:002399 CF0012              +184 	dl	SOCKET_LPOINTER
00:00239A C7E006              +185 	ds	descriptor:sobdi
(+01)10
00:00239B 5D040A              +186 	ly	udpq,,xi			. don't queue to the socket here
00:00239C 60000E              +187 	la	fp				. because that involves TS arbitration
00:00239D 3E0E96              +188 	lcal	q2				. so let the other half of UDP do that
00:00239E B601E1              +189 	j	ipv4_rxz			. and clear the interface frame now
  :                            190 
  :                            191 udp_rxqlong
00:00239F 700001              +192 	tnz	k
00:0023A0 B603A2              +192 
00:0023A1 B603A3              +193 	j	udp_uportbound?
00:0023A2 3E023D              +194 	lcal	check_part1
  :                            195 
  :                            196 udp_uportbound?
  :                            197 	$if	 __SOCHECK=0
  :                            198 	dl	SOCKET_LPOINTER
  :                            199 	jza	*udp_ldgram_noport
  :                            200 	$else
00:0023A3 60A001              +201 	la	uugram:destp, x
00:0023A4 3E04E6              +202 	lcal	udp_socket
00:0023A5 570012              +203 	dte	SOCKET_LPOINTER
00:0023A6 75005F              +204 	ii	GUARD$
(+01)0d
00:0023A7 C6840D              +205 	jza	*udp_ldgram_noport		. drop large ugrams to no port
  :                            206 	$endif					. without checking sum
  :                            207 
00:0023A8 60D001              +208 	la	s:socket_address+1, b
00:0023A9 A00F8E              +209 	and	(65535)				. silently or not
00:0023AA C6034D              +210 	jza	icmp_du_port			. according to nuisance levels
  :                            211 
00:0023AB 60F001              +212 	la	dgram:bytes
00:0023AC 502180              +213 	lx	rx_buffers
00:0023AD 3E0282              +214 	lcal	ibuffer
00:0023AE C601E1              +215 	jza	ipv4_rxz 
  :                            216 
00:0023AF 50E004              +217 	lx	descriptor:dgram
00:0023B0 60F001              +218 	la	dgram:bytes
  :                            219 
00:0023B1 87A000              +220 ?	$do	IPV4_OVERHAUL/8,	qpop	?*4-4, x
00:0023B2 87A004              +220 
00:0023B3 87A008              +220 
00:0023B4 87A00C              +220 
00:0023B5 87A010              +220 
00:0023B6 87A014              +220 
00:0023B7 87A018              +220 
00:0023B8 87A01C              +220 
00:0023B9 87A020              +220 
00:0023BA 87A024              +220 
00:0023BB 87A028              +220 
00:0023BC 87A02C              +220 
00:0023BD 87A030              +220 
00:0023BE 87A034              +220 
00:0023BF 87A038              +220 
00:0023C0 87A03C              +220 
00:0023C1 87A040              +220 
00:0023C2 87A044              +220 
00:0023C3 87A048              +220 
00:0023C4 87A04C              +220 
  :                            221 
00:0023C5 C5FF60              +222 	aa	-IPV4_OVERHAUL,,xi
  :                            223 
00:0023C6 850050              +224 	ax	IPV4_OVERHAUL/2,,xi
00:0023C7 8D0050              +225 	ay	IPV4_OVERHAUL/2,,xi
  :                            226 
00:0023C8 700001              +227 	tz	k
00:0023C9 B603CC              +228 	j	udp_store	
  :                            229 
00:0023CA 3E0469              +230 udp_qup	lcal	rx_nocheck
00:0023CB B60395              +231 	j	udp_rxqthru			. socket buffer acquired, check waived
  :                            232 
  :                            233 udp_store
00:0023CC 3E0419              +234 	lcal	rx_payload
00:0023CD DE03CF              +235 	jnzb	$+2
00:0023CE 680F8E              +236 	lb	(65535)
00:0023CF B80001              +237 	xorB	k
00:0023D0 CE0395              +238 	jzb	udp_rxqthru			. socket buffer acquired, payload checks 
00:0023D1 B601DD              +239 	j	ipv4_drop			. socket buffer acquired but checksum fail
  :                            240 
  :                            241 	$else	. IPV4_OVERHAUL
  :                            242 	
  :                            243 	$endif	. IPV4_OVERHAUL
  :                            244 
  :                            245 .	this is the feed to udpq for reassembled datagrams
  :                            246 .	which are already in a chain of rx_buffer with ACW
  :                            247 .	descriptors
  :                            248 
  :                            249 .	each fragment has the checksum addition of its data
  :                            250 .	in the ACW, to exploit the chance of checksum
  :                            251 .	generation during copy to rx_buffer
  :                            252 
  :                            253 .	it has been second-guessed in all cases that checksum
  :                            254 .	is specified in the UDP header (the UDP header may not
  :                            255 .	be the first fragment of the datagram to arrive).
  :                            256 
  :                            257 .	also, it is unlikely that UDP payload large enough
  :                            258 .	to need reassembly would be exempt from checksum
  :                            259 
  :                            260 .	no-checksum is usually a feature of high-speed
  :                            261 .	media traffic which is transmitted in much smaller
  :                            262 .	packets than any MTU
  :                            263 
  :                            264 .	large reassembly is more likely to be traffic like
  :                            265 .	NFS in 8KByte slabs (or 3KByte slabs where RTA is the
  :                            266 .	NFS client). Checksum would certainly apply
  :                            267 
  :                            268 .	So all the data arriving here has been end-around
  :                            269 .	added and the positive sum left in the ACW
  :                            270 
  :                            271 .	if the UDP header has a nonzero checksum, the data sums
  :                            272 .	are now summed with network address, protocol index
  :                            273 .	and user datagram length, then inverted and if finally
  :                            274 .	zero inverted again. Then compared.
  :                            275 
  :                            276 	$if	RX_FRAGMENTS
  :                            277 udp_rx_rasm
  :                            278 	lx	descriptor:uproto
  :                            279 	la	uugram:checksum, x
  :                            280 	jza	udp_rx_rasm_nocheck
  :                            281 	push	a
  :                            282 	z	uugram:checksum, x
  :                            283 	lcal	rasm77_gcheck
  :                            284 	tnz	b		. because zero isn't
  :                            285 	xorB,xi	-1		. a UDP checksum
  :                            286 	xorB	0, sp
  :                            287 	pop	uugram:checksum, x
  :                            288 	la	fp
  :                            289 	jnzb	net_free_chain
  :                            290 udp_rx_rasm_nocheck
  :                            291 	la	fp
  :                            292 	lx, xi	udpq	
  :                            293 	j	net_add_chain
  :                            294 	$endif
  :                            295 
  :                            296 
  :                            297 udp_buy_txaw
00:0023D2 6D4500              +298 	lb, xi	04500		. no option bytes, TOS default 0
  :                            299 
  :                            300 udp_buy_txaw_optional
00:0023D3 F80004              +301 	push	a
00:0023D4 C50008              +302 	aa, xi	8		. UDP header length
00:0023D5 3E01E4              +303 	lcal	ip_buy_datagram
00:0023D6 380005              +304 	pop	b
00:0023D7 C603DF              +305 	jza	udp_txbx
00:0023D8 28C003              +306 	sb	descriptor:bytes, a
00:0023D9 500013              +307 	lx	TX_DATAGRAM
00:0023DA 6D3C11              +308 	lb, xi	IP_DEFAULT_TTL++IPPROTO_UDP
00:0023DB 28A004              +309 	sb	dgram:ttl_protocol, x
00:0023DC 500011              +310 	lx	TP_HEADER
00:0023DD 54A004              +311 	lx, i	8/2, x
00:0023DE 10C006              +312 	sx	descriptor:apdata, a
  :                            313 udp_txbx
00:0023DF 3D0000              +314 	fret	0
  :                            315 				. this is a far call because
  :                            316 				. socket users may call it
  :                            317 
  :                            318 				. unlike the similar calls
  :                            319 				. in icmp and tcp which are
  :                            320 				. not application visible
  :                            321 
  :                            322 
  :                            323 
  :                            324 . far calls
  :                            325 
  :                            326 .	udp_acw_send
  :                            327 .	udp_acw_send_nocheck
  :                            328 
  :                            329 . get to here
  :                            330 
  :                            331 . udp_txaw
  :                            332 . udp_txaw_nocheck
  :                            333 
  :                            334 . low level call with the acw adress in X
  :                            335 
  :                            336 . both ports must be in the UDP header
  :                            337 . both adresses must be in the address buffer
  :                            338 
  :                            339 . if there is no come-from address in the address buffer
  :                            340 . the thing cannot now be checksummed and an earlier
  :                            341 . call should have done the internal routing step to
  :                            342 . find the sending interface and its default network
  :                            343 . address
  :                            344 
  :                            345 . so in that case an error gets returned as described
  :                            346 . in the rest of this discussion
  :                            347 
  :                            348 . it's the interface number that is important in
  :                            349 . finding a local address for the datagram and
  :                            350 . for the checksum
  :                            351 
  :                            352 . it's also optimal if the interface index is already
  :                            353 . in the descriptor
  :                            354 
  :                            355 . we have the local address and the interface number
  :                            356 . already when we just bounce back reversing the
  :                            357 . incoming addresses as a server with the calls to
  :                            358 
  :                            359 . 	udp_rtxbuffer->udp_response_buffer
  :                            360 
  :                            361 . and after message construction, to here:
  :                            362 
  :                            363 .	udp_acw_send->udp_txaw
  :                            364 
  :                            365 . some implementations suggest you do a connect
  :                            366 . which makes a routing call to IP and plugs the
  :                            367 . default network address of the interface back
  :                            368 . into the socket
  :                            369 
  :                            370 . having a from address in the socket is
  :                            371 . usable when you are making the conventional
  :                            372 . calls send and sendto
  :                            373 
  :                            374 . the connect idea is nice for send but not
  :                            375 . for sendto which is meant for random desinations
  :                            376 . reached over various interfaces
  :                            377 
  :                            378 . it's also not right that an application should
  :                            379 . need to pick a local network address before
  :                            380 . binding a UDP socket. The application and its
  :                            381 . developer cannot know that unless the
  :                            382 . application is for one host with one interface
  :                            383 
  :                            384 . since this is the final path step of all the
  :                            385 . possible interface calls to send UDP
  :                            386 
  :                            387 . and the step where checksum is done if opted
  :                            388 . and the come-from address therefore needed
  :                            389 
  :                            390 . we'll do the following here
  :                            391 
  :                            392 . we'll return with an error code if there is
  :                            393 . no source address, because
  :                            394 
  :                            395 . if you got here with the primitive
  :                            396 
  :                            397 .	udp_acw_send
  :                            398 
  :                            399 . then it was up to you to copy the address
  :                            400 . information into the buffers. At this
  :                            401 . point it's no longer certain that the
  :                            402 . socket/port structure is based. That's
  :                            403 . not even in the parameters to this call
  :                            404 . and it's intended that the caller decides
  :                            405 . what at this point is based in socket
  :                            406 . space
  :                            407 
  :                            408 . so we'll send back an error
  :                            409 
  :                            410 . if you obtained the buffer with
  :                            411 
  :                            412 .	udp_rtxbuffer
  :                            413 
  :                            414 . then that DID set the addresses up for you
  :                            415 
  :                            416 . if you came from send, send had access
  :                            417 . to your socket and copied the addresses
  :                            418 . in there
  :                            419 
  :                            420 . if you then get to here with no come-from
  :                            421 . address you hadn't done the connect call
  :                            422 . which writes both to and from addresses
  :                            423 . to the socket. So the same error return
  :                            424 . is appropriate, we'll call it something
  :                            425 . like
  :                            426 
  :                            427 . UDP_NOSOURCENET	$equ	-5
  :                            428 
  :                            429 . if you got here from sendto, that makes
  :                            430 . the same internal routing call as connect
  :                            431 . for every datagram
  :                            432 . but writes what it finds to the datagram
  :                            433 . address buffer and not to the socket
  :                            434 
  :                            435 . recvfrom can cheekily write all the
  :                            436 . incoming addressing to the socket
  :                            437 
  :                            438 . then sendto can skip the internal routing
  :                            439 . step if the socket has a source address
  :                            440 . and the destinaton address stored on the
  :                            441 . socket is the sendto parameter address
  :                            442 
  :                            443 . send can just send on the recvfrom
  :                            444 . addresses as if it had connected
  :                            445 
  :                            446 . since the routing call finds the next hop
  :                            447 . as well as the interface, that information
  :                            448 . stays in the address buffer of the datagram
  :                            449 . and IP routing will not need to find the
  :                            450 . next hop again for this one datagram
  :                            451 
  :                            452 . for connect/send the next-hop isn't saved,
  :                            453 . because it might change. But the interface
  :                            454 . is saved
  :                            455 
  :                            456 
  :                            457 
  :                            458 udp_txaw
00:0023E0 58A004              +459 	ly	descriptor:dgram, x
00:0023E1 4FB006              +460 	ql	dgram:ipsource, y
00:0023E2 7C0408              +461 	jdz	udp_nosource
00:0023E3 D70006              +462 	da	6			. destination network
00:0023E4 C70008              +463 	ds	8
00:0023E5 18000B              +464 	sy	11			. IP datagram pointer
00:0023E6 58A005              +465 	ly	descriptor:uproto, x
00:0023E7 60A003              +466 	la	descriptor:bytes, x
  :                            467 
00:0023E8 680004              +468 	lb	a			. payload length no flag for checksum algo
00:0023E9 A80F95              +469 	andB	(07FFFFF)
00:0023EA 400005              +470 	lr	b
  :                            471 
00:0023EB 64C008              +472 	la	8, a, i			. add UDP header length to payload length
00:0023EC 20A003              +473 	sa	descriptor:bytes, x	. byte count -> descriptor
00:0023ED A00F95              +474 	and	(07FFFFF)		. remove keep flag if any
00:0023EE 20B002              +475 	sa	uugram:udgraml, y	. length -> user datagram header
  :                            476 
  :                            477 .	sa	descriptor:bytes, x	. byte count to... aintcha jerst done that?
  :                            478 					. dont do it again with the sticky bit switched off
  :                            479 
00:0023EF 18000A              +480 	sy	10			. uugram pointer
00:0023F0 6D0011              +481 	lb, xi	IPPROTO_UDP
00:0023F1 C80004              +482 	ab	a			. length counts twice, of itself and as a header word
00:0023F2 D7B000              +483 	da	0, y			. ports from to
00:0023F3 D70008              +484 	da	8
00:0023F4 3E04C9              +485 	lcal	udp_check_payload_tx
00:0023F5 68000A              +486 	lb	10
00:0023F6 20D003              +487 	sa	uugram:checksum, b
00:0023F7 58000B              +488 	ly	11
  :                            489 
00:0023F8 B60403              +490 	j	udp_ip_send
  :                            491 
  :                            492 udp_txaw_nocheck
00:0023F9 58A004              +493 	ly	descriptor:dgram, x
00:0023FA 4FB006              +494 	ql	dgram:ipsource, y
00:0023FB 7C0408              +495 	jdz	udp_nosource
00:0023FC 68A005              +496 	lb	descriptor:uproto, x
00:0023FD 60A003              +497 	la	descriptor:bytes, x
00:0023FE 64C008              +498 	la	8, a, i			. add udp header length
00:0023FF 20A003              +499 	sa	descriptor:bytes, x
00:002400 A00F95              +500 	and	(07FFFFF)		. unlikely you want a sticky bit
  :                            501 					. on a datagram you didn't want checked
  :                            502 					. but no harm making sure
00:002401 20D002              +503 	sa	uugram:udgraml, b
00:002402 30D003              +504 	z	uugram:checksum, b
  :                            505 
  :                            506 udp_ip_send
00:002403 FD0001              +507 	MIB_ICOUNT48	udpOutDatagrams:i
(+01)0f
00:002404 2F057E              +507 
00:002405 5E0407              +507 
(+01)0f
00:002406 17057D              +507 
  :                            508 
00:002407 B6013B              +509 	j	ip_send			. hand IP the datagram address in Y
  :                            510 
  :                            511 udp_nosource
00:002408 65FFD9              +512 	la, xi	-UDP_NOSOURCENET
00:002409 3D0000              +513 	fret	0
  :                            514 
  :                            515 
  :                            516 					. vector udp_rtxbuffer gets here
  :                            517 udp_response_buffer			. ultra primitive call interface
  :                            518 					. the input axw is in B
  :                            519 					. the buffer byte size request
  :                            520 					. is in A
  :                            521 
  :                            522 					. socket option DNF is in K
  :                            523 
00:00240A F80005              +524 	push	b			. you need that back after
00:00240B FF0F96              +525 	call	(udp_txbuffer)		. the buffer request
00:00240C 380002              +526 	pop	x
00:00240D C60418              +527 	jza	udp_noresponseb
  :                            528 					. the new buffer descriptor
  :                            529 					. is in A
  :                            530 					. the application buffer
  :                            531 					. pointer is in B
00:00240E 58A005              +532 	ly	axw:uproto, x
00:00240F 9FB000              +533 	dpush	uugram:sourcep, y
00:002410 58C005              +534 	ly	axw:uproto, a
00:002411 38B001              +535 	pop	uugram:destp, y
00:002412 38B000              +536 	pop	uugram:sourcep, y
  :                            537 
00:002413 58A004              +538 	ly	axw:dgram, x
00:002414 9FB006              +539 	dpush	dgram:ipsource, y
00:002415 9FB008              +540 	dpush	dgram:ipdest, y
00:002416 58C004              +541 	ly	axw:dgram, a
00:002417 87B006              +542 	qpop	dgram:ipsource, y
  :                            543 
  :                            544 .	push	axw:i_f, x
  :                            545 .	pop	axw:i_f, a
  :                            546 
  :                            547 udp_noresponseb
00:002418 3D0000              +548 	fret	0
  :                            549 
  :                            550 check8in* $proc
  :                            551 	qpush	?*4-4, y
  :                            552 	da	0, sp
  :                            553 	da	2, sp
  :                            554 	qpop	?*4-4, x
  :                            555 	$end
  :                            556 
  :                            557 HEADER_SUM $equ	6
  :                            558 
  :                            559 tx_payload
  :                            560 rx_payload
00:002419 160006              +561 	dsr	6
00:00241A 400004              +562 	lr	a
00:00241B 360003              +563 	dsl	3
00:00241C A50007              +564 	and, xi	7
00:00241D 9F0004              +565 	dpush	a
00:00241E CF0006              +566 	dl	HEADER_SUM
00:00241F B60445              +567 	j	rxcheck64?
  :                            568 rxcheck64!
00:002420 8FB000              +569 ?	$do	8,	check8in
00:002421 D7F000              +569 
00:002422 D7F002              +569 
00:002423 87A000              +569 
00:002424 8FB004              +569 
00:002425 D7F000              +569 
00:002426 D7F002              +569 
00:002427 87A004              +569 
00:002428 8FB008              +569 
00:002429 D7F000              +569 
00:00242A D7F002              +569 
00:00242B 87A008              +569 
00:00242C 8FB00C              +569 
00:00242D D7F000              +569 
00:00242E D7F002              +569 
00:00242F 87A00C              +569 
00:002430 8FB010              +569 
00:002431 D7F000              +569 
00:002432 D7F002              +569 
00:002433 87A010              +569 
00:002434 8FB014              +569 
00:002435 D7F000              +569 
00:002436 D7F002              +569 
00:002437 87A014              +569 
00:002438 8FB018              +569 
00:002439 D7F000              +569 
00:00243A D7F002              +569 
00:00243B 87A018              +569 
00:00243C 8FB01C              +569 
00:00243D D7F000              +569 
00:00243E D7F002              +569 
00:00243F 87A01C              +569 
00:002440 850020              +570 	ax, xi	32
00:002441 8D0020              +571 	ay, xi	32
00:002442 C00005              +572 	aa	b
00:002443 160010              +573 	dsr	16
00:002444 0E0008              +574 	sbr	8
  :                            575 rxcheck64?
00:002445 1E0420              +576 	jdr	rxcheck64!
00:002446 380000              +577 	pop	r
00:002447 B6044E              +578 	j	rxcheck8?
  :                            579 rxcheck8!
00:002448 8FB000              +580 	qpush	0, y
00:002449 D7F000              +581 	da	0, sp
00:00244A D7F002              +582 	da	2, sp
00:00244B 87A000              +583 	qpop	0, x
00:00244C 850004              +584 	ax, xi	4
00:00244D 8D0004              +585 	ay, xi	4
  :                            586 rxcheck8?
00:00244E 1E0448              +587 	jdr	rxcheck8!
  :                            588 
00:00244F 3FF000              +589 	slc	0, sp
00:002450 5E0457              +590 	jnc	rnowordpair
00:002451 9FB000              +591 	dpush	0, y
00:002452 D7F000              +592 	da	0, sp
  :                            593 
00:002453 38A000              +594 	dpop	0, x
00:002454 38A001              +594 
00:002455 850002              +595 	ax	2,,xi
00:002456 8D0002              +596 	ay	2,,xi
  :                            597 
  :                            598 rnowordpair
00:002457 C70006              +599 	ds	6
00:002458 380004              +600 	pop	a		. that should leave a return address
  :                            601 				. next on the stack
00:002459 16002E              +602 	dsr	24+22		. any 1, 2 or 3 bytes ?
  :                            603 
00:00245A CE0460              +604 	jzb	rnolastbytes
00:00245B 40DF8F              +605 	lr	(0, 32, 16, 8q), b
00:00245C CFB000              +606 	dl	0, y
00:00245D 168000              +607 	dsr	*r
00:00245E 368000              +608 	dsl	*r
00:00245F C7A000              +609 	ds	0, x
  :                            610 rnolastbytes
00:002460 D70006              +611 	da	6
00:002461 C70006              +612 	ds	6
00:002462 3E026E              +613 	lcal	check_complete
  :                            614 
00:002463 600005              +615 	la	b
  :                            616 
00:002464 350000              +617 	lret	0
  :                            618 
  :                            619 udp_tx_payload
  :                            620 udp_rx_payload
00:002465 3E0419              +621 	lcal	tx_payload
00:002466 D60468              +622 	jnza	$+2
00:002467 B00F8E              +623 	xor	(00FFFF)
00:002468 350000              +624 	lret	0
  :                            625 
  :                            626 in8nocheck* $proc
  :                            627 	qpush	?*4-4, y
  :                            628 	qpop	?*4-4, x
  :                            629 	$end
  :                            630 
  :                            631 tx_nocheck
  :                            632 rx_nocheck
00:002469 160006              +633 	dsr	6
00:00246A 400004              +634 	lr	a	
00:00246B 360003              +635 	dsl	3
00:00246C A50007              +636 	and, xi	7
00:00246D B60480              +637 	j	rx64?
  :                            638 rx64!
00:00246E 8FB000              +639 ?	$do	8,	in8nocheck
00:00246F 87A000              +639 
00:002470 8FB004              +639 
00:002471 87A004              +639 
00:002472 8FB008              +639 
00:002473 87A008              +639 
00:002474 8FB00C              +639 
00:002475 87A00C              +639 
00:002476 8FB010              +639 
00:002477 87A010              +639 
00:002478 8FB014              +639 
00:002479 87A014              +639 
00:00247A 8FB018              +639 
00:00247B 87A018              +639 
00:00247C 8FB01C              +639 
00:00247D 87A01C              +639 
00:00247E 850020              +640 	ax, xi	32
00:00247F 8D0020              +641 	ay, xi	32
00:002480 1E046E              +642 rx64?	jdr	rx64!
00:002481 400004              +643 	lr	a
00:002482 B60487              +644 	j	rx8?
00:002483 8FB000              +645 rx8!	qpush	0, y
00:002484 87A000              +646 	qpop	0, x
00:002485 850004              +647 	ax, xi	4
00:002486 8D0004              +648 	ay, xi	4
00:002487 1E0483              +649 rx8?	jdr	rx8!
00:002488 360002              +650 	dsl	2
00:002489 A50003              +651 	and, xi	3
00:00248A 400004              +652 	lr	a
00:00248B B60490              +653 	j	rx2?
00:00248C F8B000              +654 rx2!	push	0, y
00:00248D 38A000              +655 	pop	0, x
00:00248E 850001              +656 	ax, xi	1
00:00248F 8D0001              +657 	ay, xi	1
00:002490 1E048C              +658 rx2?	jdr	rx2!
00:002491 AE0495              +659 	jpb	rxnocheckZ
00:002492 60B000              +660 	la	0, y
00:002493 A00F97              +661 	and	(00FF00)
00:002494 20A000              +662 	sa	0, x
  :                            663 rxnocheckZ
00:002495 350000              +664 	lret	0
  :                            665 
  :                            666 
  :                            667 check_payload_tx
00:002496 58A006              +668 	ly	descriptor:apdata, x
  :                            669 check_payload
00:002497 C70008              +670 	ds	8
  :                            671 
00:002498 600000              +672 	la	r
00:002499 160006              +673 	dsr	6
00:00249A 400004              +674 	lr	a
00:00249B 650000              +675 	la, xi	0
00:00249C 360004              +676 	dsl	4
00:00249D 9F0004              +677 	dpush	a
  :                            678 
00:00249E CF0008              +679 	dl	8
00:00249F B604B4              +680 	j	txsum64?	. sum any blocks of 64 bytes
  :                            681 
  :                            682 txsum64!
                                ?	$do	16,	;
00:0024A0 D7B000              +684 	da	?*2-2, y
00:0024A1 D7B002              +684 
00:0024A2 D7B004              +684 
00:0024A3 D7B006              +684 
00:0024A4 D7B008              +684 
00:0024A5 D7B00A              +684 
00:0024A6 D7B00C              +684 
00:0024A7 D7B00E              +684 
00:0024A8 D7B010              +684 
00:0024A9 D7B012              +684 
00:0024AA D7B014              +684 
00:0024AB D7B016              +684 
00:0024AC D7B018              +684 
00:0024AD D7B01A              +684 
00:0024AE D7B01C              +684 
00:0024AF D7B01E              +684 
  :                            685 
00:0024B0 8D0020              +686 	ay, xi	32
00:0024B1 C00005              +687 	aa	b		. fold the sum down
00:0024B2 160010              +688 	dsr	16		. otherwise overflow becomes
00:0024B3 0E0008              +689 	sbr	8		. possible after about 1K bytes
  :                            690 
  :                            691 txsum64?
00:0024B4 1E04A0              +692 	jdr	txsum64!
  :                            693 
00:0024B5 380000              +694 	pop	r
00:0024B6 B604B9              +695 	j	txsum4?		. sum any blocks of 4 bytes
  :                            696 txsum4!
00:0024B7 D7B000              +697 	da	0, y
00:0024B8 8D0002              +698 	ay, xi	2
  :                            699 txsum4?
00:0024B9 1E04B7              +700 	jdr	txsum4!
  :                            701 
00:0024BA C00005              +702 	aa	b
00:0024BB 380005              +703 	pop	b
  :                            704 
00:0024BC AE04BF              +705 	jpb	txsum1?
00:0024BD C0B000              +706 	aa	0, y		. sum a remaining byte pair
00:0024BE 8D0001              +707 	ay, xi	1
  :                            708 txsum1?
00:0024BF 6E0001              +709 	rbl	1
00:0024C0 AE04C4              +710 	jpb	txsumz
00:0024C1 68B000              +711 	lb	0, y		. sum a remaining byte
00:0024C2 A80F97              +712 	andB	(00FF00)
  :                            713 txsumx
00:0024C3 C00005              +714 	aa	b
  :                            715 txsumz
00:0024C4 160010              +716 	dsr	16
00:0024C5 0E0008              +717 	sbr	8
00:0024C6 D604C3              +718 	jnza	txsumx
00:0024C7 600005              +719 	la	b
00:0024C8 350000              +720 	lret	0
  :                            721 
  :                            722 udp_check_payload_tx
00:0024C9 3E0496              +723 	lcal	check_payload_tx
00:0024CA B00F8E              +724 	xor	(00FFFF)
00:0024CB C604CA              +725 	jza	$-1
00:0024CC 350000              +726 	lret	0
  :                            727 
  :                            728 
  :                            729 .	atomic reads and writes of buffer queues shared between the IP task
  :                            730 .	and socket users
  :                            731 
  :                            732 .	the lock cells are in the socket structures, because not all queues need them
  :                            733 
  :                            734 .	some socket users are application protocols in the IP task and some are
  :                            735 .	different tasks
  :                            736 
  :                            737 .	udp_write_rxq is called from udp in the IP task
  :                            738 .	the socket structure is in x
  :                            739 
  :                            740 udp_write_rxq
00:0024CD 3E0EA1              +741 	lcal	readq
00:0024CE C604D8              +742 	jza	udp_noqdata
  :                            743 
00:0024CF FD0007              +744 	LOCK	s:udp:tsq, x
00:0024D0 27F000              +744 
00:0024D1 07A005              +744 
00:0024D2 B604D1              +744 
00:0024D3 5CA006              +745 	ly, i	s:udp:socket_inq, x
00:0024D4 3E0E96              +746 	lcal	q2
00:0024D5 30A005              +747 	FREE	s:udp:tsq, x
00:0024D6 27F000              +747 
00:0024D7 17000F              +747 
  :                            748 
  :                            749 udp_noqdata
00:0024D8 350000              +750 	lret	0
  :                            751 
  :                            752 
  :                            753 .	udp_read_rxq is called by the socket user which may be a server protocol
  :                            754 .	in the IP task or it may be another task
  :                            755 
  :                            756 .	again, the socket structure pointer is in x
  :                            757 
  :                            758 udp_read_rxq
00:0024D9 FD0007              +759 	push,xi	NETMASK_ABSOLUTE
00:0024DA 27F000              +760 	sim	0, sp
00:0024DB 07A005              +761 	ts	s:udp:tsq, x
00:0024DC B604DB              +762 	j	$-1
00:0024DD 5CA006              +763 	ly, i	s:udp:socket_inq, x
00:0024DE 3E0EA1              +764 	lcal	readq
00:0024DF 30A005              +765 	z	s:udp:tsq, x
00:0024E0 27F000              +766 	sim	0, sp
00:0024E1 17000F              +767 	inc	sp
00:0024E2 350000              +768 	lret	0
  :                            769 
  :                            770 
  :                            771 .	it's been decided that
  :                            772 
  :                            773 
  :                            774 .	inward traffic will always be in rx_buffers
  :                            775 .	traffic on loopback will just be copied
  :                            776 
  :                            777 udp_drop_dgram
  :                            778 	$if	RX_FRAGMENTS
  :                            779 	LOCK	s:udp:tsq, x
  :                            780 	ly, i	s:udp:socket_inq, x
  :                            781 	lcal	net_drop
  :                            782 	FREE	s:udp:tsq, x
  :                            783 	fret	0
  :                            784 	$else
00:0024E3 3E04D9              +785 	lcal	udp_read_rxq
00:0024E4 3E00C9              +786 	lcal	net_free
00:0024E5 3D0000              +787 	fret	0
  :                            788 	$endif
  :                            789 
  :                            790 udp_socket
  :                            791 	$if	1
  :                            792 
00:0024E6 F80002              +793 	push	x
00:0024E7 552080              +794 	lx	usockb(1),,xi
00:0024E8 3E0A14              +795 	lcal	protocol_socket
00:0024E9 380002              +796 	pop	x
  :                            797 
  :                            798 	$else
  :                            799 
  :                            800         lb, i   BSOCKET*/9      .       | 000 000 000 101 111 000 000 000 |
  :                            801         dsr     9               .       | sss sss sss 000 000 000 101 111 |
  :                            802         and, xi 127
  :                            803         aa, xi  usockb(1)
  :                            804         la      0, a
  :                            805 	rbr	12
  :                            806 	
  :                            807 	$endif
  :                            808 
00:0024EA C604EC              +809         jza     udp_socketx
00:0024EB 34002F              +810         sabr    BSOCKET
  :                            811 
  :                            812 .	la      s:socket_address+1, b	. socket storage page is there
  :                            813 .	and     (65535)			. is it bound? Let the caller ask
  :                            814 udp_socketx
00:0024EC 350000              +815 	lret	0
  :                            816 
  :                            817 
  :                            86 .	$include	udp_send
  :                            87: 	$include	anomaly
  :                            1 TCP_SEEK_ANOMALY	$equ	0	. turn this on for example if remote TCP
  :                            2 					. is receiving impossible ACK pointers
  :                            3 	$if	TCP_SEEK_ANOMALY
  :                            4 tcp_seek_anomaly
  :                            5 	qpush	x
  :                            6 	la	x
  :                            7 	sar	18
  :                            8 	aa	-BSOCKET,,xi		. is that like a connection pointer?
  :                            9 	jnza	tcp_no_socket_address	. no this value certainly is not
  :                            10 	dl	transmission:ack_window	. is the cached ACK value real?
  :                            11 	dsr	8
  :                            12 	sbr	8
  :                            13 	dan	10
  :                            14 	andB	-4,,xi
  :                            15 	jdz	tcp_anomaly_clear	. near enough
  :                            16 
  :                            17 tcp_no_socket_address
  :                            18 tcp_ack_overwritten
  :                            19 	ii	GUARD$			. update calling code
  :                            20 
  :                            21 tcp_anomaly_clear
  :                            22 	qpop	x	
  :                            23 	lret	0
  :                            24 	$endif
  :                            88: 	$include	tcp
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 
  :                            41 SOCKET_LPOINTER	$equ	d$save2		. and d$save3, but only for 10 instructions
  :                            42 . TX_DATAGRAM	$equ	d$save3
  :                            43 AP_DATA		$equ	HEADER_LONGWORDS
  :                            44 RX_APDATA	$equ	AP_DATA
  :                            45 HL_FLAGS	$equ	SOCKET_CALL_FLAGS
  :                            46 TPAYLOAD_BYTES	$equ	d$save2
  :                            47 
  :                            48 MSS		$equ	26
  :                            49 					. if a TX reset follows RX segment
  :                            50 
  :                            51 $(67::,y)
43:000000                     +52 tlist	tbank
43:000001                     +52 
43:000002                     +52 
43:000003                     +52 
43:000004                     +52 
43:000005                     +52 
43:000006                     +52 
43:000007                     +52 
43:000008                     +52 
43:000009                     +52 
43:00000A                     +52 
43:00000B                     +52 
43:00000C                     +52 
43:00000D                     +52 
43:00000E                     +52 
43:00000F                     +52 
43:000010                     +52 
43:000011                     +52 
43:000012                     +52 
43:000013                     +52 
43:000014                     +52 
43:000015                     +52 
43:000016                     +52 
43:000017                     +52 
43:000018                     +52 
43:000019                     +52 
43:00001A                     +52 
43:00001B                     +52 
43:00001C                     +52 
43:00001D                     +52 
43:00001E                     +52 
43:00001F                     +52 
43:000020                     +52 
43:000021                     +52 
43:000022                     +52 
43:000023                     +52 
43:000024                     +52 
43:000025                     +52 
43:000026                     +52 
43:000027                     +52 
43:000028                     +52 
43:000029                     +52 
43:00002A                     +52 
43:00002B                     +52 
43:00002C                     +52 
43:00002D                     +52 
43:00002E                     +52 
43:000030                     +52 
43:000032                     +52 
43:000034                     +52 
43:000036                     +52 
43:000038                     +52 
43:000039                     +52 
43:00003A                     +52 
43:00003B                     +52 
43:00003C                     +52 
43:00003D                     +52 
43:00003E                     +52 
43:00003F                     +52 
43:000040                     +52 
43:000041                     +52 
43:000042                     +52 
43:000043                     +52 
43:000044                     +52 
43:000045                     +52 
43:000046                     +52 
43:000048                     +52 
43:00004A                     +52 
43:00004C                     +52 
43:00004E                     +52 
43:000050                     +52 
43:000051                     +52 
43:000052                     +52 
43:000053                     +52 
43:000054                     +52 
43:000055                     +52 
43:000056                     +52 
43:000057                     +52 
  :                            53 
  :                            54 $(70::,x)
46:000000                     +55 transmission	tcp_connection
46:000001                     +55 
46:000002                     +55 
46:000003                     +55 
46:000004                     +55 
46:000005                     +55 
46:000006                     +55 
46:000008                     +55 
46:00000A                     +55 
46:00000C                     +55 
46:00000E                     +55 
46:000010                     +55 
46:000011                     +55 
46:000012                     +55 
46:000013                     +55 
46:000014                     +55 
46:000015                     +55 
46:000016                     +55 
46:000017                     +55 
  :                            56 $(66::,x)
42:000000                     +57 transfer	segment
42:000001                     +57 
42:000002                     +57 
42:000004                     +57 
42:000006                     +57 
42:000007                     +57 
42:000008                     +57 
42:000009                     +57 
42:00000A                     +57 
  :                            58 
  :                            59 $(1)
  :                            60 
  :                            61 	$if	TCP_NOQ
  :                            62 	$else
  :                            63 tcpq	dq
  :                            64 	$endif
  :                            65 
01:00040E 0006E9              +66 tcp_lsegment_noport + tcp_reset_deflect	. default vector RX large segment no port bound:
  :                            67 					. TCP_RST without preliminary checksum. Avoids
  :                            68 					. expensive input-completion / buffering / repooling
  :                            69 
  :                            70 					. can be changed administratively either to silent drop
  :                            71 					. or even to full checksum to choose whether
  :                            72 					. RST + discard or silent discard
  :                            73 
01:00040F 000000              +74 tcp_2nd_list	0			. next candidate list for state service
01:000410 000000              +75 tcp_states_beat	0
01:000411 000000              +76 tcp_superpages	0
01:000412 000000              +77 tcp_supercount	0
  :                            78 
  :                            79 $(0)
  :                            80 
  :                            81 tcp_states_step
00:0024ED 65000A              +82 	la	TCP_STATES_BEAT,,xi
00:0024EE C00097              +83 	aa	DAYCLOCK$
(+01)0f
00:0024EF 200410              +84 	sa	tcp_states_beat
00:0024F0 350000              +85 	lret	0
  :                            86 
00:0024F1 600097              +87 xtcp4	la	DAYCLOCK$
(+01)0f
00:0024F2 D00410              +88 	ana	tcp_states_beat
00:0024F3 E60508              +89 	jna	tcp4x
00:0024F4 3E04ED              +90 	lcal	tcp_states_step
  :                            91 
  :                            92 	$if	TCP_NOQ			. HVSOCKET needs it done this way
  :                            93 	$else
  :                            94 
  :                            95 tcp4	la	tcpq.head
  :                            96 	jza	tcp4_high_volume
  :                            97 	lcal	tcp4_rxaction		. requeues payload to target connection
  :                            98 	j	tcp4
  :                            99 
  :                            100 	$endif
  :                            101 
  :                            102 tcp4_high_volume
  :                            103 
  :                            104 tcp4_routine				. walk and maintain all connections
  :                            105 
  :                            106 					. default connections bank is serviced
  :                            107 					. first and separately
  :                            108 
00:0024F5 602185              +109 	la	tcx_v4(1)
  :                            110 
  :                            111 tcp4_service
00:0024F6 3E0509              +112 	lcal	tcp4_service_connection_list	. service the default list
  :                            113 
  :                            114 	$if	HVSOCKET
  :                            115 	$if	1
(+01)0f
00:0024F7 60040F              +116 	la	tcp_2nd_list
00:0024F8 D604FE              +117 	jnza	tcp_service_2nd_list
00:0024F9 608F98              +118 	la	*(BSOCKET*/12++tlist:link)	. tcx_v4(1) is based here
  :                            119 
(+01)0f
00:0024FA 680412              +120 	lb	tcp_supercount			. abstract the count_up
(+01)0f
00:0024FB 280411              +121 	sb	tcp_superpages			
(+01)0f
00:0024FC 300412              +122 	z	tcp_supercount			. and restart it
  :                            123 	
00:0024FD C60508              +124 	jza	tcp_no_2nd_list			. there is only tcx_v4(1)
  :                            125 
  :                            126 tcp_service_2nd_list
(+01)0f
00:0024FE 170412              +127 	inc	tcp_supercount
00:0024FF 3E0509              +128 	lcal	tcp4_service_connection_list	. service up to 1 hvlist
00:002500 A70004              +129 	lsc	a				. calculate log of # established
00:002501 650018              +130 	la	24,,xi
00:002502 D00005              +131 	ana	b
00:002503 680F82              +132 	lb	(BSOCKET*/18s)
00:002504 20D02D              +133 	sa	tlist:connection_block(1):timer(2), b
00:002505 60D000              +134 	la	tlist:link, b			. next hvlist next pass
(+01)0f
00:002506 20040F              +135 	sa	tcp_2nd_list
00:002507 B60508              +136 	j	tcp4x
  :                            137 			
  :                            138 tcp_no_2nd_list
  :                            139 	$else
  :                            140 	la	*(BSOCKET*/12++tlist:link)
  :                            141 	jnza	tcp4_service
  :                            142 	$endif
  :                            143 	$endif
  :                            144 
00:002508 350000              +145 tcp4x	lret	0
  :                            146 
  :                            147 tcp4_service_connection_list
                                	$head_near	scalars(established_count,	int	;
00:002509 FD0000              +149 				save_chain_pointer,	int	)
00:00250A FD0000              +149 
  :                            150 
00:00250B 34002F              +151 	sabr	BSOCKET
00:00250C 500F99              +152 	lx	(BSOCKET*/12++tlist:chain(1))
  :                            153 tcp4_process_list
00:00250D 10F000              +154 	sx	save_chain_pointer
00:00250E B6054C              +155 	j	tcp4_locate_next_connection
  :                            156 
  :                            157 tcp4_service_next_connection
  :                            158 
00:00250F 60A001              +159 	la	transmission:state
00:002510 E60530              +160 	jna	tcp4_globaltime!
  :                            161 
  :                            162 .	and, xi	63
  :                            163 	
  :                            164 
00:002511 680004              +165 	anu, xi	TCP_ESTABLISHED
00:002512 DD0005              +165 
00:002513 CE0516              +166 	jzb	tcp4_established!
00:002514 CDFFFD              +167 	ab, xi	TCP_ESTABLISHED-TCP_CLOSEWAIT
00:002515 DE0521              +168 	jnzb	tcp4_synreceived?
  :                            169 
  :                            170 				. closewait
  :                            171 tcp4_established!
  :                            172 	$if	1
00:002516 70A014              +173 	tz	transmission:q4window
00:002517 3E0737              +174 	lcal	tcp_send_on_window
  :                            175 	$endif
  :                            176 
00:002518 17F001              +177 	inc	established_count
  :                            178 
  :                            179 .	la	transmission:q4ack:head
  :                            180 .	jza	tcp4_new_traffic?	. (tcp4_globaltime?)
  :                            181 
  :                            182 .	lcal	tcp4_outstanding
  :                            183 
00:002519 600097              +184 	la	DAYCLOCK$
00:00251A D0A005              +185 	ana	transmission:timer(2)
00:00251B E6051E              +186 	jna	tcp4_new_traffic?	. (tcp4_globaltime?)
  :                            187 					. the top bit of the result
  :                            188 					. is reliable
  :                            189 .	tz	transmission:q4ack:head
  :                            190 .	lcal	tcp4_outstanding
00:00251C 70A016              +191 	tz	transmission:q4ack:head
00:00251D 3E057E              +192 	lcal	tcp4_retransmit1
  :                            193 .	lcal	tcp_restart_timer2	. inside retransmit1
  :                            194 
  :                            195 tcp4_new_traffic?
  :                            196 	$if	1
00:00251E 70A014              +197 	tz	transmission:q4window
00:00251F 3E0737              +198 	lcal	tcp_send_on_window
  :                            199 	$endif
  :                            200 
00:002520 B60532              +201 	j	tcp4_globaltime?
  :                            202 
  :                            203 tcp4_synreceived?
00:002521 680004              +204 	anu, xi	TCP_SYNRECEIVED
00:002522 DD0004              +204 
00:002523 DE052C              +205 	jnzb	tcp4_synsent?
  :                            206 
  :                            207 tcp4_most_states
00:002524 70A014              +208 	tz	transmission:q4window
00:002525 3E0737              +209 	lcal	tcp_send_on_window
  :                            210 
  :                            211 .	lcal	tcp4_outstanding	. drops the ACKed segments
  :                            212 
00:002526 600097              +213 	la	DAYCLOCK$
00:002527 D0A005              +214 	ana	transmission:timer(2)
00:002528 E60532              +215 	jna	tcp4_globaltime?
  :                            216 
  :                            217 	$if	1			. adult time now!
  :                            218 .	tz	transmission:q4ack:head	. a local socket replied?
  :                            219 .	lcal	tcp4_outstanding
00:002529 70A016              +220 	tz	transmission:q4ack:head
00:00252A 3E057E              +221 	lcal	tcp4_retransmit1	. resend if so
  :                            222 .	lcal	tcp_restart_timer2	. inside retransmit1
  :                            223 
  :                            224 	$else
  :                            225 
  :                            226 	lcal	tcp_restart_timer2
  :                            227 	call	(tcp_accept)
  :                            228 	j	tcp4_globaltime?	. there are 2 comebacks from accept
  :                            229 
  :                            230 	$endif
  :                            231 
00:00252B B60532              +232 	j	tcp4_globaltime?
  :                            233 
  :                            234 tcp4_synsent?
00:00252C 680004              +235 	anu	TCP_SYNSENT,,xi
00:00252D DD0003              +235 
00:00252E CE0524              +236 	jzb	tcp4_most_states
00:00252F B60539              +237 	j	tcp4_state?
  :                            238 
  :                            239 tcp4_globaltime!
00:002530 0FA001              +240 	n	transmission:state	. socket owner reversed state
00:002531 B60536              +241 	j	tcp4_mark_time		. to command relinquish
  :                            242 
  :                            243 tcp4_globaltime?
00:002532 60A004              +244 	la	transmission:timer(1)
00:002533 C6054C              +245 	jza	tcp4_locate_next_connection
  :                            246 
00:002534 D00097              +247 	ana	DAYCLOCK$
00:002535 A6054C              +248 	jpa	tcp4_locate_next_connection
  :                            249 
  :                            250 tcp4_mark_time
00:002536 3E08C5              +251 	lcal	tcp_restart_timer1	. don't repeat the same timeout
  :                            252 					. during final state transitions
  :                            253 
  :                            254 		. an inactivity timeout is not part of TCP protocol except
  :                            255 		. in state TCP_TIMEWAIT during outgoing close.
  :                            256 		. However t77.4 provides inactivity timeout as an optional
  :                            257 		. socket service in states
  :                            258 
  :                            259 		.	TCP_ESTABLISHED
  :                            260 		.	TCP_FINWAIT2
  :                            261 		.	TCP_CLOSEWAIT
  :                            262 
  :                            263 		. because many application protocols use an inactivity timeout.
  :                            264 		. The timeout is signalled upwards by connection state change
  :                            265 		.
  :                            266 
  :                            267 		. The timeout is not active if connection:timer(1) is zero
  :                            268 
00:002537 FF0F9A              +269 	call	(xdisco)
  :                            270 
00:002538 B6054C              +271 	j	tcp4_locate_next_connection
  :                            272 
  :                            273 tcp4_state?
  :                            274 tcp4_closed?
00:002539 680004              +275 	anu, xi	TCP_CLOSED
00:00253A DD0001              +275 
00:00253B CE053F              +276 	jzb	tcp4_free_block
00:00253C 680004              +277 	anu, xi	TCP_DELETETCB
00:00253D DD000C              +277 
00:00253E DE0532              +278 	jnzb	tcp4_globaltime?
  :                            279 	
  :                            280 tcp4_free_block
  :                            281 
00:00253F FD0002              +282 	push	TCP_LISTEN,,xi			. use this state nowhere else
00:002540 38A001              +283 	pop	transmission:state		. on a transmission block
  :                            284 
00:002541 3E05A3              +285 	lcal	tcp_free_rxtx			. free all buffers attached
  :                            286 
00:002542 68A000              +287 	lb	transmission:next, x		. out of traffic chain
00:002543 28B000              +288 	sb	transmission:next, y
00:002544 F88F9B              +289 	push	*(BSOCKET*/12++tlist:free)
00:002545 38A000              +290 	pop	0, x				. into free chain
00:002546 108F9B              +291 	sx	*(BSOCKET*/12++tlist:free)
  :                            292 
  :                            293 	$if	HVSOCKET
00:002547 788F9C              +294 	tp	*(BSOCKET*/12++tlist:flags)
00:002548 B6054A              +295 	j	tcp4_free_no_mib_line
  :                            296 	$endif
  :                            297 
00:002549 FF0F9D              +298 	call	(tcp_agent_free)
  :                            299 
  :                            300 tcp4_free_no_mib_line
00:00254A 500005              +301 	lx	b
00:00254B B6054E              +302 	j	tcp4_located_next_connection
  :                            303 
  :                            304 tcp4_locate_next_connection
00:00254C 580002              +305 	ly	x
00:00254D 50A000              +306 	lx	0, x
  :                            307 tcp4_located_next_connection
00:00254E 700002              +308 	tz	x
00:00254F B6050F              +309 	j	tcp4_service_next_connection
00:002550 50F000              +310 	lx	save_chain_pointer
00:002551 850001              +311 	ax, xi	1
  :                            312 
  :                            313 .	$do	tlist:chain()<32,	$flag	connections bank insufficient chain head space
00:002552 400F9E              +314 	lr	(BSOCKET*/12++tlist:chain(CHAINS)+1)
00:002553 F60555              +315 	jxge	tcp4_list_processed
00:002554 B6050D              +316 	j	tcp4_process_list
  :                            317 
  :                            318 tcp4_list_processed
00:002555 380004              +319 	pop	a		. discard save_chain_pointer
00:002556 380004              +320 	pop	a		. return established + closewait
00:002557 350000              +321 	lret	0
  :                            322 
  :                            323 tcp4_outstanding
                                	$head_near	 params(tra_remote_ack,	long)			;
                                									;
                                			scalars(transmission_p,	int,	x		;
                                				transfer_fp,	int,	fp		;
00:002558 F80002              +328 				proto_apdata,	long,	RX_APDATA	)
00:002559 F8000E              +328 
00:00255A 9F0010              +328 
  :                            329 
  :                            330 tcp4_outstanding_next
00:00255B 60A016              +331 	la	transmission:q4ack:head
00:00255C C60579              +332 	jza	tcp4_outstanding_later
00:00255D 50C001              +333 	lx	descriptor:frame, a
  :                            334 
  :                            335 	$if	1
00:00255E 78A00D              +336 	tp	nframe:stack_index, x	. is it on an interface output queue?
00:00255F B60579              +337 	j	tcp4_outstanding_later	. wait until it is not
  :                            338 	$endif
  :                            339 
  :                            340 	$if	1			. because pointer apdata is repurposed
  :                            341 					. for some transmitted segments
00:002560 50C005              +342 	lx	descriptor:uproto, a	. calculation uses header longwords quartet
00:002561 580004              +343 	ly	a
00:002562 60A006              +344 	la	transfer:hl_code
00:002563 16000C              +345 	dsr	12
00:002564 260002              +346 	sal	2			. bytes <- netlongs
00:002565 0E000C              +347 	sbr	12
00:002566 AD0003              +348 	andB	TCP_SYN++TCP_FIN,,xi
00:002567 CE0569              +349 	jzb	tcp4_flags_weighed	. no SYN no FIN weighs nothing
00:002568 6D0001              +350 	lb	1,,xi			. SYN or FIN weighs 1 byte
  :                            351 
  :                            352 tcp4_flags_weighed
00:002569 D80004              +353 	anb	a			. minus header length
00:00256A C8B003              +354 	ab	descriptor:bytes, y
  :                            355 
  :                            356 	$else
  :                            357 
  :                            358 	lb	descriptor:uproto, a
  :                            359 	lx	b
  :                            360 	anb	descriptor:apdata, a	. generate minus header length
  :                            361 	sbl	1			. byte-pairs -> bytes
  :                            362 
  :                            363 	ly	a
  :                            364 	la	transfer:hl_code
  :                            365 	and	TCP_SYN++TCP_FIN,,xi
  :                            366 	jza	tcp4_flags_weighed
  :                            367 	ab	1,,xi			. plus flags weight
  :                            368 
  :                            369 tcp4_flags_weighed
  :                            370 	ab	descriptor:bytes, y	. tpdu - header + [ SYN | FIN ]
  :                            371 
  :                            372 	$endif
  :                            373 
00:00256B 360020              +374 	dsl	32
00:00256C 160010              +375 	dsr	16
00:00256D C70008              +376 	ds	8
00:00256E CFA002              +377 	dl	transfer:seq
00:00256F 2E0008              +378 	sbl	8
00:002570 360008              +379 	dsl	8
00:002571 D70008              +380 	da	8			. (sequence + payload) */ 16
  :                            381 
00:002572 DFF006              +382 	dan	tra_remote_ack		. lower 16 bits of remote ack are remote window
  :                            383 					. equal only happens when remote window is zero
00:002573 7C0575              +384 	jdz	tcp4_outstanding_release . positive diffence otherwise means higher
00:002574 A60579              +385 	jpa	tcp4_outstanding_later	. sequence + payload > remote ack part
  :                            386 
  :                            387 tcp4_outstanding_release
00:002575 50F003              +388 	lx	transmission_p		. transmission control block pointer
00:002576 5CA016              +389 	ly	transmission:q4ack,,i
  :                            390 .	la	y			. ?	buffer descriptor pointer
  :                            391 
  :                            392 	$if	HVSOCKET
00:002577 3E08D1              +393 	lcal	tcp4_net_free_txdatagram
  :                            394 	$else
  :                            395 	lcal	net_free_txdatagram
  :                            396 	$endif
  :                            397 
00:002578 B6055B              +398 	j	tcp4_outstanding_next
  :                            399 
  :                            400 tcp4_outstanding_later
  :                            401 
  :                            402 .	dpop	0, sp			. mpved to parameter stream
  :                            403 
00:002579 380010              +404 	dpop	RX_APDATA
00:00257A 380011              +404 
00:00257B 38000E              +405 	pop	fp			. current input frame descriptor pointer
00:00257C 380002              +406 	pop	x			. transmission control block pointer
00:00257D 350000              +407 	lret	0
  :                            408 
  :                            409 tcp4_retransmit1
                                	$head_near	scalars(txbloc_p,	int,	x			;
00:00257E F80002              +411 				txq_p,		int,	transmission:q4ack:head	)
00:00257F F8A016              +411 
  :                            412 
  :                            413 				. scalar descriptor from queue head
  :                            414 				. must be on stack top for tcp_xmit
  :                            415 
  :                            416 	$if	1
00:002580 3E08BD              +417 	lcal	tcp_restart_timer2
  :                            418 	$else
  :                            419 	la	DAYCLOCK$
  :                            420 	aa, xi	TCP_TIMER2
  :                            421 	sa	transmission:timer(2)
  :                            422 	$endif
  :                            423 
  :                            424 tcp4_retransmit_next
00:002581 60F000              +425 	la	txq_p			. descriptor must stay on stack top
00:002582 C605A0              +426 	jza	tcp4_retransmitted	. until after tcp_xmit
  :                            427 
00:002583 68C001              +428 	lb	descriptor:frame, a
  :                            429 
  :                            430 	$if	1
00:002584 78D00D              +431 	tp	nframe:stack_index, b
00:002585 B605A0              +432 	j	tcp4_retransmitted	. it's still on interface TX queue
  :                            433 	$endif
  :                            434 
00:002586 58C005              +435 	ly	descriptor:uproto, a
00:002587 180011              +436 	sy	TP_HEADER
  :                            437 
00:002588 CFB004              +438 	dl	transfer:ack, y
00:002589 C0B007              +439 	aa	transfer:window, y
00:00258A C8B008              +440 	ab	transfer:checksum, y
  :                            441 
  :                            442 tcp4_retransmit_rewind
00:00258B C00005              +443 	aa	b
00:00258C 160010              +444 	dsr	16
00:00258D 0E0008              +445 	sbr	8
00:00258E D6058B              +446 	jnza	tcp4_retransmit_rewind
  :                            447 
00:00258F B80F8E              +448 	xorB	(00FFFF)
00:002590 28B008              +449 	sb	transfer:checksum, y
  :                            450 
00:002591 50F001              +451 	lx	txbloc_p		. may be looped round from tcp_xmit / (ipsend)
  :                            452 					. and got a different structure in x ->
00:002592 3E0723              +453 	lcal	tcp_award_window
00:002593 CFA00E              +454 	dl	transmission:ack_window
00:002594 160008              +455 	dsr	8
00:002595 0E0008              +456 	sbr	8
00:002596 C7000A              +457 	ds	10
  :                            458 
  :                            459 	$if	TCP_SEEK_ANOMALY
  :                            460 	lcal	tcp_seek_anomaly
  :                            461 	$endif
  :                            462 
00:002597 3E0776              +463 	lcal	tcp_xmit
  :                            464 
00:002598 FD0001              +465 	MIB_ICOUNT48	tcpRetransSegs:i
(+01)0f
00:002599 2F0569              +465 
00:00259A 5E059C              +465 
(+01)0f
00:00259B 170568              +465 
  :                            466 
  :                            467 	$if	1
00:00259C 60F000              +468 	la	txq_p
00:00259D 60C000              +469 	la	descriptor:next, a
00:00259E 20F000              +470 	sa	txq_p
00:00259F D60581              +471 	jnza	tcp4_retransmit_next
  :                            472 	$endif
  :                            473 
  :                            474 tcp4_retransmitted
00:0025A0 380004              +475 	pop	a			. descriptor
00:0025A1 380002              +476 	pop	x			. connection
  :                            477 
00:0025A2 350000              +478 	lret	0
  :                            479 
00:0025A3 9F0002              +480 tcp_free_rxtx $head_near	scalars(xy, long, x)
00:0025A4 5CA010              +481 	ly, i	transmission:receiveq
00:0025A5 3E05B2              +482 	lcal	tcp_freerxq
00:0025A6 50F000              +483 	lx	xy
00:0025A7 5CA012              +484 	ly, i	transmission:deferq
00:0025A8 3E05B2              +485 	lcal	tcp_freerxq
00:0025A9 50F000              +486 	lx	xy
00:0025AA 5CA014              +487 	ly, i	transmission:q4window
00:0025AB 3E05BA              +488 	lcal	tcp_freetxq
00:0025AC 50F000              +489 	lx	xy
00:0025AD 5CA016              +490 	ly, i	transmission:q4ack
00:0025AE 3E05BA              +491 	lcal	tcp_freetxq
  :                            492 
00:0025AF 380002              +493 	dpop	x
00:0025B0 380003              +493 
00:0025B1 350000              +494 	lret	0
  :                            495 
  :                            496 tcp_freerxq $tree
00:0025B2 F80003              +497 	$head_near	scalars(qtuple, int, y)
00:0025B3 3E0EA1              +498 sample	lcal	readq
00:0025B4 C605B8              +499 	jza	clear
00:0025B5 3E08B3              +500 	lcal	tcp_free
00:0025B6 58F000              +501 	ly	qtuple
00:0025B7 B605B3              +502 	j	sample
00:0025B8 380003              +503 clear	pop	y
00:0025B9 350000              +504 	lret	0
  :                            505 	$root
  :                            506 
  :                            507 tcp_freetxq $tree
00:0025BA F80003              +508 	$head_near	scalars(qtuple, int, y)
00:0025BB 3E0EA1              +509 sample	lcal	readq
00:0025BC C605C0              +510 	jza	clear
00:0025BD 3E08B6              +511 	lcal	tcp_free_tx
00:0025BE 58F000              +512 	ly	qtuple
00:0025BF B605BB              +513 	j	sample
00:0025C0 380003              +514 clear	pop	y
00:0025C1 350000              +515 	lret	0
  :                            516 	$root
  :                            517 
  :                            518 tcp4_construct_connections_bank
00:0025C2 651000              +519 	la, xi	4096
00:0025C3 750043              +520 	ii	BANK$
00:0025C4 C605DA              +521 	jza	tcp4_construct_x
00:0025C5 34002F              +522 	sabr	BSOCKET
00:0025C6 580F82              +523 	ly	(BSOCKET*/18s)
00:0025C7 8F0004              +524 	qpush	a
00:0025C8 160030              +525 	dsr	48				. clear hash chain heads
00:0025C9 C70006              +526 	ds	6
  :                            527 
00:0025CA 54B008              +528 	lx	tlist:chain(1),,i
00:0025CB 450007              +529 	lr	CHAINS/4-1,,xi
  :                            530 
  :                            531 tcp4_zhash_chain
00:0025CC 47A000              +532 	qs	0, x
00:0025CD 850004              +533 	ax	4,,xi
00:0025CE 1E05CC              +534 	jdr	tcp4_zhash_chain
  :                            535 	
00:0025CF 30B001              +536 	z	tlist:free
00:0025D0 64B028              +537 	la	tlist:connection_block(1),,i
00:0025D1 20B002              +538 	sa	tlist:top			. new transmission block acquire pointer
00:0025D2 602180              +539 	la	rx_buffers			. default buffer pool
00:0025D3 20B003              +540 	sa	tlist:rxbu_p			
00:0025D4 602181              +541 	la	tx_buffers			. default buffer pool
00:0025D5 20B004              +542 	sa	tlist:txbu_p
00:0025D6 870004              +543 	qpop	a
  :                            544 
00:0025D7 30B000              +545 	z	tlist:link			. tcp service chain
00:0025D8 30B006              +546 	z	tlist:flags			. default transmissions block
00:0025D9 30B007              +547 	z	tlist:rxowner			. owning application thread control block
  :                            548 
  :                            549 tcp4_construct_x
00:0025DA 350000              +550 	lret	0
  :                            551 
  :                            552 tcp_auto_accept
00:0025DB 3E0604              +553 	lcal	tcp_add_connection
00:0025DC 350000              +554 	lret	0				. no connection block
00:0025DD 3E063A              +555 	lcal	tcp_add_incoming_defaults
00:0025DE 350001              +556 	lret	1				. input segment bad
  :                            557 
00:0025DF FD0001              +558 	MIB_ICOUNT48	tcpPassiveOpens:i
(+01)0f
00:0025E0 2F055F              +558 
00:0025E1 5E05E3              +558 
(+01)0f
00:0025E2 17055E              +558 
  :                            559 
00:0025E3 CFA00E              +560 	dl	transmission:ack_window, x
00:0025E4 D70F9F              +561 	da	(1*/16:d)
00:0025E5 C7A00E              +562 	ds	transmission:ack_window, x
00:0025E6 8F0008              +563 	qpush	8
00:0025E7 87A006              +564 	qpop	transmission:socket_address, x
  :                            565 
00:0025E8 FD0004              +566 	push,xi	TCP_SYNRECEIVED
00:0025E9 38A001              +567 	pop	transmission:state
  :                            568 
00:0025EA 788F9C              +569 	tp	*(BSOCKET*/12++tlist:flags)
00:0025EB B605EE              +570 	j	tcp_hv_accept
  :                            571 
00:0025EC FF0FA1              +572 	call	(tcp_agent_add)
00:0025ED 350002              +573 	lret	2
  :                            574 
  :                            575 tcp_hv_accept
00:0025EE 3E08BD              +576 	lcal	tcp_restart_timer2
00:0025EF FF0FA2              +577 	call	(tcp_accept)
00:0025F0 B605F5              +578 	j	tcp_accept_fail			. could not respond yet
00:0025F1 CFA00C              +579         dl      transmission:sequence_ackx, x
00:0025F2 D70F9F              +580         da      (1*/16:d)
00:0025F3 C7A00C              +581         ds      transmission:sequence_ackx, x
00:0025F4 350002              +582 	lret	2				. good
  :                            583 
  :                            584 tcp_accept_fail
00:0025F5 FD0001              +585 	MIB_ICOUNT48	tcpAttemptFails:i
(+01)0f
00:0025F6 2F0561              +585 
00:0025F7 5E05F9              +585 
(+01)0f
00:0025F8 170560              +585 
00:0025F9 350001              +586 	lret	1
  :                            587 
  :                            588 tcp_xaccept
00:0025FA 60A016              +589 	la	transmission:q4ack:head
00:0025FB 90A014              +590 	or	transmission:q4window.head
00:0025FC D60601              +591 	jnza	tcp_e0_accept
  :                            592 .	ql	(06012, 04500, 0204, 0q)
  :                            593 .	push	transmission:mss	. this may be happening
  :                            594 .	pop	7			. many circuits later than
  :                            595 					. SYNC receive
  :                            596 
00:0025FD 3E05EE              +597 	lcal	tcp_hv_accept
00:0025FE B60602              +598 	j	tcp_e1_accept
00:0025FF B60602              +599 	j	tcp_e2_accept
00:002600 650000              +600 	la, xi	0			. generate a handle!
  :                            601 
  :                            602 tcp_e0_accept
00:002601 3D0000              +603 	fret	0
  :                            604 tcp_e1_accept
  :                            605 tcp_e2_accept
00:002602 65FFFF              +606 	la, xi	-1
00:002603 3D0000              +607 	fret	0
  :                            608 	
  :                            609 .	prior pointer is in y
  :                            610 .	actual pointer is NULL
  :                            611 
  :                            612 tcp_add_connection
00:002604 60B000              +613 	la	0, y			. insert point forward pointer
00:002605 680F82              +614 	lb	(BSOCKET*/18s)
00:002606 50D001              +615 	lx	tlist:free, b
00:002607 700002              +616 	tz	x
00:002608 B60611              +617 	j	tcp_free_block_found
00:002609 50D002              +618 	lx	tlist:top, b		. new connexions heap top
00:00260A 44DFE9              +619 	lr	4096-24+1, b, i		. limit default transmissions block
00:00260B 78D006              +620 	tp	tlist:flags, b		. big traffic connections list?
00:00260C 40D003              +621 	lr	tlist:climit, b		. limit port-dedicated transmissions block
00:00260D F60627              +622 	jxge	tcp_no_new_connection
00:00260E FCA018              +623 	push, i	24, x
00:00260F 38D002              +624 	pop	tlist:top, b
00:002610 B60613              +625 	j	tcp_connection_made
  :                            626 
  :                            627 tcp_free_block_found
00:002611 F8A000              +628 	push	transmission:next, x
00:002612 38D001              +629 	pop	tlist:free, b
  :                            630 
  :                            631 tcp_connection_made
00:002613 20A000              +632 	sa	transmission:next, x	. insert point forward pointer
00:002614 10B000              +633 	sx	transmission:next, y	. insert point previous block
  :                            634 
00:002615 CF0096              +635 	dl	DAYCLOCK$U
00:002616 360010              +636 	dsl	16
00:002617 C7A00C              +637 	ds	transmission:sequence_ackx
  :                            638 
00:002618 30A004              +639 	z	transmission:timer(1)	. no timeout for high-volume connections
00:002619 788F9C              +640 	tn	*(BSOCKET*/12++tlist:flags)
00:00261A B6061C              +640 
00:00261B 3E08C5              +641 	lcal	tcp_restart_timer1	. timeout for regular connections
  :                            642 
00:00261C 160030              +643 	dsr	48
00:00261D 30A003              +644 	z	transmission:tsq
00:00261E C7A010              +645 	ds	transmission:receiveq:head
00:00261F C7A012              +646 	ds	transmission:deferq:head
00:002620 C7A014              +647 	ds	transmission:q4window:head
00:002621 C7A016              +648 	ds	transmission:q4ack:head
  :                            649 
00:002622 6D2000              +650 	lb	MAXIMUM,,xi
  :                            651 
  :                            652 	$if	HVSOCKET
00:002623 788F9C              +653 	tp	*(BSOCKET*/12++tlist:flags)
00:002624 688FA3              +654 	lb	*(BSOCKET*/12++tlist:connection_block(1):mss)
  :                            655 	$endif
  :                            656 
00:002625 C7A00E              +657 	ds	transmission:ack_window
00:002626 350001              +658 	lret	1
  :                            659 
  :                            660 tcp_no_new_connection
00:002627 350000              +661 	lret	0
  :                            662 
  :                            663 tcp_scan_options
00:002628 400004              +664 	lr	a
00:002629 B60638              +665 	j	tcp_scan_next_option?
  :                            666 
  :                            667 tcp_scan_next_option
00:00262A 60B000              +668 	la	0, y
00:00262B 680004              +669 	anu, xi	0204
00:00262C DD0204              +669 
00:00262D DE0637              +670 	jnzb	tcp_scan_option2
00:00262E 1E0630              +671 	jdr	tcp_scan_mss
00:00262F 350000              +672 	lret	0
  :                            673 
  :                            674 tcp_scan_mss
00:002630 60B001              +675 	la	1, y
00:002631 680004              +676 	anu	MSS
00:002632 D8001A              +676 
00:002633 7E0635              +677 	jc	tcp_keep_mss
00:002634 20001A              +678 	sa	MSS
  :                            679 tcp_keep_mss
00:002635 8D0002              +680 	ay, xi	2
00:002636 B60638              +681 	j	tcp_scan_next_option?
  :                            682 
  :                            683 		. that will work so long as MSS
  :                            684 		. option is on a byte pair boundary
  :                            685 
  :                            686 
  :                            687 tcp_scan_option2
00:002637 8D0001              +688 	ay, xi	1
  :                            689 
  :                            690 tcp_scan_next_option?
00:002638 1E062A              +691 	jdr	tcp_scan_next_option
00:002639 350001              +692 	lret	1
  :                            693 
  :                            694 tcp_add_incoming_defaults
00:00263A 60E002              +695 	la	descriptor:i_f
(+01)10
00:00263B C50000              +696 	aa, xi	i_f_pointer_array
00:00263C 60C000              +697 	la	0, a
00:00263D 68C004              +698 	lb	this_if:mtu, a
00:00263E CDFFD8              +699 	ab, xi	-40
00:00263F 28001A              +700 	sb	MSS
00:002640 58E005              +701 	ly	descriptor:uproto
00:002641 CFB002              +702 	dl	transfer:seq, y
00:002642 2E0008              +703 	sbl	8
00:002643 360008              +704 	dsl	8
00:002644 480F8E              +705 	lk	(00FFFF)
00:002645 BFA00F              +706 	mlb	transmission:ack_window+1, x
00:002646 C7A00E              +707 	ds	transmission:ack_window, x
  :                            708 
00:002647 CFA00C              +709 	dl	transmission:sequence_ackx, x
00:002648 BFB007              +710 	mlb	transfer:window, y
00:002649 C7A00A              +711 	ds	transmission:remote_ack_window, x
  :                            712 
00:00264A 60001B              +713 	la	HL_FLAGS
00:00264B 06000B              +714 	sar	12-1
00:00264C A5001E              +715 	and, xi	30
00:00264D 8D000A              +716 	ay, xi	10
00:00264E C5FFF6              +717 	aa, xi	-10
  :                            718 
00:00264F E60652              +719 	jna	tcp_add_anomaly
00:002650 C60653              +720 	jza	tcp_options_complete
00:002651 3E0628              +721 	lcal	tcp_scan_options
  :                            722 tcp_add_anomaly
00:002652 350000              +723 	lret	0	. bad return from scan_options
  :                            724 
  :                            725 tcp_options_complete
00:002653 18E006              +726 	sy	descriptor:apdata
  :                            727 
00:002654 60001A              +728 	la	MSS
00:002655 20A002              +729 	sa	transmission:mss, x
00:002656 350001              +730 	lret	1
  :                            731 
  :                            732 tcp_log_reset
00:002657 FD0001              +733 	MIB_ICOUNT48	tcpOutRsts:i
(+01)0f
00:002658 2F056D              +733 
00:002659 5E065B              +733 
(+01)0f
00:00265A 17056C              +733 
00:00265B 350000              +734 	lret	0	
  :                            735 
  :                            736 tcp_ripdown
  :                            737 .	lcal	tcp_clear
00:00265C 3E0657              +738 	lcal	tcp_log_reset
00:00265D FD0001              +739 	push,xi	TCP_CLOSED
00:00265E 38A001              +740 	pop	transmission:state
00:00265F 350000              +741 	lret	0
  :                            742 
  :                            743 	$if	0
  :                            744 tcp_refuse
  :                            745 	lcal	tcp_reset	. send a reset if possible
  :                            746 	j	$+1	
  :                            747 	lcal	tcp_ripdown
  :                            748 	fret	0
  :                            749 	$endif
  :                            750 
  :                            751 tcp_locate_connection		. passive connect from remote
00:002660 50E005              +752 	lx	descriptor:uproto
00:002661 100011              +753 	sx	TP_HEADER
00:002662 60A006              +754 	la	transfer:hl_code, x
00:002663 20001B              +755 	sa	HL_FLAGS
  :                            756 
00:002664 CFA000              +757 	dl	transfer:sourcep
00:002665 20000B              +758 	sa	11		. the remote port
00:002666 280009              +759 	sb	9		. the local port
  :                            760 
00:002667 480F8E              +761 	lk	(00FFFF)
00:002668 50E004              +762 	lx	descriptor:dgram
  :                            763 
00:002669 CFA006              +764 	dl	dgram:ipsource, x
00:00266A 2E0008              +765 	sbl	8
00:00266B 360008              +766 	dsl	8
00:00266C BF000B              +767 	mlb	11
00:00266D C70006              +768 	ds	6		. the remote socket
  :                            769 
00:00266E CFA008              +770 	dl	dgram:ipdest, x
00:00266F 2E0008              +771 	sbl	8
00:002670 360008              +772 	dsl	8
00:002671 BF0009              +773 	mlb	9
  :                            774 				. the local socket
  :                            775 
  :                            776 tcp_check_connection		. active or passive connect
00:002672 470008              +777 	qs	8		. local_net:port:remote_net:port
  :                            778 
  :                            779 	$if	HVSOCKET
00:002673 FF0FA4              +780 	call	(tcp_hash_connection)
  :                            781 
  :                            782 	$else
  :                            783 
  :                            784 	dsl	32		. isolate local port
  :                            785 	sar	8
  :                            786 	call	(tcp_hash_localsocket)
  :                            787 	$endif
  :                            788 
00:002674 500F99              +789 	lx	(BSOCKET*/12++tlist:chain(1))	. &first
00:002675 800004              +790 	ax	a
  :                            791 tcp_seek
00:002676 580002              +792 	ly	x
00:002677 50A000              +793 	lx	transmission:next
  :                            794 
00:002678 700002              +795 	tz	x
00:002679 B6067B              +796 	j	tcp_compare_local
00:00267A 350000              +797 	lret	0
  :                            798 
  :                            799 tcp_compare_local
00:00267B 4FA006              +800 	ql	transmission:socket_address
00:00267C DF0008              +801 	dan	8
  :                            802 
00:00267D 7C0681              +803 	jdz	tcp_compare_remote
00:00267E 5E0676              +804 	jnc	tcp_seek	. candidate address > address in chain
  :                            805 
00:00267F 550000              +806 	lx, xi	0		. insert point is in y
00:002680 350000              +807 	lret	0
  :                            808 
  :                            809 tcp_compare_remote
00:002681 CF0006              +810 	dl	6
00:002682 DF000A              +811 	dan	10
  :                            812 
00:002683 7C0686              +813 	jdz	tcp_tbloc_found	. socket addresses = segment addresses
00:002684 5E0676              +814 	jnc	tcp_seek	. candidate address > address in chain
  :                            815 
00:002685 550000              +816 	lx, xi	0		. insert point is in y
  :                            817 tcp_tbloc_found
00:002686 350000              +818 	lret	0
  :                            819 
  :                            820 	. the LRET was up there
  :                            821 
00:002687 350000              +822 	lret	0
  :                            823 
00:002688 60A006              +824 tcp_rxq	la	transfer:hl_code
00:002689 20001B              +825 	sa	HL_FLAGS
00:00268A 60F001              +826 	la	dgram:bytes		. TP_HEADER is in x
00:00268B 48A008              +827 	lk	transfer:checksum, x
00:00268C 30A008              +828 	z	transfer:checksum, x
00:00268D 680004              +829 	anu	IPV4_OVERHAUL,,xi
00:00268E DD00A0              +829 
00:00268F CE0691              +830 	jzb	tcp_rxqexact
00:002690 7E06C0              +831 	jc	tcp_rxqlong		. interface contains
  :                            832 					. more of this datagram
  :                            833 
  :                            834 tcp_rxqexact				. datagram is all in internal stack
00:002691 3E023F              +835 	lcal	check_part1s		. and can be checksumed there
00:002692 3E026E              +836 	lcal	check_complete		. return is recalculated checksum in b
00:002693 B80001              +837 	xorB	k
00:002694 DE06B9              +838 	jnzb	tcp_rx_error
  :                            839 
  :                            840 	$if	__SOCHECK=0
  :                            841 	dl	SOCKET_LPOINTER
  :                            842 	jza	tcp_reset_deflect
  :                            843 	$else
00:002695 60A001              +844 	la	transfer:destp, x
00:002696 3E08AD              +845 	lcal	tcp_socket
00:002697 570012              +846 	dte	SOCKET_LPOINTER
00:002698 75005F              +847 	ii	GUARD$
00:002699 C606E9              +848 	jza	tcp_reset_deflect	. the port is not tabled
  :                            849 	$endif
  :                            850 					. there is no buffer descriptor yet
00:00269A 60D001              +851 	la	s:socket_address+1, b	. netaddress|0.0.0.0:port_number if bound
00:00269B A00F8E              +852 	and	(00FFFF)
00:00269C C606E9              +853 	jza	tcp_reset_deflect	. the port is not bound
  :                            854 
  :                            855 .	lx	rx_buffers		. default space for RX segments
  :                            856 
00:00269D 40F001              +857 	lr	dgram:bytes
00:00269E 3E0274              +858 	lcal	t_ibuffer
00:00269F C606B4              +859 	jza	tcp_rxbu_error		. no buffer available
  :                            860 					. descriptor is in fp
00:0026A0 68F001              +861 	lb	dgram:bytes		. buffer the datagram
00:0026A1 CDFFFF              +862 	ab	-1,,xi			. calculate 8-byte blocks less 1
00:0026A2 5E06BB              +863 	jnc	tcp_escape_error
00:0026A3 0E0003              +864 	sbr	3
00:0026A4 400005              +865 	lr	b
00:0026A5 50E004              +866 	lx	descriptor:dgram
  :                            867 
  :                            868 tcp_iquick
00:0026A6 87A000              +869 	qpop	0, x
00:0026A7 850004              +870 	ax	4,,xi
00:0026A8 1E06A6              +871 	jdr	tcp_iquick
  :                            872 
  :                            873 tcp_qthru
00:0026A9 FD0001              +874 	MIB_ICOUNT48	tcpInSegs:i
(+01)0f
00:0026AA 2F0565              +874 
00:0026AB 5E06AD              +874 
(+01)0f
00:0026AC 170564              +874 
  :                            875 	$if	TCP_NOQ			. HVSOCKET needs it done this way
00:0026AD 3E08D8              +876 	lcal	tcp4_rxaction
  :                            877 	$else
  :                            878 	dl	SOCKET_LPOINTER		. socket structure long virtual address
  :                            879 	ds	descriptor:sobdi
  :                            880 
  :                            881 	ly	tcpq,,xi
  :                            882 
  :                            883 	la	fp
  :                            884 	lcal	q2
  :                            885 	$endif
  :                            886 
00:0026AE B601E1              +887 	j	ipv4_rxz
  :                            888 
  :                            889 tcp_log_rx_error
00:0026AF FD0001              +890 	MIB_ICOUNT48	tcpInErrs:i
(+01)0f
00:0026B0 2F056B              +890 
00:0026B1 5E06B3              +890 
(+01)0f
00:0026B2 17056A              +890 
00:0026B3 350000              +891 	lret	0
  :                            892 
  :                            893 tcp_rxbu_error
00:0026B4 FD0001              +894 	MIB_ICOUNT48	tcpInDrops:i
(+01)0f
00:0026B5 2F0573              +894 
00:0026B6 5E06B8              +894 
(+01)0f
00:0026B7 170572              +894 
00:0026B8 B601E1              +895 	j	ipv4_rxz
  :                            896 
  :                            897 tcp_rx_error				. get here if socket buffer 
00:0026B9 3E06AF              +898 	lcal	tcp_log_rx_error	. not yet assigned
00:0026BA B601E1              +899 	j	ipv4_rxz		. and error detected
  :                            900 
  :                            901 tcp_escape_error			. get here if socket buffer assigned
00:0026BB 3E06AF              +902 	lcal	tcp_log_rx_error	. before error detected
  :                            903 					. drop thru
  :                            904 tcp_escape				. get here if it's not an error
00:0026BC 60000E              +905 	la	fp			. but rx segment is completely actioned
  :                            906 
  :                            907 	$if	HVSOCKET
00:0026BD 508FA5              +908 	lx	*(BSOCKET*/12++tlist:rxbu_p)
  :                            909 	$else
  :                            910 	lx	rx_buffers
  :                            911 	$endif
  :                            912 
00:0026BE 3E0E49              +913 	lcal	sell1
00:0026BF B601E1              +914 	j	ipv4_rxz
  :                            915 
  :                            916 tcp_rxqlong
00:0026C0 3E023D              +917 	lcal	check_part1		. uses HEADER_LONGWORDS
  :                            918 
  :                            919 	$if	__SOCHECK=0
  :                            920 	dl	SOCKET_LPOINTER
  :                            921 	jza	*tcp_lsegment_noport
  :                            922 	$else
00:0026C1 60A001              +923 	la	transfer:destp, x
00:0026C2 3E08AD              +924 	lcal	tcp_socket
00:0026C3 570012              +925 	dte	SOCKET_LPOINTER
00:0026C4 75005F              +926 	ii	GUARD$
(+01)0d
00:0026C5 C6840E              +927 	jza	*tcp_lsegment_noport	. without even checksum. default is reset
  :                            928 	$endif				. it might stop more junk coming
  :                            929 
00:0026C6 60D001              +930 	la	s:socket_address+1, b	. netaddress|0.0.0.0:port_number if bound
00:0026C7 A00F8E              +931 	and	(00FFFF)
(+01)0d
00:0026C8 C6840E              +932 	jza	*tcp_lsegment_noport
  :                            933 
  :                            934 .	lx	rx_buffers		. default RX segments space
  :                            935 
00:0026C9 40F001              +936 	lr	dgram:bytes
00:0026CA 3E0274              +937 	lcal	t_ibuffer		. this call saves / restores y and b
00:0026CB C606B4              +938 	jza	tcp_rxbu_error
  :                            939 					. fp -> descriptor
00:0026CC 50E004              +940 	lx	descriptor:dgram
00:0026CD 60F001              +941 	la	dgram:bytes		. obtain the datagram second part length
00:0026CE C5FF60              +942 	aa	-IPV4_OVERHAUL,,xi	. while the header is in the internal stack
  :                            943 
00:0026CF 87A000              +944 ?	$do	IPV4_OVERHAUL/8,	qpop	?*4-4, x
00:0026D0 87A004              +944 
00:0026D1 87A008              +944 
00:0026D2 87A00C              +944 
00:0026D3 87A010              +944 
00:0026D4 87A014              +944 
00:0026D5 87A018              +944 
00:0026D6 87A01C              +944 
00:0026D7 87A020              +944 
00:0026D8 87A024              +944 
00:0026D9 87A028              +944 
00:0026DA 87A02C              +944 
00:0026DB 87A030              +944 
00:0026DC 87A034              +944 
00:0026DD 87A038              +944 
00:0026DE 87A03C              +944 
00:0026DF 87A040              +944 
00:0026E0 87A044              +944 
00:0026E1 87A048              +944 
00:0026E2 87A04C              +944 
  :                            945 
00:0026E3 850050              +946 	ax	IPV4_OVERHAUL/2,,xi
00:0026E4 8D0050              +947 	ay	IPV4_OVERHAUL/2,,xi
  :                            948 
00:0026E5 3E0419              +949 	lcal	rx_payload		. return is recalculated checksum in b
00:0026E6 B80001              +950 	xorB	k			. k holds the retrieved checksum
00:0026E7 CE06A9              +951 	jzb	tcp_qthru
  :                            952 
00:0026E8 B606BB              +953 	j	tcp_escape_error	. if it did not checksum
  :                            954 					. push the buffer back while it's still at heap top
  :                            955 
  :                            956 tcp_reset_deflect
00:0026E9 60A006              +957 	la	transfer:hl_code, x
00:0026EA A50004              +958 	and	TCP_RST,,xi
00:0026EB D601E1              +959 	jnza	ipv4_rxz		. don't reset a reset
  :                            960 
  :                            961 	$if	IPV4_OVERHAUL>144	. protect the internal stack
  :                            962 					. if the frame in it is too large for more work
00:0026EC 450020              +963 	lr	32,,xi			. make sure 20 word shuffle does not overlap
00:0026ED 58000F              +964 	ly	sp			. read the datagram leading edge
00:0026EE FE06FA              +965 	jyge	tcp_deflect_frame_safe	. do not shuffle unnecessarily or with overlap
  :                            966 
  :                            967 	$if	0
  :                            968 
  :                            969 	j	ipv4_rxz		. the simpler way may be even better:
  :                            970 					. i.e. drop the input silently
  :                            971 	$else				. but it may be helpful to send reset
  :                            972 
00:0026EF 500011              +973 	lx	TP_HEADER		. read the TCP header leading edge
00:0026F0 600091              +974 	la	ONE_TIME_SAVE1		. take the stack back nearer its origin
00:0026F1 20000F              +975 	sa	sp
00:0026F2 8FA006              +976 	qpush	6, x			. push the minimum TCP header
00:0026F3 8FA002              +977 	qpush	2, x
00:0026F4 9FA000              +978 	dpush	0, x
00:0026F5 60000F              +979 	la	sp
00:0026F6 200011              +980 	sa	TP_HEADER		. and mark where it is
00:0026F7 8FB006              +981 	qpush	6, y			. push the minimum datagram header
00:0026F8 8FB002              +982 	qpush	2, y
00:0026F9 9FB000              +983 	dpush	0, y			. it's where the stack pointer is
  :                            984 
  :                            985 	$endif
  :                            986 
  :                            987 tcp_deflect_frame_safe
  :                            988 	$endif
  :                            989 
00:0026FA 58000F              +990 	ly	sp
00:0026FB 3E0788              +991 	lcal	tcp_reject
  :                            992 
00:0026FC B601E1              +993 	j	ipv4_rxz		. don't get here if you have a buffer
  :                            994 
  :                            995 
  :                            996 .	group of similar functions which
  :                            997 .	get a buffer and send a short segment
  :                            998 .
  :                            999 .	for	SYN
  :                            1000 .		SYN_ACK
  :                            1001 .		FIN
  :                            1002 .		FIN_ACK
  :                            1003 
  :                            1004 .	connection address is in X
  :                            1005 
  :                            1006 .       hl_code is in A
  :                            1007 .       if header is over 5 longwords
  :                            1008 .       address of options list is in B
  :                            1009 
  :                            1010 .	options list is 16 bits per word
  :                            1011 
  :                            1012 .		0000 0000 tttt tttt llll llll
  :                            1013 .		0000 0000 vvvv vvvv vvvv vvvv
  :                            1014 
  :                            1015 .	if there is payload
  :                            1016 .	the byte count is in B
  :                            1017 .	the data address is in Y
  :                            1018 .	the data at Y is already in
  :                            1019 .	16-bit network format
  :                            1020 
  :                            1021 .		0000 0000 xxxx xxxx yyyy yyyy
  :                            1022 
  :                            1023 .       connection state variables are
  :                            1024 .       used
  :                            1025 
  :                            1026 .       the segment is queued and flagged for
  :                            1027 .       retain, meaning IP doesn't pool the
  :                            1028 .       buffer on transmit, but lets TCP do
  :                            1029 .       that on remote ACK
  :                            1030 
  :                            1031 .	these are far calls visible to
  :                            1032 .	applications
  :                            1033 
  :                            1034 .	the vector for tcp_send_syn is __tcp_connect
  :                            1035 
  :                            1036 .	the vector for tcp_respond_syn_ack
  :                            1037 .	is tcp_accept
  :                            1038 
  :                            1039 .	the vector for tcp_send_i
  :                            1040 .	is tcp_send_push
  :                            1041 
  :                            1042 tcp_send_syn
00:0026FD 450000              +1043 	lr	0,,xi
00:0026FE 4F0FA6              +1044 	ql	(06000++TCP_SYN, 04500, 0204, 0q)
00:0026FF F8A002              +1045 	push	transmission:mss
00:002700 380007              +1046 	pop	7
  :                            1047 
  :                            1048 .	push	0204,,xi
  :                            1049 .	pop	25
  :                            1050 .	lb	25,,xi
  :                            1051 .	push	transmission:mss
  :                            1052 .	pop	26
00:002701 B6070B              +1053 	j	tcp_message_segment_i
  :                            1054 
  :                            1055 tcp_respond_syn_ack
00:002702 450000              +1056 	lr, xi	0
00:002703 4F0FAA              +1057 	ql	(06000++TCP_SYN++TCP_ACK, 04500, 0204, 0q)
00:002704 F8A002              +1058 	push	transmission:mss
00:002705 380007              +1059 	pop	7
  :                            1060 
  :                            1061 .	push,xi	0204
  :                            1062 .	pop	25
  :                            1063 .	lb, xi	25		. MSS is in 26
00:002706 B6070B              +1064 	j	tcp_message_segment_i
  :                            1065 
  :                            1066 tcp_respond_fin_ack
00:002707 450000              +1067 	lr, xi	0
00:002708 CF0FAE              +1068 	dl	(05000++TCP_FIN++TCP_ACK, 04500L)
00:002709 B6070B              +1069 	j	tcp_message_segment_i
  :                            1070 
  :                            1071 tcp_send_i
00:00270A CF0FB0              +1072 	dl	(05000++TCP_ACK++TCP_PSH, 04500L)
  :                            1073 
  :                            1074 tcp_message_segment_i
00:00270B 3E07D7              +1075 	lcal	tcp_startbuffer
00:00270C 3D0000              +1076 	fret	0		. that didn't work
  :                            1077 
00:00270D F80004              +1078 	push	a		. the descriptor
00:00270E F80002              +1079 	push	x		. the connection
  :                            1080 
00:00270F 680012              +1081 	lb	TPAYLOAD_BYTES	. segment length
00:002710 980FB2              +1082 	orB	(0800000:s)	. send now
  :                            1083 
00:002711 28C003              +1084 	sb	descriptor:bytes, a
  :                            1085 
00:002712 680012              +1086 	lb	TPAYLOAD_BYTES
00:002713 C80007              +1087 	ab	HEADER_SUM+1
00:002714 280007              +1088 	sb	HEADER_SUM+1
  :                            1089 
00:002715 500010              +1090 	lx	AP_DATA
00:002716 600000              +1091 	la	r
00:002717 3E0419              +1092 	lcal	tx_payload
  :                            1093 
00:002718 500011              +1094 	lx	TP_HEADER
00:002719 B80F8E              +1095 	xorB	(00FFFF)	. it won't be right until it was to be wrong
00:00271A 28A008              +1096 	sb	transfer:checksum, x
  :                            1097 
  :                            1098 .	lx	TP_HEADER
  :                            1099 .	aa	TPAYLOAD_BYTES
  :                            1100 .	sa	transfer:checksum, x
  :                            1101 
00:00271B 50F000              +1102 	lx	0, sp
00:00271C 60F001              +1103 	la	1, sp
  :                            1104 
00:00271D 3E085D              +1105 	lcal	tcp_write_txq
  :                            1106 
00:00271E 380002              +1107 	pop	x			. the connection
00:00271F 380004              +1108 	pop	a			. the descriptor
  :                            1109 
00:002720 70A014              +1110 	tz	transmission:q4window
00:002721 3E0737              +1111 	lcal	tcp_send_on_window
  :                            1112 
00:002722 3D0001              +1113 	fret	1
  :                            1114 
  :                            1115 
  :                            1116 .	advertise new window when sending
  :                            1117 .	window can only go up not down when sending
  :                            1118 
  :                            1119 .	window closes incrementally when receiving
  :                            1120 
  :                            1121 WINDOW	$equ	d$save3
  :                            1122 
  :                            1123 tcp_award_window
  :                            1124 
  :                            1125 	$if	1
  :                            1126 
00:002723 F80003              +1127 	push	y
00:002724 F80000              +1128 	push	r
  :                            1129 
00:002725 60A00F              +1130 	la	transmission:ack_window+1	. read existing window
00:002726 160010              +1131 	dsr	16
00:002727 0E0008              +1132 	sbr	8
  :                            1133 
  :                            1134 	$if	1
  :                            1135 
00:002728 580005              +1136 	ly	b
00:002729 452000              +1137 	lr	MAXIMUM,,xi
00:00272A FE0733              +1138 	jyge	tcp_store_window		. include case zero
  :                            1139 
  :                            1140 	$else
  :                            1141 
  :                            1142 	push	b
  :                            1143 	ab	-MAXIMUM,,xi			. already > MAXIMUM ?
  :                            1144 	pop	b
  :                            1145 	jc	tcp_store_window
  :                            1146 	$endif
  :                            1147 
00:00272B 70A010              +1148 	tz	transmission:receiveq.head	. any RX data buffered?
00:00272C B60733              +1149 	j	tcp_store_window		. yes, keep window depleted or not
00:00272D 6D2000              +1150 	lb	MAXIMUM,,xi			. no, restart window
00:00272E 788F9C              +1151 	tp	*(BSOCKET*/12++tlist:flags)			. high volume TCP ?
00:00272F 688FA3              +1152 	lb	*(BSOCKET*/12++tlist:connection_block(1):mss)	. restart smaller window
  :                            1153 
00:002730 260010              +1154 	sal	16
00:002731 900005              +1155 	or	b	
00:002732 20A00F              +1156 	sa	transmission:ack_window+1 	. update transmission control block
  :                            1157 
  :                            1158 tcp_store_window
00:002733 280013              +1159 	sb	WINDOW				. store for checksum
  :                            1160 
00:002734 380000              +1161 	pop	r
00:002735 380003              +1162 	pop	y
00:002736 350000              +1163 	lret	0
  :                            1164 
  :                            1165 	$else
  :                            1166 
  :                            1167 	lb	MAXIMUM,,xi
  :                            1168 
  :                            1169 	$if	HVSOCKET
  :                            1170 	tp	*(BSOCKET*/12++tlist:flags)
  :                            1171 	call	(tcp_window)		. window calculatiom
  :                            1172 	$endif				. returns in b
  :                            1173 
  :                            1174 	lk	(00FFFF)		. needed for masked load
  :                            1175 	sb	WINDOW			. new calculation
  :                            1176 					. but don't roll back residual window
  :                            1177 	lb	transmission:ack_window+1
  :                            1178 	la	b
  :                            1179 	and	k			. update residual window
  :                            1180 	ana	WINDOW			. if new calculation is larger
  :                            1181 	jnc	tcp_award_new_window
  :                            1182 	andB	k			. otherwise don't update connection block
  :                            1183 	sb	WINDOW			. decision is positively stored at WINDOW
  :                            1184 	lret	0			. for checksum
  :                            1185 
  :                            1186 tcp_award_new_window
  :                            1187 	mlb	WINDOW		. K still contains 00FFFF
  :                            1188 	sb	transmission:ack_window+1
  :                            1189 	lret	0
  :                            1190 
  :                            1191 	$endif
  :                            1192 
  :                            1193 
  :                            1194 
  :                            1195 tcp_send_on_window
                                	$head_near	scalars(xmitted,	int		;
00:002737 FD0000              +1197 				tconnection_p,	int,	x	)
00:002738 F80002              +1197 
  :                            1198 
  :                            1199 .	push,xi 0	. count of transmissions
  :                            1200 .	push	x	. the connection
  :                            1201 
  :                            1202 			. remote ACK + window >=
  :                            1203 			. sequence + size = send
  :                            1204 
  :                            1205 
00:002739 CFA00A              +1206 	dl	transmission:remote_ack_window, x
00:00273A C70008              +1207 	ds	8
00:00273B 360020              +1208 	dsl	32
00:00273C 160010              +1209 	dsr	16
00:00273D D70008              +1210 	da	8
00:00273E C70008              +1211 	ds	8
  :                            1212 .	lcal	tcp_award_window
00:00273F CFA00E              +1213 	dl	transmission:ack_window, x
00:002740 160008              +1214 	dsr	8
00:002741 0E0008              +1215 	sbr	8
00:002742 C7000A              +1216 	ds	10
  :                            1217 
  :                            1218 tcp_send_on_window_next
00:002743 60A014              +1219 	la	transmission:q4window:head, x
00:002744 C6076E              +1220 	jza	tcp_sent_all
  :                            1221 
00:002745 580004              +1222 	ly	a
00:002746 60B003              +1223 	la	descriptor:bytes, y
00:002747 A6076E              +1224 	jpa	tcp_sent_all		. the sticky bit = send
  :                            1225 					. otherwise the segment
  :                            1226 					. is still accumulating
  :                            1227 					. and is last on the window q
  :                            1228 
00:002748 A00FB3              +1229 	and	(01FFFF)		. remove the sticky bit
  :                            1230 					. for calculation
  :                            1231 
00:002749 68B005              +1232 	lb	descriptor:uproto, y	. the negative of the size
00:00274A 280011              +1233 	sb	TP_HEADER
  :                            1234 
00:00274B DE074D              +1235 	jnzb	$+2
00:00274C 75005F              +1236 	ii	GUARD$
  :                            1237 
00:00274D 70B006              +1238 	tnz	descriptor:apdata, y
00:00274E B60750              +1238 
00:00274F 75005F              +1239 	ii	GUARD$
  :                            1240 
00:002750 D8B006              +1241 	anb	descriptor:apdata, y	. of the segment header
00:002751 2E0001              +1242 	sbl	1			. in bytes at 16/24 bits/word
  :                            1243 	
00:002752 C80004              +1244 	ab	a			. segment minus header
  :                            1245 					. = payload
00:002753 650000              +1246 	la, xi	0
00:002754 360010              +1247 	dsl	16
00:002755 C70006              +1248 	ds	6
  :                            1249 
00:002756 580011              +1250 	ly	TP_HEADER
00:002757 CFB002              +1251 	dl	transfer:seq, y
  :                            1252 
00:002758 2E0008              +1253 	sbl	8
00:002759 360008              +1254 	dsl	8	. sequence
  :                            1255 
00:00275A D70006              +1256 	da	6	. sequence + payload
00:00275B C70006              +1257 	ds	6
  :                            1258 
  :                            1259 .	maybe cache the sum of remote window + remote ack
  :                            1260 .	as soon as remote ack has been actioned on the
  :                            1261 .	front of q4ack
  :                            1262 .	so this sum would not be done here
  :                            1263 
  :                            1264 
00:00275C CF0008              +1265 	dl	8	. remote ack plus remote window
  :                            1266 
00:00275D DF0006              +1267 	dan	6
00:00275E E6076E              +1268 	jna	tcp_sent_possible
  :                            1269 
  :                            1270 
00:00275F 3E0867              +1271 	lcal	tcp_read_txq	. remove atomically from queue
  :                            1272 
  :                            1273 	$if	1
00:002760 C6076E              +1274 	jza	tcp_sent_all	. when traced the q4window.tail is already on q4ack
  :                            1275 	$else			. so this loop restarted or something else moved q2q
  :                            1276 	jza	rum_do		. this routine can be called from applications
  :                            1277 	$endif			. which may be time-sliced
  :                            1278 
00:002761 50F000              +1279 	lx	tconnection_p		. connection is on the stack top
  :                            1280 					. scalar names tconnection_p and xmitted
  :                            1281 					. displaced by 5 pushed words
00:002762 8F0008              +1282 	qpush	8			. the cached state variables
00:002763 F80004              +1283 	push	a			. descriptor must be on stack top for tcp_xmit
00:002764 3E0723              +1284 	lcal	tcp_award_window	.
  :                            1285 
  :                            1286 	$if	TCP_SEEK_ANOMALY
  :                            1287 	lcal	tcp_seek_anomaly
  :                            1288 	$endif
  :                            1289 
00:002765 3E0776              +1290 	lcal	tcp_xmit
  :                            1291 
00:002766 380004              +1292 	pop	a			. the descriptor
00:002767 870008              +1293 	qpop	8			. the cached state variables
  :                            1294 					. scalar names at restored displacements
  :                            1295 
00:002768 50F000              +1296 	lx	tconnection_p		. the connection pointer on the stack top
00:002769 5CA016              +1297 	ly, i	transmission:q4ack
  :                            1298 
00:00276A 3E0E90              +1299 	lcal	q2first?		. write the q4ACK
00:00276B B6076C              +1300 	j	tcp_ackq_started	. but
  :                            1301 
  :                            1302 	$if	0
  :                            1303 	$if	1
  :                            1304 	lcal	tcp_restart_timer2
  :                            1305 	$else
  :                            1306 
  :                            1307 	lb, xi	TCP_TIMER2		. only start this timer
  :                            1308 	ab	DAYCLOCK$		. if the ACK q was empty
  :                            1309 	sb	transmission:timer(2)	. before
  :                            1310 	$endif
  :                            1311 	$endif
  :                            1312 
  :                            1313 tcp_ackq_started
  :                            1314 
00:00276C 17F001              +1315 	inc	xmitted			. count of transmissions
  :                            1316 
00:00276D B60743              +1317 	j	tcp_send_on_window_next
  :                            1318 
  :                            1319 tcp_sent_possible
  :                            1320 	$if	0			. check ACK up to date in R10:11
  :                            1321 					. before switching this back on
  :                            1322 					. and check this is an advantage anyway
  :                            1323 					. I have traffic and no window
  :                            1324 	la	1, sp			. reasonable if I have sent any segments
  :                            1325 	jnza	tcp_sent_all
  :                            1326 
  :                            1327 	la	DAYCLOCK$		. well I'm waiting to send
  :                            1328 	ana	transmission:timer(2)	
  :                            1329 	jpa	tcp_sent_all
  :                            1330 					. periodically say so
  :                            1331 					. can be done with a 1-byte sample
  :                            1332 
  :                            1333 	dl	transmission:ack_window
  :                            1334 	dsr	8
  :                            1335 	sbr	8
  :                            1336 	ds	10			. tcp_xmit needs that there
  :                            1337 
  :                            1338 	lcal	tcp_send_ack		. or try to
  :                            1339 	lcal	tcp_ack_dropped		. nop, send_ack skips on succesful return
  :                            1340 .	lcal	tcp_restart_timer2
  :                            1341 	$endif
  :                            1342 
  :                            1343 tcp_sent_all
  :                            1344 .tcp_sent_enough
  :                            1345 					. the connection pointer is now at the stack top
00:00276E 380002              +1346 	pop	x			. $$frame was exactly 2 words
00:00276F 380004              +1347 	pop	a			. count of transmissions
00:002770 350000              +1348 	lret	0
  :                            1349 
  :                            1350 	$if	0
  :                            1351 rum_do	ii	GUARD$
  :                            1352 	$endif
  :                            1353 
  :                            1354 tcp_ack_dropped
00:002771 FD0001              +1355 	MIB_ICOUNT48	tcpOutAckDrops:i
(+01)0f
00:002772 2F0577              +1355 
00:002773 5E0775              +1355 
(+01)0f
00:002774 170576              +1355 
00:002775 350000              +1356 	lret	0
  :                            1357 
  :                            1358 tcp_xmit 
00:002776 CF000A              +1359         dl      10      . this should be ACK
  :                            1360 
00:002777 500011              +1361         lx      TP_HEADER
00:002778 C7A004              +1362         ds      transfer:ack, x
00:002779 C80004              +1363         ab      a
  :                            1364 
  :                            1365 	$if	0
  :                            1366 	la, xi	8192
  :                            1367 	$else
00:00277A 600013              +1368         la      WINDOW
  :                            1369 	$endif
  :                            1370 
00:00277B 20A007              +1371         sa      transfer:window, x
00:00277C C0A008              +1372         aa      transfer:checksum, x
  :                            1373 
00:00277D 3E026E              +1374 	lcal	check_complete
00:00277E 28A008              +1375         sb      transfer:checksum, x
  :                            1376 
00:00277F 50F001              +1377         lx      1, sp		. the descriptor
  :                            1378 
00:002780 58A004              +1379         ly      descriptor:dgram, x
00:002781 4FB006              +1380 	ql      dgram:ipsource, y
  :                            1381 
00:002782 FD0001              +1382 	MIB_ICOUNT48	tcpOutSegs:i
(+01)0f
00:002783 2F0567              +1382 
00:002784 5E0786              +1382 
(+01)0f
00:002785 170566              +1382 
  :                            1383 
00:002786 FF0F94              +1384         call    (ipsend)
00:002787 350000              +1385         lret    0
  :                            1386 
  :                            1387 
  :                            1388 
  :                            1389 
  :                            1390 .	following is unique of TCP send calls
  :                            1391 .	because it's called when there is no
  :                            1392 .	connection, consequently no connection
  :                            1393 .	pointer and no state variables to
  :                            1394 .	consult
  :                            1395 
  :                            1396 .	the only input is the received buffer
  :                            1397 .	descriptor in fp
  :                            1398 
  :                            1399 .	if there is payload or SYNC or FIN
  :                            1400 .	it may help to up the ACK accordingly
  :                            1401 .	because the far side may otherwise drop the RST from here
  :                            1402 .	or don't set _ACK as well as _RST
  :                            1403 
  :                            1404 TCP_REFLEX_SEQUENCE_ON_REJECT	$equ	1
  :                            1405 TCP_ALIGN_ON_REJECT 		$equ	0	. not making any difference
  :                            1406 TCP_WINDOW_ON_REJECT		$equ	0000
  :                            1407 
  :                            1408 	$if	TCP_ALIGN_ON_REJECT
  :                            1409 
  :                            1410 tcp_reject_xtras
  :                            1411 	dpush	a			. a has part of a checksum in it
  :                            1412 	la	transfer:hl_code, y
  :                            1413 	dsr	12			. header longwords
  :                            1414 	sal	2			. header bytes
  :                            1415 	andB	(+(TCP_SYN++TCP_FIN)*/12)
  :                            1416 	jzb	tcp_no_reject_flagweight
  :                            1417 	aa	-1,,xi			. the header length counts 1 less than itself
  :                            1418 tcp_no_reject_flagweight		. or bytes count 1 more than themselves
  :                            1419 	lb	descriptor:bytes
  :                            1420 	anb	a
  :                            1421 	jzb	tcp_reject_no_traffic_weight
  :                            1422 	ab	7, sp			. ACK low 16 bits
  :                            1423 	la	b
  :                            1424 	dsa	16			. crazy if it went negative, but timeout eventually
  :                            1425 	sbr	8
  :                            1426 	aa	6, sp			. ACK high 16 bits
  :                            1427 	and	(00FFFF)		. thankfully no carry-round
  :                            1428 	ds	6, sp			. so put ACK back in the stack for addition + store
  :                            1429 tcp_reject_no_traffic_weight
  :                            1430 	dpop	a
  :                            1431 	lret	0
  :                            1432 
  :                            1433 	$endif
  :                            1434 
  :                            1435 tcp_reject				. this is when TCP_RST must be sent
  :                            1436 					. and there is no connection
  :                            1437 
00:002788 F80003              +1438 	push	y			. datagram
00:002789 650014              +1439 	la, xi	20
00:00278A 3E083A              +1440 	lcal	tcp_txbuffer
00:00278B 380003              +1441 	pop	y
00:00278C C607B9              +1442 	jza	tcp_noresetbuffer	. no action either!
  :                            1443 
00:00278D F80004              +1444 	push	a			. the descriptor
  :                            1445 
00:00278E 9FB006              +1446 	dpush	dgram:ipsource, y
00:00278F 9FB008              +1447 	dpush	dgram:ipdest, y
  :                            1448 
00:002790 4FF000              +1449 	ql	0, sp			. ipsend wants the
00:002791 D70006              +1450 	da	6			. destination in 6:7
  :                            1451 
00:002792 C50006              +1452 	aa, xi	IPPROTO_TCP
00:002793 CD0014              +1453 	ab, xi	20
  :                            1454 
00:002794 580013              +1455 	ly	TX_DATAGRAM
00:002795 87B006              +1456 	qpop	dgram:ipsource, y
  :                            1457 
00:002796 58E005              +1458 	ly	descriptor:uproto
  :                            1459 
  :                            1460 	$if	TCP_REFLEX_SEQUENCE_ON_REJECT
00:002797 9FB004              +1461 	dpush	transfer:ack, y
  :                            1462 	$endif	
  :                            1463 
00:002798 9FB002              +1464 	dpush	transfer:seq, y
00:002799 9FB000              +1465 	dpush	transfer:sourcep, y
  :                            1466 
  :                            1467 
  :                            1468 	$if	TCP_ALIGN_ON_REJECT
  :                            1469 	push	(05000++TCP_RST++TCP_ACK)
  :                            1470 	lcal	tcp_reject_xtras	. see if aligning ACK on RST cheers the other side up
  :                            1471 	$else				. it doesn't cheer OSX up much
00:00279A F80FB4              +1472 	push	(05000++TCP_RST)
00:00279B 30F004              +1473 	z	4, sp			. but will this? RST without ACK field
00:00279C 30F003              +1474 	z	3, sp
  :                            1475         $endif
  :                            1476 
  :                            1477 
00:00279D C0F000              +1478 	aa	0, sp
00:00279E D7F001              +1479 	da	1, sp
00:00279F D7F003              +1480 	da	3, sp
  :                            1481 
  :                            1482 	$if	TCP_REFLEX_SEQUENCE_ON_REJECT
00:0027A0 D7F005              +1483 	da	5, sp
  :                            1484 	$endif
  :                            1485 
00:0027A1 38A006              +1486 	pop	transfer:hl_code, x	. tx_datagram loads
00:0027A2 38A001              +1487 	pop	transfer:destp, x	. x->segment
00:0027A3 38A000              +1488 	pop	transfer:sourcep, x
  :                            1489 
00:0027A4 30A002              +1490 	z	transfer:seq, x
00:0027A5 30A003              +1491 	z	transfer:seq+1, x
  :                            1492 
00:0027A6 38A004              +1493 	dpop	transfer:ack, x
00:0027A7 38A005              +1493 
  :                            1494 
  :                            1495 	$if	TCP_REFLEX_SEQUENCE_ON_REJECT
00:0027A8 38A002              +1496 	dpop	transfer:seq, x
00:0027A9 38A003              +1496 
  :                            1497 	$endif
  :                            1498 
00:0027AA C50000              +1499 	aa	TCP_WINDOW_ON_REJECT,,xi
00:0027AB FD0000              +1500 	push	TCP_WINDOW_ON_REJECT,,xi
00:0027AC 38A007              +1501 	pop	transfer:window, x
  :                            1502 
00:0027AD 30A009              +1503 	z	transfer:urgent, x
  :                            1504 
00:0027AE C00005              +1505 	aa	b
00:0027AF 160010              +1506 	dsr	16
00:0027B0 0E0008              +1507 	sbr	8
00:0027B1 D607AE              +1508 	jnza	$-3
00:0027B2 B80F8E              +1509 	xorB	(00FFFF)
00:0027B3 28A008              +1510 	sb	transfer:checksum, x
  :                            1511 
00:0027B4 380002              +1512 	pop	x			. the descriptor
00:0027B5 580013              +1513 	ly	TX_DATAGRAM
00:0027B6 4FB006              +1514 	ql	dgram:ipsource, y	. that might be needed for routing
00:0027B7 FF0F94              +1515 	call	(ipsend)
  :                            1516 
00:0027B8 3E0657              +1517 	lcal	tcp_log_reset
  :                            1518 	
  :                            1519 tcp_noresetbuffer
00:0027B9 350000              +1520 	lret	0
  :                            1521 
  :                            1522 
  :                            1523 
  :                            1524 .	following routine with ++entry points
  :                            1525 .	sends short segments when there is a
  :                            1526 .	connection
  :                            1527 
  :                            1528 .	it's different from payload because
  :                            1529 .	it sends the most recent sequence
  :                            1530 .	value transmitted, not the advanced
  :                            1531 .	sequence value assigned to new payload
  :                            1532 .	segments
  :                            1533 
  :                            1534 .	used just for ACK + advertise window
  :                            1535 .	or to probe for window with 1 byte
  :                            1536 .	of payload
  :                            1537 
  :                            1538 .	The segment isn't flagged for retain or
  :                            1539 .	held on the output queue / ack wait queue
  :                            1540 
  :                            1541 .	payload bytes are in R
  :                            1542 .	if payload, the pointer is in Y
  :                            1543 .	and is two bytes per word right justified
  :                            1544 .	not internal format
  :                            1545 
  :                            1546 .	this isn't the payload send and
  :                            1547 .	may not alter the SEQ variable
  :                            1548 
  :                            1549 
  :                            1550 tcp_reset		. this is when TCP_RST must be sent
  :                            1551 			. and the connection is about to
  :                            1552 			. get ripped
00:0027BA 450000              +1553 	lr, xi	0
00:0027BB CF0FB5              +1554 	dl	(05000++TCP_RST, 04500L)
00:0027BC FD000C              +1555 	push,xi	TCP_DELETETCB
00:0027BD 38A001              +1556 	pop	transmission:state
00:0027BE B607C3              +1557 	j	tcp_sendq2
  :                            1558 
  :                            1559 tcp_send_ack
00:0027BF 450000              +1560 	lr, xi	0
00:0027C0 CF0FB7              +1561 	dl	(05000++TCP_ACK, 04504L)
00:0027C1 B607C3              +1562 	j	tcp_sendq2
  :                            1563 
  :                            1564 tcp_sendq
00:0027C2 CF0FB9              +1565 	dl	(05000++TCP_ACK, 04500L)
  :                            1566 
  :                            1567 tcp_sendq2
00:0027C3 3E07D7              +1568 	lcal	tcp_startbuffer
00:0027C4 350000              +1569 	lret	0		. not obtained
  :                            1570 
  :                            1571 .	check conversions between words and bytes
  :                            1572 .	in calls to startbuffer, txbuffer
  :                            1573 
  :                            1574 
00:0027C5 F80002              +1575 	push	x			. the connection
00:0027C6 F80004              +1576 	push	a			. new descriptor must be on stack top
  :                            1577 					. for tcp_xmit
  :                            1578 
00:0027C7 CFA00E              +1579 	dl	transmission:ack_window
00:0027C8 160008              +1580 	dsr	8
00:0027C9 0E0008              +1581 	sbr	8
00:0027CA C7000A              +1582 	ds	10
  :                            1583 
00:0027CB 3E0723              +1584 	lcal	tcp_award_window
  :                            1585 	
00:0027CC 500010              +1586 	lx 	AP_DATA
00:0027CD 600000              +1587 	la	r			. startbuffer returns
  :                            1588 					. the payload count in r
  :                            1589 
00:0027CE 3E0419              +1590 	lcal	tx_payload		. payload address if any
  :                            1591 					. is in Y
  :                            1592 
00:0027CF 500011              +1593 	lx	TP_HEADER
00:0027D0 B80F8E              +1594 	xorB	(00FFFF)		. it's become too right to be wrong enough
00:0027D1 C80012              +1595 	ab	TPAYLOAD_BYTES
00:0027D2 28A008              +1596 	sb	transfer:checksum
  :                            1597 
  :                            1598 	$if	0
  :                            1599 	ly	0, sp
  :                            1600 	ly	descriptor:dgram, y
  :                            1601 	la	dgram:vers_ihl_tos, y
  :                            1602 	or	4,,xi
  :                            1603 	sa	dgram:vers_ihl_tos, y
  :                            1604 	$endif
  :                            1605 
00:0027D3 3E0776              +1606 	lcal	tcp_xmit
00:0027D4 380003              +1607 	pop	y			. the descriptor
00:0027D5 380002              +1608 	pop	x			. the connection
00:0027D6 350001              +1609 	lret	1
  :                            1610 
  :                            1611 
  :                            1612 
  :                            1613 
  :                            1614 
  :                            1615 
  :                            1616 
  :                            1617 .	this primes a buffer to accumulate output
  :                            1618 .	length wanted for payload is in R
  :                            1619 .	hl_code is in A
  :                            1620 .	if header is over 5 longwords
  :                            1621 .	address of options list is in B
  :                            1622 
  :                            1623 .	the checksum seed is left in HEADER_SUM
  :                            1624 .	registers 6:7
  :                            1625 
  :                            1626 .	the checksum seed does not include ACK
  :                            1627 .	or window
  :                            1628 
  :                            1629 .	ACK is re-read from the transmission block
  :                            1630 .	each time some segments may be sent or
  :                            1631 .	resent
  :                            1632 
  :                            1633 .	window is generated new each time some
  :                            1634 .	segments may be sent or resent
  :                            1635 
  :                            1636 .	send or resend must include new window
  :                            1637 .	and ACK in the checksum, so those are
  :                            1638 .	not included here
  :                            1639 
  :                            1640 tcp_startbuffer	$tree
  :                            1641 
  :                            1642 	$if	1
  :                            1643 
                                	$head_near	scalars(addresses,	float,	transmission:socket_address	;
                                				option_string,	float192,	a			;
                                				save_rkxy,	float,		r			;
00:0027D7 8FA006              +1647 				axw_p,		int					)
00:0027D8 8F0008              +1647 
00:0027D9 8F0004              +1647 
00:0027DA 8F0000              +1647 
00:0027DB FD0000              +1647 
  :                            1648 
00:0027DC 000012              +1649 	sr	TPAYLOAD_BYTES
00:0027DD 06000C              +1650 	sar	12		. header longwords
00:0027DE 260002              +1651 	sal	2		. then bytes
00:0027DF C00000              +1652 	aa	r
  :                            1653 
00:0027E0 3E0835              +1654 	lcal	tcp_txbufferx
00:0027E1 C60822              +1655 	jza	txp_nostart
00:0027E2 20F000              +1656 	sa	axw_p
  :                            1657 
00:0027E3 580013              +1658         ly      TX_DATAGRAM
00:0027E4 CFF00D              +1659         dl      addresses
00:0027E5 160008              +1660         dsr     8
00:0027E6 0E0008              +1661         sbr     8
00:0027E7 C70006              +1662         ds      HEADER_SUM
00:0027E8 C7B006              +1663         ds      dgram:ipsource, y
00:0027E9 CFF00F              +1664         dl      addresses+2
00:0027EA 160008              +1665         dsr     8
00:0027EB 0E0008              +1666         sbr     8
00:0027EC C7B008              +1667         ds      dgram:ipdest, y
00:0027ED D70006              +1668 	da	HEADER_SUM
00:0027EE C70006              +1669 	ds	HEADER_SUM
  :                            1670 
00:0027EF 580011              +1671 	ly	TP_HEADER
00:0027F0 30B009              +1672 	z	transfer:urgent, y
00:0027F1 30B008              +1673 	z	transfer:checksum, y
00:0027F2 30B007              +1674 	z	transfer:window, y
00:0027F3 30B004              +1675 	z	transfer:ack, y
00:0027F4 30B005              +1676 	z	transfer:ack+1, y
  :                            1677 	
00:0027F5 50F003              +1678 	lx	save_rkxy+2			. connection
00:0027F6 CFA00C              +1679 	dl	transmission:sequence_ackx
00:0027F7 160008              +1680 	dsr	8
00:0027F8 0E0008              +1681 	sbr	8
00:0027F9 C7B002              +1682 	ds	transfer:seq, y
00:0027FA D70006              +1683 	da	HEADER_SUM
00:0027FB C70006              +1684 	ds	HEADER_SUM
  :                            1685 	
00:0027FC 60F00E              +1686 	la	addresses+1
00:0027FD 68F010              +1687 	lb	addresses+3
00:0027FE 360008              +1688 	dsl	8
00:0027FF 060008              +1689 	sar	8
00:002800 0E0008              +1690 	sbr	8
00:002801 C7B000              +1691 	ds	transfer:sourcep, y
  :                            1692 	
00:002802 D70006              +1693 	da	HEADER_SUM
00:002803 C70006              +1694 	ds	HEADER_SUM
  :                            1695 
00:002804 60F005              +1696 	la	option_string			. header length / flags
00:002805 20B006              +1697 	sa	transfer:hl_code, y
00:002806 6D0006              +1698 	lb	IPPROTO_TCP,,xi
00:002807 D70006              +1699 	da	HEADER_SUM
00:002808 C70006              +1700 	ds	HEADER_SUM
  :                            1701 
00:002809 68F005              +1702 	lb	option_string			. header words
00:00280A 0E000C              +1703 	sbr	12
00:00280B 280010              +1704 	sb	HEADER_LONGWORDS
00:00280C CDFFFB              +1705 	ab	-5,,xi
00:00280D 580011              +1706 	ly	TP_HEADER
00:00280E 8D000A              +1707 	ay	20/2,,xi
00:00280F CE0812              +1708 	jzb	tcp_sendno_options
  :                            1709 
00:002810 64F007              +1710 	la	option_string+2,,i
00:002811 3E0828              +1711 	lcal	tcp_send_options
  :                            1712 
  :                            1713 tcp_sendno_options
00:002812 680010              +1714 	lb	HEADER_LONGWORDS
00:002813 180010              +1715 	sy	AP_DATA
00:002814 60F000              +1716 	la	axw_p
00:002815 18C006              +1717 	sy	descriptor:apdata, a
  :                            1718 
00:002816 400012              +1719 	lr	TPAYLOAD_BYTES
00:002817 00F001              +1720 	sr	save_rkxy			. returned in r
00:002818 2E0002              +1721 	sbl	2
00:002819 28C003              +1722 	sb	descriptor:bytes, a
00:00281A C80000              +1723 	ab	r
00:00281B 280012              +1724 	sb	TPAYLOAD_BYTES
  :                            1725 
00:00281C 380004              +1726 	pop	a
00:00281D 870000              +1727 	qpop	r
00:00281E 87F000              +1728 	qpop	0, sp
00:00281F 87F000              +1729 	qpop	0, sp
00:002820 87F000              +1730 	qpop	0, sp
00:002821 350001              +1731 	lret	1		. buffer obtained and prepped
  :                            1732 
  :                            1733 txp_nostart
00:002822 380004              +1734 	pop	a
00:002823 870000              +1735 	qpop	r
00:002824 87F000              +1736 	qpop	0, sp
00:002825 87F000              +1737 	qpop	0, sp
00:002826 87F000              +1738 	qpop	0, sp
00:002827 350000              +1739 	lret	0		. buffer not obtained		
  :                            1740 
  :                            1741 	$else
  :                            1742 
  :                            1743 	push	x		. connection block
  :                            1744 	push	a		. header length / flags
  :                            1745 	push	6,,xi		. address of options program
  :                            1746 	sr	TPAYLOAD_BYTES	. payload bytes
  :                            1747 	sar	12
  :                            1748 	sal	2
  :                            1749 	aa	r		. buffer required for TCP segment
  :                            1750 	push	y
  :                            1751 
  :                            1752 	lcal	tcp_txbufferx	. tlist block must be at BSOCKET or you crash
  :                            1753 				. if you are process *ip the system restarts
  :                            1754 
  :                            1755 	pop	y		. quite likely the user data pointer
  :                            1756 
  :                            1757 	dpop	6		. address of options, header format word
  :                            1758 
  :                            1759 	pop	x		. connection
  :                            1760 	jza	tcp_nostart
  :                            1761 
  :                            1762 	sb	descriptor:bytes, a
  :                            1763 	
  :                            1764 	push	y		. user buffer if any
  :                            1765 	push	a		. the new descriptor
  :                            1766 
  :                            1767 	ly	TP_HEADER
  :                            1768 	z	transfer:urgent, y
  :                            1769 	z	transfer:checksum, y
  :                            1770 
  :                            1771 
  :                            1772 	qpush	transmission:socket_address, x
  :                            1773 	qpop	8
  :                            1774 
  :                            1775 	push, xi   0		. window
  :                            1776 	
  :                            1777 	push	7		. header format word
  :                            1778 
  :                            1779 	push, xi   0
  :                            1780 	push, xi   0		. ACK
  :                            1781 
  :                            1782 	dl	transmission:sequence_ackx, x
  :                            1783 	dsr	8
  :                            1784 	sbr	8
  :                            1785 	dpush	a		. SEQ
  :                            1786 
  :                            1787 	la	9
  :                            1788 	sal	8
  :                            1789 	lb	11
  :                            1790 	sbl	8
  :                            1791 	dsr	8
  :                            1792 
  :                            1793 	dpush	a		. ports
  :                            1794 
  :                            1795 	lb	7
  :                            1796 	sbr	12
  :                            1797 
  :                            1798 	sb	HEADER_LONGWORDS
  :                            1799 	
  :                            1800 	lb, xi	0
  :                            1801 	la, xi	IPPROTO_TCP
  :                            1802 
  :                            1803 	da	transfer:sourcep, sp
  :                            1804 	da	transfer:seq, sp
  :                            1805 .	da	transfer:ack, sp	. zero just now
  :                            1806 	da	transfer:hl_code, sp
  :                            1807 
  :                            1808 	dpush	6		. default options list
  :                            1809 
  :                            1810 	ds	HEADER_SUM
  :                            1811 
  :                            1812 	dpop	d$save
  :                            1813 
  :                            1814 	qpop	transfer:sourcep, y
  :                            1815 	qpop	transfer:ack, y
  :                            1816 
  :                            1817 	z	transfer:urgent, y
  :                            1818 
  :                            1819 	lb	HEADER_LONGWORDS
  :                            1820 
  :                            1821 	ab, xi	-5
  :                            1822 
  :                            1823 	ay, xi	20/2
  :                            1824 	jzb	tcp_sendno_options
  :                            1825 
  :                            1826 	la	d$save,,xi
  :                            1827 	lcal	tcp_send_options
  :                            1828 
  :                            1829 tcp_sendno_options
  :                            1830 	la	0, sp		. the descriptor
  :                            1831 	sy	descriptor:apdata, a
  :                            1832 	lb	HEADER_LONGWORDS
  :                            1833 
  :                            1834 	sbl	2
  :                            1835 	lr	TPAYLOAD_BYTES
  :                            1836 	sb	descriptor:bytes, a
  :                            1837 
  :                            1838 
  :                            1839 				. only the header byte count
  :                            1840 				. should go in the descriptor
  :                            1841 				. because this may be called
  :                            1842 				. to prime a buffer for
  :                            1843 				. streamed writing
  :                            1844 
  :                            1845 				. R is for how much space
  :                            1846 				. is required, not how much
  :                            1847 				. data is available
  :                            1848 
  :                            1849 	ab	r
  :                            1850 	sb	TPAYLOAD_BYTES	. save the total for
  :                            1851 				. direct message writes
  :                            1852 
  :                            1853 	sy	AP_DATA
  :                            1854 	ly	TX_DATAGRAM
  :                            1855 	dl	8
  :                            1856 	dsr	8
  :                            1857 	sbr	8
  :                            1858 	ds	dgram:ipsource, y
  :                            1859 	ds	8
  :                            1860 	da	HEADER_SUM	. the checksum
  :                            1861 	ds	HEADER_SUM
  :                            1862 	dl	10
  :                            1863 	dsr	8
  :                            1864 	sbr	8
  :                            1865 	ds	10
  :                            1866 	ds	dgram:ipdest, y
  :                            1867 	da	HEADER_SUM
  :                            1868 	ds	HEADER_SUM
  :                            1869 	pop	a		. the descriptor
  :                            1870 	pop	y
  :                            1871 	lret	1		. return +1 = buffer found
  :                            1872 
  :                            1873 tcp_nostart
  :                            1874 .	lx	y		. ? that looks deadly ? return without connection pointer
  :                            1875 
  :                            1876 				. removed instruction was bad for some callers
  :                            1877 				. and didn't appear good for any other callers
  :                            1878 
  :                            1879 				. callers are (indirectly) far calls tcp_add and tcp_addx
  :                            1880 				. which certainly need x -> connection block unchanged on return
  :                            1881 
  :                            1882 				. and otherwise far calls tcp_accept tcp_ack_fin tcp_send_push
  :                            1883 				. and local calls tcp_send_ack tcp_sendq tcp_sendq2
  :                            1884 				. none of which appears to need the connection pointer lost
  :                            1885 
  :                            1886 	lret	0		. return +0 = no buffer found
  :                            1887 
  :                            1888 	$endif
  :                            1889 
  :                            1890 	$root
  :                            1891 
  :                            1892 
  :                            1893 tcp_send_options
00:002828 F80002              +1894 	push	x		. the connection
00:002829 500004              +1895 	lx	a		. the option list address
00:00282A 400005              +1896 	lr	b		. the longword count
00:00282B B60832              +1897 	j	tcp_send_option?
  :                            1898 tcp_send_option!
00:00282C CFA000              +1899 	dl	0, x
00:00282D C7B000              +1900 	ds	0, y
00:00282E D70006              +1901 	da	HEADER_SUM
00:00282F C70006              +1902 	ds	HEADER_SUM
00:002830 850002              +1903 	ax, xi	2
00:002831 8D0002              +1904 	ay, xi	2
  :                            1905 tcp_send_option?
00:002832 1E082C              +1906 	jdr	tcp_send_option!
00:002833 380002              +1907 	pop	x		. the connection
00:002834 350000              +1908 	lret	0
  :                            1909 	
  :                            1910 	$if	0
  :                            1911 tcp_send
  :                            1912 	fret	0
  :                            1913 
  :                            1914 tcp_complete_segment?
  :                            1915 	tz	transmission:q4window:head
  :                            1916 	lret	0
  :                            1917 tcp_complete_segment!
  :                            1918 	ly	transmission:q4window:tail
  :                            1919 	la	descriptor:bytes, y
  :                            1920 	jna	tcp_segment_completed
  :                            1921 	jza	tcp_segment_void		. would happen with send of zero
  :                            1922 
  :                            1923 
  :                            1924 tcp_segment_completed
  :                            1925 	lret	0
  :                            1926 tcp_segment_void
  :                            1927 	lret	1
  :                            1928 	$endif
  :                            1929 
  :                            1930 tcp_txbufferx
00:002835 508FBB              +1931 	lx	*(BSOCKET*/12++tlist:txbu_p)	. tlist block must be at BSOCKET or you crash
  :                            1932 .	lb, xi	04500	. preloaded		. if you are process *ip the system restarts
00:002836 F80004              +1933 	push	a
00:002837 3E01E5              +1934 	lcal	ip_buy_datagram_alternate
00:002838 380005              +1935 	pop	b
00:002839 B6083E              +1936 	j	tcp_txbuffer_initial
  :                            1937 	
  :                            1938 tcp_txbuffer
00:00283A 6D4500              +1939 	lb, xi	04500
  :                            1940 tcp_txbuffer_optional
00:00283B F80004              +1941 	push	a		. TCP header + payload length
00:00283C 3E01E4              +1942 	lcal	ip_buy_datagram
00:00283D 380005              +1943 	pop	b
  :                            1944 
  :                            1945 tcp_txbuffer_initial
00:00283E C60844              +1946 	jza	tcp_nobuffer
00:00283F 28C003              +1947 	sb	descriptor:bytes, a
00:002840 500013              +1948 	lx	TX_DATAGRAM
00:002841 6D3C06              +1949 	lb,xi	IP_DEFAULT_TTL++IPPROTO_TCP
00:002842 28A004              +1950 	sb	dgram:ttl_protocol, x
00:002843 500011              +1951 	lx	TP_HEADER
  :                            1952 tcp_nobuffer
00:002844 350000              +1953 	lret	0
  :                            1954 
  :                            1955 
  :                            1956 .	buffer queues which are shared between tasks have to be accessed
  :                            1957 .	in a protected way. They are mainly the queues which both the IP
  :                            1958 .	task and an application protocol access. Some application protocols
  :                            1959 .	are in the IP task and some are not
  :                            1960 
  :                            1961 .	it would be quite bad to place TS cells in every queue structure
  :                            1962 .	because not all queues need them. Sockets and connections are the
  :                            1963 .	best available place for these lock cells
  :                            1964 
  :                            1965 .	all this code is SMP, so the code
  :                            1966 
  :                            1967 .	1.	prevents itself from getting interrupted or switched
  :                            1968 .	2.	locks the connection
  :                            1969 .	3.	updates the queue
  :                            1970 .	4.	frees the lock
  :                            1971 .	5.	reloads the interrupt mask it had before
  :                            1972 
  :                            1973 
  :                            1974 .	tcp_write_rxq is called from TCP in the IP task
  :                            1975 
  :                            1976 	$if	TCP_NOQ
  :                            1977 
  :                            1978 tcp_write_rxq			. descriptor is in a
  :                            1979 
  :                            1980 	$if	HVSOCKET
00:002845 788F9C              +1981 	tp	*(BSOCKET*/12++tlist:flags)
00:002846 B60851              +1982 	j	tcp_write_hvsocket_rxq
  :                            1983 	$endif
  :                            1984 
00:002847 FD0007              +1985 	LOCK	transmission:tsq
00:002848 27F000              +1985 
00:002849 07A003              +1985 
00:00284A B60849              +1985 
00:00284B 5CA010              +1986 	ly	transmission:receiveq,,i
00:00284C 3E0E96              +1987 	lcal	q2
  :                            1988 
  :                            1989 	$if	RX_FRAGMENTS
  :                            1990 	lcal	ip_fragments_thru
  :                            1991 	$endif
  :                            1992 
00:00284D 30A003              +1993 	FREE	transmission:tsq
00:00284E 27F000              +1993 
00:00284F 17000F              +1993 
00:002850 350000              +1994 	lret	0
  :                            1995 
  :                            1996 	$if	HVSOCKET
  :                            1997 tcp_write_hvsocket_rxq
00:002851 FF0FBC              +1998 	call	(hvsocket_write_rxq)
00:002852 350000              +1999 	lret	0
  :                            2000 	$endif
  :                            2001 
  :                            2002 	$else
  :                            2003 
  :                            2004 tcp_write_rxq			. descriptor is tcpq:head
  :                            2005 
  :                            2006 	LOCK	transmission:tsq
  :                            2007 	la, i	transmission:receiveq
  :                            2008 	ly, xi	tcpq
  :                            2009 	lcal	net_transfer
  :                            2010 	FREE	transmission:tsq
  :                            2011 	lret	0
  :                            2012 
  :                            2013 	$endif
  :                            2014 
  :                            2015 .	tcp_read_rxq is called from the socket user
  :                            2016 .	indirectly, nested in a far call to receive
  :                            2017 
  :                            2018 tcp_read_rxq
00:002853 FD0007              +2019 	push,xi	MAX_INT_MASK
00:002854 27F000              +2020 	sim	0, sp
00:002855 07A003              +2021 	ts	transmission:tsq
00:002856 B60855              +2022 	j	$-1
00:002857 5CA010              +2023 	ly, i	transmission:receiveq
00:002858 3E0EA1              +2024 	lcal	readq
00:002859 30A003              +2025 	z	transmission:tsq
00:00285A 27F000              +2026 	sim	0, sp
00:00285B 17000F              +2027 	inc	sp
00:00285C 350000              +2028 	lret	0
  :                            2029 
  :                            2030 .	tcp_write_txq is called in many places in TCP
  :                            2031 .	and also from socket users, nested in far calls
  :                            2032 .	to send
  :                            2033 
  :                            2034 .	the connection block transmission: is in x
  :                            2035 
  :                            2036 tcp_write_txq
  :                            2037 
  :                            2038 	$if	1
  :                            2039 
00:00285D FD0007              +2040 	LOCK	transmission:tsq
00:00285E 27F000              +2040 
00:00285F 07A003              +2040 
00:002860 B6085F              +2040 
00:002861 5CA014              +2041 	ly	transmission:q4window,,i
00:002862 3E0E96              +2042 	lcal	q2
00:002863 30A003              +2043 	FREE	transmission:tsq
00:002864 27F000              +2043 
00:002865 17000F              +2043 
00:002866 350000              +2044 	lret	0
  :                            2045 
  :                            2046 	$else
  :                            2047 
  :                            2048 	push,xi	MAX_INT_MASK
  :                            2049 	sim	0, sp
  :                            2050 	ts	transmission:tsq
  :                            2051 	j	$-1
  :                            2052 	ly, i	transmission:q4window
  :                            2053 	lcal	q2
  :                            2054 	z	transmission:tsq
  :                            2055 	sim	0, sp
  :                            2056 	inc	sp
  :                            2057 	lret	0
  :                            2058 
  :                            2059 	$endif
  :                            2060 
  :                            2061 .	tcp calls tcp_read_txq when it moves segments
  :                            2062 .	from q4window to q4ack
  :                            2063 
  :                            2064 tcp_read_txq
  :                            2065 	$if	1
00:002867 FD0007              +2066 	LOCK	transmission:tsq
00:002868 27F000              +2066 
00:002869 07A003              +2066 
00:00286A B60869              +2066 
00:00286B 5CA014              +2067 	ly	transmission:q4window,,i
00:00286C 3E0EA1              +2068 	lcal	readq
00:00286D 30A003              +2069 	FREE	transmission:tsq
00:00286E 27F000              +2069 
00:00286F 17000F              +2069 
00:002870 350000              +2070 	lret	0
  :                            2071 
  :                            2072 	$else
  :                            2073 
  :                            2074 	push,xi	MAX_INT_MASK
  :                            2075 	sim	0, sp
  :                            2076 	ts	transmission:tsq
  :                            2077 	j	$-1
  :                            2078 	ly, i	transmission:q4window
  :                            2079 	lcal	readq
  :                            2080 .	z	0, a		. you might didn't get no address in a
  :                            2081 	z	transmission:tsq
  :                            2082 	sim	0, sp
  :                            2083 	inc	sp
  :                            2084 	lret	0
  :                            2085 	$endif
  :                            2086 
  :                            2087 				. low level far calls
  :                            2088 				. for message-based TCP traffic
  :                            2089 
  :                            2090 tcp_rsegment			. vector name tcpr
00:002871 F80002              +2091 	push	x		. read a descriptor from connection->receiveq
00:002872 3E0853              +2092 	lcal	tcp_read_rxq	. under lock
00:002873 380002              +2093 	pop	x
00:002874 3D0000              +2094 	fret	0
  :                            2095 
  :                            2096 tcp_zsegment			. vector name tpcz
00:002875 C60879              +2097 	jza	tcp_xsegment	. pool descriptor a-> +  buffer
00:002876 F80002              +2098 	push	x
00:002877 3E08B3              +2099 	lcal	tcp_free
00:002878 380002              +2100 	pop	x
  :                            2101 tcp_xsegment
00:002879 3D0000              +2102 	fret	0
  :                            2103 
  :                            2104 tcp_textline_release		. vector name tcp_release_rxline
00:00287A F80002              +2105 	push	x		. read a descriptor + buffer from connection:receiveq
00:00287B 3E0853              +2106 	lcal	tcp_read_rxq				. under lock and pool it 
00:00287C C6087E              +2107 	jza	tcp_textline_not_there
00:00287D 3E08B3              +2108 	lcal	tcp_free
  :                            2109 tcp_textline_not_there
00:00287E 380002              +2110 	pop	x
00:00287F 3D0000              +2111 	fret	0
  :                            2112 
  :                            2113 tcp_hash_connect
00:002880 788FBD              +2114 	tp	*(BSOCKET*/18++tlist:flags:S)
00:002881 B6088B              +2115 	j	tcp_hashremote
  :                            2116 
  :                            2117 
  :                            2118 	$if	1
  :                            2119 
  :                            2120 p	$proc
  :                            2121 tcp_hash_fold* $name
  :                            2122 	rbl	CHAINS_LOG
  :                            2123 	xor	b
  :                            2124 	$end
  :                            2125 	
  :                            2126 tcp_hashlocal					. input is local port number
  :                            2127 
  :                            2128 	$if	16//CHAINS_LOG<3		. for example 256 chains log 8
  :                            2129 
  :                            2130 	la	9
  :                            2131 	sal	8
  :                            2132 	dsr	8+CHAINS_LOG
  :                            2133 	sbr	24-CHAINS_LOG
  :                            2134 	xor	b
  :                            2135 	fret	0
  :                            2136 
  :                            2137 	$elseif	16//CHAINS_LOG<5
  :                            2138 
00:002882 600009              +2139 	la	9
00:002883 260008              +2140 	sal	8
00:002884 160012              +2141 	dsr	8+(16//CHAINS_LOG)//2*CHAINS_LOG	. slide large half of slices to b
00:002885 0E000E              +2142 	sbr	24-(16//CHAINS_LOG)//2*CHAINS_LOG
00:002886 B00005              +2143 	xor	b					. xor 2 slices to 1..2 slices
  :                            2144 
00:002887 160005              +2145 	dsr	CHAINS_LOG
00:002888 0E0013              +2146 	sbr	24-CHAINS_LOG				. xor 1 slice to 1 slice
00:002889 B00005              +2147 	xor	b
00:00288A 3D0000              +2148 	fret	0
  :                            2149 
  :                            2150 	$else					. for example 8 chains log 3
  :                            2151 
  :                            2152 	la	9
  :                            2153 	sal	8
  :                            2154 	dsr	8+(16//CHAINS_LOG)//3*CHAINS_LOG*2
  :                            2155 	sbr	24-(16//CHAINS_LOG)//3*CHAINS_LOG*2
  :                            2156 	xor	b
  :                            2157 	sbr	CHAINS_LOG*(16//CHAINS_LOG)//3
  :                            2158 	xor	b
  :                            2159 	dsr	CHAINS_LOG
  :                            2160 	sbr	24-CHAINS_LOG
  :                            2161 	xor	b
  :                            2162 	and	CHAINS_MASK,,xi
  :                            2163 	fret	0
  :                            2164 
  :                            2165 	$endif
  :                            2166 
  :                            2167 tcp_hashremote		. input is remote socket netaddress:port
  :                            2168 
  :                            2169 	$if	24//CHAINS_LOG<3
  :                            2170 
  :                            2171 	$flag	hash CHAINS > 2048 not supported
  :                            2172 
  :                            2173 	$elseif	24//CHAINS_LOG<4
  :                            2174 
  :                            2175 	dl	10
  :                            2176 	xor	b
  :                            2177 	dsr	CHAINS_LOG*2
  :                            2178 	sbr	24-CHAINS_LOG*2
  :                            2179 	xor	b
  :                            2180 	sbr	CHAINS_LOG
  :                            2181 	xor	b
  :                            2182 	and	CHAINS_MASK,,xi
  :                            2183 	fret	0
  :                            2184 
  :                            2185 
  :                            2186 	$elseif	24//CHAINS_LOG<5
  :                            2187 
  :                            2188 	dl	10
  :                            2189 	xor	b
  :                            2190 	dsr	CHAINS_LOG*(24//CHAINS_LOG)//2
  :                            2191 	sbr	24-CHAINS_LOG*(24//CHAINS_LOG)//2
  :                            2192 	xor	b
  :                            2193 	dsr	CHAINS_LOG
  :                            2194 	sbr	24-CHAINS_LOG
  :                            2195 	xor	b
  :                            2196 	fret	0
  :                            2197 
  :                            2198 	$elseif	24//CHAINS_LOG<7
  :                            2199 
00:00288B CF000A              +2200 	dl	10
00:00288C B00005              +2201 	xor	b
00:00288D 160014              +2202 	dsr	CHAINS_LOG*2*((24//CHAINS_LOG)//3)
00:00288E 0E0004              +2203 	sbr	24-CHAINS_LOG*2*((24//CHAINS_LOG)//3)
00:00288F B00005              +2204 	xor	b
00:002890 0E000A              +2205 	sbr	CHAINS_LOG*2
00:002891 B00005              +2206 	xor	b
00:002892 160005              +2207 	dsr	CHAINS_LOG
00:002893 0E0013              +2208 	sbr	24-CHAINS_LOG
00:002894 B00005              +2209 	xor	b
00:002895 A5001F              +2210 	and	CHAINS_MASK,,xi
00:002896 3D0000              +2211 	fret	0
  :                            2212 	
  :                            2213 	$elseif	24//CHAINS_LOG<9
  :                            2214 
  :                            2215 	dl	10
  :                            2216 	xor	b
  :                            2217 	dsr	CHAINS_LOG*(24//CHAINS_LOG)//2
  :                            2218 	sbr	24-CHAINS_LOG*(24//CHAINS_LOG)//2
  :                            2219 	xor	b
  :                            2220 	dsr	CHAINS_LOG*(24//CHAINS_LOG)//4
  :                            2221 	sbr	24-CHAINS_LOG*(24//CHAINS_LOG)//4
  :                            2222 	xor	b
  :                            2223 	dsr	CHAINS_LOG
  :                            2224 	sbr	24-CHAINS_LOG
  :                            2225 	xor	b
  :                            2226 	fret	0
  :                            2227 
  :                            2228 	$else
  :                            2229 
  :                            2230 	dl	10
  :                            2231 	xor	b
  :                            2232 	$if	24///CHAINS_LOG
  :                            2233 	dsr	24-24///CHAINS_LOG		. keep the lesser slice in a
  :                            2234 	$else					. or else
  :                            2235 	dsr	24-CHAINS_LOG			. keep one equal slice in a
  :                            2236 	$endif
  :                            2237 	$do	24//CHAINS_LOG-1,	tcp_hash_fold
  :                            2238 	and	CHAINS_MASK,,xi
  :                            2239 	fret	0
  :                            2240 	$endif
  :                            2241 
  :                            2242 	
  :                            2243 tcp_xdisco		. vector is xdisco
  :                            2244 			. low level connection close
  :                            2245 			. connection in x
  :                            2246 
00:002897 60A001              +2247 	la	transmission:state
00:002898 680004              +2248 	anu, xi	TCP_CLOSEWAIT	. remote close received
00:002899 DD0008              +2248 
  :                            2249 				. close from local socket awaited
  :                            2250 
00:00289A CE08A5              +2251 	jzb	tcp_xclosewait
  :                            2252 
  :                            2253 	$if	0
  :                            2254 
  :                            2255 	j	tcp_xfinwait1	. treat timeout
  :                            2256 				. as outgoing close
  :                            2257 	$else
  :                            2258 
00:00289B CD0003              +2259 	ab, xi	TCP_CLOSEWAIT-TCP_ESTABLISHED
00:00289C CE08A0              +2260 	jzb	tcp_xfinwait1
  :                            2261 
  :                            2262 	$endif
  :                            2263 
  :                            2264 tcp_xclose
  :                            2265 				. it's been ripped and the owner knows
00:00289D FD000C              +2266 	push,xi	TCP_DELETETCB	. It can be really reassigned
00:00289E 38A001              +2267 	pop	transmission:state
00:00289F 3D0000              +2268 	fret	0
  :                            2269 
  :                            2270 tcp_xfinwait1			. outgoing close
00:0028A0 FF0FBE              +2271 	call	(tcp_ack_fin)
00:0028A1 B6089D              +2272 	j	tcp_xclose	. better delete roughly
  :                            2273 				. if you could not send ACK++FIN
  :                            2274 
00:0028A2 FD0006              +2275 	push,xi	TCP_FINWAIT1
00:0028A3 38A001              +2276 	pop	transmission:state
00:0028A4 B608A9              +2277 	j	tcp_xfin_upsequence
  :                            2278 
  :                            2279 tcp_xclosewait			. passive close
00:0028A5 FF0FBE              +2280 	call	(tcp_ack_fin)	. 
00:0028A6 B6089D              +2281 	j	tcp_xclose	. better delete roughly
  :                            2282 				. if you could not send ACK++FIN
  :                            2283 
00:0028A7 FD0009              +2284 	push,xi TCP_LASTACK
00:0028A8 38A001              +2285 	pop	transmission:state
  :                            2286 
  :                            2287 tcp_xfin_upsequence
  :                            2288 
00:0028A9 CFA00C              +2289 	dl	transmission:sequence_ackx
00:0028AA D70F9F              +2290 	da	(65536d)
00:0028AB C7A00C              +2291 	ds	transmission:sequence_ackx
00:0028AC 3D0000              +2292 	fret	0
  :                            2293 
  :                            2294 	$if	RX_FRAGMENTS
  :                            2295 tcp_rx_rasm
  :                            2296 	lx	descriptor:uproto
  :                            2297 	push	transfer:checksum, x
  :                            2298 	lcal	rasm77_gcheck
  :                            2299 	xorB	0, sp
  :                            2300 	pop	transfer:checksum, x
  :                            2301 	la	fp
  :                            2302 	jnzb	net_free_chain
  :                            2303 	lx, xi	tcpq
  :                            2304 	j	net_add_chain
  :                            2305 	$endif
  :                            2306 
  :                            2307 .	do not call tcp_socket from application threads
  :                            2308 .	even in kernel routines called by applications
  :                            2309 .	like send receive read write etc
  :                            2310 .	because tcp_socket reads kernel vectors direct
  :                            2311 .	and is called every rx segment so is minimal
  :                            2312 .	application threads call app_tcp_port
  :                            2313 .	which requests kernel vector
  :                            2314 .	on occasional need to access port structure
  :                            2315 
  :                            2316 tcp_socket
  :                            2317 
  :                            2318 	$if	1
  :                            2319 
00:0028AD F80002              +2320 	push	x
00:0028AE 552100              +2321 	lx	tsockb(1),,xi
00:0028AF 3E0A14              +2322 	lcal	protocol_socket
00:0028B0 380002              +2323 	pop	x
  :                            2324 
  :                            2325 	$else
  :                            2326 
  :                            2327         lb, xi  BSOCKET*/9      .       000 000 000 bbb bbb 000 000 000
  :                            2328 
  :                            2329                                 .       000 000 000 000 000 00p ppp ppp : A
  :                            2330         dsr     9               .       ppp ppp ppp 000 000 000 bbb bbb : B
  :                            2331 	and	127,,xi
  :                            2332         aa, xi  tsockb(1)       .       000 000 000 010 000 11p ppp ppp : A
  :                            2333 
  :                            2334         la      0, a            .       is there even storage where the
  :                            2335                                 .       bound socket structure should be?
  :                            2336 
  :                            2337         jza     tcp_socketx
  :                            2338 
  :                            2339         rbr     12              .       000 000 bbb bbb ooo ooo ooo 000
  :                            2340 
  :                            2341 	$endif
  :                            2342 
00:0028B1 34002F              +2343         sabr    BSOCKET         .       look at the port socket structure
  :                            2344 tcp_socketx
00:0028B2 350000              +2345 	lret	0
  :                            2346 
  :                            2347 tcp_free
00:0028B3 508FA5              +2348 	lx	*(BSOCKET*/12++tlist:rxbu_p)
00:0028B4 3E0E49              +2349 	lcal	sell1
00:0028B5 350000              +2350 	lret	0
  :                            2351 
  :                            2352 tcp_free_tx
00:0028B6 508FBB              +2353 	lx	*(BSOCKET*/12++tlist:txbu_p)
00:0028B7 3E0E49              +2354 	lcal	sell1
00:0028B8 350000              +2355 	lret	0
  :                            2356 
  :                            2357: 	$include	tcp4ruti
  :                            1 tcp_event1_acknowledged?
  :                            2 
  :                            3 __REMOTE_ACK	$equf	1, sp
  :                            4 
00:0028B9 CFA00C              +5 	dl	transmission:sequence_ackx
00:0028BA A80FBF              +6 	andB	(0FF0000s)			. ls 16 bits aren't used yet, but...
00:0028BB DFF001              +7 	dan	__REMOTE_ACK			. is the new remote ACK
00:0028BC 350000              +8 	lret	0
  :                            9 
  :                            10 tcp_restart_timer2
  :                            11 	$if	TCP_TIMER2<32768
00:0028BD 650BB8              +12 	la	TCP_TIMER2,,xi
  :                            13 	$else
  :                            14 	la	(TCP_TIMER2)
  :                            15 	$endif
  :                            16 
  :                            17 	$if	HVSOCKET
00:0028BE 788F9C              +18 	tp	*(BSOCKET*/12++tlist:flags)
00:0028BF 260003              +19 	sal	HVSOCKET_LOG				. lcal	tcp_stretch_timer2
  :                            20 	$endif					. timer(2) is stretched by waiting
  :                            21 						. for service to hv connection blocks
  :                            22 						. traffic = restart timer(2)
00:0028C0 C00097              +23 	aa	DAYCLOCK$
00:0028C1 20A005              +24 	sa	transmission:timer(2)
00:0028C2 350000              +25 	lret	0
  :                            26 
  :                            27 	$if	0				. HVSOCKET
  :                            28 tcp_stretch_timer2
  :                            29 	$if	1
  :                            30 
  :                            31 	push	b
  :                            32 	lb	tcp_superpages
  :                            33 	sbl	HVSOCKET_LOG			. add 128 milliseconds (1 << LOG)
  :                            34 	aa	b				. for each HV connections block in use
  :                            35 	pop	b
  :                            36 	lret	0
  :                            37 
  :                            38 	$else
  :                            39 
  :                            40 	push	b
  :                            41 	lb	tcp_superpages						. number of connection tanks
  :                            42 	sbl	7
  :                            43 	aa	b
  :                            44 	lb	*(BSOCKET*/12++tlist:connection_block(1):timer(2))	. log of connections
  :                            45 	sbl	2							. in this tank
  :                            46 	aa	b
  :                            47 	pop	b
  :                            48 	lret	0
  :                            49 	$endif
  :                            50 	$endif
  :                            51 
  :                            52 tcp_start_timewait
  :                            53 	$if	TCP_TIMEWAIT_MS<32768
00:0028C3 652710              +54 	la	TCP_TIMEWAIT_MS,,xi
  :                            55 	$else
  :                            56 	la	(TCP_TIMEWAIT_MS)
  :                            57 	$endif
  :                            58 
00:0028C4 B608C6              +59 	j	tcp_add_timer1
  :                            60 
  :                            61 tcp_restart_timer1
00:0028C5 600FC0              +62 	la	(TCP_TIMER1)			. something arrived
  :                            63 tcp_add_timer1
00:0028C6 C00097              +64 	aa	DAYCLOCK$			. restart the big timer
  :                            65 .	jnza	tcp_store_timer1
00:0028C7 950001              +66 	or, xi	1				. but don't restart it to zero
  :                            67 tcp_store_timer1
00:0028C8 20A004              +68 	sa	transmission:timer(1)
00:0028C9 350000              +69 	lret	0
  :                            70 
  :                            71 tcp4_reset_dq_lx
00:0028CA 500011              +72 	lx	TP_HEADER
  :                            73 tcp4_reset_dq
00:0028CB 60A006              +74 	la	transfer:hl_code
00:0028CC A50004              +75 	and	TCP_RST,,xi
00:0028CD D608D0              +76 	jnza	tcp4_reset_dqx			. don't answer a reset
  :                            77 
00:0028CE 58E004              +78 	ly	descriptor:dgram
00:0028CF 3E0788              +79 	lcal	tcp_reject
  :                            80 tcp4_reset_dqx
00:0028D0 350000              +81 	lret	0
  :                            82 
  :                            83 	$if	HVSOCKET
  :                            84 tcp4_net_free_txdatagram
00:0028D1 3E0EA1              +85 	lcal	readq
00:0028D2 C608D7              +86 	jza	tcp4_net_free_txdatagram_no_action
00:0028D3 9F0002              +87 	dpush	x
00:0028D4 3E08B6              +88 	lcal	tcp_free_tx
00:0028D5 380002              +89 	dpop	x
00:0028D6 380003              +89 
  :                            90 tcp4_net_free_txdatagram_no_action
00:0028D7 350000              +91 	lret	0
  :                            92 	$endif
  :                            93 
  :                            94 tcp4_rxaction	$tree	. all calling routines have fp -> rx segment descriptor
  :                            95 
                                	$head_near	scalars(connection,	int,	x	;
                                				ACK_AWAITED,	int		;
                                				state,		int		;
                                				received_seq,	long		;
00:0028D8 F80002              +100 				remote_ack,	long		)
00:0028D9 FD0000              +100 
00:0028DA FD0000              +100 
00:0028DB 9F0FC1              +100 
00:0028DC 9F0FC1              +100 
  :                            101 
  :                            102 	$if	TCP_NOQ
  :                            103 
  :                            104 	.	buffer acquire t_ibuffer writes descriptor to fp
  :                            105 	.	fp is saved in case a buffer is bought for SYN_ACK.RST.ACK_FIN
  :                            106 	.	and should be reloaded after
  :                            107 
  :                            108 	$else
  :                            109 	sa	fp
  :                            110 	dl	descriptor:sobdi
  :                            111 	sabr	BSOCKET
  :                            112 	la	s:tcp:tbase, b
  :                            113 	sabr	BSOCKET
  :                            114 	$endif
  :                            115 
00:0028DD 3E0660              +116 	lcal	tcp_locate_connection
00:0028DE 700002              +117 	tz	x
00:0028DF B608EF              +118 	j	tcp_connection_located	.
  :                            119 
  :                            120 					. so is it an incoming connect?
00:0028E0 50E005              +121 	lx	descriptor:uproto
00:0028E1 100011              +122 	sx	TP_HEADER
00:0028E2 60A006              +123 	la	transfer:hl_code, x
00:0028E3 20001B              +124 	sa	HL_FLAGS
  :                            125 
00:0028E4 A50016              +126 	and, xi	TCP_SYN++TCP_ACK++TCP_RST
00:0028E5 B50002              +127 	xor, xi	TCP_SYN
00:0028E6 C608EB              +128 	jza	tcp4_accept
  :                            129 
  :                            130 tcp_reset_dq_lx
00:0028E7 3E08CA              +131 	lcal	tcp4_reset_dq_lx		. similar case to IP input loop
00:0028E8 B60A02              +132 	j	tcp_stepover_response		. nothing listening, but we must
  :                            133 						. dq from tcpq and drop, send RST
  :                            134 						. and continue in this loop here
  :                            135 tcp_accept_fail2
00:0028E9 10F006              +136 	sx	connection
00:0028EA B609DB              +137 	j	tcp_ripdown_reset
  :                            138 
  :                            139 .	lcal	tcp4_ripdown_reset
  :                            140 .	j	tcp_stepover_response
  :                            141 						. either q the request to
  :                            142 						. the listening socket owner
  :                            143 						. or do this automatic accept
  :                            144 tcp4_accept
00:0028EB 3E05DB              +145 	lcal	tcp_auto_accept
00:0028EC B608E7              +146 	j	tcp_reset_dq_lx			. connection not assigned
00:0028ED B608E9              +147 	j	tcp_accept_fail2		. connection assigned but not working
  :                            148 						. connection SYN_ACK, 3rd return
00:0028EE B60A02              +149 	j	tcp_stepover_response		. SYN pdu consumed
  :                            150 
  :                            151 tcp_connection_located
  :                            152 
00:0028EF 60A001              +153 	la	transmission:state
00:0028F0 A608F2              +154 	jpa	$+2
00:0028F1 B5FFFF              +155 	xor	-1,,xi
00:0028F2 20F004              +156 	sa	state
  :                            157 
00:0028F3 10F006              +158 	sx	connection
00:0028F4 70A004              +159 	tz	transmission:timer(1)		. restart the big timer
00:0028F5 3E08C5              +160 	lcal	tcp_restart_timer1		. unless it's switched off
  :                            161 
00:0028F6 580011              +162 	ly	TP_HEADER
00:0028F7 60B006              +163 	la	transfer:hl_code, y
00:0028F8 20001B              +164 	sa	HL_FLAGS
00:0028F9 A50012              +165 	and	TCP_SYN++TCP_ACK,,xi
00:0028FA B50012              +166 	xor	TCP_SYN++TCP_ACK,,xi
00:0028FB C60902              +167 	jza	tcp_synsent?			. SYN ++ ACK
  :                            168 	
00:0028FC A50002              +169 	and	TCP_SYN,,xi
00:0028FD D60908              +170 	jnza	tcp_no2ndsyn			. SYN = no SYN (xor does that 2u)
  :                            171 
  :                            172 	$if	1
00:0028FE 60F004              +173 	la	state
  :                            174 	$else
  :                            175 	la	transmission:state
  :                            176  jpa $+2					. -STATE = awaiting transition
  :                            177  xor -1,,xi
  :                            178 	$endif
  :                            179 
00:0028FF D50004              +180 	ana, xi	TCP_SYNRECEIVED
00:002900 C60A02              +181 	jza	tcp_stepover_response
00:002901 B609DB              +182 	j	tcp_ripdown_reset
  :                            183 
  :                            184 tcp_synsent?
00:002902 60F004              +185         la      state				. here because you got SYN_ACK
00:002903 C5FFFD              +186 	aa	-TCP_SYNSENT,,xi
00:002904 C60908              +187         jza	tcp_syn_ack_correct		. your were expecting SYN_ACK
  :                            188 
00:002905 C5FFFE              +189 	aa	TCP_SYNSENT-TCP_ESTABLISHED,,xi	. moved to established?
00:002906 C60A01              +190 	jza	tcp_ack				. SYN ++ ACK, already seen it
00:002907 B609DB              +191 	j	tcp_ripdown_reset		. not making enough sense to use
  :                            192 
  :                            193 tcp_syn_ack_correct
  :                            194 tcp_no2ndsyn
00:002908 60001B              +195 	la	HL_FLAGS
00:002909 06000B              +196 	sar	11
00:00290A A5001E              +197 	and, xi	30
  :                            198 
00:00290B C00003              +199 	aa	y
00:00290C 20E006              +200 	sa	descriptor:apdata
00:00290D 200010              +201 	sa	RX_APDATA
  :                            202 						. policy if remote ack is illogical:
  :                            203 						. network has delivered out of order
  :                            204 
  :                            205 						. is the ACK reasonable?
  :                            206 
00:00290E CFA00A              +207 	dl	transmission:remote_ack_window	. previous state remote ack
00:00290F A80FBF              +208 	andB	(255*/16:s)
  :                            209 
00:002910 C7F000              +210 	ds	remote_ack			. remote ack so far
  :                            211 
00:002911 CFB004              +212 	dl	transfer:ack, y			. new remote ack <- store format
00:002912 2E0008              +213 	sbl	8				. ms 32 bits of 2 words
00:002913 360008              +214 	dsl	8
00:002914 C70008              +215 	ds	8				. proposed new remote ack 8..9
  :                            216 
00:002915 DFF000              +217 	dan	remote_ack			. remote ACK gone backwards?
  :                            218 
  :                            219 						. new remote ack < stored remote ack ?
00:002916 E60A02              +220 	jna	tcp_stepover_response		. segment already accepted
  :                            221 						. and cannot be needed
  :                            222 tcp_compare_forward
00:002917 60001B              +223         la      HL_FLAGS
00:002918 A50004              +224         and     TCP_RST,,xi
00:002919 D609E5              +225         jnza    tcp_ripdown_silently
  :                            226 
00:00291A CFA00C              +227 	dl	transmission:sequence_ackx
00:00291B A80FBF              +228 	andB	(255*/16:s)
  :                            229 
00:00291C DF0008              +230 	dan	8				. remote ACK beyond local SEQ?
  :                            231 
00:00291D A60920              +232 	jpa	tc_no_problem_p
  :                            233 
  :                            234 	$if	1
00:00291E 17F005              +235 	inc	ACK_AWAITED
00:00291F B60A02              +236 	j	tcp_stepover_response		. drop as a broken segment
  :                            237 	$else
  :                            238 	j	tcp_ripdown_reset		. or complain about it
  :                            239 	$endif
  :                            240 
  :                            241 tc_no_problem_p
  :                            242 
  :                            243 	$if	0				. moved back to compare_forward
  :                            244 	la	HL_FLAGS
  :                            245 	and, xi	TCP_RST
  :                            246 	jnza	tcp_ripdown_silently
  :                            247 	$endif
  :                            248 
00:002920 CF0008              +249 	dl	8				. accept proferred remote ack
00:002921 C7F000              +250 	ds	remote_ack			. in cached copy
00:002922 480F8E              +251 	lk	(00FFFF)
00:002923 BFB007              +252 	mlb	transfer:window, y		. remote ack ++ remote window
00:002924 C7A00A              +253 	ds	transmission:remote_ack_window	. in connection state ->
  :                            254 
  :                            255 	.	0:	is the remote ACK possible?
  :                            256 
  :                            257 	.	0:5	is there a remote reset?
  :                            258 
  :                            259 	.	1:	cache remote ACK and window
  :                            260 
  :                            261 	.	2:1	send waiting segments as remote
  :                            262 	.		window allows
  :                            263 
  :                            264 	.	2:2	release segments queued for ACK
  :                            265 	.		according to remote ACK value
  :                            266 	.		vs sequence + size of sent output
  :                            267 
  :                            268 	.	3:	compare remote sequence with local
  :                            269 	.		ACK
  :                            270 
  :                            271 	.	4:	if less, shave the leading edge
  :                            272 	.		of the input
  :                            273 
  :                            274 	.	5:	if more but sequence + length
  :                            275 	.		within local ACK + window, deferq
  :                            276 	.		and otherwise drop
  :                            277 
  :                            278 	.	6:	accept as much of the net input at 4:
  :                            279 	.		as local window allowed. This avoids
  :                            280 	.		accepting single bytes which are
  :                            281 	.		sent to push the window open
  :                            282 	.		and also avoids rejecting payload
  :                            283 	.		for which we have advertised
  :                            284 	.		window. Drop the segment if no
  :                            285 	.		part of it is accepted, and shave
  :                            286 	.		the trailing edge if part of it
  :                            287 	.		is rejected
  :                            288 
  :                            289 	.		It might be unwise to accept beyond
  :                            290 	.		window. A well behaved remote system
  :                            291 	.		won't send beyond window (apart from
  :                            292 	.		experimental 1-byters, and the response
  :                            293 	.		to those is drop them and advertise
  :                            294 	.		new window). A malicious remote system
  :                            295 	.		might try to manipulate window
  :                            296 
  :                            297 	.	7:	Advance local ACK and reduce local
  :                            298 	.		window according to the amount accepted
  :                            299 
  :                            300 	.	8:	generate new local window
  :                            301 
  :                            302 	.	9:	transmit segments queued for remote window
  :                            303 	.		according to remote ACK + window,  and
  :                            304 	.		if there is none, and no further input
  :                            305 	.		segment after this has yet been received
  :                            306 	.		for this connection, send an ACK, unless
  :                            307 	.		the incoming segment is an ACK without
  :                            308 	.		payload and its SEQ is not beyond local ACK
  :                            309 
  :                            310 	.		SYN and FIN have a payload weight of
  :                            311 	.		1 byte
  :                            312 
  :                            313 	.		restart connection:timer(1)
  :                            314 	.		maybe do this at an early point, depending
  :                            315 	.		whether the attempt to communicate
  :                            316 	.		counts as keepalive even if it is
  :                            317 	.		out of range
  :                            318 
  :                            319 
  :                            320 
  :                            321 
  :                            322 	.	1	is the remote ACK possible?
  :                            323 
  :                            324 
  :                            325 	$if	0	. already been done
  :                            326 	dl	6	. unless new remote ack < old remote ack
  :                            327 
  :                            328 	lk	(65535)
  :                            329 	mlb	transfer:window, y
  :                            330 	ds	transmission:remote_ack_window
  :                            331 	$endif
  :                            332 
  :                            333 
  :                            334 	.	2:1	drop ACKed outputs
  :                            335 	.		remote ACK is still in 6:7
  :                            336 
  :                            337 
  :                            338 p	$proc
  :                            339 jlist*	$name
  :                            340 ?	$do	p(1),	+	p(1, ?)
  :                            341 	$end
  :                            342 
00:002925 68F004              +343 	lb	state
00:002926 AD000F              +344 	andB	15,,xi
00:002927 68D929              +345 	lb	stepfor, b
00:002928 B6D000              +346 	j	0, b
  :                            347 
                                stepfor	jlist	;
                                	tcp_listen,		tcp_closed,	tcp_listen,	tcp_synsent,	;
                                	tcp_synreceived,   tcp_established,	tcp_finwait1,	tcp_finwait2,	;
                                	tcp_closewait,	       tcp_lastack,	tcp_closing,	tcp_timewait,	;
00:002929 000A02              +352 	tcp_deletetcb,		tcp_listen,	tcp_listen,	tcp_listen
00:00292A 0009F0              +352 
00:00292B 000A02              +352 
00:00292C 0009F1              +352 
00:00292D 0009D3              +352 
00:00292E 000939              +352 
00:00292F 0009AF              +352 
00:002930 0009C5              +352 
00:002931 000939              +352 
00:002932 000966              +352 
00:002933 0009B8              +352 
00:002934 0009CD              +352 
00:002935 0009EE              +352 
00:002936 000A02              +352 
00:002937 000A02              +352 
00:002938 000A02              +352 
  :                            353 
  :                            354 
  :                            355 tcp_established
  :                            356 tcp_closewait
  :                            357 tcp_tx_segments_acked?
  :                            358 
00:002939 60A016              +359 	la	transmission:q4ack:head
00:00293A C6093F              +360 	jza	tcp_rx_in_range?
00:00293B 9FF000              +361 	lc	tcp4_outstanding	remote_ack,,long
00:00293C FCF002              +361 
00:00293D 3E0558              +361 
00:00293E 38000F              +361 
  :                            362 
  :                            363 tcp_rx_in_range?
  :                            364 						. finally time to calculate the
  :                            365 						. header length, payload address
  :                            366 
00:00293F CFA00E              +367 	dl	transmission:ack_window, x
00:002940 280009              +368 	sb	9				. save the window
00:002941 A80FBF              +369 	andB	(255*/16:s)
  :                            370 
  :                            371 
  :                            372 local_ack $equf	remote_ack			. reuse cached location
  :                            373 
00:002942 C7F000              +374 	ds	local_ack			. exactly expected sequence?
  :                            375 
  :                            376 tcp_place_in_stream
00:002943 680011              +377 	lb	TP_HEADER
00:002944 D80010              +378 	anb	RX_APDATA
00:002945 2E0001              +379 	sbl	1				. minus header length in bytes
00:002946 C8E003              +380 	ab	descriptor:bytes
00:002947 28E003              +381 	sb	descriptor:bytes		. calculate payload length
00:002948 28F005              +382 	sb	ACK_AWAITED
  :                            383 
00:002949 28000B              +384 	sb	11				. make a 48 bit payload byte count
00:00294A 280012              +385 	sb	TPAYLOAD_BYTES
00:00294B 30000A              +386 	z	10
  :                            387 
00:00294C 580011              +388 	ly	TP_HEADER
00:00294D CFB002              +389 	dl	transfer:seq, y			. extract the incoming sequence
  :                            390 
00:00294E 2E0008              +391 	sbl	8
00:00294F 360008              +392 	dsl	8
  :                            393 
00:002950 C7F002              +394 	ds	received_seq
  :                            395 
00:002951 DFF000              +396 	dan	local_ack
00:002952 7C0958              +397 	jdz	tcp_rx_exact_sequence
00:002953 A6099A              +398 	jpa	tcp_rx_above_ack
  :                            399 						. have you ACKED all this payload?
  :                            400 
  :                            401 						. comparison with expected sequence
  :                            402 						. yields a negative #
  :                            403 						. which reduces the net payload
  :                            404 
00:002954 960010              +405 	dsa	16
00:002955 D7000A              +406 	da	10				. payload + sequence - acked
00:002956 7C09A7              +407 	jdz	tcp_rx_already_acked
00:002957 E609A7              +408 	jna	tcp_rx_already_acked
  :                            409 
  :                            410 tcp_rx_exact_sequence
00:002958 28E007              +411 	sb	descriptor:readpoint		. rx_seq + payload - stored_ack
  :                            412 						. = descriptor -> bytes_to_bypass
00:002959 60001B              +413 	la	HL_FLAGS
00:00295A A50001              +414 	and, xi	TCP_FIN				. established -> closewait ?
  :                            415 
00:00295B C6096F              +416 	jza	tcp_rx_payload?			. no such event, keep going
  :                            417 
00:00295C CFF002              +418 	dl	received_seq			. add event_weight + remote_sequence
00:00295D D70F9F              +419 	da	(1*/16:d)			. equivalent 1 octet
00:00295E C7F000              +420 	ds	local_ack
00:00295F 480F8E              +421 	lk	(00FFFF)
00:002960 BF0009              +422 	mlb	9				. that had better be local_window
00:002961 C7A00E              +423 	ds	transmission:ack_window, x	. store connection -> local_ack:window
  :                            424 
00:002962 FD0008              +425 	push,xi	TCP_CLOSEWAIT			. store updated state
00:002963 38A001              +426 	pop	transmission:state
  :                            427 
00:002964 17F005              +428 	inc	ACK_AWAITED			. lcal	tcp_send_ack
00:002965 B60972              +429 	j	tcp_rx_payload			. zero payload is queued as a signal
  :                            430 						. to the application of remote close
  :                            431 
  :                            432 tcp_lastack
00:002966 3E08B9              +433 	lcal	tcp_event1_acknowledged?
00:002967 7C096C              +434 	jdz	tcp_lastack2closed
00:002968 600097              +435 	la	DAYCLOCK$
00:002969 C51770              +436 	aa	6000,,xi			. in case last ack gets lost
00:00296A 20A004              +437 	sa	transmission:timer(1)		. drop connection in a few seconds
00:00296B B60A02              +438 	j	tcp_stepover_response
  :                            439 
  :                            440 tcp_lastack2closed
00:00296C FD0001              +441 	push,xi	TCP_CLOSED
00:00296D 38A001              +442 	pop	transmission:state
00:00296E B60A02              +443 	j	tcp_stepover_response
  :                            444 	
  :                            445 tcp_rx_payload?
00:00296F 700012              +446 	tz	TPAYLOAD_BYTES
00:002970 B60972              +447 	j	tcp_rx_payload
  :                            448 
  :                            449 	$if	1
00:002971 B60A02              +450 	j	tcp_stepover_response
  :                            451 	$else
  :                            452 	.	to do it this way first update ack as below in rx_payload
  :                            453 	.	there seem to be enough acks for intense flow control anyway
  :                            454 
  :                            455 	j	tcp_rx_ack_nopayload
  :                            456 	$endif
  :                            457 
  :                            458 tcp_rx_payload
  :                            459 						. now is the segment within window?
00:002972 600009              +460 	la	9				. for now, discard any segment not
00:002973 A00F8E              +461 	and	(00FFFF)			. completely within window
00:002974 D0000B              +462 	ana	11				. down with window
00:002975 5E09AE              +463 	jnc	tcp_rx_above_range		. drop + ACK
00:002976 200009              +464 	sa	9				. reduced local window
00:002977 CFF000              +465 	dl	local_ack			. ACK is */ 16
  :                            466 
00:002978 160010              +467 	dsr	16				. + 48-bit payload count
00:002979 D7000A              +468 	da	10				. up with ACK
  :                            469 
00:00297A C7000A              +470 	ds	10				. cache the new ACK point
  :                            471 
00:00297B 360010              +472 	dsl	16
00:00297C 980009              +473 	orB	9				. save new ACK ++ WINDOW
00:00297D C7A00E              +474 	ds	transmission:ack_window
  :                            475 
00:00297E 60000E              +476 	la	fp
00:00297F 3E0845              +477 	lcal	tcp_write_rxq
  :                            478 						. now see if deferq joins on
  :                            479 
  :                            480 
00:002980 64A012              +481 	la, i	transmission:deferq.head, x
00:002981 580004              +482 	ly	a
  :                            483 tcp_rx_rechain					. look for any deferred segment
00:002982 400003              +484 	lr	y				. which is no longer gapped
00:002983 60C000              +485 	la	0, a
00:002984 C60996              +486 	jza	tcp_ack_point
00:002985 580004              +487 	ly	a
00:002986 60C005              +488 	la	descriptor:uproto, a
00:002987 200011              +489 	sa	TP_HEADER
00:002988 CFC002              +490 	dl	transfer:seq, a
00:002989 2E0008              +491 	sbl	8
00:00298A 360008              +492 	dsl	8
  :                            493 
00:00298B DFF000              +494 	dan	local_ack
00:00298C E60982              +495 	jna	tcp_rx_rechain
  :                            496 
00:00298D F8B000              +497 	push	descriptor:next, y
00:00298E 388000              +498 	pop	*r				. unchain the segment
  :                            499 
00:00298F 18000E              +500 	sy	fp				. expected descriptor base
00:002990 CFE005              +501 	dl	descriptor:uproto		. + TP_HEADER
00:002991 200011              +502 	sa	TP_HEADER
00:002992 280010              +503 	sb	RX_APDATA
00:002993 68C006              +504 	lb	transfer:hl_code, a
00:002994 28001B              +505 	sb	HL_FLAGS
00:002995 B60943              +506 	j	tcp_place_in_stream
  :                            507 
  :                            508 	. here you decide whether waiting segments
  :                            509 	. can be transmitted. Any earlier, and the
  :                            510 	. local ACK pointer would be out of date
  :                            511 
  :                            512 	. checksum must always be finalised at
  :                            513 	. the moment of transmission, because local
  :                            514 	. ACK is summed in the segment header
  :                            515 
  :                            516 tcp_ack_point
00:002996 50F006              +517 	lx	connection
00:002997 70F005              +518 	tz	ACK_AWAITED
00:002998 3E0A09              +519 	lcal	tcp_rack
00:002999 B60A05              +520 	j	tcp4xreact			. go keep input data on connection chain
  :                            521 
  :                            522 tcp_rx_above_ack				. 48-bit positive difference SEQ > ACK is in A:B
  :                            523 						. and window is in 9 but with some bits from ACK
00:00299A D7000A              +524 	da	10				. calculate SEQ - ACK + payload
00:00299B C7000A              +525 	ds	10
  :                            526 
00:00299C 600009              +527 	la	9
00:00299D 260008              +528 	sal	8
00:00299E 160020              +529 	dsr	32
00:00299F DF000A              +530 	dan	10
  :                            531 
00:0029A0 5E09AE              +532 	jnc	tcp_rx_above_range
  :                            533 
  :                            534 	$if	TCP_NOQ
  :                            535 
00:0029A1 60000E              +536 	la	fp
00:0029A2 5CA012              +537 	ly	transmission:deferq,,i		. application thread does not touch this
  :                            538 						. so no double update
  :                            539 	
  :                            540 ELIMINATE_PREVIOUS_RESEND $equ	0
  :                            541 
  :                            542 	$if	ELIMINATE_PREVIOUS_RESEND	. don't stack iterated resends
  :                            543 						. search segment not 100% queued already
  :                            544 	lcal	eliminate_previous_resend	. must return +1 for do +0 for don't queue
  :                            545 	$else
00:0029A3 70B000              +546 	tz	0, y				. simple and effective
  :                            547 	$endif	ELIMINATE_PREVIOUS_RESEND	. never > 1 above_ack rx buffer queued
  :                            548 
  :                            549 
00:0029A4 B60A02              +550 	j	tcp_stepover_response
  :                            551 
00:0029A5 3E0E96              +552 	lcal	q2
  :                            553 
  :                            554 	$else	TCP_NOQ
  :                            555 
  :                            556 	ly	tcpq,,xi
  :                            557 	la, i	transmission:deferq
  :                            558 	lcal	net_transfer
  :                            559 
  :                            560 	$endif	TCP_NOQ
  :                            561 
00:0029A6 B60A05              +562 	j	tcp4xreact			. only stay for 1 segment
  :                            563 						. the next one may be for any connection
  :                            564 
  :                            565 tcp_rx_already_acked
00:0029A7 600012              +566 	la	TPAYLOAD_BYTES
00:0029A8 C60A02              +567 	jza	tcp_stepover_response
00:0029A9 FD0001              +568 	MIB_ICOUNT48	tcpDupDrops:i		. all this segment already rx
(+01)0f
00:0029AA 2F0575              +568 
00:0029AB 5E09AD              +568 
(+01)0f
00:0029AC 170574              +568 
00:0029AD B60A01              +569 	j	tcp_ack
  :                            570 
  :                            571 	$if	1	
  :                            572 tcp_rx_above_range
  :                            573 .	la, xi	1
  :                            574 .	sa	ACK_AWAITED
  :                            575 .	lcal	tcp_send_ack
  :                            576 
  :                            577 tcp_rx_ack_nopayload
00:0029AE B60A01              +578 	j	tcp_ack
  :                            579 .	ly, xi	tcpq
  :                            580 .	lcal	net_drop
  :                            581 .	j	tcp_ack_point
  :                            582 	$endif
  :                            583 
  :                            584 tcp_finwait1
00:0029AF 60001B              +585 	la	HL_FLAGS
00:0029B0 A50001              +586 	and, xi	TCP_FIN
00:0029B1 C609BB              +587 	jza	tcp_finwait1_acked?
00:0029B2 CF0F9F              +588 	dl	(1*/16d)
00:0029B3 D7A00E              +589 	da	transmission:ack_window
00:0029B4 C7A00E              +590 	ds	transmission:ack_window
00:0029B5 FD000A              +591 	push,xi	TCP_CLOSING
00:0029B6 38A001              +592 	pop	transmission:state
00:0029B7 3E0A09              +593 	lcal	tcp_rack
  :                            594 				. ACK and FIN  may be on the same segment
  :                            595 tcp_closing
00:0029B8 3E08B9              +596 	lcal	tcp_event1_acknowledged?
00:0029B9 7C09C1              +597 	jdz	tcp_close2timewait
00:0029BA B60A02              +598 	j	tcp_stepover_response
  :                            599 
  :                            600 tcp_finwait1_acked?
00:0029BB 3E08B9              +601 	lcal	tcp_event1_acknowledged?
00:0029BC 7C09BE              +602 	jdz	tcp_finwait1tofinwait2
00:0029BD B60A02              +603 	j	tcp_stepover_response
  :                            604 
  :                            605 tcp_finwait1tofinwait2
00:0029BE FD0007              +606 	push,xi	TCP_FINWAIT2
00:0029BF 38A001              +607 	pop	transmission:state
00:0029C0 B60A02              +608 	j	tcp_stepover_response
  :                            609 
  :                            610 tcp_close2timewait
00:0029C1 FD000B              +611 	push,xi	TCP_TIMEWAIT
00:0029C2 38A001              +612 	pop	transmission:state
00:0029C3 3E08C3              +613 	lcal	tcp_start_timewait
00:0029C4 B60A02              +614 	j	tcp_stepover_response
  :                            615 	
  :                            616 tcp_finwait2
00:0029C5 60001B              +617 	la	HL_FLAGS
00:0029C6 A50001              +618 	and, xi	TCP_FIN
00:0029C7 C60A02              +619 	jza	tcp_stepover_response
00:0029C8 CF0F9F              +620 	dl	(1*/16d)
00:0029C9 D7A00E              +621 	da	transmission:ack_window
00:0029CA C7A00E              +622 	ds	transmission:ack_window
00:0029CB 3E0A09              +623 	lcal	tcp_rack
00:0029CC B609C1              +624 	j	tcp_close2timewait
  :                            625 	
  :                            626 tcp_timewait
00:0029CD 600097              +627 	la	DAYCLOCK$
00:0029CE D0A004              +628 	ana	transmission:timer(1)
00:0029CF E60A02              +629 	jna	tcp_stepover_response
00:0029D0 650001              +630 	la, xi	TCP_CLOSED
00:0029D1 20A001              +631 	sa	transmission:state
00:0029D2 B60A02              +632 	j	tcp_stepover_response
  :                            633 
  :                            634 tcp_synreceived
00:0029D3 3E08B9              +635 	lcal	tcp_event1_acknowledged?
00:0029D4 7C09D6              +636 	jdz	tcp_syn_ack_acked
00:0029D5 B609DB              +637 	j	tcp_ripdown_reset
  :                            638 
  :                            639 tcp_syn_ack_acked
00:0029D6 650005              +640 	la, xi	TCP_ESTABLISHED
00:0029D7 20A001              +641 	sa	transmission:state
  :                            642 
00:0029D8 5CA016              +643         ly      transmission:q4ack,,i
  :                            644         $if     HVSOCKET
00:0029D9 3E08D1              +645         lcal    tcp4_net_free_txdatagram
  :                            646         $else
  :                            647         lcal    net_free_txdatagram
  :                            648         $endif
  :                            649 
00:0029DA B60A02              +650         j	tcp_stepover_response
  :                            651 
  :                            652 tcp_ripdown_reset
00:0029DB 50F006              +653 	lx	connection
00:0029DC 60A001              +654 	la	transmission:state
00:0029DD A609DF              +655  jpa $+2				. -STATE = awaiting transition
00:0029DE B5FFFF              +656  xor -1,,xi
00:0029DF C5FFFF              +657 	aa	-TCP_CLOSED,,xi
00:0029E0 C60A02              +658 	jza	tcp_stepover_response
00:0029E1 C5FFF5              +659 	aa	TCP_CLOSED-TCP_DELETETCB,,xi
00:0029E2 C60A02              +660 	jza	tcp_stepover_response
00:0029E3 3E07BA              +661 	lcal	tcp_reset		. send a reset if possible
00:0029E4 B609E5              +662 	j	$+1			. there are two returns
  :                            663 tcp_ripdown_silently
00:0029E5 50F006              +664 	lx	connection
  :                            665 
00:0029E6 60A001              +666 	la	transmission:state
00:0029E7 A609E9              +667  jpa $+2				. -STATE = awaiting transition
00:0029E8 B5FFFF              +668  xor -1,,xi
00:0029E9 C5FFF4              +669 	aa	-TCP_DELETETCB,,xi
00:0029EA C60A02              +670 	jza	tcp_stepover_response
00:0029EB C5000B              +671 	aa	TCP_DELETETCB-TCP_CLOSED,,xi
00:0029EC C60A02              +672 	jza	tcp_stepover_response
  :                            673 
00:0029ED 3E065C              +674 	lcal	tcp_ripdown
  :                            675 
  :                            676 tcp_deletetcb
00:0029EE FD0001              +677 	push,xi	TCP_CLOSED
00:0029EF 38A001              +678 	pop	transmission:state
  :                            679 tcp_closed				. the TCB may already be reassigned
00:0029F0 B60A02              +680 	j	tcp_stepover_response	. this PDU wasn't added to an input chain
  :                            681 .	ly, xi	tcpq
  :                            682 .	lcal	net_drop
  :                            683 .	j	tcp4xreact
  :                            684 
  :                            685 tcp_synsent
00:0029F1 3E08B9              +686 	lcal	tcp_event1_acknowledged?
00:0029F2 7C09F4              +687 	jdz	tcp_synsent1
00:0029F3 B609DB              +688 	j	tcp_ripdown_reset
  :                            689 tcp_synsent1
00:0029F4 650005              +690 	la, xi	TCP_ESTABLISHED
00:0029F5 20A001              +691 	sa	transmission:state
00:0029F6 580011              +692 	ly	TP_HEADER
00:0029F7 CFB002              +693 	dl	transfer:seq, y
00:0029F8 2E0008              +694 	sbl	8
00:0029F9 360008              +695 	dsl	8
00:0029FA D70F9F              +696 	da	(1*/16d)
00:0029FB C7A00E              +697 	ds	transmission:ack_window
  :                            698 
  :                            699 	$if	HVSOCKET
00:0029FC 788F9C              +700 	tn	*(BSOCKET*/12++tlist:flags)
00:0029FD B609FF              +700 
  :                            701 	$endif
00:0029FE FF0FA1              +702 	call	(tcp_agent_add)
  :                            703 
00:0029FF 5CA016              +704 	ly	transmission:q4ack,,i
  :                            705 
  :                            706 tcp_clear_syn				. take SYN segment off output q
  :                            707 
  :                            708 	$if	HVSOCKET
00:002A00 3E08D1              +709 	lcal	tcp4_net_free_txdatagram
  :                            710 	$else
  :                            711 	lcal	net_free_txdatagram
  :                            712 	$endif
  :                            713 
00:002A01 3E0A09              +714 tcp_ack	lcal	tcp_rack
  :                            715 
  :                            716 tcp_listen				. stub
  :                            717 tcp_stepover_response			. getting here drops buffered rx segment
  :                            718 
  :                            719 	$if	TCP_NOQ
00:002A02 60000E              +720 	la	fp
00:002A03 508FA5              +721 	lx	*(BSOCKET*/12++tlist:rxbu_p)
00:002A04 3E0E49              +722 	lcal	sell1
  :                            723 
  :                            724 
  :                            725 	$else
  :                            726 
  :                            727 	ly	tcpq,,xi
  :                            728 	lcal	net_drop
  :                            729 
  :                            730 	$endif
  :                            731 					. get here without dropping segment
  :                            732 tcp4xreact				. when buffered rx segment is queued to socket
  :                            733 
00:002A05 B601E1              +734 	j	ipv4_rxz		. this $ret doesn't happen but it looks nice 
  :                            735 					. interface window must be freed
00:002A06 FCF007              +736 	$ret
00:002A07 38000F              +736 
00:002A08 350000              +736 
  :                            737 
  :                            738 tcp_rack
00:002A09 F8000E              +739 	push	fp
00:002A0A 3E07BF              +740 	lcal	tcp_send_ack
00:002A0B 3E0771              +741 	lcal	tcp_ack_dropped
00:002A0C 38000E              +742 	pop	fp
00:002A0D 350000              +743 	lret	0
  :                            744 
  :                            745 	$root
  :                            746 
  :                            747 tcp_rx_far				. called from reassembly device driver
00:002A0E CF0012              +748 	dl	SOCKET_LPOINTER		. fp -> rx segment descriptor
00:002A0F 34002F              +749 	sabr	BSOCKET
00:002A10 60D005              +750 	la	s:tcp:tbase
00:002A11 34002F              +751 	sabr	BSOCKET
  :                            752 
00:002A12 3E08D8              +753 	lcal	tcp4_rxaction
00:002A13 3D0000              +754 	fret	0
  :                            2358 
  :                            89: 	$include	socket
  :                            1 .		x -> usockb(1)
  :                            2 .	OR	x -> tsockb(1)
  :                            3 .		a contains port number
  :                            4 
  :                            5 protocol_socket
00:002A14 6D5E00              +6 	lb	BSOCKET*/9,,xi
00:002A15 360008              +7 	dsl	8
00:002A16 160011              +8 	dsr	8+9
00:002A17 4E000C              +9 	rbr	12
00:002A18 800004              +10 	ax	a
00:002A19 750053              +11 	ii	READ_XVECTOR$
00:002A1A 350000              +12 	lret	0
  :                            13 
  :                            90: 	$include	connect
  :                            1 .
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 
  :                            41 
  :                            42 .	these blocking-only calls are central to the
  :                            43 .	known classical POSIX-like socket interface
  :                            44 
  :                            45 .	they correspond to the vectors	listen()
  :                            46 .					accept()
  :                            47 .					close()
  :                            48 .					connect()
  :                            49 
  :                            50 .	their blocking characteristic is in this file connect.msm
  :                            51 
  :                            52 .	and they complement		recv()
  :                            53 .	and				send()
  :                            54 
  :                            55 .	which block or not per flags argument
  :                            56 
  :                            57 .	first parameter of these routines is the handle integer
  :                            58 
  :                            59 .	the target connections of these routines are
  :                            60 .	in the default connections array
  :                            61 .	not the high-volume connection arrays
  :                            62 
  :                            63 
  :                            64 "$sockif"*	$tree
  :                            65 
  :                            66 .	vector name connect	. call from applications
  :                            67 
  :                            68 
  :                            69 socket_connect
                                	$head_far		 params(handle1,		int		;
                                					target_address,		float	)	;
                                										;
                                				scalars(socket_address,		long		;
00:002A1B 9F0FC1              +74 					handle_encoding,	long		)
00:002A1C 9F0FC1              +74 
  :                            75 
00:002A1D 60F007              +76 	la			handle1
00:002A1E 750055              +77 	ii			READ_SOCKET$
00:002A1F C7F000              +78 	ds			handle_encoding
  :                            79 
00:002A20 480FBF              +80 	lk			(255*/16s)
00:002A21 E60A56              +81 	jna			socket_nane
00:002A22 AF0F80              +82 	mtane			(IPPROTO_TCP*/16)
00:002A23 B60A25              +82 
00:002A24 B60A58              +83 	j			tcp_connect
00:002A25 AF0F7F              +84 	mta			(IPPROTO_UDP*/16)
00:002A26 B60A56              +85 	j			socket_nane
  :                            86 
00:002A27 70F001              +87 	tz			handle_encoding+1	. did they bind a local  port?
00:002A28 B60A33              +88 	j			connection_port_bound
  :                            89 							. not if it isn't in a storage block
  :                            90 							. they are allowed not to
00:002A29 9F0FC1              +91 	c	(bind)		handle1	(0L),,long
00:002A2A F8F009              +91 
00:002A2B FCF003              +91 
00:002A2C FF0FC3              +91 
00:002A2D 38000F              +91 
00:002A2E E60A6A              +92 	jna			connect_y
00:002A2F CF000A              +93 	dl			10			. socket structure long virtual address
00:002A30 34002F              +94 	sabr			BSOCKET
00:002A31 560018              +95 	drr			24
00:002A32 60C001              +96 	la			s:socket_address+1, a						
  :                            97 
  :                            98 connection_port_bound
00:002A33 A501FF              +99 	and			511,,xi			. UDP connect = 
00:002A34 955E00              +100 	or			BSOCKET*/12-3,,xi	. associate with remote address:port
00:002A35 260003              +101 	sal			3
00:002A36 500004              +102 	lx			a
00:002A37 600005              +103 	la			b
00:002A38 34002F              +104 	sabr			BSOCKET
00:002A39 CFF00A              +105 	dl			target_address+2
00:002A3A C7A002              +106 	ds			s:remote_address, x
  :                            107 							. return a status
00:002A3B CFF008              +108 	dl			target_address		. source address from caller?
00:002A3C A80FBF              +109 	andB			(0FF0000s)
00:002A3D 7C0A42              +110 	jdz			no_new_source
  :                            111 
  :                            112 write_derived_source
00:002A3E 480F8E              +113 	lk			(00FFFF)		. port must be bound first
00:002A3F BFA001              +114 	mlb			s:socket_address+1, x
00:002A40 C7A000              +115 	ds			s:socket_address, x
  :                            116 
00:002A41 B60A53              +117 	j			udp_connect_status
  :                            118 
  :                            119 no_new_source
00:002A42 CFA000              +120 	dl			s:socket_address, x
00:002A43 A80FBF              +121 	andB			(0FF0000s)
00:002A44 7C0A46              +122 	jdnz			udp_connect_status	. source address already found
00:002A45 B60A53              +122 
  :                            123 	
00:002A46 CFF00A              +124 	dl			target_address+2
00:002A47 160008              +125 	dsr			8			. into network format
00:002A48 0E0008              +126 	sbr			8
00:002A49 C70006              +127 	ds			6
00:002A4A 100008              +128 	sx			8
00:002A4B 3E0DFB              +129 	lcal			route_outward_interface	. derive a come_from address
00:002A4C B60A56              +130 	j			socket_nane		. if possible
00:002A4D 50A002              +131 	lx			this_if:address_list
00:002A4E CFA003              +132 	dl			ifaddr:net
00:002A4F 2E0008              +133 	sbl			8
00:002A50 360008              +134 	dsl			8
00:002A51 500008              +135 	lx			8
00:002A52 B60A3E              +136 	j			write_derived_source
  :                            137 
  :                            138 udp_connect_status
00:002A53 200008              +139 	sa			8			. 1st word of address.port.address.port§
00:002A54 650000              +140 	la			0,,xi			. net buffers were not accessed
00:002A55 B60A6A              +141 	j			connect_y		. only BSOCKET
  :                            142 
  :                            143 socket_nane
00:002A56 65FFEA              +144 	la			-NO_HANDLE,,xi			
00:002A57 B60A69              +145 	j			connect_x
  :                            146 
  :                            147 tcp_connect
  :                            148 
00:002A58 75006D              +149 	ii	ON_NETB$	. caller to __connect
  :                            150 				. must run with network resources
  :                            151 				. in address space
  :                            152 
00:002A59 260008              +153 	sal	8		. a = port number if any
00:002A5A 160020              +154 	dsr	24+8		. in bound or unbound handle
  :                            155 
                                	c	(__connect)	a,,long			;
00:002A5B 9FF00A              +157 				target_address+2,,long
00:002A5C 9F0004              +157 
00:002A5D FCF004              +157 
00:002A5E FF0FC4              +157 
00:002A5F 38000F              +157 
  :                            158 
00:002A60 A60A66              +159 	jpa	update_tcp_handle
00:002A61 680004              +160 	lb	a		. no connection
00:002A62 60F007              +161 	la	handle1		. drop the handle
00:002A63 750051              +162 	ii	FREE_HANDLE$
00:002A64 600005              +163 	la	b
  :                            164 
00:002A65 B60A69              +165 	j	connect_x
  :                            166 
  :                            167 update_tcp_handle
00:002A66 60F007              +168 	la	handle1
  :                            169 				. convert handle type to TCP_TCB
00:002A67 750056              +170 	ii	USOCKET$C	. and update with pointers in x and BSOCKET
  :                            171 
00:002A68 650000              +172 	la	0,,xi		. you arrived
  :                            173 
  :                            174 connect_x
00:002A69 750070              +175 	ii	FREE_NETB$
  :                            176 connect_y
00:002A6A 75006F              +177 	ii	FREE_SOCKB$
00:002A6B FCF004              +178 	$ret
00:002A6C 38000F              +178 
00:002A6D 3D0000              +178 
  :                            179 
  :                            180 .	vector name __connect	. kernel environment is already addressable
  :                            181 				. tranmission control block generated not handle
  :                            182 .	parameter is near.far socket names netaddress.port.netaddress.port
  :                            183 .	return with TCP_ESTABLISHED is zero -> a x -> transmission control block
  :                            184 
  :                            185 active_connect
                                	$head_far		 params(addresses,		float	;
                                					fast_release,		int)	;
                                									;
                                				scalars(connect_socketpointer,	long	;
                                					default_ifp,		int	;
00:002A6E 9F0FC1              +191 					send_syn_tries,	int,	5,,xi	)
00:002A6F FD0000              +191 
00:002A70 FD0005              +191 
  :                            192 
00:002A71 CFF009              +193 	dl	addresses+2			. find a route
00:002A72 160008              +194 	dsr	8				. to find interface
00:002A73 0E0008              +195 	sbr	8				. and therefore MTU
00:002A74 C70006              +196 	ds	6				. and come_from address if not given
  :                            197 
  :                            198 
00:002A75 75006D              +199 	ii	ON_NETB$
  :                            200 
00:002A76 3E0DFB              +201 	lcal	route_outward_interface		. you always get back from here with IP B1 frame
00:002A77 B60AE7              +202 	j	connect_no_path
  :                            203 	
00:002A78 10F001              +204 	sx	default_ifp
  :                            205 						. first: check / fix up local address:port
  :                            206 
00:002A79 CFF007              +207 	dl	addresses
00:002A7A 7C0A88              +208 	jdz	connect_local_wildcard
  :                            209 
  :                            210 	$if	1
00:002A7B 360020              +211         dsl	24+8
00:002A7C 060008              +212 	sar	8
00:002A7D 3E08AD              +213 	lcal	tcp_socket
  :                            214 	$else
  :                            215 
  :                            216 	dsl	24+8				. base the port structure
  :                            217 	lb	(BSOCKET*/9+8)
  :                            218 	dsr	8+9
  :                            219 	rbr	12
  :                            220 	lx	tsockb(1),,xi
  :                            221 	ax	a
  :                            222 	ii	READ_XVECTOR$
  :                            223 
  :                            224 	$endif
  :                            225 
00:002A7E C60AE9              +226 	jza	connect_bad_argument
  :                            227 
00:002A7F C7F002              +228 	ds	connect_socketpointer
00:002A80 C70012              +229 	ds	SOCKET_LPOINTER
00:002A81 34002F              +230 	sabr	BSOCKET
00:002A82 580005              +231 	ly	b
00:002A83 480F8E              +232 	lk	(00FFFF)
00:002A84 60F008              +233 	la	addresses+1
00:002A85 AFD001              +234 	mta	s:socket_address+1
00:002A86 B60AE9              +235 	j	connect_bad_argument
00:002A87 B60A93              +236 	j	connect_fixport
  :                            237 
  :                            238 connect_local_wildcard
00:002A88 9FF007              +239 	c	(__bind)	(IPPROTO_TCP*/16s)	addresses,,long
00:002A89 F80F80              +239 
00:002A8A FCF003              +239 
00:002A8B FF0FC5              +239 
00:002A8C 38000F              +239 
  :                            240 
00:002A8D E60AEA              +241 	jna	connect_return
  :                            242 
00:002A8E 60000B              +243 	la	11
00:002A8F CFC000              +244 	dl	s:socket_address, a
00:002A90 C7F007              +245 	ds	addresses			. updated sockaddress
00:002A91 CF000A              +246 	dl	10
00:002A92 C7F002              +247 	ds	connect_socketpointer
  :                            248 
  :                            249 connect_fixport
00:002A93 60D005              +250 	la	s:tcp:tbase, b
  :                            251 
  :                            252 	$if	HVSOCKET
00:002A94 D60A96              +253 	jnza	connect_socket_storage_assigned
00:002A95 FF0F93              +254 	call	(hvsocket_storage)		. outgoing connection writes
  :                            255 connect_socket_storage_assigned			. this storage unconditionally
  :                            256 	$endif
  :                            257 
00:002A96 C60ADA              +258 	jza	connections_tank_unprepared
00:002A97 34002F              +259 	sabr	BSOCKET				. change space 2F000 to connections tank
  :                            260 						. 1: any sending address in the parameter
00:002A98 CFF007              +261 	dl	addresses
00:002A99 A80FBF              +262 	andB	(255*/16s)
00:002A9A 7C0A9C              +263 	jdz	connect_bound_source?
00:002A9B B60AA1              +264 	j	connect_source_net
  :                            265 
  :                            266 						. 2: any sending address bound to the port
  :                            267 	$if	1
  :                            268 connect_bound_source?				. same address as connect_routed_source
  :                            269 	$else
  :                            270 connect_bound_source?				. ports socket just got unbased
  :                            271 	dl	s:socket_address, y
  :                            272 	andB	(255*/16s)
  :                            273 	jdz	connect_routed_source
  :                            274 	j	connect_source_net
  :                            275 	$endif
  :                            276 
  :                            277 						. 3: the default interface address on the default
  :                            278 						.    route to the remote destination
  :                            279 connect_routed_source
00:002A9C 50F001              +280 	lx	default_ifp			. interface descriptor pointer
00:002A9D 50A002              +281 	lx	this_if:address_list
00:002A9E CFA003              +282 	dl	ifaddr:net
00:002A9F 2E0008              +283 	sbl	8				. pack it ready
00:002AA0 360008              +284 	dsl	8				. to catenate the port #
  :                            285 
  :                            286 connect_source_net
00:002AA1 480F8E              +287 	lk	(00FFFF)
00:002AA2 BFF008              +288 	mlb	addresses+1			. can't change the local socket port #
00:002AA3 C7F007              +289 	ds	addresses			. so splice it with the final from-network-address
  :                            290 
  :                            291 						. local_net:port:remote_net:port all present
00:002AA4 4FF007              +292 	ql	addresses
00:002AA5 3E0672              +293 	lcal	tcp_check_connection		. outbound equivalent tcp_locate_connection
00:002AA6 700002              +294 	tz	x
00:002AA7 B60ADC              +295 	j	you_may_not			. the connection exists locally
  :                            296 
00:002AA8 3E0604              +297 	lcal	tcp_add_connection		. insert the connection between *y and y->next
00:002AA9 B60ADD              +298 	j	connect_reverse			. it didn't
  :                            299 
  :                            300 .	ly	connect_socketpointer+1		. the port socket is not based, and this isn't needed
  :                            301 .	ql	addresses			. mark this port to the outgoing connection
  :                            302 .	qs	s:socket_address, y		. additional outgoing connections
  :                            303 						. may replace the network and remote parts
  :                            304 
  :                            305 						. x -> new connection
00:002AAA 3E08BD              +306 	lcal	tcp_restart_timer2
00:002AAB CFA00C              +307 	dl	transmission:sequence_ackx
00:002AAC C7A00A              +308 	ds	transmission:remote_ack_window
00:002AAD 60F001              +309 	la	default_ifp
00:002AAE 60C004              +310 	la	this_if:mtu,a
00:002AAF C5FFD8              +311 	aa	-40,,xi
00:002AB0 20001A              +312 	sa	MSS
00:002AB1 20A002              +313 	sa	transmission:mss
  :                            314 
00:002AB2 4FF007              +315 	ql	addresses
00:002AB3 47A006              +316 	qs	transmission:socket_address
  :                            317 
  :                            318 connect_syn_tx
00:002AB4 FD0001              +319 	MIB_ICOUNT48	tcpActiveOpens:i	. ip send in (__tcp_connect)
(+01)0f
00:002AB5 2F055D              +319 
00:002AB6 5E0AB8              +319 
(+01)0f
00:002AB7 17055C              +319 
  :                            320 						. switches back to application B1
00:002AB8 FF0FC6              +321 	call	(__tcp_connect)				
00:002AB9 B60ABB              +322 	j	connect_no_tx
00:002ABA B60AC3              +323 	j	connect_syn_sent
  :                            324 
  :                            325 connect_no_tx					. ie send SYN never happened yet
00:002ABB 750041              +326 	ii	YIELD$
00:002ABC 1FF000              +327 	dec	send_syn_tries
00:002ABD 70F000              +328 	tz	send_syn_tries
00:002ABE B60AB4              +329 	j	connect_syn_tx
  :                            330 
00:002ABF 65000C              +331 	la	TCP_DELETETCB,,xi		. give up in possession of a
00:002AC0 20A001              +332 	sa	transmission:state		. transmission control block
00:002AC1 45FFDD              +333 	lr	-COULD_NOT,,xi			. let the state machine pool it
00:002AC2 B60ADD              +334 	j	connect_reverse
  :                            335 
  :                            336 connect_syn_sent
00:002AC3 650003              +337 	la	TCP_SYNSENT,,xi
00:002AC4 20A001              +338 	sa	transmission:state
00:002AC5 CF0F9F              +339 	dl	(1*/16d)
00:002AC6 D7A00C              +340 	da	transmission:sequence_ackx
00:002AC7 C7A00C              +341 	ds	transmission:sequence_ackx
  :                            342 
00:002AC8 40F006              +343 	lr	addresses-1			. is fast_release in the call frame?
00:002AC9 5CF00B              +344 	ly	fast_release,,i
00:002ACA FE0ACE              +345 	jyge	connect_review			. no
  :                            346 
00:002ACB 650000              +347 	la	0,,xi				. status so far so good
00:002ACC 78F00B              +348 	tp	fast_release
00:002ACD B60AEA              +349 	j	connect_return			. yes, leave it to the state machine
  :                            350 
  :                            351 connect_review
00:002ACE 750041              +352 	ii	YIELD$
00:002ACF 60A001              +353 	la	transmission:state
00:002AD0 C5FFFD              +354 	aa	-TCP_SYNSENT,,xi
00:002AD1 C60ACE              +355 	jza	connect_review
00:002AD2 C5FFFE              +356 	aa	TCP_SYNSENT-TCP_ESTABLISHED,,xi
00:002AD3 C60AEA              +357 	jza	connect_return
  :                            358 
00:002AD4 FD0001              +359 	MIB_ICOUNT48	tcpAttemptFails:i
(+01)0f
00:002AD5 2F0561              +359 
00:002AD6 5E0AD8              +359 
(+01)0f
00:002AD7 170560              +359 
00:002AD8 45FFC3              +360 	lr	-REMOTE_REFUSED,,xi
00:002AD9 B60ADD              +361 	j	connect_reverse			. let the state machine interpret
  :                            362 						. the state
  :                            363 . refinement needed
  :                            364 . only free the outward port here
  :                            365 . if it wasn't bound before the attempt at outward connection
  :                            366 . unless it's OK that companion connections on this port stop getting traffic
  :                            367 
  :                            368 connections_tank_unprepared
00:002ADA 45FF9D              +369 	lr	-99,,xi	
00:002ADB B60ADD              +370 	j	connect_reverse
  :                            371 
  :                            372 you_may_not
00:002ADC 45FFC8              +373 	lr	-ALREADY_CONNECTED,,xi
  :                            374 
  :                            375 connect_reverse
00:002ADD 788F9C              +376 	tp	*(BSOCKET*/12++tlist:flags)
00:002ADE B60AEA              +377 	j	connect_return			. do not unbind a multiport
  :                            378 
00:002ADF 60F002              +379 	la	connect_socketpointer		. give up before or after getting a
00:002AE0 34002F              +380 	sabr	BSOCKET				. transmission control block
00:002AE1 58F003              +381 	ly	connect_socketpointer+1		. free the port
  :                            382 
00:002AE2 160030              +383 	dsr	48
00:002AE3 C70006              +384 	ds	6
00:002AE4 47B000              +385 	qs	s:socket_address, y
00:002AE5 600000              +386 	la	r				. retrieve result value
00:002AE6 B60AEA              +387 	j	connect_return
  :                            388 
  :                            389 connect_no_path
00:002AE7 65FFBF              +390 	la	-NO_PATH,,xi
00:002AE8 B60AEA              +391 	j	connect_return
  :                            392 
  :                            393 connect_bad_argument
00:002AE9 65FFEA              +394 	la	-BAD_ARGUMENT,,xi		. the argument might have been fine
  :                            395 						. but the kernel structure was not
  :                            396 						. give up without altering
  :                            397 connect_return
00:002AEA 750058              +398 	ii	B1$				. return to application B1 frame
  :                            399 
00:002AEB FCF004              +400 	$ret
00:002AEC 38000F              +400 
00:002AED 3D0000              +400 
  :                            401 
  :                            402 .	vector name accept
  :                            403 
                                tcp_await_connection $head_far	 params(port_socket,	int)	;
00:002AEE FD0000              +405 				scalars(txarray_bank,	int)
  :                            406 
00:002AEF 60F004              +407 	la	port_socket
00:002AF0 750055              +408 	ii	READ_SOCKET$
  :                            409 
00:002AF1 480FBF              +410 	lk	(255*/16:s)
00:002AF2 AF0F80              +411 	mta	(IPPROTO_TCP*/16)
00:002AF3 B60B15              +412 	j	tcp_porthandle_wrong
00:002AF4 75006D              +413 	ii	ON_NETB$
  :                            414 
00:002AF5 C70006              +415 	ds	6
00:002AF6 6D5E00              +416 	lb, xi	BSOCKET*/9	.	000 000 000 bbb bbb 000 000 000
00:002AF7 160009              +417 	dsr	9		.	ppp ppp ppp 000 000 000 bbb bbb
00:002AF8 4E000C              +418 	rbr	12		.	000 000 bbb bbb ppp ppp ppp 000
  :                            419 
00:002AF9 600007              +420 	la	7
00:002AFA 34002F              +421 	sabr	BSOCKET
  :                            422 
00:002AFB 60D005              +423 	la	s:tcp:tbase
00:002AFC 34002F              +424 	sabr	BSOCKET
00:002AFD 20F000              +425 	sa	txarray_bank
  :                            426 
00:002AFE 500F99              +427 	lx	(BSOCKET*/12++tlist:chain(1))
  :                            428 	
00:002AFF 600006              +429 	la	6
  :                            430 
  :                            431 	$if	1
00:002B00 200009              +432 	sa	9	. subroutine does shave it
  :                            433 	$else		. but it must be in 9
  :                            434 	and	(00FFFF)
  :                            435 	$endif
  :                            436 
00:002B01 FF0FC7              +437 	call	(tcp_hash_localsocket)
00:002B02 800004              +438 	ax	a
  :                            439 
00:002B03 100007              +440 	sx	7
  :                            441 
00:002B04 600006              +442 	la	6
00:002B05 480F8E              +443 	lk	(00FFFF)
  :                            444 
  :                            445 tcp_search_new
00:002B06 50A000              +446 	lx	transmission:next
00:002B07 700002              +447 	tz	x
00:002B08 B60B0C              +448 	j	tcp_test_new
00:002B09 750041              +449 	ii	YIELD$
00:002B0A 500007              +450 	lx	7
  :                            451 
00:002B0B B60B06              +452 	j	tcp_search_new
  :                            453 	
  :                            454 tcp_test_new
00:002B0C AFA007              +455 	mta	transmission:socket_address+1
00:002B0D B60B06              +456 	j	tcp_search_new
  :                            457 
00:002B0E 68A001              +458 	lb	transmission:state
00:002B0F CDFFFC              +459 	ab, xi	-TCP_SYNRECEIVED
  :                            460 
00:002B10 DE0B06              +461 	jnzb	tcp_search_new
  :                            462 
00:002B11 FF0FC8              +463 	call	(xaccept)
  :                            464 
00:002B12 40F000              +465 	lr	txarray_bank
00:002B13 3E0B1B              +466 	lcal	tcp_newhandle
00:002B14 A60B16              +467 	jpa	tcp_awaitx
  :                            468 
  :                            469 tcp_porthandle_wrong
00:002B15 65FFFF              +470 	la, xi	-1
  :                            471 
  :                            472 tcp_awaitx
00:002B16 750070              +473 	ii	FREE_NETB$			. mask kernel buffers from application
00:002B17 75006F              +474 	ii	FREE_SOCKB$			. mask socket structures from application
00:002B18 FCF001              +475 	$ret
00:002B19 38000F              +475 
00:002B1A 3D0000              +475 
  :                            476 
  :                            477 tcp_newhandle
00:002B1B 600F80              +478 	la	(IPPROTO_TCP*/16:s)		. must be IPPROTO_TCP -> TCP_TCB
00:002B1C 750050              +479 	ii	HANDLE$
00:002B1D E60B1F              +480 	jna	tcp_newhandle_x
00:002B1E 750056              +481 	ii	USOCKET$C			. complete the new handle encoding
  :                            482 
  :                            483 tcp_newhandle_x
00:002B1F 350000              +484 	lret	0
  :                            485 
  :                            486 .	socket close vector name __net_disengage
  :                            487 .	local name is within structure $sockif
  :                            488 	
  :                            489 net_disengage
  :                            490 	$head_far	 params(close_handle,	int)
  :                            491 
  :                            492 	$if	0			. state TCP_TIMEWAIT should cover this
  :                            493 	dl	(200L)			. for outgoing close with traffic still queued
  :                            494 	ii	TWAIT$			. this is in application thread
  :                            495 	$endif
  :                            496 
00:002B20 60F003              +497 	la	close_handle
00:002B21 750055              +498 	ii	READ_SOCKET$
  :                            499 
00:002B22 480FBF              +500 	lk	(255*/16s)
00:002B23 AF0FC9              +501 	mta	(TCP_TCB*/16s)
00:002B24 B60B34              +502 	j	disengage_port?
  :                            503 
00:002B25 CE0B43              +504 	jzb	disengage_handle
00:002B26 3E0B60              +505 	lcal	sock_structure_connection
00:002B27 500005              +506 	lx	b
  :                            507 
  :                            508 	$if	0
  :                            509 
  :                            510 	dl	(400L)
  :                            511 	ii	TWAIT$
  :                            512 	j	disengage_handle
  :                            513 	$else
  :                            514 
00:002B28 450095              +515 	lr	150-1,,xi
  :                            516 	
  :                            517 traffic_free?
00:002B29 70A014              +518 	tz	transmission:q4window:head
00:002B2A B60B2F              +519 	j	traffic_gate
00:002B2B 70A016              +520 	tz	transmission:q4ack:head
00:002B2C B60B2F              +521 	j	traffic_gate
  :                            522 
  :                            523 	$if	1			. all clear
00:002B2D 0FA001              +524 	n	transmission:state	. start state unwind
  :                            525 	$else
  :                            526 	la	DAYCLOCK$
  :                            527 	sa	transmission:timer(1)
  :                            528 	$endif
  :                            529 
00:002B2E B60B43              +530 	j	disengage_handle	. in state machine
  :                            531 
  :                            532 traffic_gate				. in application try to disengage at application speed
00:002B2F CF0FCA              +533 	dl	(2L)			. msecs
00:002B30 75005B              +534 	ii	TWAIT$
  :                            535 
00:002B31 1E0B29              +536 	jdr	traffic_free?
  :                            537 
00:002B32 3E08C5              +538 	lcal	tcp_restart_timer1	. connection times out in minutes
00:002B33 B60B43              +539 	j	disengage_handle	. and separates now from application
  :                            540 					. incoming acks may prompt tx traffic until close
  :                            541 	$endif
  :                            542 
  :                            543 disengage_port?
00:002B34 AF0F7F              +544 	mta	(IPPROTO_UDP*/16s)
00:002B35 B60B3C              +545 	j	disengage_tcp_port?
  :                            546 
00:002B36 CE0B43              +547 	jzb	disengage_handle
00:002B37 3E0B61              +548 	lcal	sock_structure_port
00:002B38 75006D              +549 	ii	ON_NETB$
00:002B39 FF0FCC              +550 	call	(__port_disengage_udp)
00:002B3A 750070              +551 	ii	FREE_NETB$
00:002B3B B60B43              +552 	j	disengage_handle
  :                            553 
  :                            554 disengage_tcp_port?
00:002B3C AF0F80              +555 	mta	(IPPROTO_TCP*/16s)
00:002B3D B60B43              +556 	j	disengage_handle
  :                            557 
00:002B3E CE0B43              +558 	jzb	disengage_handle
  :                            559 
  :                            560 	$if	0
  :                            561 	drr	24
  :                            562 	sabr	BSOCKET
  :                            563 	andB	511,,xi
  :                            564 	orB	BSOCKET*/12-3,,xi
  :                            565 	sbl	3
  :                            566 	lx	b
  :                            567 	ql	(0q)
  :                            568 	tn	s:flags, x
  :                            569 	qs	s:socket_address, x
  :                            570 	$else
00:002B3F 3E0B61              +571 	lcal	sock_structure_port
  :                            572 .	lx	b
00:002B40 78D004              +573 	tn	s:flags				. do not disengage a TCP multiport
00:002B41 B60B43              +573 
00:002B42 FF0FCD              +574 	call	(__port_disengage)
  :                            575 	$endif
  :                            576 
  :                            577 disengage_handle
00:002B43 60F003              +578 	la	close_handle
00:002B44 750051              +579 	ii	FREE_HANDLE$
00:002B45 75006F              +580 	ii	FREE_SOCKB$
00:002B46 3D0000              +581 	fret	0
  :                            582 
  :                            583 
  :                            584 .	vector name is __port_disengage_udp
  :                            585 .	local name is within structure $sockif
  :                            586 .	parameter is x -> socket structure
  :                            587 
  :                            588 port_disengage_udp				. for ports which have a buffer q
00:002B47 5CD006              +589 	ly	s:udp:socket_inq,,i		. as UDP does
00:002B48 F80005              +590 	push	b				. retain socket pointer b
00:002B49 3E05B2              +591 	lcal	tcp_freerxq			. drop user datagrams on receive q
00:002B4A 380005              +592 	pop	b				. recover socket pointer b
  :                            593 
  :                            594 port_disengage					. vector name is __port_disengage
  :                            595 
  :                            596 	$if	1				. no use zeroing b
00:002B4B 8F0FCE              +597 	qpush	(0q)				. it is the operational pointer
00:002B4C 87D000              +598 	qpop	s:socket_address
  :                            599 	$else
  :                            600 	dsr	48				. for ports which have no buffer queue
  :                            601 	ds	6				. as TCP does not
  :                            602 	qs	s:socket_address 	 	. that's the port no longer bound
  :                            603 	$endif
  :                            604 	
  :                            605 port_disengage_z
00:002B4D 3D0000              +606 	fret	0
  :                            607 
  :                            608 
  :                            609 .	end connection and fall thru to unbind port
  :                            610 .	vector name __disconnect_free_tcp
  :                            611 
  :                            612 disconnect_free
  :                            613 
  :                            614 	$if	1
00:002B4E 0FA001              +615 	n	transmission:state		. don't loop on closing states
  :                            616 						. uncouple disconnect from port free / not free
  :                            617 	$else
  :                            618 
  :                            619 	la	DAYCLOCK$
  :                            620 	jnza	disconnect_free!
  :                            621 	la	1,,xi
  :                            622 disconnect_free!
  :                            623 	sa	transmission:timer(1)
  :                            624 
  :                            625 .	$endif
  :                            626 
  :                            627 disconnect_free?
  :                            628 	la	transmission:state
  :                            629 	aa	-TCP_LISTEN,,xi
  :                            630 	jza	free_tcp_port
  :                            631 	aa	TCP_LISTEN-TCP_CLOSED,,xi
  :                            632 	jza	free_tcp_port
  :                            633 	aa	TCP_CLOSED-TCP_DELETETCB,,xi
  :                            634 	jza	free_tcp_port
  :                            635 	ii	YIELD$
  :                            636 	j	disconnect_free?
  :                            637 
  :                            638 .	relinquish tcp port vector name __free_tcp_port
  :                            639 .	local name is within structure $sockif
  :                            640 .	parameter is a = port number
  :                            641 
  :                            642 	$endif
  :                            643 
  :                            644 free_tcp_port
00:002B4F 60A007              +645 	la	transmission:socket_address+1
00:002B50 3E0B57              +646 	lcal	app_tcp_port
00:002B51 C60B56              +647 	jza	free_tcp_port_z
00:002B52 30D000              +648 	z	0, b
00:002B53 30D001              +649 	z	1, b
00:002B54 30D002              +650 	z	2, b
00:002B55 30D003              +651 	z	3, b
  :                            652 free_tcp_port_z
00:002B56 3D0000              +653 	fret	0
  :                            654 					. application call to address TCP port structure
  :                            655 app_tcp_port				. unlike tcp_socket called in IP threads every rx segment
  :                            656 
  :                            657 	$if	1
00:002B57 3E08AD              +658 	lcal	tcp_socket
  :                            659 	$else
  :                            660 
  :                            661 	lb	BSOCKET*/9,,xi		. that is faster because it already has kernel vectors
  :                            662 	dsr	9			. app_tcp_port is called occasionally
  :                            663 	rbr	12
  :                            664 	and	127,,xi			. please only use 16 port number bits
  :                            665 	lx	tsockb(1),,xi
  :                            666 	ax	a
  :                            667 	ii	READ_XVECTOR$		. read kernel vector storage block index
  :                            668 
  :                            669 	$endif
  :                            670 
00:002B58 C60B5A              +671 	jza	app_tcp_port_x		. if there is none don't base it
00:002B59 34002F              +672 	sabr	BSOCKET
  :                            673 app_tcp_port_x
00:002B5A 350000              +674 	lret	0
  :                            675 
  :                            676 tcp_fin1
00:002B5B 650006              +677 	la	TCP_FINWAIT1,,xi
00:002B5C 20A001              +678 tcp_fin	sa	transmission:state
00:002B5D FF0FBE              +679 	call	(tcp_ack_fin)
  :                            680 
  :                            681 tcp_disconnect_z
00:002B5E 3D0000              +682         fret    0
00:002B5F 3D0000              +683 	fret	0				. successful return is here
  :                            684 
  :                            685 	$if	1				. input is handle encoding
  :                            686 sock_structure_connection			. 24-word block
00:002B60 060003              +687 	sar	3				. as notional 3-word code
  :                            688 						. 501 is max connections / page
  :                            689 sock_structure_port				. port ** 511 : page
00:002B61 560018              +690 	drr	24
00:002B62 34002F              +691 	sabr	BSOCKET
00:002B63 AD01FF              +692 	andB	511,,xi
00:002B64 9D5E00              +693 	orB	BSOCKET*/12-3,,xi
00:002B65 2E0003              +694 	sbl	3				. port * 8 = structure size
00:002B66 350000              +695 	lret	0
  :                            696 
  :                            697 	$else
  :                            698 sock_structure_port
  :                            699 	push	a				. save encoding 1st word
  :                            700 	sal	12
  :                            701 	lcal	sock_structure
  :                            702 	pop	a				. hand back encoding 1st word
  :                            703 	lret	0
  :                            704 
  :                            705 sock_structure_connection
  :                            706 	sar	3
  :                            707 	sal	15
  :                            708 sock_structure
  :                            709 	or	BSOCKET,,xi
  :                            710 	rar	12
  :                            711 	drr	24
  :                            712 	sabr	BSOCKET
  :                            713 	lret	0
  :                            714 	$endif
  :                            715 
  :                            716 tcp_port_socket		. vector name __tcp_socket far call get TCP port encoding
00:002B67 3E08AD              +717 	lcal	tcp_socket
00:002B68 3D0000              +718 	fret	0
  :                            719 	
  :                            720 	$root
  :                            91: 	$include	rwsocket
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 . SOCKET_CALL_FLAGS $equ 27		. in pointers.def
  :                            41 RECORD_MARK	  $equ d$save1
  :                            42 RECORD_MARK_FLAG  $equ d$save
  :                            43 NON_BLOCKING	  $equ SOCKET_CALL_FLAGS
  :                            44 
  :                            45 REPACKED	$equ	1
  :                            46 
  :                            47 	$if	REPACKED
  :                            48 
  :                            49 resolve_socket
00:002B69 750055              +50         ii      READ_SOCKET$
00:002B6A C60B7F              +51 	jza	socket_protocol_wrong
00:002B6B E60B80              +52         jna     socket_unresolved
00:002B6C 480FBF              +53         lk      (255*/16:s)
00:002B6D AF0F7F              +54         mta     (IPPROTO_UDP*/16:s)
00:002B6E B60B77              +55         j       socket_tcp?
  :                            56 
  :                            57 	$if	0
  :                            58 	and	0FF8,,xi
  :                            59 	$else
00:002B6F A501FF              +60         and, xi 511
00:002B70 260003              +61         sal     3
  :                            62 	$endif
  :                            63 
00:002B71 500F98              +64         lx      (BSOCKET*/12)
00:002B72 800004              +65         ax      a
00:002B73 600005              +66         la      b
00:002B74 34002F              +67         sabr    BSOCKET
00:002B75 600F7F              +68 	la	(IPPROTO_UDP*/16)
00:002B76 350001              +69 	lret	1
  :                            70 
  :                            71 socket_tcp?
00:002B77 AF0FC9              +72         mta     (TCP_TCB*/16)
00:002B78 B60B7F              +73         j       socket_protocol_wrong	. don't confirm the handle as a known protocol
00:002B79 A50FF8              +74         and, xi 0FF8
00:002B7A 500F98              +75         lx      (BSOCKET*/12)
00:002B7B 800004              +76         ax      a
00:002B7C 600005              +77         la      b
00:002B7D 34002F              +78         sabr    BSOCKET
00:002B7E 600FC9              +79 	la	(TCP_TCB*/16)
  :                            80 socket_protocol_wrong
00:002B7F 350001              +81 	lret	1
  :                            82 
  :                            83 socket_unresolved
00:002B80 350000              +84 	lret	0
  :                            85 
  :                            86 
  :                            87 .	you don't need to call here if you're a thread of ip
  :                            88 .       use the socket or connection queue heads to sense traffic
  :                            89 
  :                            90 .	the vector name of this is (sense_data)
  :                            91 
  :                            92 socket_sense	$head_far	 params(serx,	int	)
00:002B81 75006D              +93 	ii	ON_NETB$
00:002B82 60F003              +94 	la	serx
00:002B83 3E0B69              +95 	lcal	resolve_socket
00:002B84 B60B8E              +96 	j	sense_socket_x
  :                            97 					. resolve_socket sets k <- mask FF0000
00:002B85 AF0F7F              +98 	mta	(IPPROTO_UDP*/16)
00:002B86 B60B89              +99 	j	socket_sense_tcp?
00:002B87 3E0B91              +100 	lcal	udp_traffic?
00:002B88 B60B8E              +101 	j	sense_socket_x
  :                            102 
  :                            103 socket_sense_tcp?
00:002B89 AF0FC9              +104 	mta	(TCP_TCB*/16)
00:002B8A B60B8D              +105 	j	sense_socket_protocol_wrong
  :                            106 
  :                            107 	$if	0
  :                            108 	ly	serx-1			. internal stack walkback word
  :                            109 	lr	serx+2,,i		. possible 2nd param + 1
  :                            110 	jyge	socket_sense_tcp_extend
  :                            111 	$endif
  :                            112 
00:002B8B 3E0B97              +113 	lcal	tcp_traffic?
00:002B8C B60B8E              +114 	j	sense_socket_x
  :                            115 
  :                            116 	$if	0
  :                            117 socket_sense_tcp_extend
  :                            118 	lr	serx+1			. minimum octets sought 2nd param
  :                            119 	lcal	tcp_traffic_at_socket
  :                            120 	j	sense_socket_x
  :                            121 	$endif
  :                            122 
  :                            123 sense_socket_protocol_wrong
00:002B8D 65FFEA              +124 	la	-22,,xi
  :                            125 
  :                            126 sense_socket_x
00:002B8E 75006F              +127 	ii	FREE_SOCKB$
00:002B8F 750070              +128 	ii	FREE_NETB$
00:002B90 3D0000              +129 	$ret
  :                            130 
  :                            131 udp_traffic?
00:002B91 60A006              +132 	la	s:udp:socket_inq:head, x
00:002B92 C60B96              +133 	jza	udp_traffic_x
00:002B93 68C006              +134 	lb	descriptor:apdata, a
00:002B94 60C003              +135 	la	descriptor:bytes, a
00:002B95 68D000              +136 	lb	0, b
  :                            137 udp_traffic_x
00:002B96 350000              +138 	lret	0
  :                            139 
  :                            140 tcp_traffic?
00:002B97 60A010              +141 	la	transmission:receiveq:head
00:002B98 C60B9C              +142 	jza	tcp_traffic_x
  :                            143 
00:002B99 68C006              +144 	lb	descriptor:apdata, a
00:002B9A 60C003              +145 	la	descriptor:bytes, a
00:002B9B 68D000              +146 	lb	0, b
  :                            147 
  :                            148 tcp_traffic_x
00:002B9C 350000              +149 	lret	0
  :                            150 
  :                            151 	$if	0
  :                            152 tcp_traffic_at_socket
  :                            153 	ly	0,,xi
  :                            154 	lb	transmission:receiveq:head
  :                            155 	jzb	tcp_traffic_y
  :                            156 	ly	descriptor:bytes, b
  :                            157 
  :                            158 tcp_target?
  :                            159 	jyge	tcp_traffic_y
  :                            160 
  :                            161 	lb	descriptor:next, b
  :                            162 	jzb	tcp_traffic_y
  :                            163 	ay	descriptor:bytes, b
  :                            164 	j	tcp_target?
  :                            165 
  :                            166 tcp_traffic_y
  :                            167 	la	y
  :                            168 	lb	transmission:state
  :                            169 	lret	0
  :                            170 
  :                            171 	$endif
  :                            172 	$endif	. REPACKED
  :                            173 
  :                            174 .	dont't call here if you're a thread of ip
  :                            175 .	you get locked off ip socket buffers on exit
  :                            176 .	call (tcp_rx) instead on inspecting queue heads
  :                            177 .	or sense and access UDP queue heads 
  :                            178 
  :                            179 .	the vector name of this is (recv)
  :                            180 
                                socket_receive	$head_far	 params(sorx,		int	;
                                					rxbuf,		int	;
                                					rxbytes,	int	;
                                					rxflags,	int)	;
                                								;
                                				scalars(rstream_registers,	float, RDATAC	;
00:002B9D 8F0014              +187 					rcaller_8_11,		float,	8	)
00:002B9E 8F0008              +187 
  :                            188 
00:002B9F 60F00B              +189 	la	sorx
00:002BA0 75006D              +190 	ii	ON_NETB$
  :                            191 
  :                            192 	$if	REPACKED
00:002BA1 3E0B69              +193 	lcal	resolve_socket
00:002BA2 B60BC9              +194 	j	receive_socket_x
00:002BA3 AF0F7F              +195 	mta	(IPPROTO_UDP*/16)
00:002BA4 B60BB4              +196 	j	socket_receive_tcp?
  :                            197 
00:002BA5 60F00E              +198 	la	rxflags
00:002BA6 A50080              +199 	and	MSG_NONBLOCK,,xi
00:002BA7 D60BAD              +200 	jnza	noblock_udp
  :                            201 
  :                            202 udp_wait?
00:002BA8 3E0B91              +203 	lcal	udp_traffic?
00:002BA9 D60BAD              +204 	jnza	noblock_udp
  :                            205 
00:002BAA CF0FD2              +206 	dl	(3d)
00:002BAB 75005B              +207 	ii	TWAIT$
00:002BAC B60BA8              +208 	j	udp_wait?
  :                            209 	
  :                            210 noblock_udp
  :                            211 
  :                            212 	$else				. REPACKED
  :                            213 	ii	READ_SOCKET$
  :                            214 	jna	receive_socket_x
  :                            215 	lk	(255*/16:s)
  :                            216 	mta	(IPPROTO_UDP*/16)
  :                            217 	j	socket_receive_tcp?
  :                            218 	and, xi	511
  :                            219 	sal	3
  :                            220 	lx	(BSOCKET*/12)
  :                            221 	ax	a
  :                            222 	la	b
  :                            223 	sabr	BSOCKET
  :                            224 	$endif				. REPACKED
  :                            225 
00:002BAD 60F00C              +226 	la	rxbuf
00:002BAE 20000C              +227 	sa	p
00:002BAF 0D0010              +228 	off	b$stream16w
00:002BB0 300016              +229 	z	WDATAC
  :                            230 
00:002BB1 CFF00D              +231 	dl	rxbytes			. rxbytes:rxflags in param order
  :                            232 .	sb	SOCKET_CALL_FLAGS
  :                            233 
00:002BB2 3E0DB1              +234 	lcal	udgram_read
00:002BB3 B60BC9              +235 	j	receive_socket_x
  :                            236 
  :                            237 socket_receive_tcp?
00:002BB4 AF0FC9              +238 	mta	(TCP_TCB*/16)
00:002BB5 B60BC8              +239 	j	receive_socket_protocol_wrong
  :                            240 
  :                            241 	$if	REPACKED
  :                            242 
  :                            243 	$else
  :                            244 	and, xi	0FF8
  :                            245 	lx	(BSOCKET*/12)
  :                            246 	ax	a
  :                            247 	la	b
  :                            248 	sabr	BSOCKET
  :                            249 	$endif
  :                            250 
00:002BB6 60F00C              +251 	la	rxbuf
00:002BB7 20000C              +252 	sa	p
  :                            253 .	off	b$stream16w		. those are done in tcp_read
  :                            254 .	z	WDATAC
  :                            255 
00:002BB8 CFF00D              +256 	dl	rxbytes			. rxbytes:rxflags in param order
  :                            257 
  :                            258 	$if	0			. MSG_WAITALL also needed
  :                            259 	andB	MSG_NONBLOCK,,xi	. for TCP receive,
  :                            260 	$endif
  :                            261 
00:002BB9 28001B              +262 	sb	SOCKET_CALL_FLAGS	. NONBLOCK or no flags
  :                            263 
00:002BBA AD0040              +264 	andB	MSG_WAITALL,,xi
00:002BBB CE0BBF              +265 	jzb	receive_socket_state?
  :                            266 
00:002BBC 680F8E              +267 	lb	(00FFFF)
00:002BBD 98A00F              +268 	orB	transmission:ack_window+1
00:002BBE 28A00F              +269 	sb	transmission:ack_window+1
  :                            270 
  :                            271 receive_socket_state?
00:002BBF 68A001              +272 	lb	transmission:state
00:002BC0 CDFFFB              +273 	ab, xi	-TCP_ESTABLISHED
00:002BC1 CE0BC6              +274 	jzb	socket_rx_established
  :                            275 
  :                            276 	$if	1
  :                            277 
00:002BC2 CD0003              +278 	ab	TCP_ESTABLISHED-TCP_LISTEN,,xi
  :                            279 					. all states except deassigned
  :                            280 					. can read queued input if it's there
  :                            281 					. change to _LISTEN when repooling
00:002BC3 DE0BC6              +282 	jnzb	socket_rx_readable	. connection block is otherwise never_LISTEN
  :                            283 
  :                            284 	$else
  :                            285 
  :                            286 	ab	TCP_ESTABLISHED-TCP_SYNSENT,,xi
  :                            287 	jzb	socket_rx_readable	. block or not is (tcp_rx)
  :                            288 	ab	TCP_SYNSENT-TCP_SYNRECEIVED,,xi
  :                            289 	jzb	socket_rx_readable	. block or not is (tcp_rx)
  :                            290 	ab	TCP_SYNRECEIVED-TCP_CLOSED,,xi
  :                            291 	jzb	socket_rx_stop_reading
  :                            292 	ab	TCP_CLOSED-TCP_DELETETCB,,xi
  :                            293 	jnzb	socket_rx_readable	. connection may be half-closed
  :                            294 					. while inward data is still queued
  :                            295 socket_rx_stop_reading			. otherwise return a hands-off status
  :                            296 
  :                            297 	$endif
  :                            298 
00:002BC4 65FFE0              +299 	la	-NO_CONNECTION,,xi
00:002BC5 B60BC9              +300 	j	receive_socket_x
  :                            301 
  :                            302 socket_rx_readable
  :                            303 socket_rx_established
00:002BC6 FF0FD4              +304 	call	(tcp_rx)
  :                            305 					. return is unconditionally to here
  :                            306 					. return if you got anything
  :                            307 					. ie part of maximum or -status
  :                            308 					. if you're blocking and got nothing
  :                            309 					. you didn't get here either
00:002BC7 B60BC9              +310 	j	receive_socket_x
  :                            311 
  :                            312 
  :                            313 	$if	0
  :                            314 socket_rx_waiting
  :                            315 socket_rx_not_established
  :                            316 	.	something like a remote close has happened
  :                            317 	.	or you tried to receive before it was established
  :                            318 
  :                            319 .	blocking arrives here until something happens
  :                            320 
  :                            321 	la	SOCKET_CALL_FLAGS	. blocking
  :                            322 	jza	receive_socket_x	. report no data
  :                            323 
  :                            324 	la, i	TCP_ESTABLISHED, b	. non_blocking
  :                            325 	xor, xi	-1			. ^state
  :                            326 
  :                            327 	j	receive_socket_x
  :                            328 	$endif
  :                            329 
  :                            330 receive_socket_protocol_wrong
00:002BC8 65FFEA              +331 	la, xi	-22			. more minus than a negative state
  :                            332 
  :                            333 receive_socket_x
  :                            334 .	USTREAM				. restore b$stream register defaults
00:002BC9 75006F              +335 	ii	FREE_SOCKB$
00:002BCA 750070              +336 	ii	FREE_NETB$
00:002BCB 870008              +337 	qpop	8
00:002BCC 870014              +338 	qpop	RDATAC
00:002BCD 3D0000              +339 	fret	0
  :                            340 
  :                            341 
  :                            342 .	dont't call here if you're a thread of ip
  :                            343 .	you get locked off ip socket buffers on exit
  :                            344 .	call (tcp_tx) instead
  :                            345 
  :                            346 .	vector name of this is (send)
  :                            347 
                                socket_send	$head_far	 params(sotx,		int		;
                                					txbuf,		int		;
                                					txbytes,	int		;
                                					txflags,	int	)	;
                                									;
                                				scalars(wstream_registers, 	float, RDATAC	;
00:002BCE 8F0014              +354 					wcaller_8_11,		float,	8	)
00:002BCF 8F0008              +354 
  :                            355 
  :                            356 
00:002BD0 60F00B              +357 	la	sotx
  :                            358 
00:002BD1 75006D              +359 	ii	ON_NETB$
  :                            360 
  :                            361 	$if	1
00:002BD2 3E0B69              +362 	lcal	resolve_socket
00:002BD3 B60C0B              +363 	j	transmit_socket_x
00:002BD4 AF0F7F              +364 	mta	(IPPROTO_UDP*/16)
00:002BD5 B60C00              +365 	j	socket_transmit_tcp?
  :                            366 
  :                            367 	$else
  :                            368 	ii	READ_SOCKET$
  :                            369 	jna	transmit_socket_x
  :                            370 	lk	(255*/16:s)
  :                            371 	mta	(IPPROTO_UDP*/16:s)
  :                            372 	j	socket_transmit_tcp?
  :                            373 	and, xi	511
  :                            374 	sal	3
  :                            375 	lx	(BSOCKET*/12)
  :                            376 	ax	a
  :                            377 	la	b
  :                            378 	sabr	BSOCKET
  :                            379 	$endif
  :                            380 
00:002BD6 60F00C              +381 	la	txbuf
00:002BD7 20000D              +382 	sa	q
  :                            383 
  :                            384 	$if	0
  :                            385 	la	txbytes
  :                            386 	$else
00:002BD8 CFF00D              +387 	dl	txbytes				. tbytes:txflags in param order
00:002BD9 28001B              +388 	sb	SOCKET_CALL_FLAGS
  :                            389 	$endif
  :                            390 
00:002BDA F80002              +391 	push	x
00:002BDB FF0F96              +392 	call	(udp_txbuffer)
00:002BDC 380003              +393 	pop	y
00:002BDD C60BFE              +394 	jza	socket_udp_fail5
00:002BDE 500004              +395 	lx	a
00:002BDF 4FB000              +396 	ql	0, y				. addresses from connected socket
00:002BE0 F80005              +397 	push	b
00:002BE1 58A004              +398 	ly	descriptor:dgram, x
00:002BE2 160008              +399 	dsr	8
00:002BE3 0E0008              +400 	sbr	8
00:002BE4 C7B006              +401 	ds	dgram:ipsource, y
00:002BE5 CF0006              +402 	dl	6
00:002BE6 160008              +403 	dsr	8
00:002BE7 0E0008              +404 	sbr	8
00:002BE8 C7B008              +405 	ds	dgram:ipdest, y
00:002BE9 58A005              +406 	ly	descriptor:uproto, x
00:002BEA 380004              +407 	pop	a
00:002BEB 680007              +408 	lb	7
00:002BEC 360008              +409 	dsl	8
00:002BED 060008              +410 	sar	8
00:002BEE 0E0008              +411 	sbr	8
00:002BEF C7B000              +412 	ds	uugram:sourcep, y
00:002BF0 60F00D              +413 	la	txbytes
00:002BF1 20A003              +414 	sa	descriptor:bytes, x
00:002BF2 58A006              +415 	ly	descriptor:apdata, x
00:002BF3 3E0DC3              +416 	lcal	udgram_write
  :                            417 
  :                            418 	$if	1
00:002BF4 60F00E              +419 	la	txflags
  :                            420 	$else
  :                            421 	la	SOCKET_CALL_FLAGS
  :                            422 	$endif
  :                            423 
00:002BF5 A00FD5              +424 	and	(UDP_NO_CHECKSUM:s)
00:002BF6 C60BF9              +425 	jza	socket_call_udp_txaw
  :                            426 
00:002BF7 FF0FD6              +427 	call	(udgram_acw_send_nocheck)
00:002BF8 B60BFA              +428 	j	transmit_socket_y
  :                            429 
  :                            430 socket_call_udp_txaw
00:002BF9 FF0FD7              +431 	call	(udp_acw_send)
  :                            432 transmit_socket_y
00:002BFA 560018              +433 	drr	24
00:002BFB E60BFD              +434 	jna	transmit_socket_status	. if it's negative leave it how it is
00:002BFC C5FFE4              +435 	aa	-28,,xi			. minus	headers
  :                            436 transmit_socket_status		. 
00:002BFD B60C0B              +437 	j	transmit_socket_x
  :                            438 
  :                            439 socket_udp_fail5
00:002BFE 65FFFB              +440 	la, xi	-5
00:002BFF B60C0B              +441 	j	transmit_socket_x
  :                            442 
  :                            443 socket_transmit_tcp?
00:002C00 AF0FC9              +444 	mta	(TCP_TCB*/16:s)
00:002C01 B60C0A              +445 	j	transmit_socket_protocol_wrong
  :                            446 
  :                            447         $if	REPACKED=0
  :                            448 
  :                            449 	and, xi	0FF8
  :                            450 	lx	(BSOCKET*/12)
  :                            451 	ax	a
  :                            452 	la	b
  :                            453 	sabr	BSOCKET
  :                            454 	$endif
  :                            455 
  :                            456 .	la	txbuf
  :                            457 .	sa	q
00:002C02 CFF00D              +458 	dl	txbytes			. txbytes:txflags in param order
00:002C03 28001B              +459 	sb	SOCKET_CALL_FLAGS
00:002C04 AD0FFF              +460 	andB	 0FFF,,xi
00:002C05 9D5010              +461 	orB, xi	05000++TCP_ACK
00:002C06 480005              +462 	lk	b
00:002C07 68F00C              +463 	lb	txbuf
  :                            464 .	sb	SOCKET_CALL_FLAGS
00:002C08 FF0FD8              +465 	call	(tcp_tx)
00:002C09 B60C0B              +466 	j	transmit_socket_x
  :                            467 
  :                            468 transmit_socket_protocol_wrong
00:002C0A 55FFEA              +469 	lx	-22,,xi
  :                            470 
  :                            471 transmit_socket_x
  :                            472 .	USTREAM				. restore b$stream register defaults
00:002C0B 75006E              +473 	ii	FREE_DEVB$
00:002C0C 75006F              +474 	ii	FREE_SOCKB$
00:002C0D 750070              +475 	ii	FREE_NETB$
  :                            476 
00:002C0E 870008              +477 	qpop	8
00:002C0F 870014              +478 	qpop	RDATAC
  :                            479 
00:002C10 3D0000              +480 	fret	0
  :                            481 
  :                            482 .	SUBROUTINES AFTER HERE MUST NEVER REFERENCE INTERNAL STACK VARIABLES BEFORE HERE
  :                            483 
  :                            484 .	for write to socket buffer
  :                            485 .	16 bits at a time are read from user data
  :                            486 .	via the staging register
  :                            487 
  :                            488 .	PSR designator b$streamZR is on
  :                            489 .	b$stream16r gets cleared here
  :                            490 .	this is for 24-bit opaque data
  :                            491 .	
  :                            492 
  :                            493 .	in TCP only
  :                            494 .	the caller may write an odd number of bytes
  :                            495 .	into the transmit segment buffer, so there
  :                            496 .	may be a data word half written from the 
  :                            497 .	previous send call
  :                            498 
  :                            499 .	the pointer is apdata[word] + bytes[byte]
  :                            500 .	descriptor:bytes is updated
  :                            501 
  :                            502 .	the segment may be filled and queued, and
  :                            503 .	a new segment started
  :                            504 
  :                            505 .	on calling, the connection is in x
  :                            506 .	the caller may have a dynamic frame on FP
  :                            507 .	we save fp and use it as descriptor:
  :                            508 
  :                            509 .	the user data is in q:RDATA:RDATAC
  :                            510 .	the user byte count is in a
  :                            511 
  :                            512 
  :                            513 .	tcp_add far call vector name (tcp_tx)
  :                            514 .	x -> transmission control block
  :                            515 .	a =  bytes
  :                            516 .	q -> transmission buffer
  :                            517 
  :                            518: 	$include	tcp_add
  :                            1 tcp_add	$tree
  :                            2 
  :                            3 .	vector name tcp_tx
  :                            4 
00:002C11 28000D              +5 	sb	q
00:002C12 050040              +6 	on	b$streamZR	. read to cleared a register
00:002C13 0D0020              +7 	off	b$stream16r	. from 24-bit application-space data
00:002C14 300014              +8 	z	RDATAC		. discount residual data in RDATA
  :                            9 				. readout starts at data word q ->
00:002C15 3E0C1A              +10 	lcal	tcpa
00:002C16 3D0000              +11 	fret	0
  :                            12 
  :                            13 .	vector name tcp_addx
  :                            14 
00:002C17 28000D              +15 __x	sb	q
00:002C18 3E0C1A              +16 	lcal	tcpa		. as tcp_tx but without automatic PSR settings 
00:002C19 3D0000              +17 	fret	0		. caller to decide PSR flags and RDATAC initialisation
  :                            18 
  :                            19 
  :                            20 
                                tcpa	$head_near	scalars(caller_fp,	int,	fp	;
                                				socket_call_flags, int,	k	;
                                				mss,		int,	transmission:mss ;
                                				lookaside,	int		;
                                				outstanding,	int,	a	;
00:002C1A F8000E              +26 				requested,	int,	a	)
00:002C1B F80001              +26 
00:002C1C F8A002              +26 
00:002C1D FD0000              +26 
00:002C1E F80004              +26 
00:002C1F F80004              +26 
  :                            27 	
  :                            28 
00:002C20 3E0C62              +29 	$do	1,	lcal	wherefore?
00:002C21 688FA3              +30 	lb	*(BSOCKET*/12++tlist:connection_block(1):mss
00:002C22 788F9C              +31 	tp	*(BSOCKET*/12++tlist:flags)
00:002C23 28F003              +32 	sb	mss
  :                            33 
00:002C24 680001              +34 	lb	k
00:002C25 AD0FFF              +35 	andB	4095,,xi
00:002C26 9D5000              +36 	orB	05000,,xi
00:002C27 28F004              +37 	sb	socket_call_flags
  :                            38 
00:002C28 68F001              +39 add	lb	outstanding	. buffer request
00:002C29 48F004              +40 	lk	socket_call_flags
00:002C2A 3E0C8D              +41 	lcal	buffer
  :                            42 
00:002C2B B60C5B              +43 	j	no_output	. nothing's available, get gone
  :                            44 	
00:002C2C 20000E              +45 	sa	fp		. a -> buffer descriptor
00:002C2D 3E0C62              +46 	$do	1,	lcal	wherefore?
00:002C2E 40E003              +47 	lr	descriptor:bytes
00:002C2F 60F001              +48 	la	outstanding	. outstanding data byte count in this request
  :                            49 
00:002C30 700000              +50 	tz	r		. data already in segment buffer?
00:002C31 C60C4E              +51 	jza	push?		. there is waiting output but none new	
00:002C32 C60C5B              +52 	jza	no_output	. there is no new output
  :                            53 				. there is new output to add
00:002C33 68F003              +54 	lb	mss
00:002C34 D80000              +55 	anb	r		. available
00:002C35 20F002              +56 	sa	lookaside	. reserve the outstanding
00:002C36 D00005              +57 	ana	b
00:002C37 20F001              +58 	sa	outstanding	.
00:002C38 600005              +59 	la	b		. suggest the transfer shall be available writespace
00:002C39 7E0C3B              +60 	jc	transfer	. request = or >  write space
00:002C3A 60F002              +61 	la	lookaside	. request < write space
  :                            62 
  :                            63 transfer
00:002C3B 680000              +64 	lb	r		. update segment bytes total
00:002C3C C80004              +65 	ab	a
00:002C3D 28E003              +66 	sb	descriptor:bytes
  :                            67 
00:002C3E 68E005              +68 	lb	descriptor:uproto
00:002C3F 280011              +69 	sb	TP_HEADER
00:002C40 DE0C42              +70 	jnzb	$+2
00:002C41 75005F              +71 	ii	GUARD$
  :                            72 
00:002C42 58E006              +73 	ly	descriptor:apdata
00:002C43 180010              +74 	sy	AP_DATA
  :                            75 
00:002C44 0D0001              +76 	off	carry$
00:002C45 370000              +77 	src	r		. halve the byte count up before now, carry = remainder
00:002C46 880000              +78 	ay	r		. address in buffer for next complete data word
  :                            79 
00:002C47 68D008              +80 	lb	transfer:checksum, b
00:002C48 5E0C4B              +81 	jnc	add_words
00:002C49 3E0C85              +82 	lcal	insert_byte	. previous accumulation is an odd number of bytes
00:002C4A C5FFFF              +83 	aa	-1,,xi		. obtain the next byte and add to checksum in b
  :                            84 				. down the outstanding byte count for this transfer
  :                            85 add_words
00:002C4B 3E0CBE              +86 	lcal	w2buffer	. target address in y
  :                            87 				. byte count passed to w2buffer in a
  :                            88 				. checksum returned in a
  :                            89 				. input stream in q / RDATA / RDATAC
  :                            90 
00:002C4C 680011              +91 	lb	TP_HEADER
00:002C4D 20D008              +92 	sa	transfer:checksum, b
  :                            93 
00:002C4E 60F004              +94 push?	la	socket_call_flags
00:002C4F 680004              +95 	lb	a
00:002C50 A50008              +96 	and	TCP_PSH,,xi
00:002C51 D60C54              +97 	jnza	release		. send it
  :                            98 
00:002C52 78F001              +99 	tp	outstanding	
00:002C53 B60C5C              +100 	j	add_x				. there is space for the next send
  :                            101 
00:002C54 3E0C6A              +102 release	lcal	segment_transmit
  :                            103 
  :                            104 	$if	0
  :                            105 	tz	transmission:q4window
  :                            106 	lcal	tcp_send_on_window
  :                            107 	$endif	
  :                            108 
00:002C55 3E0C62              +109 	$do	1,	lcal	wherefore?
  :                            110 
00:002C56 68F001              +111 	lb	outstanding
00:002C57 EE0C5C              +112 	jnb	add_x				. everything is sent
00:002C58 CE0C5C              +113 	jzb	add_x
  :                            114 
00:002C59 750041              +115 	ii	YIELD$				. let TCP and IP optimise the buffer pools
  :                            116 
00:002C5A B60C28              +117 	j	add
  :                            118 
  :                            119 no_output
00:002C5B 20F000              +120 	sa	requested			. return a minus error code
  :                            121 .	sa	outstanding			. or zero for non-error void write
  :                            122 
00:002C5C 870004              +123 add_x	qpop	a				. requested:finalcount:lookaside:mss -> a:b:6:7
00:002C5D 380001              +124 	pop	k
00:002C5E 38000E              +125 	pop	fp
  :                            126 
00:002C5F EE0C61              +127 	jnb	add_z				. unless final count < 0
00:002C60 D00005              +128 	ana	b				. result = requested - final count
  :                            129 
00:002C61 350000              +130 add_z	lret	0
  :                            131 
  :                            132 	$if	1
  :                            133 wherefore?
00:002C62 CFF008              +134 	dl	8, sp
00:002C63 570FD9              +135 	dte	(4, 0503:d)
00:002C64 350000              +136 	lret	0
00:002C65 6DFF5A              +137 	lb	-0A6,,xi
00:002C66 C8F00F              +138 	ab	15, sp
00:002C67 DE0C69              +139 	jnzb	weh
00:002C68 350000              +140 	lret	0
00:002C69 75005F              +141 weh	ii	GUARD$
  :                            142 	$endif
  :                            143 
  :                            144 segment_transmit				. this is out of line because it plays stack
00:002C6A 8F0002              +145 	qpush	x				. connection.write_pointer.TCP_PSH.outstanding count 0+
  :                            146 						. b contains final call flags
00:002C6B 500011              +147 	lx	TP_HEADER
00:002C6C 480FDB              +148 	lk	(TCP_HL)
00:002C6D BFA006              +149 	mlb	transfer:hl_code, x		. insert the header length originally bespoke	
00:002C6E 28A006              +150 	sb	transfer:hl_code, x
  :                            151 
00:002C6F AD0FFF              +152 	andB,xi	TCP_FLAGS			. add header flags to the checksum
00:002C70 C8A008              +153 	ab	transfer:checksum, x
00:002C71 50F000              +154 	lx	0, sp				. connection
  :                            155 
00:002C72 400005              +156 	lr	b				. lodge checksum in r
  :                            157 
00:002C73 680010              +158 	lb	AP_DATA				. find the header length
00:002C74 D80011              +159 	anb	TP_HEADER			. again
00:002C75 2E0001              +160 	sbl	1				. in bytes
00:002C76 F8E003              +161 	push	descriptor:bytes		. calculate the total segment
00:002C77 C8F000              +162 	ab	0, sp				. length, save payload length
00:002C78 600011              +163 	la	TP_HEADER			. save segment total for checksum
00:002C79 F80005              +164 	push	b				. for the checksum
00:002C7A 980FB2              +165 	orB	(0800000:s)			. and for the 
00:002C7B 28E003              +166 	sb	descriptor:bytes		. descriptor fp ->
  :                            167 
00:002C7C 2F0000              +168 	popA	r				. add segment total to checksum
00:002C7D 00C008              +169 	sr	transfer:checksum, a
  :                            170 
00:002C7E 380005              +171 	pop	b				. retrieve the payload length
00:002C7F 650000              +172 	la, xi	0
00:002C80 360010              +173 	dsl	16
00:002C81 D7A00C              +174 	da	transmission:sequence_ackx	. update the sequence state
00:002C82 C7A00C              +175 	ds	transmission:sequence_ackx	. variable of the connection
  :                            176 	
00:002C83 870002              +177 	qpop	x				. retrieve	x = connection
  :                            178 						.		y = segment buffer write position
  :                            179 						.		a = descriptor
  :                            180 						.		b = hl_flags
00:002C84 350000              +181 	lret	0
  :                            182 
  :                            183 insert_byte					. this is out of line because it plays stack
00:002C85 F80004              +184 	push	a
  :                            185 
00:002C86 150008              +186 	rsr	8				. obtain 1 byte application data
00:002C87 C80004              +187 	ab	a				. it won't carry
00:002C88 90B000              +188 	or	0, y				. 1st byte this word, already checksummed
00:002C89 20B000              +189 	sa	0, y
00:002C8A 8D0001              +190 	ay	1,,xi				. write and increment pointer
  :                            191 
00:002C8B 380004              +192 	pop	a
00:002C8C 350000              +193 	lret	0
  :                            194 
  :                            195 
  :                            196 .	(tcp_tx)->tcp_add calls here. This routine blocks until a buffer is obtained
  :                            197 .	or the connection is not longer [ TCP_ESTABLISHED / TCP_CLOSEWAIT ]
  :                            198 
  :                            199 .	for this reason the caller can never be ip initial thread
  :                            200 .	because that runs TCP state machine which frees segment buffers on TCP_ACK
  :                            201 
  :                            202 .	ip initial thread gets small buffers for [ TCP_ACK TCP_SYN_ACK TCP_FIN TCP_RST ]
  :                            203 .	from routines [ tcp_txbuffer txp_txbufferx ]
  :                            204 .	which return no-buffer in preference to blocking
  :                            205 
  :                            206 .	oustanding transmission count is in b
  :                            207 
  :                            208 
  :                            209 buffer					. b <- outstanding  <- flags
  :                            210 	$if	0
  :                            211 	inA	65
  :                            212 	aa	-11,,xi
  :                            213 	jpa	$+2
  :                            214 	ii	GUARD$			. you are ip main thread and may not call here
  :                            215 	$endif
  :                            216 
00:002C8D 60A014              +217 	la	transmission:q4window:head
00:002C8E C60C94              +218 	jza	new_segment
00:002C8F 60A015              +219 	la	transmission:q4window:tail
00:002C90 40C003              +220 	lr	descriptor:bytes, a
00:002C91 780000              +221 	tn	r			. is 800000 (do not delete or change) on?	
00:002C92 B60C94              +221 
00:002C93 350001              +222 	lret	1			. no, segment may be incremented
  :                            223 					. yes, segment is sealed for transmission
  :                            224 					. so fall thru here to start a new segment
  :                            225 new_segment
  :                            226 
00:002C94 CE0CBD              +227 	jzb	drop_request_zero	. nothing + nothing = do nothing
  :                            228 					. even with push flag. Status zero - zero
00:002C95 F80005              +229 	push	b			. requested bytes, figure may need refreshing 
  :                            230 
  :                            231 
00:002C96 60A001              +232 request	la	transmission:state	. check connection state before requesting buffer,
00:002C97 C5FFFB              +233 	aa	-TCP_ESTABLISHED,,xi	. every time and every retry.
00:002C98 C60C9B              +234 	jza	new_segment_request	. buffers can otherwise remain locked for many minutes
00:002C99 C5FFFD              +235 	aa	TCP_ESTABLISHED-TCP_CLOSEWAIT,,xi
00:002C9A D60CBB              +236 	jnza	drop_request_closed
  :                            237 
  :                            238 new_segment_request
  :                            239 
  :                            240 LIMITQ	$equ	0
  :                            241 
  :                            242 	$if	LIMITQ
  :                            243 	lr	LIMITQ,,xi
  :                            244 	la	transmission:q4ack	. q:head segments awaiting ACK
  :                            245 
  :                            246 limitq	jza	request_segment
  :                            247 	la	0, a			. further segment awaiting ACK ?
  :                            248 	jdr	limitq			. test chain next
  :                            249 	j	no_segment		. too many segments awaiting ACK: thread wait
  :                            250 request_segment				. request segment buffer
  :                            251 	$endif
  :                            252 
00:002C9B 40A002              +253 	lr	transmission:mss
  :                            254 
  :                            255 	$if	HVSOCKET		. segment space assigned independent of mss
00:002C9C 788FBD              +256 	tp	*(+(BSOCKET*/18++tlist:flags)s)
00:002C9D 408FDC              +257 	lr	*(+(BSOCKET*/18++tlist:connection_block(1):mss)s)
  :                            258 	$endif				. size cached in contentrator table
  :                            259 
00:002C9E 600000              +260 	la	r			. outstanding[b] > mss[r] ?
00:002C9F D00005              +261 	ana	b
00:002CA0 5E0CA5              +262 	jnc	request_maximum_segment_buffer	. keep request within mss
  :                            263 
00:002CA1 600001              +264 	la	k
00:002CA2 A50008              +265 	and	TCP_PSH,,xi
00:002CA3 C60CA5              +266 	jza	request_maximum_segment_buffer
  :                            267 
00:002CA4 400005              +268 	lr	b			. TCP_PSH so only request a buffer the send() length
  :                            269 					. TCP / IP / LLH add all their own headings
  :                            270 request_maximum_segment_buffer
  :                            271 
  :                            272 	$if	1
00:002CA5 600001              +273 	la	k			. should get a pattern like 5018.4500 or 5010.4500
00:002CA6 A00FDB              +274 	and	(TCP_HL)		. but flags are stuck back on : on transmission
00:002CA7 6D4500              +275 	lb	04500,,xi		. and thenabouts checksummed
00:002CA8 3E07D7              +276 	lcal	tcp_startbuffer
00:002CA9 B60CB2              +277 	j	no_segment
  :                            278 	$else
  :                            279 	and	TCP_HL,,xi		. isolate header length. Keep flags from checksum
  :                            280 	lcal	tcp_shield_buffer
  :                            281 	j	no_segment
  :                            282 	$endif
  :                            283 
00:002CAA 30C003              +284 	z	descriptor:bytes, a	. before the buffer is on the queue
00:002CAB 3E085D              +285 	lcal	tcp_write_txq
00:002CAC 450000              +286 	lr	0,,xi
00:002CAD 580011              +287 	ly	TP_HEADER		. pointer set by shield_buffer
00:002CAE 680006              +288 	lb	6			. 2-word checksum from shield_buffer
00:002CAF C80007              +289 	ab	7			. compress
00:002CB0 28B008              +290 	sb	 transfer:checksum, y
00:002CB1 B60CB9              +291 	j	segment
  :                            292 
  :                            293 no_segment
00:002CB2 9F001A              +294 	dpush	MSS			. shield registers [ 26 27 ]
  :                            295 .	dpush	x
  :                            296 
00:002CB3 CF0FDD              +297 	dl	(10d)			. don't call tcp_add from IP main thread
  :                            298 
  :                            299 	$if	0
  :                            300 	ii	KERNEL$B1_1		. call from application needs IP B1 frame
  :                            301 	MIB_ICOUNT48	tcpAddWait:i
  :                            302 	ii	B1$			. back to application B1 frame
  :                            303 	$endif
  :                            304 
00:002CB4 75005B              +305 	ii	TWAIT$
  :                            306 
  :                            307 .	c	(tx_mib_update)	tcpAddWait:i,,xi	1,,xi
  :                            308 
  :                            309 .	dpop	x
00:002CB5 38001A              +310 	dpop	MSS			. recover mss & call flags
00:002CB6 38001B              +310 
00:002CB7 68F000              +311 	lb	0, sp			. recover request # bytes for next attempt
00:002CB8 B60C96              +312 	j	request
  :                            313 
00:002CB9 17000F              +314 segment	inc	sp			. request # bytes was cached on stack top
00:002CBA 350001              +315 	lret	1			. = buffer obtained
  :                            316 
  :                            317 drop_request_closed
  :                            318 	$if	1
  :                            319 .	c	(tx_mib_update)	tcpAddRelinquish:i,,xi	1,,xi
  :                            320 	$else
  :                            321 	ii	KERNEL$B1_1		. call from application needs IP B1 frame
  :                            322 	MIB_ICOUNT48	tcpAddRelinquish:i
  :                            323 	ii	B1$			. back to application B1 frame
  :                            324 	$endif
  :                            325 
00:002CBB 65FFE0              +326 	la	-FILE_NOT_OPEN,,xi
  :                            327 
00:002CBC 17000F              +328 	inc	sp			. request # bytes was cached on stack top
  :                            329 
  :                            330 drop_request_zero
00:002CBD 350000              +331 	lret	0
  :                            332 
  :                            333 	$root
  :                            334 
  :                            519 
  :                            520 	$if	0
  :                            521 tcp_shield_buffer
  :                            522 .	dpush	MSS
  :                            523 
  :                            524 	lb	04500,,xi
  :                            525 	lcal	tcp_startbuffer
  :                            526 	sr	0
  :                            527 .	pop	MSS
  :                            528 .	pop	SOCKET_CALL_FLAGS
  :                            529 	jza	tcp_nobuffer_shield
  :                            530 	lret	1
  :                            531 tcp_nobuffer_shield
  :                            532 	lret	0
  :                            533 	$endif
  :                            534 
  :                            535 sendbytepair* $proc
  :                            536 	rsr	16
  :                            537 	sa	?-1, y
  :                            538 	ab	a
  :                            539 	$end
  :                            540 
  :                            541 w2buffer
00:002CBE F80004              +542 	push	a
00:002CBF 060005              +543 	sar	5
00:002CC0 400004              +544 	lr	a
00:002CC1 B60CF7              +545 	j	send32bytes?
  :                            546 send32bytes!
00:002CC2 150010              +547 ?	$do	16,	sendbytepair
00:002CC3 20B000              +547 
00:002CC4 C80004              +547 
00:002CC5 150010              +547 
00:002CC6 20B001              +547 
00:002CC7 C80004              +547 
00:002CC8 150010              +547 
00:002CC9 20B002              +547 
00:002CCA C80004              +547 
00:002CCB 150010              +547 
00:002CCC 20B003              +547 
00:002CCD C80004              +547 
00:002CCE 150010              +547 
00:002CCF 20B004              +547 
00:002CD0 C80004              +547 
00:002CD1 150010              +547 
00:002CD2 20B005              +547 
00:002CD3 C80004              +547 
00:002CD4 150010              +547 
00:002CD5 20B006              +547 
00:002CD6 C80004              +547 
00:002CD7 150010              +547 
00:002CD8 20B007              +547 
00:002CD9 C80004              +547 
00:002CDA 150010              +547 
00:002CDB 20B008              +547 
00:002CDC C80004              +547 
00:002CDD 150010              +547 
00:002CDE 20B009              +547 
00:002CDF C80004              +547 
00:002CE0 150010              +547 
00:002CE1 20B00A              +547 
00:002CE2 C80004              +547 
00:002CE3 150010              +547 
00:002CE4 20B00B              +547 
00:002CE5 C80004              +547 
00:002CE6 150010              +547 
00:002CE7 20B00C              +547 
00:002CE8 C80004              +547 
00:002CE9 150010              +547 
00:002CEA 20B00D              +547 
00:002CEB C80004              +547 
00:002CEC 150010              +547 
00:002CED 20B00E              +547 
00:002CEE C80004              +547 
00:002CEF 150010              +547 
00:002CF0 20B00F              +547 
00:002CF1 C80004              +547 
00:002CF2 600005              +548 	la	b
00:002CF3 160010              +549 	dsr	16
00:002CF4 0E0008              +550 	sbr	8
00:002CF5 C80004              +551 	ab	a
00:002CF6 8D0010              +552 	ay, xi	16
  :                            553 send32bytes?
00:002CF7 1E0CC2              +554 	jdr	send32bytes!
  :                            555 
00:002CF8 60F000              +556 	la	0, sp
00:002CF9 A5001F              +557 	and, xi	31
00:002CFA 060001              +558 	sar	1
00:002CFB 400004              +559 	lr	a
00:002CFC B60D01              +560 	j	send2bytes?
  :                            561 send2bytes!
00:002CFD 150010              +562 ?	$do	1,	sendbytepair
00:002CFE 20B000              +562 
00:002CFF C80004              +562 
00:002D00 8D0001              +563 	ay, xi	1
  :                            564 send2bytes?
00:002D01 1E0CFD              +565 	jdr	send2bytes!
  :                            566 
00:002D02 380004              +567 	pop	a
00:002D03 9E0D06              +568 	jao	send1byte
00:002D04 600005              +569 	la	b
00:002D05 350000              +570 	lret	0
  :                            571 
  :                            572 send1byte
00:002D06 150008              +573 	rsr	8
00:002D07 260008              +574 	sal	8
00:002D08 20B000              +575 	sa	0, y
00:002D09 C00005              +576 	aa	b
00:002D0A 350000              +577 	lret	0
  :                            578 
  :                            579 
  :                            580 rbufferq* $proc
  :                            581 	dl	?*2-2, y
  :                            582 	dsl	8
  :                            583 	wsr	16
  :                            584 	la	b
  :                            585 	wsr	16
  :                            586 	$end
  :                            587 
00:002D0B F80004              +588 rbuffer	push	a
00:002D0C 060005              +589 	sar	5
00:002D0D 400004              +590 	lr	a
00:002D0E B60D38              +591 	j	rbuffer32?
  :                            592 
  :                            593 rbuffer32!
00:002D0F CFB000              +594 ?	$do	8,	rbufferq
00:002D10 360008              +594 
00:002D11 1D0010              +594 
00:002D12 600005              +594 
00:002D13 1D0010              +594 
00:002D14 CFB002              +594 
00:002D15 360008              +594 
00:002D16 1D0010              +594 
00:002D17 600005              +594 
00:002D18 1D0010              +594 
00:002D19 CFB004              +594 
00:002D1A 360008              +594 
00:002D1B 1D0010              +594 
00:002D1C 600005              +594 
00:002D1D 1D0010              +594 
00:002D1E CFB006              +594 
00:002D1F 360008              +594 
00:002D20 1D0010              +594 
00:002D21 600005              +594 
00:002D22 1D0010              +594 
00:002D23 CFB008              +594 
00:002D24 360008              +594 
00:002D25 1D0010              +594 
00:002D26 600005              +594 
00:002D27 1D0010              +594 
00:002D28 CFB00A              +594 
00:002D29 360008              +594 
00:002D2A 1D0010              +594 
00:002D2B 600005              +594 
00:002D2C 1D0010              +594 
00:002D2D CFB00C              +594 
00:002D2E 360008              +594 
00:002D2F 1D0010              +594 
00:002D30 600005              +594 
00:002D31 1D0010              +594 
00:002D32 CFB00E              +594 
00:002D33 360008              +594 
00:002D34 1D0010              +594 
00:002D35 600005              +594 
00:002D36 1D0010              +594 
00:002D37 8D0010              +595 	ay, xi	16
  :                            596 rbuffer32?
00:002D38 1E0D0F              +597 	jdr	rbuffer32!
  :                            598 
00:002D39 60F000              +599 	la	0, sp
00:002D3A A5001F              +600 	and, xi	31
00:002D3B 060001              +601 	sar	1
00:002D3C 400004              +602 	lr	a
00:002D3D B60D42              +603 	j	rbuffer2?
  :                            604 
  :                            605 rbuffer2!
00:002D3E 60B000              +606 	la	0, y
00:002D3F 260008              +607 	sal	8
00:002D40 1D0010              +608 	wsr	16
00:002D41 8D0001              +609 	ay, xi	1
  :                            610 rbuffer2?
00:002D42 1E0D3E              +611 	jdr	rbuffer2!
  :                            612 
00:002D43 380004              +613 	pop	a
00:002D44 9E0D46              +614 	jao	rbuffer1
00:002D45 350000              +615 	lret	0
  :                            616 
  :                            617 rbuffer1
00:002D46 60B000              +618 	la	0, y
00:002D47 260008              +619 	sal	8
00:002D48 1D0008              +620 	wsr	8
00:002D49 350000              +621 	lret	0
  :                            622 
  :                            623 
  :                            624 tcp_rbuffer
00:002D4A F80004              +625 	push	a			. push the total sought
00:002D4B 680004              +626 	lb	a			. initialise an outstanding final count
  :                            627 tcp_rbuffer_next
00:002D4C 60A010              +628 	la	transmission:receiveq:head
00:002D4D 20000E              +629 	sa	fp
00:002D4E C60D74              +630 	jza	tcp_rbuffer_x
00:002D4F CE0D74              +631 	jzb	tcp_rbuffer_x
  :                            632 
  :                            633 .	push	b			. # bytes sought again
  :                            634 
00:002D50 60E003              +635 	la	descriptor:bytes	. read byte count this buffer
00:002D51 40E007              +636 	lr	descriptor:readpoint	. and delivered count / pointer
  :                            637 
00:002D52 D00000              +638 	ana	r			. difference is bytes not yet delivered
00:002D53 C60D6A              +639 	jza	tcp_rbuffer_free	. to the caller
  :                            640 
00:002D54 F80005              +641 	push	b			. bytes outstanding short term on the stack top
00:002D55 D80004              +642 	anb	a			. bytes outstanding minus bytes available
  :                            643 
00:002D56 7E0D58              +644 	jc	tcp_readtransfer	. transfer is bytes available
  :                            645 					. bytes oustanding < bytes available
  :                            646 
00:002D57 60F000              +647 	la	0, sp			. transfer is outstanding count
  :                            648 
  :                            649 
  :                            650 tcp_readtransfer
00:002D58 20F000              +651 	sa	0, sp
00:002D59 2FE007              +652 	popA	descriptor:readpoint
  :                            653 					. so far it reads sp -> #requested | return address
00:002D5A F80005              +654 	push	b			. sp -> #requested - transfer | #requested | return address
  :                            655 
00:002D5B 7E0D71              +656 	jc	tcp_read_disaster	. if updating the octet read pointer carried
  :                            657 					. something is really wrong
00:002D5C 370000              +658 	src	r			. octet read counter -> byte pair offset, carry = odd byte 
00:002D5D 58E006              +659 	ly	descriptor:apdata
00:002D5E 880000              +660 	ay	r			. this instruction does not sense or change carry
  :                            661 
00:002D5F 5E0D67              +662 	jnc	tcp_read_words
  :                            663 
00:002D60 F80004              +664 	push	a			. carry = 1 = last read left a byte in leading word
00:002D61 60B000              +665 	la	0, y			. read that word
00:002D62 8D0001              +666 	ay, xi	1			. and point beyond it
00:002D63 260010              +667 	sal	16			. write to receive buffer
00:002D64 1D0008              +668 	wsr	8
00:002D65 1FF000              +669 	dec	0, sp			. decrement final count on the stack
00:002D66 380004              +670 	pop	a
  :                            671 
  :                            672 tcp_read_words
00:002D67 3E0D0B              +673 	lcal	rbuffer
  :                            674 
00:002D68 380005              +675 	pop	b			. sp -> #requested | return address
00:002D69 EE0D74              +676 	jnb	tcp_rbuffer_x		. outstanding minus available < 0 = leave
  :                            677 .	jzb	tcp_rbuffer_x
  :                            678 
  :                            679 tcp_rbuffer_free			. buffer all delivered
00:002D6A F80005              +680 	push	b			. outstanding count
00:002D6B 3E0853              +681 	lcal	tcp_read_rxq		. that's the delivered buffer: take it from the queue
  :                            682 
00:002D6C F80002              +683 	push	x			. save connexion pointer
00:002D6D 3E00C9              +684 	lcal	net_free		. pool it
00:002D6E 380002              +685 	pop	x
  :                            686 
00:002D6F 380005              +687 	pop	b			. retrieve the outstanding count
00:002D70 B60D4C              +688 	j	tcp_rbuffer_next
  :                            689 
  :                            690 tcp_read_disaster
00:002D71 30F000              +691 	z	0, sp			. this should deliver -100
00:002D72 6D0064              +692 	lb	100,,xi
00:002D73 B60D86              +693 	j	tcp_rbuffer_complete
  :                            694 
  :                            695 tcp_rbuffer_x
00:002D74 EE0D86              +696 	jnb	tcp_rbuffer_complete	. maximum bytes read
00:002D75 CE0D86              +697 	jzb	tcp_rbuffer_complete
  :                            698 
  :                            699 	$if	1
  :                            700 
00:002D76 60001B              +701 	la	SOCKET_CALL_FLAGS
00:002D77 A50080              +702 	and	MSG_NONBLOCK,,xi
00:002D78 D60D86              +703 	jnza	tcp_rbuffer_complete	. don't block at all
  :                            704 
00:002D79 60001B              +705 	la	SOCKET_CALL_FLAGS
00:002D7A A50040              +706 	and	MSG_WAITALL,,xi
00:002D7B D60D7F              +707 	jnza	rx_state_examine	. block until all or error
  :                            708 
  :                            709 	$else
  :                            710 
  :                            711 	tz	NON_BLOCKING
  :                            712 	j	tcp_rbuffer_complete
  :                            713 
  :                            714 	$endif
  :                            715 
00:002D7C 60F000              +716 	la	0, sp			. only block if no data is received already
00:002D7D D00005              +717 	ana	b
00:002D7E D60D86              +718 	jnza	tcp_rbuffer_complete	. some bytes rx
  :                            719 
  :                            720 rx_state_examine
00:002D7F 60A001              +721 	la	transmission:state
  :                            722 
  :                            723 
  :                            724 	$if	0
  :                            725 	jpa	rx_state_positive
  :                            726 	xor	-1,,xi
  :                            727 
  :                            728 rx_state_positive
  :                            729 	aa	-TCP_ESTABLISHED,,xi	. is state different from ESTABLISHED ?
  :                            730 	jnza	rx_connection_down	. if so remote socket sends nothing more
  :                            731 	ii	YIELD$			. see if if data or state change comes
  :                            732 	j	tcp_rbuffer_next
  :                            733 
  :                            734 rx_connection_down
  :                            735 .	lb	a			. break state changed
  :                            736 .	ab	TCP_ESTABLISHED,,xi	. state before -TCP_ESTABLISHED,,xi was added
  :                            737 	la	0,,xi
  :                            738 	lb	NO_CONNECTION,,xi
  :                            739 
  :                            740 	$else
  :                            741 	
00:002D80 C5FFF8              +742 	aa	-TCP_CLOSEWAIT,,xi	. or if changed from estabished
00:002D81 C60D86              +743 	jza	tcp_rbuffer_complete
  :                            744 	
00:002D82 750041              +745 	ii	YIELD$
  :                            746 .	la	transmission:state
00:002D83 C50006              +747 	aa	TCP_CLOSEWAIT-TCP_LISTEN,,xi
00:002D84 D60D4C              +748 	jnza	tcp_rbuffer_next	. file closed
00:002D85 6D0020              +749 	lb	NO_CONNECTION,,xi	. this gets turned into -NO_CONNECTION
  :                            750 
  :                            751 	$endif
  :                            752 
  :                            753 					. fall athru
  :                            754 tcp_rbuffer_complete
00:002D86 650000              +755 	la	0,,xi			. store any 1 or 2 bytes waiting in WDATA
00:002D87 1D0010              +756 	wsr	16
00:002D88 380004              +757 	pop	a			. original request count
  :                            758 					. we need to check somewhere if the
  :                            759 					. connnection has been lost
00:002D89 EE0D8B              +760 	jnb	$+2
00:002D8A D00005              +761 	ana	b			. result is request minus oustanding count
00:002D8B 350000              +762 	lret	0			. giving bytes received
  :                            763 
  :                            764 
  :                            765 .	tcp_read far call vector name is (tcp_rx)
  :                            766 .	x -> transmission control block
  :                            767 .	a =  bytes
  :                            768 .	p -> receive buffer
  :                            769 
  :                            770 tcp_read
  :                            771 	$if	0
  :                            772 	la	x
  :                            773 	lk	-4096,,xi
  :                            774 	mta	(BSOCKET*/12)
  :                            775 	ii	GUARD$
  :                            776 	$endif
  :                            777 	
00:002D8C 0D0010              +778 	off	b$stream16w	. target store 3 octets / word
00:002D8D 300016              +779 	z	WDATAC		. starting on a word edge
  :                            780 
00:002D8E F8000E              +781 	push	fp
00:002D8F 3E0D4A              +782 	lcal	tcp_rbuffer
00:002D90 C60D93              +783 	jza	tcp_rbuffer_z	. because you read nothing
00:002D91 700016              +784 	tz	WDATAC
00:002D92 3E0D95              +785 	lcal	tcp_rbuffer_y	. write the staging register through
  :                            786 tcp_rbuffer_z
00:002D93 38000E              +787 	pop	fp
00:002D94 3D0000              +788 	fret	0		. end (tcp_rx)
  :                            789 
  :                            790 tcp_rbuffer_y
  :                            791 udp_rbuffer_y
00:002D95 F80004              +792 	push	a
00:002D96 60800C              +793 	la	*p
00:002D97 680017              +794 	lb	WDATA
00:002D98 268016              +795 	sal	*WDATAC
00:002D99 568016              +796 	drr	*WDATAC
00:002D9A 20800C              +797 	sa	*p
00:002D9B 380004              +798 	pop	a
00:002D9C 350000              +799 	lret	0
  :                            800 
  :                            801 XDR_TCP_INLINE $set 0
  :                            802 	$if	XDR_TCP_INLINE
  :                            803 	$flag	untested and better off somewhere else
  :                            804 
  :                            805 .	there is no detailed guidance from IETF, SUN or anywhere else
  :                            806 .	whether marked record fragments can split fields up
  :                            807 
  :                            808 .	Apple's NFS / TCP is written as if that was possible, so this
  :                            809 .	is also written as if a new record mark could start in the
  :                            810 .	middle of an opaque or number field
  :                            811 
  :                            812 .	these XDR calls will only work on a blocking connection
  :                            813 .	so the socket owner may not be the IP stack itself for these
  :                            814 
  :                            815 
  :                            816 
  :                            817 tcp_rbuffer_marked
  :                            818 	lb	RECORD_MARK
  :                            819 	jzb	tcp_read_record_mark
  :                            820 	anb	a
  :                            821 	push,xi	0
  :                            822 	jc	tcp_rbuffer_record
  :                            823 	ana	RECORD_MARK
  :                            824 	sa	0, sp
  :                            825 	la	RECORD_MARK
  :                            826 	lb, xi	0
  :                            827 
  :                            828 tcp_rbuffer_record
  :                            829 	sb	RECORD_MARK
  :                            830 	lcal	tcp_rbuffer
  :                            831 	pop	a
  :                            832 	jnza	tcp_read_record_mark
  :                            833 	wsr	16
  :                            834 	fret	0
  :                            835 
  :                            836 tcp_read_record_mark
  :                            837 	tp	RECORD_MARK_FLAG
  :                            838 	j	tcp_read_record_alignment_error
  :                            839 	push	a
  :                            840 	push	WDATA
  :                            841 	push	WDATAC
  :                            842 	push	p
  :                            843 	push,xi	6
  :                            844 	pop	p
  :                            845 	z	WDATAC
  :                            846 	la, xi	4
  :                            847 	lcal	tcp_rbuffer
  :                            848 	wsr	16
  :                            849 	dl	6
  :                            850 	dsa	16
  :                            851 	ds	RECORD_MARK_FLAG
  :                            852 	pop	p
  :                            853 	pop	WDATAC
  :                            854 	pop	WDATA
  :                            855 	pop	a
  :                            856 	j	tcp_rbuffer_marked
  :                            857 
  :                            858 tcp_read_record_alignment_error
  :                            859 	la, xi	-99
  :                            860 	fret	0
  :                            861 
  :                            862 
  :                            863 
  :                            864 tcp_read_opaque
  :                            865 	push	fp
  :                            866 	z	WDATAC
  :                            867 			. ask for the number of bytes you actually want
  :                            868 			. round up the descriptor:readpointer
  :                            869 			. in the final buffer read
  :                            870 			. push out the last delivered word to 24 bits
  :                            871 
  :                            872 	push	a	. how much you want
  :                            873 
  :                            874 	lcal	tcp_rbuffer_marked
  :                            875 	jnzb	tcp_incomplete_opaque_read
  :                            876 
  :                            877 
  :                            878 	z	WDATAC
  :                            879 
  :                            880 	la	0, sp	. # bytes requested
  :                            881 	and, xi	3	. flag up not 4 multiple
  :                            882 	jza	tcp_read_opaquex
  :                            883 
  :                            884 	tz	fp
  :                            885 	j	tcp_round_opaque_read
  :                            886 
  :                            887 			. we tested the marked record
  :                            888 			. for all present, so if no
  :                            889 			. segment buffer is at the
  :                            890 			. queue head, we are scanning
  :                            891 			. the wrong structure
  :                            892 
  :                            893 tcp_incomplete_opaque_read
  :                            894 	n	0, sp	. flag something is miscalculated
  :                            895 	j	tcp_read_opaquex
  :                            896 
  :                            897 tcp_round_opaque_read
  :                            898 	xor, xi	3
  :                            899 	push, i	1, a
  :                            900 	popA	descriptor:readpoint
  :                            901 
  :                            902 tcp_read_opaquex
  :                            903 	pop	a
  :                            904 	pop	fp
  :                            905 	fret	0
  :                            906 
  :                            907 tcp_floating_xdr64_read
  :                            908 	push	fp
  :                            909 	push	p
  :                            910 	push,xi	8
  :                            911 	pop	p
  :                            912 	z	WDATAC
  :                            913 	la, xi	8
  :                            914 	lcal	tcp_rbuffer_marked
  :                            915 	jzb	tcp_double_convert
  :                            916 	la, xi	-12
  :                            917 	j	tcp_floating_xdr64_readx
  :                            918 tcp_double_convert
  :                            919 	lx, xi	8
  :                            920 	call	(ieee754_64_2float)
  :                            921 	ly	0, sp
  :                            922 	qs	0, y
  :                            923 	ay, xi	4
  :                            924 	sy	0, sp
  :                            925 	la, xi	12
  :                            926 tcp_floating_xdr64_readx
  :                            927 	pop	p
  :                            928 	pop	fp
  :                            929 	fret	0
  :                            930 
  :                            931 tcp_integer_xdr32_read
  :                            932 	push	fp
  :                            933 	push	p
  :                            934 	push,xi	8
  :                            935 	pop	p
  :                            936 	z	WDATAC
  :                            937 	la, xi	4
  :                            938 	lcal	tcp_rbuffer_marked
  :                            939 	pop	y
  :                            940 	jzb	tcp_align_integer
  :                            941 	la, xi	-6
  :                            942 	j	tcp_integer_xdr32_readx
  :                            943 tcp_align_integer
  :                            944 	dl	8
  :                            945 	dsa	16
  :                            946 	ds	0, y
  :                            947 	ay, xi	2
  :                            948 	la, xi	6
  :                            949 tcp_integer_xdr32_readx
  :                            950 	sy	p
  :                            951 	pop	fp
  :                            952 	fret	0
  :                            953 
  :                            954 	$endif
  :                            955 
  :                            956 
  :                            957 	$if	0	. these don't seem to be called
  :                            958 tcp_add1byte
  :                            959 	sal	16
  :                            960 	wsr	8
  :                            961 	la	0, y
  :                            962 	aa, xi	1
  :                            963 	anu, xi	24
  :                            964 	sa	0, y
  :                            965 	jnc	tcp_addxbyte
  :                            966 
  :                            967 	z	SOCKET_CALL_FLAGS
  :                            968 
  :                            969 tcp_sendlastbytes
  :                            970 	lb, i, 	1, y
  :                            971 	sb	p
  :                            972 	sb	q
  :                            973 	z	0, y
  :                            974 	z	RDATAC
  :                            975 	z	WDATAC
  :                            976 	lcal	tcp_add
  :                            977 	fet	0
  :                            978 
  :                            979 tcp_pushline
  :                            980 	la	1, y
  :                            981 	jza	tcp_addxbyte
  :                            982 	push,xi	TCP_PSH
  :                            983 	pop	SOCKET_CALL_FLAGS
  :                            984 	wsr	16
  :                            985 	j	tcp_sendlastbytes
  :                            986 	
  :                            987 tcp_addxbyte
  :                            988 	fret	0
  :                            989 	$endif
  :                            990 
  :                            991 
  :                            992 	$if	0
  :                            993 udp_read
  :                            994 	lb	a
  :                            995 udp_read1
  :                            996 	la	s:udp:socket_inq:head
  :                            997 	jza	udp_readx
  :                            998 udp_read_next
  :                            999 	sa	fp
  :                            1000 	push	b
  :                            1001 	la	descriptor:bytes
  :                            1002 	anb	a
  :                            1003 	jc	udp_readbuffer
  :                            1004 	la	0, sp
  :                            1005 udp_readbuffer
  :                            1006 	sb	0, sp
  :                            1007 	lr	descriptor:readpoint
  :                            1008 	lb	r
  :                            1009 	ab	a
  :                            1010 	sb	descriptor:readpoint
  :                            1011 	lb	r
  :                            1012 	sbr	1
  :                            1013 	ly	b
  :                            1014 	ay	descriptor:apdata	
  :                            1015 
  :                            1016 	lcal	rbuffer
  :                            1017 
  :                            1018 	pop	b
  :                            1019 	jnb	udp_readx
  :                            1020 	jzb	udp_readx
  :                            1021 
  :                            1022 	la	descriptor:dgram
  :                            1023 	la	dgram:flags_fragment, a
  :                            1024 	and, xi	IP_MORE
  :                            1025 	jza	udp_readx
  :                            1026 	lcal	udp_read_rxq	. the readq call returns q:head in A
  :                            1027 	push	b		. and next in B
  :                            1028 	push	x		. keep the socket as well
  :                            1029 	lcal	net_free
  :                            1030 	pop	x		. the socket
  :                            1031 	pop	a		. the new first in readq if any
  :                            1032 	jnza	udp_read_next
  :                            1033 udp_readx
  :                            1034 	lret	0
  :                            1035 
  :                            1036 	$endif
  :                            1037 
  :                            1038 .	that routine consumes the buffers in the user datagram
  :                            1039 .	unconditionally and uses the cursor :readpoint
  :                            1040 .	it is for XDR / RPC field extractions
  :                            1041 
  :                            1042 .	next is a similar routine for plain udgram_read
  :                            1043 .	the buffers are not dropped, in case it's flagged
  :                            1044 .	that this is a PEEK
  :                            1045 
  :                            1046 .	the :readpoint cursor is not maintained or consulted
  :                            1047 
  :                            1048 udgram_rbuffer
00:002D9D 60E003              +1049 	la	descriptor:bytes
00:002D9E 68F002              +1050 	lb	2, sp
00:002D9F D80004              +1051 	anb	a	. subtract available from required
00:002DA0 7E0DA2              +1052 	jc	udgram_rbloc
00:002DA1 60F002              +1053 	la	2, sp	. transfer block is total required
  :                            1054 udgram_rbloc
00:002DA2 F80004              +1055 	push	a
00:002DA3 2FF002              +1056 	popA	2, sp	. increment rx count		
00:002DA4 28F002              +1057 	sb	2, sp	. push the new outstanding #
00:002DA5 58E006              +1058 	ly	descriptor:apdata
00:002DA6 3E0D0B              +1059 	lcal	rbuffer
  :                            1060 
  :                            1061 	$if	RX_FRAGMENTS
  :                            1062 	jnb	udgram_rbuffer_x
  :                            1063 	jzb	udgram_rbuffer_x
  :                            1064 	lb	descriptor:dgram
  :                            1065 	lb	dgram:flags_fragment, b
  :                            1066 	andB,xi	IP_MORE
  :                            1067 	jzb	udgram_rbuffer_x
  :                            1068 	la	descriptor:next
  :                            1069 	jnza	udgram_rbuffer
  :                            1070 	$endif
  :                            1071 
  :                            1072 udgram_rbuffer_x
00:002DA7 350000              +1073 	lret	0
  :                            1074 
  :                            1075 udp_auto_connect
00:002DA8 58E004              +1076 	ly	descriptor:dgram
00:002DA9 CFB006              +1077 	dl	dgram:ipsource, y
00:002DAA 2E0008              +1078 	sbl	8
00:002DAB 360008              +1079 	dsl	8
00:002DAC 58E005              +1080 	ly	descriptor:uproto
00:002DAD 480F8E              +1081 	lk	(00FFFF)
00:002DAE BFB000              +1082 	mlb	uugram:sourcep, y
00:002DAF C7A002              +1083 	ds	s:remote_address, x
00:002DB0 350000              +1084 	lret
  :                            1085 
  :                            1086 
  :                            1087 udgram_read
00:002DB1 F8000E              +1088 	push	fp
00:002DB2 F80004              +1089 	push	a		. max bytes
00:002DB3 60A006              +1090 	la	s:udp:socket_inq:head, x
00:002DB4 C60DC0              +1091 	jza	udgram_readx
00:002DB5 20000E              +1092 	sa	fp
  :                            1093 	
00:002DB6 60001B              +1094 	la	SOCKET_CALL_FLAGS
00:002DB7 A00FDF              +1095 	and	(UDP_AUTO_CONNECT:s)
00:002DB8 C60DBA              +1096 	jza	$+2
00:002DB9 3E0DA8              +1097 	lcal	udp_auto_connect
  :                            1098 
00:002DBA FD0000              +1099 	push,xi	0		. received bytes
00:002DBB 3E0D9D              +1100 	lcal	udgram_rbuffer
00:002DBC 700016              +1101 	tz	WDATAC
00:002DBD 3E0D95              +1102 	lcal	udp_rbuffer_y
  :                            1103 .	tp	SOCKET_CALL_FLAGS
00:002DBE FF0FE0              +1104 	call	(release_udgram)
00:002DBF 380004              +1105 	pop	a		. received
  :                            1106 udgram_readx
00:002DC0 380005              +1107 	pop	b		. final-count
00:002DC1 38000E              +1108 	pop	fp
00:002DC2 350000              +1109 	lret	0
  :                            1110 
  :                            1111 
  :                            1112 wpair_nocheck* $proc
  :                            1113 	rsr	16
  :                            1114 	sa	?-1, y
  :                            1115 	$end
  :                            1116 
  :                            1117 udgram_write
00:002DC3 300014              +1118 	z	RDATAC
00:002DC4 050040              +1119 	on	b$streamZR
00:002DC5 0D0020              +1120 	off	b$stream16r
  :                            1121 w2buffer_nocheck
00:002DC6 160005              +1122 	dsr	5
00:002DC7 F80005              +1123 	push	b
00:002DC8 400004              +1124 	lr	a
00:002DC9 B60DEB              +1125 	j	w2nocheck32?
  :                            1126 
  :                            1127 w2nocheck32!
00:002DCA 150010              +1128 ?	$do	16,	wpair_nocheck
00:002DCB 20B000              +1128 
00:002DCC 150010              +1128 
00:002DCD 20B001              +1128 
00:002DCE 150010              +1128 
00:002DCF 20B002              +1128 
00:002DD0 150010              +1128 
00:002DD1 20B003              +1128 
00:002DD2 150010              +1128 
00:002DD3 20B004              +1128 
00:002DD4 150010              +1128 
00:002DD5 20B005              +1128 
00:002DD6 150010              +1128 
00:002DD7 20B006              +1128 
00:002DD8 150010              +1128 
00:002DD9 20B007              +1128 
00:002DDA 150010              +1128 
00:002DDB 20B008              +1128 
00:002DDC 150010              +1128 
00:002DDD 20B009              +1128 
00:002DDE 150010              +1128 
00:002DDF 20B00A              +1128 
00:002DE0 150010              +1128 
00:002DE1 20B00B              +1128 
00:002DE2 150010              +1128 
00:002DE3 20B00C              +1128 
00:002DE4 150010              +1128 
00:002DE5 20B00D              +1128 
00:002DE6 150010              +1128 
00:002DE7 20B00E              +1128 
00:002DE8 150010              +1128 
00:002DE9 20B00F              +1128 
00:002DEA 8D0010              +1129 	ay, xi	16
  :                            1130 w2nocheck32?
00:002DEB 1E0DCA              +1131 	jdr	w2nocheck32!
  :                            1132 
00:002DEC 380004              +1133 	pop	a
00:002DED 160014              +1134 	dsr	20
00:002DEE 400004              +1135 	lr	a
00:002DEF F80005              +1136 	push	b
00:002DF0 B60DF4              +1137 	j	w2nocheckpair?
  :                            1138 
  :                            1139 w2nocheckpair!
00:002DF1 150010              +1140 	rsr	16
00:002DF2 20B000              +1141 	sa	0, y
00:002DF3 8D0001              +1142 	ay, xi	1
  :                            1143 w2nocheckpair?
00:002DF4 1E0DF1              +1144 	jdr	 w2nocheckpair!
  :                            1145 
00:002DF5 380004              +1146 	pop	a	
00:002DF6 A60DFA              +1147 	jpa	w2nocheckbyte
  :                            1148 
00:002DF7 150008              +1149 	rsr	8
00:002DF8 260008              +1150 	sal	8
00:002DF9 20B000              +1151 	sa	0, y
  :                            1152 w2nocheckbyte
  :                            1153 
00:002DFA 350000              +1154 	lret	0
  :                            1155 
  :                            92: 	$include	route_if
  :                            1 route_outward_interface				. remote address must be in 6:7
00:002DFB 750059              +2 	ii	KERNEL$B1_1			. change to IP B1 frame
  :                            3 
00:002DFC FF0FE1              +4 	call	(__route)
00:002DFD 700002              +5 	tz	x
00:002DFE B60E00              +6 	j	extract_if
  :                            7 
  :                            8 no_path2remote
00:002DFF 350000              +9 	lret	0
  :                            10 
  :                            11 extract_if
00:002E00 60A002              +12 	la	ro:i_f
00:002E01 A50FFF              +13 	and	4095,,xi			. relative 1 interface subscript
00:002E02 C60DFF              +14 	jza	no_path2remote			. there is no index-zero interface
00:002E03 500004              +15 	lx	a
(+01)0f
00:002E04 400000              +16 	lr	$if0p				. highest interface number
00:002E05 170000              +17 	inc	r				. highest interface is allowed
00:002E06 F60DFF              +18 	jxge	no_path2remote			
  :                            19 
(+01)10
00:002E07 850000              +20 	ax	$if0p,,xi			. address 1st interface pointer - 1
00:002E08 50A000              +21 	lx	0, x				. address interface descriptor
00:002E09 350001              +22 	lret	1				. obtained interface descriptor
  :                            23 
  :                            93: 	$include	dq
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 
  :                            41 $(66::,x)
42:000000                     +42 pool	mpool
42:000001                     +42 
42:000002                     +42 
42:000003                     +42 
42:000004                     +42 
42:000005                     +42 
42:000006                     +42 
42:000007                     +42 
42:000008                     +42 
42:000009                     +42 
42:00000A                     +42 
42:00000B                     +42 
42:00000C                     +42 
42:00000D                     +42 
42:00000E                     +42 
42:00000F                     +42 
42:000010                     +42 
42:000011                     +42 
42:000012                     +42 
42:000013                     +42 
42:000014                     +42 
42:000015                     +42 
42:000016                     +42 
42:000017                     +42 
42:000018                     +42 
42:000019                     +42 
42:00001A                     +42 
42:00001B                     +42 
42:00001C                     +42 
42:00001D                     +42 
42:00001E                     +42 
42:00001F                     +42 
42:000020                     +42 
42:000021                     +42 
42:000022                     +42 
42:000023                     +42 
42:000024                     +42 
42:000025                     +42 
42:000026                     +42 
42:000027                     +42 
42:000028                     +42 
42:000029                     +42 
42:00002A                     +42 
42:00002B                     +42 
42:00002C                     +42 
42:00002D                     +42 
42:00002E                     +42 
42:00002F                     +42 
42:000030                     +42 
42:000031                     +42 
42:000032                     +42 
42:000033                     +42 
42:000034                     +42 
42:000035                     +42 
42:000036                     +42 
42:000037                     +42 
42:000038                     +42 
42:000039                     +42 
42:00003A                     +42 
42:00003B                     +42 
42:00003C                     +42 
42:00003D                     +42 
42:00003E                     +42 
42:00003F                     +42 
42:000040                     +42 
42:000041                     +42 
42:000042                     +42 
42:000043                     +42 
42:000044                     +42 
42:000045                     +42 
42:000046                     +42 
42:000047                     +42 
42:000048                     +42 
42:000049                     +42 
42:00004A                     +42 
42:00004B                     +42 
42:00004C                     +42 
42:00004D                     +42 
42:00004E                     +42 
42:00004F                     +42 
42:000050                     +42 
42:000051                     +42 
42:000052                     +42 
42:000053                     +42 
42:000054                     +42 
42:000055                     +42 
42:000056                     +42 
42:000057                     +42 
42:000058                     +42 
42:000059                     +42 
42:00005A                     +42 
42:00005B                     +42 
42:00005C                     +42 
42:00005D                     +42 
42:00005E                     +42 
42:00005F                     +42 
42:000060                     +42 
42:000061                     +42 
42:000062                     +42 
42:000063                     +42 
42:000064                     +42 
42:000065                     +42 
42:000066                     +42 
42:000067                     +42 
42:000068                     +42 
42:000069                     +42 
42:00006A                     +42 
42:00006B                     +42 
42:00006C                     +42 
42:00006D                     +42 
42:00006E                     +42 
42:00006F                     +42 
42:000070                     +42 
42:000071                     +42 
42:000072                     +42 
42:000073                     +42 
42:000074                     +42 
42:000075                     +42 
42:000076                     +42 
42:000077                     +42 
42:000078                     +42 
42:000079                     +42 
42:00007A                     +42 
42:00007B                     +42 
42:00007C                     +42 
42:00007D                     +42 
42:00007E                     +42 
42:00007F                     +42 
42:000080                     +42 
42:000081                     +42 
42:000082                     +42 
42:000083                     +42 
42:000084                     +42 
42:000085                     +42 
42:000086                     +42 
42:000087                     +42 
42:000088                     +42 
42:000089                     +42 
42:00008A                     +42 
42:00008B                     +42 
42:00008C                     +42 
42:00008D                     +42 
42:00008E                     +42 
42:00008F                     +42 
42:000090                     +42 
42:000091                     +42 
42:000092                     +42 
42:000093                     +42 
42:000094                     +42 
42:000095                     +42 
42:000096                     +42 
42:000097                     +42 
42:000098                     +42 
42:000099                     +42 
42:00009A                     +42 
42:00009B                     +42 
42:00009C                     +42 
42:00009D                     +42 
42:00009E                     +42 
42:00009F                     +42 
42:0000A0                     +42 
42:0000A1                     +42 
42:0000A2                     +42 
42:0000A3                     +42 
42:0000A4                     +42 
42:0000A5                     +42 
42:0000A6                     +42 
42:0000A7                     +42 
42:0000A8                     +42 
42:0000A9                     +42 
42:0000AA                     +42 
42:0000AB                     +42 
42:0000AC                     +42 
42:0000AD                     +42 
42:0000AE                     +42 
42:0000AF                     +42 
42:0000B0                     +42 
42:0000B1                     +42 
42:0000B2                     +42 
42:0000B3                     +42 
42:0000B4                     +42 
42:0000B5                     +42 
42:0000B6                     +42 
42:0000B7                     +42 
42:0000B8                     +42 
42:0000B9                     +42 
42:0000BA                     +42 
42:0000BB                     +42 
42:0000BC                     +42 
42:0000BD                     +42 
42:0000BE                     +42 
42:0000BF                     +42 
42:0000C0                     +42 
42:0000C1                     +42 
42:0000C2                     +42 
42:0000C3                     +42 
42:0000C4                     +42 
42:0000C5                     +42 
42:0000C6                     +42 
42:0000C7                     +42 
42:0000C8                     +42 
42:0000C9                     +42 
42:0000CA                     +42 
42:0000CB                     +42 
42:0000CC                     +42 
42:0000CD                     +42 
42:0000CE                     +42 
42:0000CF                     +42 
42:0000D0                     +42 
42:0000D1                     +42 
42:0000D2                     +42 
42:0000D3                     +42 
42:0000D4                     +42 
42:0000D5                     +42 
42:0000D6                     +42 
42:0000D7                     +42 
42:0000D8                     +42 
42:0000D9                     +42 
42:0000DA                     +42 
42:0000DB                     +42 
42:0000DC                     +42 
42:0000DD                     +42 
42:0000DE                     +42 
42:0000DF                     +42 
42:0000E0                     +42 
42:0000E1                     +42 
42:0000E2                     +42 
42:0000E3                     +42 
42:0000E4                     +42 
42:0000E5                     +42 
42:0000E6                     +42 
42:0000E7                     +42 
42:0000E8                     +42 
42:0000E9                     +42 
42:0000EA                     +42 
42:0000EB                     +42 
42:0000EC                     +42 
42:0000ED                     +42 
42:0000EE                     +42 
42:0000EF                     +42 
42:0000F0                     +42 
42:0000F1                     +42 
42:0000F2                     +42 
42:0000F3                     +42 
42:0000F4                     +42 
42:0000F5                     +42 
42:0000F6                     +42 
42:0000F7                     +42 
42:0000F8                     +42 
42:0000F9                     +42 
42:0000FA                     +42 
42:0000FB                     +42 
42:0000FC                     +42 
42:0000FD                     +42 
42:0000FE                     +42 
42:0000FF                     +42 
42:000100                     +42 
42:000101                     +42 
42:000102                     +42 
42:000103                     +42 
  :                            43 
  :                            44 $(67::,y)
43:000000                     +45 queue	dq
43:000001                     +45 
  :                            46 
  :                            47 $(0)
  :                            48 init_pool	$tree
                                	$head_near	scalars(caller_y,		int,	y	;
                                				save_simd,		float,	RDATAC	;
                                				initial_pointers,	float		;
                                				simd_control,		float,		;
00:002E0A F80003              +53 				(-1, 0, NET_FREECHAINS//4-1, 4q)	)
00:002E0B 8F0014              +53 
00:002E0C 8F0FCE              +53 
00:002E0D 8F0FE2              +53 
  :                            54 
00:002E0E 870014              +55 	qpop	RDATAC		. 4 chain pointers 0,0,0,0q at stack top
  :                            56 
00:002E0F 580004              +57 	ly		a			. words in pool	
00:002E10 880002              +58 	ay		x			. top of pool
00:002E11 8DFFF0              +59 	ay, xi		-ACW_SIZE*2		. minus 2 descriptors
00:002E12 18A001              +60 	sy		pool:next		. first assignable descriptor
00:002E13 10B009              +61 	sx		descriptor:frame+ACW_SIZE, y
  :                            62 						. buffer in fixed top descriptor
00:002E14 6DFFFF              +63 	lb		-1,,xi
00:002E15 28B00A              +64 	sb		descriptor:i_f+ACW_SIZE, y
00:002E16 30B00B              +65 	z		descriptor:bytes+ACW_SIZE, y
00:002E17 6CA120              +66 	lb, i		+(2+NET_FREECHAINS)//NET_GRANULE*NET_GRANULE, x
00:002E18 28B001              +67 	sb		descriptor:frame, y
  :                            68 						. first assignable address in
  :                            69 						. first assignable descriptor
  :                            70 
00:002E19 5CA002              +71 	ly		pool:free(1),,i
00:002E1A 740FE6              +72 	rex		(qs	0, y)
  :                            73 	$endif
  :                            74 
00:002E1B 30A000              +75 	z		pool:lock_cell
  :                            76 
00:002E1C 87F000              +77 	qpop		0, sp
00:002E1D 870014              +78 	qpop		RDATAC
00:002E1E 380003              +79 	pop		y
  :                            80 
00:002E1F 350000              +81 	lret		0
  :                            82 	$root
  :                            83 
00:002E20 C5FFFF              +84 buy1	aa, xi	-1
00:002E21 7E0E24              +85 	jc	buy1_soon
  :                            86 
  :                            87 buy1_never		. requested size is out of range
00:002E22 650000              +88 	la, xi	0	. result = no descriptor
00:002E23 350000              +89 	lret	0
  :                            90 buy1_soon
00:002E24 060005              +91 	sar	NET_LOG
00:002E25 680004              +92 	anu,xi	NET_FREECHAINS
00:002E26 DD0102              +92 
00:002E27 7E0E22              +93 	jc	buy1_never
  :                            94 
00:002E28 FD0007              +95 	LOCK	pool:lock_cell
00:002E29 27F000              +95 
00:002E2A 07A000              +95 
00:002E2B B60E2A              +95 
  :                            96 
00:002E2C 6CC001              +97 	lb, i	1, a		. b = # granules
00:002E2D C4A002              +98 	aa, i	pool:free(1)
00:002E2E 580004              +99 	ly	a
00:002E2F 60B000              +100 	la	0, y		. free chain head
00:002E30 C60E36              +101 	jza	buy1_new
00:002E31 68C000              +102 	lb	0, a		. second in chain
00:002E32 28B000              +103 	sb	0, y		. -> chain head
00:002E33 30C003              +104 	z	descriptor:bytes, a
00:002E34 30C000              +105 	z	descriptor:next, a
  :                            106 
00:002E35 B60E45              +107 	j	buy1_complete
  :                            108 
  :                            109 buy1_new
00:002E36 60A001              +110 	la	pool:next
00:002E37 2E0005              +111 	sbl	NET_LOG
00:002E38 C8C001              +112 	ab	descriptor:frame, a
  :                            113 				. new next buffer
00:002E39 C5FFF8              +114 	aa, xi	-ACW_SIZE	. new next descriptor
  :                            115 
00:002E3A 580005              +116 	ly	b
00:002E3B 680004              +117 	anu	y		. descriptor < buffer
00:002E3C D80003              +117 
00:002E3D 7E0E40              +118 	jc	buy1_new_now	. if so unavailable
  :                            119 
00:002E3E 650000              +120 	la, xi	0		. result = no descriptor
00:002E3F B60E45              +121 	j	buy1_complete
  :                            122 
  :                            123 buy1_new_now
00:002E40 20A001              +124 	sa	pool:next
00:002E41 18C001              +125 	sy	descriptor:frame, a
00:002E42 64C008              +126 	la	ACW_SIZE, a, i
00:002E43 30C003              +127 	z	descriptor:bytes, a
00:002E44 30C000              +128 	z	descriptor:next, a
  :                            129 
  :                            130 buy1_complete
00:002E45 30A000              +131 	FREE	pool:lock_cell
00:002E46 27F000              +131 
00:002E47 17000F              +131 
00:002E48 350000              +132 	lret	0
  :                            133 
  :                            134 
00:002E49 C60E8E              +135 sell1	jza	sell1_u			. popped from an empty queue?
00:002E4A 700002              +136 	tnz	x
00:002E4B B60E4D              +136 
00:002E4C B60E8E              +137 	j	sell1_u			. buffer pool pointer an untested variable?
  :                            138 
00:002E4D FD0007              +139 	LOCK	pool:lock_cell
00:002E4E 27F000              +139 
00:002E4F 07A000              +139 
00:002E50 B60E4F              +139 
  :                            140 
00:002E51 68C003              +141 	lb	descriptor:bytes, a
00:002E52 A80FE7              +142 	andB	(0400000)
00:002E53 DE0E8B              +143 	jnzb	sell1_z			. already freed or some mistake
  :                            144 	
00:002E54 400004              +145 	lr	a
00:002E55 F60E8F              +146 	jxge	wrong_pool
  :                            147 
00:002E56 58A001              +148 	ly	pool:next		. is the candidate the
00:002E57 680004              +149 	anu, i	ACW_SIZE, y		. descriptor above next-> ?
00:002E58 DCB008              +149 
  :                            150 
00:002E59 CE0E5C              +151 	jzb	sell1_more		. stack top
00:002E5A 7E0E79              +152 	jc	sell1_list		. within stack
00:002E5B B60E8B              +153 	j	sell1_z			. not assigned
  :                            154 
  :                            155 sell1_more
00:002E5C 20A001              +156 	sa	pool:next
00:002E5D 30C003              +157 	z	descriptor:bytes, a	. remove markings
  :                            158 
  :                            159 	$if	__PANGA
00:002E5E FDFFC4              +160 	push	-__PANGA,,xi		. -(__PANGA),,xi	0-__PANGA,,xi
  :                            161 	$endif
  :                            162 
  :                            163 sell1_more?
00:002E5F 68C00B              +164 	lb	descriptor:bytes+ACW_SIZE, a	. new next or non-free or stack root?
00:002E60 A80FE7              +165 	andB	(0400000)		. descriptor in a free chain?
00:002E61 CE0E77              +166 	jzb	sell1_final		. root descriptor never is either
  :                            167 					. it's at free chain far end
00:002E62 580004              +168 	ly	a			. above pointer
00:002E63 64C008              +169 	la	ACW_SIZE, a, i		. new stack top
  :                            170 
00:002E64 68B001              +171 	lb	descriptor:frame, y
00:002E65 D8C001              +172 	anb	descriptor:frame, a
00:002E66 0E0005              +173 	sbr	NET_LOG			. size chain index + 1
00:002E67 5CA001              +174 	ly	pool:free(1)-1,,i	. chains - 1
00:002E68 880005              +175 	ay	b
  :                            176 
  :                            177 . CHECK_PARADOX	$set	1
  :                            178 
00:002E69 400004              +179 	lr	a			. for comparison
00:002E6A 4DFFFF              +180 	lk	-1,,xi
  :                            181 
  :                            182 sell1_chain_walk			. chain starts descriptor @ highest address
00:002E6B 680003              +183 	lb	y			. = buffer @ lowest address = preferred memory grant
00:002E6C 58B000              +184 	ly	0, y			. so this always walks the whole chain on memory free
00:002E6D FE0E6F              +185 	jyge	sell1_chain_equal?
00:002E6E B60E77              +186 	j	sell1_final		. paradox = not in chain
  :                            187 
  :                            188 sell1_chain_equal?
00:002E6F AF0003              +189 	mta	y			. = a ?
00:002E70 B60E6B              +190 	j	sell1_chain_walk	. no, > a
  :                            191 					. yes
00:002E71 F8B000              +192 	push	0, y			. relink chain
00:002E72 38D000              +193 	pop	0, b
  :                            194 	
00:002E73 00A001              +195 	sr	pool:next
  :                            196 
  :                            197 	$if	__PANGA
  :                            198 
00:002E74 17F000              +199 	inc	0, sp			. from minus towards plus 
00:002E75 78F000              +200 	tp	0, sp
00:002E76 B60E5F              +201 	j	sell1_more?
  :                            202 
  :                            203 sell1_final
00:002E77 17000F              +204 	inc	sp
00:002E78 B60E8B              +205 	j	sell1_z
  :                            206 
  :                            207 	$else	
  :                            208 
  :                            209 	j	sell1_more?
  :                            210 	
  :                            211 	$endif
  :                            212 
  :                            213 sell1_list
  :                            214 sell1_log
00:002E79 580004              +215 	ly	a			. find free chain
00:002E7A 8DFFF8              +216 	ay, xi	-ACW_SIZE		. per buffer size
00:002E7B 68B001              +217 	lb	descriptor:frame, y
00:002E7C D8C001              +218 	anb	descriptor:frame, a
  :                            219 
00:002E7D 0E0005              +220 	sbr	NET_LOG
00:002E7E CCA001              +221 	ab, i	pool:free(1)-1
00:002E7F 400005              +222 	lr	b
  :                            223 
  :                            224 
  :                            225 sell1_list?
00:002E80 580000              +226 	ly	r
00:002E81 40B000              +227 	lr	0, y
  :                            228 	
00:002E82 680004              +229 	anu	r
00:002E83 D80000              +229 
  :                            230 
00:002E84 5E0E80              +231 	jnc	sell1_list?		. keep moving towards
  :                            232 					. the stack top
  :                            233 
00:002E85 CE0E8B              +234 	jzb	sell1_z			. equal, it's already free
  :                            235 
00:002E86 00C000              +236 	sr	0, a			. chain it in
00:002E87 20B000              +237 	sa	0, y
00:002E88 68C003              +238 	lb	descriptor:bytes, a
00:002E89 980FE7              +239 	orB	(0400000)
00:002E8A 28C003              +240 	sb	descriptor:bytes, a
  :                            241 
  :                            242 	$if	__PANGA=0
  :                            243 sell1_final
  :                            244 	$endif
  :                            245 
00:002E8B 30A000              +246 sell1_z	FREE	pool:lock_cell
00:002E8C 27F000              +246 
00:002E8D 17000F              +246 
00:002E8E 350000              +247 sell1_u	lret	0
  :                            248 	
  :                            249 wrong_pool
00:002E8F 75005F              +250 	ii	GUARD$
  :                            251 
  :                            252 q2first?
00:002E90 70B000              +253 	tz	queue:head
00:002E91 B60E9C              +254 	j	q2z
00:002E92 20B000              +255 	sa	queue:head
00:002E93 20B001              +256 	sa	queue:tail
00:002E94 30C000              +257 	z	0, a
00:002E95 350001              +258 	lret	1		. indicate this is a write
  :                            259 				. to a previously empty q
  :                            260 				. by skipping an instruction
  :                            261 				. on return
  :                            262 
00:002E96 70B000              +263 q2	tz	queue:head
00:002E97 B60E9C              +264 	j	q2z
00:002E98 20B000              +265 	sa	queue:head
00:002E99 20B001              +266 	sa	queue:tail
00:002E9A 30C000              +267 	z	0, a
00:002E9B 350000              +268 	lret	0
00:002E9C 68B001              +269 q2z	lb	queue:tail
00:002E9D 20D000              +270 	sa	0, b
00:002E9E 20B001              +271 	sa	queue:tail
00:002E9F 30C000              +272 	z	0, a
00:002EA0 350000              +273 	lret	0	
  :                            274 
00:002EA1 60B000              +275 readq	la	queue:head
00:002EA2 C60EA5              +276 	jza	readqz
00:002EA3 68C000              +277 	lb	0, a
00:002EA4 28B000              +278 	sb	queue:head
00:002EA5 350000              +279 readqz	lret	0
  :                            280 
  :                            94 
  :                            95: 	$include	bind
  :                            1 "$bind"	$tree
  :                            2 
  :                            3 .	subroutines of bind() and __bind()
  :                            4 
  :                            5 construct_port_block
00:002EA6 34002F              +6 	sabr	BSOCKET			. initialise a new block of storage
00:002EA7 580F98              +7 	ly	(BSOCKET*/12s)		. for modeling ports
  :                            8 
00:002EA8 F80005              +9 	push	b
00:002EA9 F80000              +10 	push	r
  :                            11 
00:002EAA 4501FF              +12 	lr	4096/8-1,,xi
00:002EAB 4F0FCE              +13 	ql	(0q)
  :                            14 
  :                            15 zero_port_block
00:002EAC 47B000              +16 	qs	0, y
00:002EAD 47B004              +17 	qs	4, y
00:002EAE 8D0008              +18 	ay	8,,xi
00:002EAF 1E0EAC              +19 	jdr	zero_port_block
  :                            20 		
00:002EB0 380000              +21 	pop	r
00:002EB1 380005              +22 	pop	b
00:002EB2 350000              +23 	lret	0			. end initialise
  :                            24 
  :                            25 bind_in_block				. retrieve or assign port structure
00:002EB3 D60EBA              +26 	jnza	ports_block_up		. assigning its initial 
00:002EB4 651000              +27 	la	4096,,xi
00:002EB5 75004A              +28 	ii	ASSIGN_XVECTOR$		. this must not go in caller's 
  :                            29 					. memory estate list
  :                            30 					. it's therefore different from BANK$
  :                            31 
00:002EB6 C60ECE              +32 	jza	bind_show_random_result	. which is zero = not found
00:002EB7 200010              +33 	sa	d$save
00:002EB8 3E0EA6              +34 	lcal	construct_port_block
00:002EB9 B60EBC              +35 	j	ports_block_online
  :                            36 
  :                            37 ports_block_up
00:002EBA 200010              +38 	sa	d$save
00:002EBB 34002F              +39 	sabr	BSOCKET
  :                            40 ports_block_online
00:002EBC 580F98              +41 	ly	(BSOCKET*/12s)
00:002EBD 400F8A              +42 	lr	(BSOCKET+1*/12)
00:002EBE 650000              +43 	la	0,,xi			. default result
  :                            44 
  :                            45 seek_random_free_port
00:002EBF FE0ECE              +46 	jyge	bind_show_random_result
00:002EC0 70B001              +47 	tz	s:socket_address+1,y
00:002EC1 B60ECC              +48 	j	another_random_port
  :                            49 
00:002EC2 85DF80              +50 	ax	-usockb(1),,xi		. points to [ut]sockb(3) or [ut]sockb(4)
00:002EC3 600002              +51 	la	x			. 0000 0000 0010 0000 Pppp pppp
00:002EC4 260011              +52 	sal	17			. pppp ppp0 0000 0000 0000 0000
00:002EC5 060008              +53 	sar	24-7-9			. 0000 0000 pppp ppp0 0000 0000
00:002EC6 680003              +54 	lb	y			. 0000 0010 1111 PPPP PPPP P000
00:002EC7 2E000C              +55 	sbl	12
00:002EC8 0E000F              +56 	sbr	15			. plus offset / 8
00:002EC9 900005              +57 	or	b			. 0000 0000 pppp pppP PPPP PPPP
00:002ECA 20B001              +58 	sa	s:socket_address+1,y
00:002ECB B60ECE              +59 	j	bind_show_random_result
  :                            60 
  :                            61 another_random_port
00:002ECC 8D0008              +62 	ay	8,,xi
00:002ECD B60EBF              +63 	j	seek_random_free_port
  :                            64 
  :                            65 bind_show_random_result
00:002ECE 350000              +66 	lret	0
  :                            67 
  :                            68 find_in_blocks_range
00:002ECF 44A002              +69 	lr	2, x, i			. set the limit at block(5)
00:002ED0 750053              +70 	ii	READ_XVECTOR$
00:002ED1 3E0EB3              +71 	lcal	bind_in_block
00:002ED2 D60ED6              +72 	jnza	find_in_blocks_exit	. a successful end
00:002ED3 850001              +73 	ax	1,,xi
00:002ED4 FE0ED6              +74 	jyge	find_in_blocks_exit	. an unsuccessful end
00:002ED5 B60ECF              +75 	j	find_in_blocks_range
  :                            76 find_in_blocks_exit
00:002ED6 350000              +77 	lret	0
  :                            78 
  :                            79 .	end subroutines of bind() and __bind()
  :                            80 
  :                            81 
  :                            82 .	vector name (bind)
  :                            83 
  :                            84 .	this is bind called from application space
  :                            85 .	inputs are an unbound handle number and an address:port
  :                            86 .	port may be wildcard zero. A targeted port must be previously unbound
  :                            87  
  :                            88 network_bind
                                	$head_far		 params(handle,			int	;
  :                            90 					sockaddress,		long	)	
  :                            91 
  :                            92 
00:002ED7 60F003              +93 	la	handle
00:002ED8 750052              +94 	ii	READ_HANDLE$
  :                            95 
00:002ED9 9FF004              +96 	c	(__bind)	a	sockaddress,,long
00:002EDA F80004              +96 
00:002EDB FCF003              +96 
00:002EDC FF0FC5              +96 
00:002EDD 38000F              +96 
  :                            97 
00:002EDE E60EE4              +98 	jna	network_bindz
  :                            99 
00:002EDF AD0FF8              +100 	andB	0FF8,,xi
00:002EE0 0E0003              +101 	sbr	3
00:002EE1 60F003              +102 	la	handle
00:002EE2 750078              +103 	ii	USOCKET$		. update the handle encoding in vectors list 
00:002EE3 650000              +104 	la	0,,xi			. status
  :                            105 
  :                            106 network_bindz
00:002EE4 75006F              +107 	ii	FREE_SOCKB$		. mask the block of kernel memory from application window
00:002EE5 3D0000              +108 	fret	0
  :                            109 
  :                            110 
  :                            111 .	vector name (__bind)
  :                            112 .	this is bind called without using a handle
  :                            113 .	for example from outgoing TCP connect
  :                            114 
  :                            115 .	a value like a handle encoding should be in 1st argument
  :                            116 .	either IPPROTO_UDP.0.0 or IPPROTO_TCP.0.0
  :                            117 
  :                            118 autobind
                                	$head_far		 params(encoding,		int	;
                                					sockad,			long)	;
                                									;
00:002EE6 FD0000              +122 				scalars(connections_tablep,	int)
  :                            123 
00:002EE7 4DFFFF              +124 	lk	-1,,xi
00:002EE8 60F004              +125 	la	encoding
00:002EE9 AF0F7F              +126 	mta	(IPPROTO_UDP*/16)
00:002EEA B60EED              +127 	j	net_bind_tcp?
00:002EEB 552080              +128 	lx	usockb(1),,xi
00:002EEC B60EF4              +129 	j	assign_port
  :                            130 
  :                            131 net_bind_tcp?
00:002EED AF0F80              +132 	mta	(IPPROTO_TCP*/16)
00:002EEE B60F21              +133 	j	net_bind_no_protocol
00:002EEF 552185              +134 	lx	tcx_v4(1),,xi
00:002EF0 750053              +135 	ii	READ_XVECTOR$
00:002EF1 C60F25              +136 	jza	net_bind_no_storage
00:002EF2 20F000              +137 	sa	connections_tablep	. a TCP port must have this
00:002EF3 552100              +138 	lx	tsockb(1),,xi
  :                            139 
  :                            140 assign_port
00:002EF4 60F006              +141 	la	sockad+1		. read the port number
00:002EF5 A00F8E              +142 	and	(00FFFF)
00:002EF6 C60F07              +143 	jza	assign_wildcard_socket
  :                            144 
  :                            145 	.	x -> usockb{1} or -> tsockb(1)
  :                            146 
  :                            147 	$if	1
00:002EF7 3E0A14              +148 	lcal	protocol_socket
  :                            149 	$else
  :                            150 
  :                            151 	lb	BSOCKET*/9,,xi
  :                            152 	dsr	9
  :                            153 	rbr	12
  :                            154 	ax	a
  :                            155 	ii	READ_XVECTOR$
  :                            156 
  :                            157 	$endif
  :                            158 
00:002EF8 D60EFF              +159 	jnza	net_bind_memory_up
00:002EF9 651000              +160 	la	4096,,xi
00:002EFA 75004A              +161 	ii	ASSIGN_XVECTOR$
00:002EFB C60F25              +162 	jza	net_bind_no_storage
00:002EFC 200010              +163 	sa	d$save
00:002EFD 3E0EA6              +164 	lcal	construct_port_block
00:002EFE B60F01              +165 	j	net_bind_memory_online
  :                            166 
  :                            167 net_bind_memory_up
00:002EFF 34002F              +168 	sabr	BSOCKET
00:002F00 200010              +169 	sa	d$save
  :                            170 net_bind_memory_online
00:002F01 580005              +171 	ly	b
00:002F02 60B001              +172 	la	s:socket_address+1, y
00:002F03 A00F8E              +173 	and	(00FFFF)
00:002F04 D60F23              +174 	jnza	already_bound
00:002F05 CFF005              +175 	dl	sockad
00:002F06 B60F0E              +176 	j	assign_socket
  :                            177 
  :                            178 assign_wildcard_socket
00:002F07 850002              +179 	ax	2,,xi			. move from block(1) to block(3)
  :                            180 	
00:002F08 3E0ECF              +181 	lcal	find_in_blocks_range
00:002F09 C60F25              +182 	jza	net_bind_no_storage
  :                            183 
00:002F0A 400004              +184 	lr	a
00:002F0B 480F8E              +185 	lk	(00FFFF)		. wildcard bind
00:002F0C CFF005              +186 	dl	sockad			. catenate network address
00:002F0D BF0000              +187 	mlb	r			. + acquired port #
  :                            188 
  :                            189 assign_socket
00:002F0E C7B000              +190 	ds	s:socket_address, y	. address setting in port
  :                            191 
00:002F0F 600010              +192 	la	d$save			
00:002F10 680003              +193 	lb	y
00:002F11 C7000A              +194 	ds	10			. results 7:8 long address of port descriptor
  :                            195 
00:002F12 68F000              +196 	lb	connections_tablep	. connections block if any
00:002F13 480FBF              +197 	lk	(255*/16s)
00:002F14 60F004              +198 	la	encoding
00:002F15 AF0F80              +199 	mta	(IPPROTO_TCP*/16s)
00:002F16 B60F1B              +200 	j	net_nontcp
00:002F17 28B005              +201 	sb	s:tcp:tbase, y		. default connections table
00:002F18 CF2180              +202 	dl	rx_buffers
00:002F19 C7B006              +203 	ds	s:tcp:rxbu_p, y		. default rx buffer pool
00:002F1A B60F1D              +204 	j	net_result_confirm	
  :                            205 
  :                            206 net_nontcp
00:002F1B AF0F7F              +207 	mta	(IPPROTO_UDP*/16)
00:002F1C B60F21              +208 	j	net_bind_no_protocol
  :                            209 
  :                            210 net_result_confirm
00:002F1D 6D0FFF              +211 	lb	4095,,xi
00:002F1E A8000B              +212 	andB	11			. offset part
00:002F1F 650000              +213 	la	0,,xi			. 72-bit result
00:002F20 B60F26              +214 	j	net_bind_z
  :                            215 
  :                            216 net_bind_no_protocol
00:002F21 65FFD6              +217 	la	-NO_PROTOCOL,,xi
00:002F22 B60F26              +218 	j	net_bind_z
  :                            219 
  :                            220 already_bound
00:002F23 65FFC6              +221 	la	-PORT_ALREADY_BOUND,,xi
00:002F24 B60F26              +222 	j	net_bind_z
  :                            223 
  :                            224 net_bind_no_storage
00:002F25 65FFF4              +225 	la	-NO_STORAGE,,xi
  :                            226 
  :                            227 net_bind_z
00:002F26 17000F              +228 	inc	sp
00:002F27 3D0000              +229 	fret	0
  :                            230 
  :                            231 	$root
  :                            96: 	$include	tcp_lib
  :                            1 				. x -> transmission control block
00:002F28 3E07BF              +2 far_ack	lcal	tcp_send_ack	. call vector ack_request
00:002F29 3D0000              +3 	fret	0		. ack was not sent
00:002F2A 3D0001              +4 	fret	1		. ack was sent
  :                            5 
  :                            6 
  :                            97 
  :                            98 .	$include	xdr
  :                            99 .	$include	write_ur
  :                            100 
  :                            101: 	$include	icapsule	. icapsule
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 ACTIVITY_SPACE		$equ	1		. milliseconds to keep looking for more work
  :                            41 REST_GRANULE		$equ	1000000/2000	. microseconds to rest while no work
  :                            42 						. repeated until some work
  :                            43 $(3)
  :                            44 
03:000000 000000000001        +45 akt	+	ACTIVITY_SPACE:d		. for plugitinisation
03:000002 0000080001F4        +46 takt	+	CHILLDOWN, REST_GRANULE:d	. from the console
  :                            47 
03:000004 000000000000        +48 activity_revision +	0L
  :                            49 
  :                            50 	$if		DRIVERS_BANK1
  :                            51 $(67::, y)
  :                            52 networkframe	delivery
  :                            53 	$endif
  :                            54 
  :                            55 $(0)
  :                            56 
(+01)0f
00:002F2B 400009              +57 iattend	lr	i_f_last		. find trunk-master interfaces
(+01)10
00:002F2C 55000A              +58 	lx	interface(1),,xi	. from (2) to i_f_last
  :                            59 
  :                            60 iattendu
00:002F2D 850046              +61 	ax	interface(2)-interface(1),,xi
00:002F2E 60A001              +62 	la	this_if:flags
00:002F2F C60F38              +63 	jza	iattended		. next i / f otherwise
00:002F30 70A02F              +64 	tz	this_if:oq.head		. simple general TX queue?
00:002F31 350000              +65 	lret	0			. yes, keep running
00:002F32 CFA042              +66 	dl	this_if:ift1:base_rx
00:002F33 750060              +67 	ii	XBASE$32
00:002F34 70D000              +68 	tz	networkframe:flag, b	. RX frames in trunk?
00:002F35 350000              +69 	lret	0			. keep running
  :                            70 
00:002F36 70A031              +71 	tz	this_if:oq2:head:bx	. high volume tx frames ?
00:002F37 350000              +72 	lret	0			. yes, keep running
  :                            73 iattended
00:002F38 F60F3A              +74 	jxge	icool			. trunk-master I/Fs all walked?
00:002F39 B60F2D              +75 	j	iattendu		. no
00:002F3A 350001              +76 icool	lret	1			. yes
  :                            77 
  :                            78 icapsule
00:002F3B 750041              +79 	ii	YIELD$			. let other threads ahead
00:002F3C 3E0F2B              +80 	lcal	iattend			. traffic rx / waiting tx?
00:002F3D B60F49              +81 	j	icarryon		. yes
  :                            82 
(+03)0f
00:002F3E CF0004              +83 	dl	activity_revision	
00:002F3F DF0096              +84 	dan	DAYCLOCK$U		. 
00:002F40 A60F4C              +85 	jpa	icarryalong		. keep going
  :                            86 					. but don't move the time out
  :                            87 
  :                            88 	. continuous execute frame end and no net activity
  :                            89 	. do a granule of cool
  :                            90 
00:002F41 65FFFF              +91 	la	-1,,xi
00:002F42 75007D              +92 	ii	ENERGY$			. advise other cores to cool of they want
  :                            93 					. and if they pass thru thread switch
(+03)0f
00:002F43 CF0002              +94 	dl	takt
00:002F44 1C0067              +95 	outB	chill$down
00:002F45 140066              +96 	outA	INDICATION$		. a granule of chill
  :                            97 
00:002F46 650000              +98 	la	0,,xi
00:002F47 75007D              +99 	ii	ENERGY$			. advise other cores to go for it
00:002F48 350000              +100 	lret	0			. don't restart execution timeframe
  :                            101 
  :                            102 icarryon				. restart continuous time frame
00:002F49 CF0096              +103 	dl	DAYCLOCK$U
(+03)0f
00:002F4A D70000              +104 	da	akt			. (ACTIVITY_SPACE:d)
  :                            105 					. change from literal to variable
(+03)0f
00:002F4B C70004              +106 	ds	activity_revision
  :                            107 
  :                            108 icarryalong
00:002F4C 350000              +109 	lret	0
  :                            102: 	$include	preport
  :                            1 .		places to roam withing page 002000
  :                            2 
  :                            3 .		lcal	tcp_socket		. in a
  :                            4 .		jza	tcp_reset_deflect	. frame not buffered
  :                            5 .			-> ipv4_rxz		. don't get here if it is
  :                            6 
  :                            7 .		lcal	udp_socket		. in a
  :                            8 .		jza	icmp_du_port		. frame not buffered
  :                            9 .			-> ipv4_rxz		. don't get here if it is		
  :                            10 .	a <- protocol
  :                            11 .	x -> TX_TPDATA
  :                            12 
  :                            13 .	1, sp = datagram
  :                            14 
  :                            15 .	catch RX fragments and detect quickly if any socket user wants them
  :                            16 .	of even if the I / F allows them
  :                            17 
  :                            18 preport	$tree
  :                            19 
  :                            20 $(71::,sp)
  :                            21 lookaside	$res	2
  :                            22 return		$res	1
47:000003                     +23 dgram	datagram
47:000004                     +23 
47:000005                     +23 
47:000006                     +23 
47:000007                     +23 
47:000008                     +23 
47:000009                     +23 
47:00000B                     +23 
  :                            24 
  :                            25 $(0)
00:002F4D 9F0004              +26 	$head_near	scalars(caller_ab,	long,	a)
  :                            27 
00:002F4E 300012              +28 	z	SOCKET_LPOINTER		. socket not yet known
00:002F4F 68F006              +29 	lb	dgram:flags_fragment
00:002F50 AD1FFF              +30 	andB	01FFF,,xi
00:002F51 CE0F54              +31 	jzb	unigram_or_1st_part
00:002F52 FF0FE8              +32 	call	(rasmgram)		. fragment not the 1st
00:002F53 B601E1              +33 	j	ipv4_rxz
  :                            34 	
  :                            35 unigram_or_1st_part
00:002F54 60A001              +36 	la	1, x			. dest port udp and tcp
00:002F55 68F000              +37 	lb	caller_ab		. protocol
  :                            38 
00:002F56 CDFFEF              +39 	ab	-IPPROTO_UDP,,xi
00:002F57 CE0F5C              +40 	jzb	get_udp_socket
  :                            41 
00:002F58 CD000B              +42 	ab	IPPROTO_UDP-IPPROTO_TCP,,xi
00:002F59 DE0F63              +43 	jnzb	no_pointer_needed	. not a protocol using ports
00:002F5A 3E08AD              +44 	lcal	tcp_socket
00:002F5B B60F5D              +45 	j	store_port_pointer
  :                            46 
  :                            47 get_udp_socket
00:002F5C 3E04E6              +48 	lcal	udp_socket
  :                            49 					. look at fragment zero
  :                            50 store_port_pointer			. it's the only one with port numbers
00:002F5D C70012              +51 	ds	SOCKET_LPOINTER		. this tells caller (and rasmgram)
  :                            52 					. if any process could want the TPDU
  :                            53 
00:002F5E 68F006              +54 	lb	dgram:flags_fragment	. no fragment or fragment zero?
00:002F5F AD2000              +55 	andB	IP_MORE,,xi		. classically checksum is before all this,
00:002F60 CE0F63              +56 	jzb	no_fragment_encountered	. but if the port is wrong it won't get put right
00:002F61 FF0FE8              +57 	call	(rasmgram)		. we may be doing TCP_RST / ICMP_DU
00:002F62 B601E1              +58 	j	ipv4_rxz		. when silent drop would be correct
  :                            59 					. but we dont't want to buffer then drop frames
  :                            60 					. when we already know the PDU is dud
  :                            61 no_fragment_encountered			. we use what we know to avoid hosting and
  :                            62 no_pointer_needed			. checksumming fragments which shall not be used
00:002F63 380004              +63 	dpop	a
00:002F64 380005              +63 
00:002F65 350000              +64 	lret	0
  :                            65 	$root
  :                            66 
  :                            103 
  :                            104 	$if		RX_FRAGMENTS
  :                            105 	$include	rasm77
  :                            106 	$endif
  :                            107 
  :                            108 .	$include	ifconfig	. moved to drivers bank
  :                            109 .					. and slightly changed
  :                            110 .	$include	../async/async1
  :                            111 
  :                            112: 	$include	multiarp
  :                            1 $(0)
  :                            2 
  :                            3 xarp		. maintain timers
  :                            4 		.  any that time out knock them down
  :                            5 		.  and sell any outgoing dgrams queued on them
  :                            6 
(+01)0f
00:002F66 400000              +7 	lr	i_f_pointer_array
(+01)10
00:002F67 5D0001              +8 	ly	ifxpointer(1),,xi
00:002F68 B60F6D              +9 	j	interface?
  :                            10 interface!
00:002F69 50B000              +11 	lx	0, y
00:002F6A 8D0001              +12 	ay	1,,xi
00:002F6B 70A03D              +13 	tz	this_if:xarp
00:002F6C FFA03D              +14 	call	this_if:xarp
  :                            15 interface?
00:002F6D 1E0F69              +16 	jdr	interface!
00:002F6E 350000              +17 	lret	0
  :                            18 
  :                            19 arp_rx		. it's ARP, we glean it
  :                            20 		. restart timers
  :                            21 		. send queued outgoing requests
  :                            22 
00:002F6F 70A03A              +23 	tz	this_if:arp_rx
00:002F70 FFA03A              +24 	call	this_if:arp_rx
00:002F71 350000              +25 	lret	0
  :                            113 
  :                            114 $(0)
  :                            115 .	$include		wprotect
  :                            116 ipv4_high
  :                            117         $do     $<256,$(0:256)
                                        $do     $(0)>4000,      ;
  :                            119         $note   check the literal table is still within 4095
  :                            120 
[ipv4_high][000000000000000000000000000000000000000000000f72]
  :                            121 	$trace	ipv4_high
[$zenith][000000000000000000000000000000000000000000000fe9]
  :                            122 	$trace	$zenith
  :                            123 
  :                            124 	$do	$zenith>4096,	$flag	restructure IPV4_BANK
  :                            125 
  :                            126 	$path		../netapps2
  :                            127: 	$include	ap_bank
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40: 	$include	../lib/register.def
  :                            1 .
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 LAST_BYTE_READ	$equ	d$save3
  :                            41 BYTES		$equ	d$save
  :                            42 QUAD		$equ	8
  :                            43 TRIPLE		$equ	9
  :                            44 SIGNS		$equ	d$save1
  :                            45 SCALE_TRIPPED	$equ	d$save2	. these are the same register
  :                            46 SCALE		$equ	d$save2	. so negative scale is 1s complement
  :                            47 
  :                            48 
  :                            49 "$FINESSE"      $equ    1	. this isn't a register. It causes
  :                            50 				. the scale of floating numbers in integer range
  :                            51 				. to be adjusted in fixed point
  :                            52 				. instead of being finally adjusted in
  :                            53 				. floating point with possible roundings
  :                            54 				. when scannning character to float
  :                            55 
  :                            56 
  :                            41: 	$include	../lib/alib.def
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 .	BYTES		$equ	d$save
  :                            41 
  :                            42 
  :                            43 floating_scan		$equ	fscana
  :                            44 floating_edit		$equ	fedita
  :                            45 floating_iedit		$equ	feditia
  :                            46 floating_edit192	$equ	fedit192a
  :                            47 symbol_scan		$equ	fsymbola
  :                            48 floating_scan192	$equ	fscan192a
  :                            49 integer_edit		$equ	ieditua
  :                            50 edit			$equ	iedita
  :                            51 edits			$equ	ieditas
  :                            52 edit48			$equ	iedit48a
  :                            53 edit48u			$equ	iedit48ua
  :                            54 edit48s			$equ	iedit48as
  :                            55 edit72			$equ	iedit72a
  :                            56 edit72u			$equ	iedit72ua
  :                            57 edit72s			$equ	iedit72as
  :                            58 
  :                            59 iscan_skip		$equ	iscan_skipa
  :                            60 
  :                            61 iscan			$equ	iscana
  :                            62 iscan48			$equ	iscan48a
  :                            63 iscan72			$equ	iscan72a
  :                            64 
  :                            65 otext			$equ	textoa
  :                            66 
  :                            67 rstream_scan_net	$equ	rstream_scana
  :                            68 token_net		$equ	tokena
  :                            69 . fediti			$equ	feditia
  :                            42: 	$include	../lib/i72.def
  :                            1 p	$proc
  :                            2 i72a*	$name
  :                            3 	dl	p(1)+1		. addend
  :                            4 	da	p(2)+1		. addend
  :                            5 	ds	p(3)+1		. target
  :                            6 
  :                            7 	sc	b		. carry
  :                            8 	ab	p(1)		. addend high order word
  :                            9 	ab	p(2)		. addend high order word 
  :                            10 	sb	p(3)		. target
  :                            11 	$end
  :                            12 
  :                            13 p	$proc
  :                            14 i72an*	$name
  :                            15 
  :                            16 	dl	p(1)+1		. minuend
  :                            17 	dan	p(2)+1		. subtrahend
  :                            18 	ds	p(3)+1		. target
  :                            19 
  :                            20 	sc	b		. carry
  :                            21 	ab	-1,,xi		. or borrow
  :                            22 	ab	p(1)		. minuend high order word
  :                            23 	anb	p(2)		. subtrahend high order word
  :                            24 	sb	p(3)		. target
  :                            25 	$end
  :                            26 
  :                            27 p	$proc
  :                            28 i72compare* $name
  :                            29 	dl	p(1)+1		. test subtract two low order words
  :                            30 	dan	p(2)+1		. of each comparand
  :                            31 	sc	a
  :                            32 	aa	-1,,xi		. calculate borrow
  :                            33 	aa	p(1)		. test subtract high order word
  :                            34 	ana	p(2)		. of each comparand
  :                            35 	$end			. result < = > in a, unsigned result in carry
  :                            36 
  :                            37 p	$proc
  :                            38 i72a48*	$name			. add 48 bits to 72 giving 72
  :                            39 	dl	p(1)+1
  :                            40 	da	p(2)
  :                            41 	ds	p(3)+1
  :                            42 	la	p(2)		. if it wasn't in the internal stack you've read memory twice, too bad
  :                            43 	saa	24
  :                            44 	sc	b		. carry
  :                            45 	ab	a
  :                            46 	ab	p(1)		. high order word longer field
  :                            47 	sb	p(3)
  :                            48 	$end
  :                            49 
  :                            50 p	$proc
  :                            51 i72an48* $name			. take 48 bits fom 72 giving 72
  :                            52 	dl	p(1)+1
  :                            53 	dan	p(2)+1
  :                            54 	ds	p(3)+1
  :                            55 	sc	b
  :                            56 	ab	-1,,xi		. borrow
  :                            57 	la	p(2)		. if it wasn't in the internal stack you've read memory twice, too bad
  :                            58 	saa	24		. signs shorter field
  :                            59 	ab	a
  :                            60 	la	p(1)		. high order word longer field	
  :                            61 	ana	b
  :                            62 	sa	p(3)	
  :                            63 	$end
  :                            64 
  :                            65 p	$proc
  :                            66 i72compare48* $name
  :                            67 	dl	p(1)+1		. test subtract two low-order words
  :                            68 	dan	p(2)
  :                            69 	sc	b
  :                            70 	ab	-1,,xi		. borrow
  :                            71 	la	p(2)		. if it wasn't in the internal stack you've read memory twice, too bad
  :                            72 	saa	24		. signs shorter field
  :                            73 	la	p(1)		. high order word longer field
  :                            74 	ana	b		. test subtract high order word. result < = > in a
  :                            75 	$end
  :                            76 
  :                            77 p	$proc			. add 48 bits to 48 giving 72
  :                            78 i72a48_48* $name
  :                            79 	dl	p(1)
  :                            80 	da	p(2)
  :                            81 	ds	p(3)+1
  :                            82 	saa	24
  :                            83 	sa	p(3)
  :                            84 	$end
  :                            85 
  :                            86 p	$proc
  :                            87 i72an48_48* $name		. subtract 48 bits from 48 giving 72
  :                            88 	dl	p(1)
  :                            89 	dan	p(2)
  :                            90 	ds	p(3)+1
  :                            91 	saa	24
  :                            92 	sa	p(3)
  :                            93 	$end
  :                            94 
  :                            95 p	$proc
  :                            96 i48m*	$name
  :                            97 	dl	p(1)
  :                            98 	c	(m48_24)	p(2)
  :                            99 	$if	p()>2
  :                            100 	sa	p(3)
  :                            101 	dl	6
  :                            102 	ds	p(3)+1
  :                            103 	$endif
  :                            104 	$end
  :                            105 
  :                            106 p	$proc
  :                            107 i48m48*	$name
  :                            108 	dl	p(1)
  :                            109 	c	(m48_48)	p(2),,long
  :                            110 	$do	p()>2,	qs	p(3)
  :                            111 	$end
  :                            112 
  :                            113 p	$proc
  :                            114 i72m*	$name
                                	c	(i72_multiply)	p(1),,triple	;	. multiplicand 3 data words
                                				p(2)		;	. multiplier 1 data word
  :                            117 				p(3),,i			. product address pointer
  :                            118 	$end
  :                            119 
  :                            120 p	$proc
  :                            121 i72m48*	$name
  :                            122 	la	p(1)
  :                            123 	dsa	24
  :                            124 	ds	6
  :                            125 	dl	p(1)+1
  :                            126 	c	(x72_m72_48)	p(2),,long
  :                            127 	$if	p()>2
  :                            128 	ds	p(3)+1
  :                            129 	la	7
  :                            130 	sa	p(3)
  :                            131 	$endif
  :                            132 	$end
  :                            133 
  :                            134 p	$proc
  :                            135 i72m72*	$name
  :                            136 	c	(im72_72)	p(1),,i p(2),,i p(3),,i
  :                            137 	$end
  :                            138 
  :                            139 p	$proc
  :                            140 i48d48*	$name
  :                            141 	dl	p(1)
  :                            142 	c	(d48_48)	p(2),,long
  :                            143 	$do	p()>2,	ds	p(3)
  :                            144 	$end
  :                            145 
  :                            146 p	$proc
  :                            147 i72d*	$name
                                	c	(i72_divide)	p(1),,triple	;	. dividend 3 data words
                                				p(2)		;	. divisor 1 data word
                                				p(3),,i		;	. quotient address pointer
  :                            151 				p(4),,i			. remainder address pointer optional
  :                            152 	$end
  :                            153 
  :                            154 p	$proc
  :                            155 i72d48*	$name
  :                            156 	la	p(1)
  :                            157 	dsa	24
  :                            158 	ds	6
  :                            159 	dl	p(1)+1
  :                            160 	c	(x72_d72_48)	p(2),,long
  :                            161 	$if	p()>2
  :                            162 	ds	p(1)+1
  :                            163 	la	7
  :                            164 	sa	p(1)
  :                            165 	$endif
  :                            166 	$end
  :                            167 
  :                            168 p	$proc
  :                            169 i72d72*	$name
  :                            170 	c	(id72_72)	p(1),,i	p(2),,i	p(3),,i	p(4),,i
  :                            171 	$endif
  :                            172 	$end
  :                            43: 	$include	../lib/144.def
  :                            1 f	$func
  :                            2 "$normalised"* $name
  :                            3 	$return	+(f(1, 3)/*f(1, 1)-1--f(1, 3)/*f(1, 2)-1)**1
  :                            4 	$end
  :                            5 
  :                            6 f	$func
  :                            7 "$i_f_part"* $name	0	
  :                            8 "$integer"*  $name	1
  :                            9 "$fraction"* $name	2
  :                            10 	$sterm	'.'
  :                            11 "$parts" $set	f(1, 1:)
  :                            12 "$int"	$set	f(1, 1:1)
  :                            13 "$fra"	$set	f(1, 1:2)
  :                            14 	$sterm	':'
  :                            15 	$do	p(0, 0)="$integer",	$return	$int
  :                            16 	$do	p(0, 0)="$fraction",	$return	$fra
  :                            17 	$return	$parts
  :                            18 	$end
  :                            19 
  :                            20 
  :                            21 .	e$E function for applications which only want floating point
  :                            22 .	users may put an e in a number string and expect masmx to catch on
  :                            23 .	but masmx won't even realise that's floating point without a . point
  :                            24 .	masmx native exponent operators are *+ *- but it sees e after . point
  :                            25 .	e$E sees e in any number string. You get here if the input didn't normalise
  :                            26 
  :                            27 f	$func
  :                            28 "e$E"*	$name
  :                            29 	$sterm	'e'
                                	$do	f(1, 1:)=2,	;	. 'e' between two parts
  :                            31 	$return	f(1, 1:1)z*+f(1, 1:2)	. 7-word floating value from DIGITSeDIGITS
  :                            32 	$sterm	'E'
                                	$do	f(1, 1:)=2,	;	. 'E' between two parts
  :                            34 	$return	f(1, 1:1)z*+f(1, 1:2)	. 7-word floating value from digitsEdigits
  :                            35 	$return	f(1, 1)z*+0		. 7-word floating value from integer string
  :                            36 	$end
  :                            37 
  :                            38 p	$proc
  :                            39 major_minor* $name
  :                            40 f	$func
  :                            41 normalise* $name
  :                            42 ?	$do	72,	$do	((f(1, 1)/*72-?)--signs)**1,	$return	?-1
  :                            43 	$return	?
  :                            44 	$end
  :                            45 	$do	$o('U'),	$trace	p(1, 1)
  :                            46 
  :                            47 	$twos_complement 0			. in case of -LABEL where label is a floating value
  :                            48 sum	$set,168	p(1, 1)
  :                            49 	$twos_complement 1
  :                            50 	$if		$normalised(168,144,sum)=0
  :                            51 	 $if		sum=-1			. it was -0 or -0.0
  :                            52 	 $elseif	sum=0			. it was +0 or +0.0 , or an unavailable label
  :                            53 	 $elseif	$t(p(1, 1))		. integer with a name
  :                            54 sum	 $set,168	p(1, 1)*+0		. not a number string
  :                            55 	 $else
  :                            56 sum	 $set		e$E(p(1, 1))
  :                            57 	 $sterm		':'			. e$E changes $sterm
  :                            58 	 $endif
  :                            59 	$endif
  :                            60 
  :                            61 signs	$set	sum*/-167
  :                            62 	$do	signs^=sum*/-167,	$flag	unable to fix sign correctly
  :                            63 
  :                            64 	+	sum/*72q
  :                            65 
  :                            66 	$if	1
  :                            67 residual_normalising_count	$set	normalise(sum)
  :                            68 	$if	residual_normalising_count<72
  :                            69 residual_scale	$set	(16777215**((sum--signs)/*144))-72-residual_normalising_count
  :                            70 	$do	residual_scale<0,	$flag	2nd exponent underflow
  :                            71 	$else
  :                            72 residual_scale	$set	0
  :                            73 	$endif
  :                            74 
                                	+(residual_scale--signs)*/72;
                                	++(sum*/residual_normalising_count)**((1*/72)-1);
  :                            77 	++(signs**(1*/residual_normalising_count)-1)q
  :                            78 
  :                            79 	$else
  :                            80 
  :                            81 residual_character	$set	(signs--(sum*/-144))-72
  :                            82 residual_mantissa	$set	sum**(1*/72)-1
  :                            83 residual_normalising_count $set	normalise(residual_mantissa)
  :                            84 	$if	residual_normalising_count<72
  :                            85 	$do	residual_character-residual_normalising_count<0,	$flag	2nd exponent underflow
  :                            86 residual_mantissa	$set	residual_mantissa*/residual_normalising_count++signs**(1*/residual_normalising_count)-1
  :                            87 residual_character	$set	residual_character-residual_normalising_count--signs
  :                            88 	$else
  :                            89 residual_character	$set	signs
  :                            90 	$endif
  :                            91 	+	residual_character*/72++residual_mantissa**(1*/72)-1q
  :                            92 	$endif
  :                            93 	$end
  :                            94 
  :                            44: 	$include	../lib/ascii.def
  :                            1 
  :                            2 HT	$equ	9
  :                            3 CR	$equ	0d
  :                            4 LF	$equ	10
  :                            5 SUB	$equ	26
  :                            6 ESC	$equ	27
  :                            7 HORIZONTAL_TAB $equ HT
  :                            45: 	$include	../lib/octopop.def
  :                            1 p	$proc
  :                            2 octopush* $name
  :                            3 	$do	p(1, *1),	flag	octopush cannot use *indirection
  :                            4 o	$equf	p(1)
  :                            5 	qpush	4+o
  :                            6 	$if	o\2=sp
  :                            7 	qpush	4+o
  :                            8 	$else	
  :                            9 	qpush	o
  :                            10 	$endif
  :                            11 	$end
  :                            12 
  :                            13 p	$proc
  :                            14 octopop* $name
  :                            15 	$do	p(1, *1),	flag	octopop cannot use *indirection
  :                            16 o	$equf	p(1)
  :                            17 	qpop	o
  :                            18 	$if	o\2=sp
  :                            19 	qpop	o
  :                            20 	$else
  :                            21 	qpop	4+o
  :                            22 	$endif
  :                            23 	$end
  :                            24 
  :                            25 p	$proc
  :                            26 push_normalise* $name		. fp$r must be on before this call
  :                            27 	ql	p(1)		. and will be needed to process loaded values
  :                            28 	fa	4+p(1)
  :                            29 	qpush	$residue
  :                            30 	qpush	a
  :                            31 	$end
  :                            46: 	$include	../array.app/array.def
  :                            1 
  :                            2 p	$proc
  :                            3 SIMD_CONTROL* $name
  :                            4 	qpush	p(1)
  :                            5 	qpop	RDATAC
  :                            6 	$end
  :                            7 
  :                            8 p	$proc
  :                            9 SIMD_TARGET* $name
  :                            10 	push	p(1, 1), p(1, 2), i
  :                            11 	pop	q
  :                            12 	$if	p(2, 1)>1
  :                            13 	push	p(2, 1)-1,,xi
  :                            14 	pop	RDATAC
  :                            15 	$else
  :                            16 	z	RDATAC
  :                            17 	$endif
  :                            18 	$end
  :                            19 
  :                            47: 	$include	../fponline/fponline.def
  :                            1 X_EXIT		$equ	0
  :                            2 X_LOAD		$equ	1
  :                            3 X_LOAD_NEGATIVE $equ 	2
  :                            4 X_PUSH		$equ	3
  :                            5 X_ADD		$equ	4
  :                            6 X_ADD_NEGATIVE $equ	5
  :                            7 X_MULTIPLY	$equ	6
  :                            8 X_DIVIDE	$equ	7
  :                            9 X_POP_ADD	$equ	8
  :                            10 X_POP_ADD_NEGATIVE $equ 9
  :                            11 X_POP_MULTIPLY     $equ 10
  :                            12 X_POP_DIVIDE	$equ	11
  :                            13 X_SQUARE_ROOT	$equ	12
  :                            14 X_SINE		$equ	13
  :                            15 X_SQUARE	$equ	14
  :                            16 X_CUBE_ROOT	$equ	15
  :                            17 X_CUBE		$equ	16
  :                            18 X_COSINE	$equ	17
  :                            19 X_TANGENT	$equ	18
  :                            20 X_COTANGENT	$equ	19
  :                            21 X_SINE96	$equ	20
  :                            22 X_COSINE96	$equ	21
  :                            23 X_TANGENT96	$equ	22
  :                            24 X_COTANGENT96	$equ	23
  :                            25 X_FRACTION	$equ	24
  :                            26 X_INTEGER	$equ	25
  :                            27 X_CODES		$equ	26
  :                            28 
  :                            29 FPONLINE_MESSAGE_LIMIT $equ 200
  :                            30 FPONLINE_PORT	$equ	131
  :                            31 
  :                            32 "$command" $form	24, 24
  :                            33 
  :                            34 f	$func
  :                            35 "$192"*	$name
  :                            36 pointer	$equf	$0(major_minor	f(1, 1))
  :                            37 	$return	pointer
  :                            38 	$end
  :                            39 
  :                            40 .	4-function macros connecting fponline
  :                            41 .	to masmx directive $xqt_fp
  :                            42 
  :                            43 .	these macros map to 4-function operators + - * / in expressions
  :                            44 .	starting with load = get the left side of the first expression step
  :                            45 .	all about getting a 192-bit floating result
  :                            46 .	in registers a b mantissa2 mantissa3 8 9 10 11
  :                            47 
  :                            48 p	$proc
  :                            49 "$x_load"* $name
  :                            50 	$command	X_LOAD, p(1, 1)
  :                            51 	$end
  :                            52 
  :                            53 p	$proc
  :                            54 "$x_load_negative"* $name
  :                            55 	$command	X_LOAD_NEGATIVE, p(1, 1)
  :                            56 	$end
  :                            57 
  :                            58 p	$proc
  :                            59 "$x_reserve"* $name
  :                            60 	$command	X_PUSH, p(1, 1)
  :                            61 	$end
  :                            62 
  :                            63 p	$proc
  :                            64 "$x_"* $name
  :                            65 	$end
  :                            66 
  :                            67 p	$proc
  :                            68 "$x_add"* $name
  :                            69 	$command	X_ADD, p(1, 1)
  :                            70 	$end
  :                            71 
  :                            72 p	$proc
  :                            73 "$x_subtract"* $name
  :                            74 	$command	X_ADD_NEGATIVE, p(1, 1)
  :                            75 	$end
  :                            76 
  :                            77 p	$proc
  :                            78 "$x_multiply"* $name
  :                            79 	$command	X_MULTIPLY, p(1, 1)
  :                            80 	$end
  :                            81 
  :                            82 p	$proc
  :                            83 "$x_divide"* $name
  :                            84 	$command	X_DIVIDE, p(1, 1)
  :                            85 	$end
  :                            86 
  :                            87 p	$proc
  :                            88 "$x_retrieve_add"* $name
  :                            89 	$command	X_POP_ADD, 0
  :                            90 	$end
  :                            91 
  :                            92 p	$proc
  :                            93 "$x_retrieve_subtract"* $name
  :                            94 	$command	X_POP_ADD_NEGATIVE, 0
  :                            95 	$end
  :                            96 
  :                            97 p	$proc
  :                            98 "$x_retrieve_multiply"* $name
  :                            99 	$command	X_POP_MULTIPLY, 0
  :                            100 	$end
  :                            101 
  :                            102 p	$proc
  :                            103 "$x_retrieve_divide"* $name
  :                            104 	$command	X_POP_DIVIDE, 0
  :                            105 	$end
  :                            106 
  :                            107 .	end of 4_function macros connecting fponline
  :                            108 .	to masmx directive $xqt_fp
  :                            109 
  :                            110 
  :                            111 
  :                            112 .	start of macros connecting fponline to math lib
  :                            113 .	these are command names
  :                            114 .	all about getting a 192-bit floating result
  :                            115 .	in registers a b mantissa2 mantissa3 8 9 10 11
  :                            116 
  :                            117 p	$proc
  :                            118 _root*	$name
  :                            119 	$if		p()
  :                            120 	$xqt_fp,$192	p()
  :                            121 	$else
  :                            122 	$xqt_fp,$192	$TOTAL
  :                            123 	$endif
  :                            124 	$command	X_SQUARE_ROOT, 0
  :                            125 	$end
  :                            126 
  :                            127 p	$proc
  :                            128 _square* $name
  :                            129 	$if		p()
  :                            130 	$xqt_fp,$192	p()
  :                            131 	$else
  :                            132 	$xqt_fp,$192	$TOTAL
  :                            133 	$endif
  :                            134 	$command	X_SQUARE,	0
  :                            135 	$end
  :                            136 
  :                            137 p	$proc
  :                            138 _root3*	$name
  :                            139 	$if		p()
  :                            140 	$xqt_fp,$192	p()
  :                            141 	$else
  :                            142 	$xqt_fp,$192	$TOTAL
  :                            143 	$endif
  :                            144 	$command	X_CUBE_ROOT	0
  :                            145 	$end
  :                            146 
  :                            147 p	$proc
  :                            148 _cube*	$name
  :                            149 	$if		p()
  :                            150 	$xqt_fp,$192	p()
  :                            151 	$else
  :                            152 	$xqt_fp,$192	$TOTAL
  :                            153 	$endif
  :                            154 	$command	X_CUBE		0
  :                            155 	$end
  :                            156 
  :                            157 p	$proc
  :                            158 _sine*	$name
  :                            159 	$if		p()
  :                            160 	$xqt_fp,$192	p()
  :                            161 	$else
  :                            162 	$xqt_fp,$192	$TOTAL
  :                            163 	$endif
  :                            164 	$command	X_SINE, 	0
  :                            165 	$end
  :                            166 
  :                            167 p	$proc
  :                            168 _cosine* $name
  :                            169 	$if		p()
  :                            170 	$xqt_fp,$192	p()
  :                            171 	$else
  :                            172 	$xqt_fp,$192	$TOTAL
  :                            173 	$endif
  :                            174 	$command	X_COSINE,	0
  :                            175 	$end
  :                            176 
  :                            177 p	$proc
  :                            178 _tangent* $name
  :                            179 	$if		p()
  :                            180 	$xqt_fp,$192	p()
  :                            181 	$else
  :                            182 	$xqt_fp,$192	$TOTAL
  :                            183 	$endif
  :                            184 	$command	X_TANGENT,	0
  :                            185 	$end
  :                            186 
  :                            187 p	$proc
  :                            188 _cotan*	$name
  :                            189 	$if		p()
  :                            190 	$xqt_fp,$192	p()
  :                            191 	$else
  :                            192 	$xqt_fp,$192	$TOTAL
  :                            193 	$endif
  :                            194 	$command	X_COTANGENT,	0
  :                            195 	$end
  :                            196 
  :                            197 p	$proc
  :                            198 __sine*	$name
  :                            199 	$if		p()
  :                            200 	$xqt_fp,$192	p()
  :                            201 	$else
  :                            202 	$xqt_fp,$192	$TOTAL
  :                            203 	$endif
  :                            204 	$command	X_SINE96,	0
  :                            205 	$end
  :                            206 
  :                            207 p	$proc
  :                            208 __cosine* $name
  :                            209 	$if		p()
  :                            210 	$xqt_fp,$192	p()
  :                            211 	$else
  :                            212 	$xqt_fp,$192	$TOTAL
  :                            213 	$endif
  :                            214 	$command	X_COSINE96,	0
  :                            215 	$end
  :                            216 
  :                            217 p	$proc
  :                            218 __tangent* $name
  :                            219 	$if		p()
  :                            220 	$xqt_fp,$192	p()
  :                            221 	$else
  :                            222 	$xqt_fp,$192	$TOTAL
  :                            223 	$endif
  :                            224 	$command	X_TANGENT96,	0
  :                            225 	$end
  :                            226 
  :                            227 p	$proc
  :                            228 __cotan* $name
  :                            229 	$if		p()
  :                            230 	$xqt_fp,$192	p()
  :                            231 	$else
  :                            232 	$xqt_fp,$192	$TOTAL
  :                            233 	$endif
  :                            234 	$command	X_COTANGENT96,	0
  :                            235 	$end
  :                            236 
  :                            237 p	$proc
  :                            238 _fraction* $name
  :                            239 	$if		p()
  :                            240 	$xqt_fp,$192	p()
  :                            241 	$else
  :                            242 	$xqt_fp,$192	$TOTAL
  :                            243 	$endif
  :                            244 	$command	X_FRACTION,	0
  :                            245 	$end
  :                            246 
  :                            247 p	$proc
  :                            248 _integer* $name
  :                            249 	$if		p()
  :                            250 	$xqt_fp,$192	p()
  :                            251 	$else
  :                            252 	$xqt_fp,$192	$TOTAL
  :                            253 	$endif
  :                            254 	$command	X_INTEGER,	0
  :                            255 	$end
  :                            256 
  :                            48: 	$include	../def.app/iframes.def
  :                            1 APPLICATION(1)	$equ	00B000
  :                            2 APPLICATION(2)	$equ	00C000
  :                            3 . APPLICATION(3)	$equ	00D000
  :                            4 . APPLICATION(4)	$equ	00E000
  :                            5 . APPLICATION(5)	$equ	00F000
  :                            49: 	$include	../stream/stream.def
  :                            1 stdin	$equf	0,,xi
  :                            2 stdout	$equf	1,,xi
  :                            3 stderr	$equf	2,,xi
  :                            4 
  :                            5 p	$proc
  :                            6 scanf*	$name
  :                            7 	fscanf	stdin	p()
  :                            8 	$end
  :                            9 
  :                            10 p	$proc
  :                            11 fscanf*	$name
  :                            12 	c	(__fscanf) p()
  :                            13 	$end
  :                            14 
  :                            15 p	$proc
  :                            16 fprintf* $name
  :                            17 	c	(__fprintf)	p()
  :                            18 	$end
  :                            19 
  :                            20 p	$proc
  :                            21 printf*	$name
  :                            22 	fprintf	stdout	p()
  :                            23 	$end
  :                            24 
  :                            25 p	$proc
  :                            26 sscanf*	$name
  :                            27 	c	(__sscanf) p()
  :                            28 	$end
  :                            29 
  :                            30 p	$proc
  :                            31 sprintf* $name
  :                            32 	c	(__sprintf) p()
  :                            33 	$end
  :                            34 
  :                            35 p	$proc
  :                            36 fread*	$name
  :                            37 _LDES1	$set	0
  :                            38 _LDES2	$set	0
  :                            39 	$do	$t(p(2, 1))=0,	$do	p(2)<3,_LDES1,	$set	xi
  :                            40 	$do	$t(p(3, 1))=0,	$do	p(3)<3,_LDES2,	$set	xi
  :                            41 	c	(readll)	p(4)	p(1)	p(2),,_LDES1	p(3),,_LDES2
  :                            42 	$end
  :                            43 
  :                            44 p	$proc
  :                            45 fwrite*	$name
  :                            46 _LDES1	$set	0
  :                            47 _LDES2	$set	0
  :                            48 	$do	$t(p(2, 1))=0,	$do	p(2)<3,_LDES1	$set	xi
  :                            49 	$do	$t(p(3, 1))=0,	$do	p(3)<3,_LDES2	$set	xi
  :                            50 	c	(writell)	p(4)	p(1)	p(2),,_LDES1	p(3),,_LDES2
  :                            51 	$end
  :                            52 
  :                            53 p	$proc
  :                            54 fgets*	$name
  :                            55 gets*	$name
  :                            56 
  :                            57 
  :                            58 	$if	p()<2
  :                            59 _LEN	$equf	99,,xi
  :                            60 	$note	maximum bytes arbitrarily 99 columns. Add 2nd argument HOW_MANY,,xi|i or [*]INTEGER_VARIABLE{,,w0|t1|t2|t3} for <> 33 words
  :                            61 	$else
  :                            62 	$if	p(2)<2
  :                            63 _LEN	$equf	p(2, 1),,xi
  :                            64 	$do	p(2, *1), $note length interpreted as  *LOCATION,,xi = LOCATION,,w0. For *pointer->variable type *POINTER{,,w0|t1|t2|t3}
  :                            65 	$elseif	p(2)<3
  :                            66 _LEN	$equf	p(2),,i
  :                            67 	$do	p(2, 2)^=0,	$note	length interpreted as  VALUE,INDEX,i. For variable type VALUE,INDEX{,w0|t1|t2|t3} 
  :                            68 	$else
  :                            69 _LEN	$equf	p(2)
  :                            70 	$endif
  :                            71 	$endif
  :                            72 
  :                            73 	c	(__fgets)	p(3)	p(1)	_LEN
  :                            74 
  :                            75 	dsr	24		. result in a whatever sort of file it was
  :                            76 	wsr	24		. zero->end of buffer and result in a again
  :                            77 
  :                            78 	jnb	$+3		. bad status treated as nothing received
  :                            79 	jzb	$+2		. nothing received translates to no pointer handed back
  :                            80 	la	p(1)		. nonzero result is the pointer the caller already knows
  :                            81 				. but the real answer is in register b
  :                            82 	$end
  :                            83 
  :                            84 p	$proc
  :                            85 fflush* $name
  :                            86 	c	(fsync)	p(1, 1)
  :                            87 	$end
  :                            88 
  :                            50 
  :                            51 LIBRARY	$set		LIBRARY_XDR
  :                            52 
  :                            53 FPSERVER_PORT	$equ	128
  :                            54 FPSERVER_PORT2	$equ	130
  :                            55 CALIBRATE_PORT	$equ	0	.	4610
  :                            56 AGENT1_PORT	$equ	0	.	4611
  :                            57 
  :                            58 
00:002f72+75005F
00:002f73+[0001]18:000000
00:002f74+[0002]30:000000000000
00:002f76+[0003]18:000000
00:002f77+(03)18:00000000261F
00:002f79+000000000001
00:002f7b+00015F
00:002f7c+[0004]18:000000
00:002f7d+000160
00:002f7e+[0005]18:000000
00:002f7f+110000
00:002f80+060000
00:002f81+FC0000
00:002f82+BC0000
00:002f83+[000C]18:000000
00:002f84+[000D]18:000000
00:002f85+[000E]18:000000
00:002f86+[000F]18:000000
00:002f87+[0010]18:000000
00:002f88+[0011]18:000000
00:002f89+3FFFFF
00:002f8a+030000
00:002f8b+010000
00:002f8c+C00000
00:002f8d+000000
00:002f8e+00FFFF
00:002f8f+000000000020000010000008
00:002f93+[0012]18:000000
00:002f94+00008B
00:002f95+7FFFFF
00:002f96+0000B6
00:002f97+00FF00
00:002f98+02F000
00:002f99+02F008
00:002f9a+0000A9
00:002f9b+02F001
00:002f9c+02F006
00:002f9d+00025F
00:002f9e+02F028
00:002f9f+000000010000
00:002fa1+00025E
00:002fa2+00008D
00:002fa3+02F02A
00:002fa4+0000AF
00:002fa5+02F003
00:002fa6+006002004500000204000000
00:002faa+006012004500000204000000
00:002fae+005011004500
00:002fb0+005018004500
00:002fb2+800000
00:002fb3+01FFFF
00:002fb4+005004
00:002fb5+005004004500
00:002fb7+005010004504
00:002fb9+005010004500
00:002fbb+02F004
00:002fbc+[0013]18:000000
00:002fbd+BC0006
00:002fbe+00008E
00:002fbf+FF0000
00:002fc0+0927C0
00:002fc1+000000000000
00:002fc3+000085
00:002fc4+000083
00:002fc5+000082
00:002fc6+00008C
00:002fc7+0000AE
00:002fc8+0000A8
00:002fc9+3F0000
00:002fca+000000000002
00:002fcc+000093
00:002fcd+000092
00:002fce+000000000000000000000000
00:002fd2+000000000003
00:002fd4+0000B0
00:002fd5+200000
00:002fd6+0000B3
00:002fd7+0000B7
00:002fd8+0000B1
00:002fd9+000004000503
00:002fdb+00F000
00:002fdc+BC002A
00:002fdd+00000000000A
00:002fdf+100000
00:002fe0+000087
00:002fe1+000088
00:002fe2+FFFFFF000000000040000004
00:002fe6+47B000
00:002fe7+400000
00:002fe8+[0014]18:000000
  :                            59 $(0::A_PROTOS_BANK1)
00:005000 B60126              +60 telnet		$vector	telnet_i
00:005001 B603FC              +61 http_server	$vector	http_serve
00:005002 B6004A              +62 fp_server	$vector	fp_96:fp_server
00:005003 B600AD              +63 fp_server_192	$vector	fp_192:fp_server
00:005004 B604DC              +64 integer_server	$vector	iserve:integer_serve
00:005005 B6056C              +65 fponline	$vector	fponline:launch
  :                            66 
  :                            67 		$if	SNMP_AGENT_THREADED
00:005006 B60A82              +68 snmp_agent*	$vector	snmp_agent_launch
  :                            69 		$else
  :                            70 agent2*		$vector agent_2			. snmpv1
  :                            71 		$endif
  :                            72 
00:005007 B60D4D              +73 subagent*	$vector subagent_insert
00:005008 B60D51              +74 subagent?*	$vector subagent_lookup
  :                            75 
  :                            76 	$if	CALIBRATE_PORT
  :                            77 calibration	$vector	calibrate
  :                            78 	$endif
  :                            79 
00:005009 B6030F              +80 online_xqt*	$vector	search_onlinexqt
00:00500A B6036E              +81 run_start*	$vector	startups:run
00:00500B B60339              +82 initial_startups* $vector startups:initial
00:00500C B603EF              +83 normal_string*	$vector	normal_s
  :                            84 
00:00500D B60E74              +85 x72_orU*	$vector	x72oru
00:00500E B60E80              +86 x72_andU*	$vector	x72andu
00:00500F B60E8C              +87 x72_xorU*	$vector	x72xoru
00:005010 B60D70              +88 x72_xtend*	$vector	x72xtend
00:005011 B60E49              +89 x72_sa*		$vector	x72sa
00:005012 B60E21              +90 x72_sl*		$vector	x72sl
00:005013 B60D76              +91 x72_aU*		$vector	x72au
00:005014 B60D83              +92 x72_anU*	$vector	x72anu
00:005015 B60D92              +93 x72_m48_24*     $vector x48m24
00:005016 B60D98              +94 x72_m72_24*	$vector	x72m24
00:005017 B60DA0              +95 x72_m48_48*     $vector x48m48
00:005018 B60DA6              +96 x72_m72_48*	$vector	x72m48
00:005019 B60DBF              +97 x72_m72_72*	$vector	x72m72
00:00501A B60DD8              +98 x72_d72_24*	$vector	x72d24
00:00501B B60DE9              +99 x72_d48_48*     $vector x48d48
00:00501C B60DEF              +100 x72_d72_48*	$vector	x72d48
00:00501D B60E08              +101 x72_d72_72*	$vector	x72d72
  :                            102 
00:00501E B60E98              +103 sysinfo*	$vector	sys_info
  :                            104 
00:00501F B60040              +105 app_threads*	$vector	athreads_start
00:005020 B60047              +106 app_protos*	$vector	a_protos_inline
  :                            107 
00:005021 3D0000              +108 	$do	48-$,	fret	0
00:005022 3D0000              +108 
00:005023 3D0000              +108 
00:005024 3D0000              +108 
00:005025 3D0000              +108 
00:005026 3D0000              +108 
00:005027 3D0000              +108 
00:005028 3D0000              +108 
00:005029 3D0000              +108 
00:00502A 3D0000              +108 
00:00502B 3D0000              +108 
00:00502C 3D0000              +108 
00:00502D 3D0000              +108 
00:00502E 3D0000              +108 
00:00502F 3D0000              +108 
  :                            109 
00:005030 B60746              +110 fraction192*	$vector	ap_lib192:fraction
00:005031 B60765              +111 integer192*	$vector	ap_lib192:integer
  :                            112 
00:005032 B6078E              +113 fraction96*	$vector	ap_lib96:fraction
00:005033 B607A7              +114 integer96*	$vector	ap_lib96:integer
  :                            115 
00:005034 B607D3              +116 sine192*	$vector	trig192:sine
00:005035 B607DA              +117 cosine192*	$vector	trig192:cosine
00:005036 B607EB              +118 tangent192*	$vector	trig192:tangent
00:005037 B60802              +119 cotangent192*	$vector	trig192:cotangent
  :                            120 
00:005038 B609E7              +121 sine96*		$vector	trig96:sine
00:005039 B609F0              +122 cosine96*		$vector	trig96:cosine
00:00503A B609FC              +123 tangent96*		$vector	trig96:tangent
00:00503B B60A0D              +124 cotangent96*	$vector	trig96:cotangent
  :                            125 
00:00503C B606CF              +126 square192*	$vector	ap_lib192:square
00:00503D B6068A              +127 square_root192*  $vector ap_lib192:square_root
00:00503E B60730              +128 cube192*	$vector	ap_lib192:cube
00:00503F B606E0              +129 cube_root192*	$vector	ap_lib192:cube_root
  :                            130 
  :                            131 athreads_start
  :                            132: 	$include	athreads
  :                            1 HTTP_THREADED	$equ	1
  :                            2 TELNET_THREADED	$equ	1
  :                            3 I_SERVER_THREADED $equ	1
  :                            4 SNMP_AGENT_THREADED $equ 1
  :                            5 
  :                            6 			$if	SNMP_AGENT_THREADED
                                	APPLICATION_PROTOCOLS	http_server	;
                                				telnet		;
                                				fponline	;
                                				snmp_agent	;
                                				integer_server	;
                                						;
00:005040 FF0E9D              +13 				initial_startups
00:005041 FF0E9E              +13 
00:005042 FF0E9F              +13 
00:005043 FF0EA0              +13 
00:005044 FF0EA1              +13 
00:005045 FF0EA2              +13 
  :                            14 
  :                            15 			$else
                                	APPLICATION_PROTOCOLS	http_server	;
                                				telnet		;
                                				fponline	;
  :                            19 				integer_server
  :                            20 			$endif
  :                            21 
00:005046 3D0000              +133 	fret		0
  :                            134 
  :                            135 a_protos_inline
  :                            136:         $include	a_protos
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 	$if	SNMP_AGENT_THREADED
00:005047 FF0EA3              +41 	APPLICATION_PROTOCOLS		fp_server fp_server_192
00:005048 FF0EA4              +41 
  :                            42 	$elseif	1
  :                            43 	APPLICATION_PROTOCOLS		fp_server fp_server_192 agent2
  :                            44 	$else
                                	APPLICATION_PROTOCOLS		fp_server	;
                                					fp_server_192	;
                                					calibration	;
  :                            48 					agent2
  :                            49 	$endif
00:005049 3D0000              +137         fret		0
  :                            138 
  :                            139: 	$include fpserver
  :                            1 fp_96	$tree
  :                            2 
  :                            3 $(1)
01:000413 000000              +4 socket1	+	0
01:000414 FFFFFF              +5 fp_bound -	1
  :                            6 portcb_lva	$res 1
  :                            7 portcb		$res 1
  :                            8 
  :                            9 $(0)
                                fp_server	$head_far	scalars(response_axw,	int	;		
                                					operator,	int	;
                                					left,		float	;
00:00504A FD0000              +13 					right,		float	)
00:00504B FD0000              +13 
00:00504C 8F0EA5              +13 
00:00504D 8F0EA5              +13 
  :                            14 
(+01)0f
00:00504E 700413              +15 	tz	socket1
00:00504F B6005D              +16 	j	fp_rx
00:005050 600EA9              +17 	la	(IPPROTO_UDP*/16)
00:005051 FF0EAA              +18 	call	(__socket)
(+01)0f
00:005052 200413              +19 	sa	socket1
00:005053 E600AA              +20 	jna	fp_error
  :                            21 
00:005054 9F0EAB              +22 	c	(bind) a (FPSERVER_PORT:d),,long
00:005055 F80004              +22 
00:005056 FCF003              +22 
00:005057 FF0EAD              +22 
00:005058 38000F              +22 
  :                            23 
  :                            24 .	lb, xi	FPSERVER_PORT
  :                            25 .	sb	7
  :                            26 .	z	6
  :                            27 .	call	(bind)
  :                            28 
(+01)0f
00:005059 200414              +29 	sa	fp_bound
00:00505A E600AA              +30 	jna	fp_error
  :                            31 
00:00505B CF000A              +32 	dl	10
(+01)0f
00:00505C C70415              +33 	ds	portcb_lva
  :                            34 
(+01)0f
00:00505D 780414              +35 fp_rx	tp	fp_bound
00:00505E B600AA              +36 	j	fp_error
  :                            37 
(+01)0f
00:00505F CF0415              +38 	dl	portcb_lva
00:005060 34002F              +39 	sabr	BSOCKET
  :                            40 
00:005061 68D006              +41 fp_rx1	lb	s:udp:socket_inq.head, b
00:005062 CE00AA              +42 	jzb	fp_no_traffic
  :                            43 
  :                            44 	$if	1
  :                            45 
00:005063 28000E              +46 	sb	fp
00:005064 650020              +47 	la	21+7+1+2+1,,xi
00:005065 FF0EAE              +48 	call	(udp_rtxbuffer)
00:005066 C600A6              +49 	jza	fp_release
00:005067 20F009              +50 	sa	response_axw
00:005068 60E003              +51 	la	descriptor:bytes
00:005069 68E006              +52 	lb	descriptor:apdata
00:00506A FF0EAF              +53 	call	(rstream_start_net)
  :                            54 
  :                            55 	$else
  :                            56 
  :                            57 	la	descriptor:bytes, b
  :                            58 	sa	BYTES
  :                            59 
  :                            60 	z	RDATAC
  :                            61 
  :                            62 	push	descriptor:apdata, b
  :                            63 	pop	q
  :                            64 
  :                            65 	la, xi	21+7+1+2+1
  :                            66 	call	(udp_rtxbuffer)
  :                            67 	jza	fp_release
  :                            68 
  :                            69 	ly	descriptor:apdata, a
  :                            70 	sa	response_axw
  :                            71 	sy	p
  :                            72 	z	WDATAC
  :                            73 	z	WDATA
  :                            74 
  :                            75 	$endif
  :                            76 
00:00506B FF0EB0              +77 	call	(floating_scan)
00:00506C 47F004              +78 	qs	left
  :                            79 
00:00506D FF0EB1              +80 	call	(symbol_scan)
00:00506E 20F008              +81 	sa	operator
  :                            82 
00:00506F FF0EB0              +83 	call	(floating_scan)
00:005070 47F000              +84 	qs	right
  :                            85 
00:005071 450000              +86 	lr, xi	0
00:005072 600013              +87 	la	LAST_BYTE_READ	.	LAST_BYTE_READ
00:005073 C5FFD4              +88 	aa, xi	-','
  :                            89 
00:005074 D6007A              +90 	jnza	fp_again
00:005075 FF0EB2              +91 	call	(iscan_skip)
00:005076 6D0001              +92 	lb, xi	1		.	nothing scanned
00:005077 CDFFFF              +93 	ab, xi	-1
00:005078 EE007A              +94 	jnb	fp_again
00:005079 400005              +95 	lr	b
  :                            96 
  :                            97 fp_again
00:00507A 60F008              +98 	la	operator
  :                            99 
00:00507B 680004              +100 	anu, xi	'+'
00:00507C DD002B              +100 
00:00507D CE0088              +101 	jzb	fp_add
00:00507E 680004              +102 	anu, xi	'-'
00:00507F DD002D              +102 
00:005080 CE008C              +103 	jzb	fp_add_negative
00:005081 680004              +104 	anu, xi	'*'
00:005082 DD002A              +104 
00:005083 CE0090              +105 	jzb	fp_multiply
00:005084 680004              +106 	anu, xi	'/'
00:005085 DD002F              +106 
00:005086 CE0094              +107 	jzb	fp_divide
00:005087 B60098              +108 	j	fp_nop
  :                            109 
  :                            110 fp_add
00:005088 4FF004              +111 	ql	left
  :                            112 fp_add_again
00:005089 67F000              +113 	fa	right
00:00508A 1E0089              +114 	jdr	fp_add_again
00:00508B B60099              +115 	j	fp_edit
  :                            116 
  :                            117 fp_add_negative
00:00508C 4FF004              +118 	ql	left
  :                            119 fp_add_negative_again
00:00508D 6FF000              +120 	fan	right
00:00508E 1E008D              +121 	jdr	fp_add_negative_again
00:00508F B60099              +122 	j	fp_edit
  :                            123 
  :                            124 fp_multiply
00:005090 4FF004              +125 	ql	left
  :                            126 fp_multiply_again
00:005091 77F000              +127 	fm	right
00:005092 1E0091              +128 	jdr	fp_multiply_again
00:005093 B60099              +129 	j	fp_edit
  :                            130 
  :                            131 fp_divide
00:005094 4FF004              +132 	ql	left
  :                            133 fp_divide_again
00:005095 7FF000              +134 	fd	right
00:005096 1E0095              +135 	jdr	fp_divide_again
00:005097 B60099              +136 	j	fp_edit
  :                            137 
00:005098 4FF004              +138 fp_nop	ql	left			. no operation
  :                            139 					. return scanned number if any
  :                            140 fp_edit
  :                            141 	$if	1
  :                            142 
00:005099 50F009              +143 	lx	response_axw
00:00509A 50A006              +144 	lx	descriptor:apdata, x
00:00509B FF0EB3              +145 	call	(wstream_start_net)
  :                            146 
  :                            147 	$else
  :                            148 
  :                            149 	z	BYTES
  :                            150 
  :                            151 	$endif
  :                            152 
00:00509C 75004E              +153 	ii	FP_XPO$FLAG		. must drain cached exponent overflow event
00:00509D 4F0EB4              +154 	ql	(-0.0)			. because fpser192 is also in this thread
  :                            155 					. also the event may have been in scan library
  :                            156 					. and not appear here as -0.0
00:00509E FF0EB8              +157 	call	(floating_iedit)
  :                            158 
00:00509F 600EB9              +159 	la	("":10:0:0)
00:0050A0 1D0018              +160 	wsr	24
  :                            161 	
00:0050A1 50F009              +162 	lx	response_axw
00:0050A2 600010              +163 	la	BYTES
00:0050A3 64C001              +164 	la, i	1, a
00:0050A4 20A003              +165 	sa	descriptor:bytes, x
  :                            166 
  :                            167 
00:0050A5 FF0EBA              +168 	call	(udp_acw_send)
  :                            169 
  :                            170 fp_release
(+01)0f
00:0050A6 500416              +171 	lx	portcb			. port structure in scalar frame
00:0050A7 FF0EBB              +172 	call	(release_udgram)
(+01)0f
00:0050A8 680416              +173 	lb	portcb			. port structure in scalar frame
00:0050A9 B60061              +174 	j	fp_rx1
  :                            175 fp_no_traffic
  :                            176 fp_error
  :                            177 
00:0050AA 54F00A              +178 	lx, i	$$frame, sp
00:0050AB 10000F              +179 	sx	sp
00:0050AC 3D0000              +180 	fret	0
  :                            181 	$root
  :                            140: 	$include fpser192
  :                            1 fp_192		$tree
  :                            2 $(1)
01:000417 000000              +3 socket1	+	0
01:000418 FFFFFF              +4 fp_bound -	1
  :                            5 portcb_lva	$res 1
  :                            6 portcb		$res 1
  :                            7 
  :                            8 $(0)
  :                            9 
  :                            10 
                                fp_server	$head_far	scalars(response_axw,	int	;
                                					operator,	int	;
                                					right,		8	;
00:0050AD FD0000              +14 					left,		8	)
00:0050AE FD0000              +14 
00:0050AF 8F0EA5              +14 
00:0050B0 8FF000              +14 
00:0050B1 8F0EA5              +14 
00:0050B2 8FF000              +14 
  :                            15 
(+01)0f
00:0050B3 700417              +16 	tz	socket1
00:0050B4 B600C2              +17 	j	fp_rx
00:0050B5 600EA9              +18 	la	(IPPROTO_UDP*/16)
00:0050B6 FF0EAA              +19 	call	(__socket)
(+01)0f
00:0050B7 200417              +20 	sa	socket1
00:0050B8 E60119              +21 	jna	fp_error
  :                            22 
00:0050B9 9F0EBC              +23 	c	(bind) a (FPSERVER_PORT2:d),,long
00:0050BA F80004              +23 
00:0050BB FCF003              +23 
00:0050BC FF0EAD              +23 
00:0050BD 38000F              +23 
  :                            24 
  :                            25 .	lb, xi	FPSERVER_PORT2
  :                            26 .	sb	7
  :                            27 .	z	6
  :                            28 .	call	(bind)
  :                            29 
(+01)0f
00:0050BE 200418              +30 	sa	fp_bound
00:0050BF E60119              +31 	jna	fp_error
  :                            32 
00:0050C0 CF000A              +33 	dl	10
(+01)0f
00:0050C1 C70419              +34 	ds	portcb_lva
  :                            35 
(+01)0f
00:0050C2 780418              +36 fp_rx	tp	fp_bound
00:0050C3 B60119              +37 	j	fp_error
  :                            38 
(+01)0f
00:0050C4 CF0419              +39 	dl	portcb_lva
00:0050C5 34002F              +40 	sabr	BSOCKET
  :                            41 
00:0050C6 68D006              +42 fp_rx1	lb	s:udp:socket_inq.head, b
00:0050C7 CE0119              +43 	jzb	fp_no_traffic
  :                            44 
  :                            45 	$if	1
  :                            46 
00:0050C8 28000E              +47 	sb	fp			. take a copy of the input axw
00:0050C9 650036              +48 	la	43+7+1+2+1,,xi
00:0050CA FF0EAE              +49 	call	(udp_rtxbuffer)
00:0050CB C60115              +50 	jza	fp_release		. can't buffer  a response
  :                            51 					. so drop the question
00:0050CC 20F011              +52 	sa	response_axw
00:0050CD 60E003              +53 	la	descriptor:bytes
00:0050CE 68E006              +54 	lb	descriptor:apdata
00:0050CF FF0EAF              +55 	call	(rstream_start_net)
  :                            56 
  :                            57 	$else
  :                            58 
  :                            59 	la	descriptor:bytes, b
  :                            60 	sa	BYTES
  :                            61 
  :                            62 	z	RDATAC
  :                            63 
  :                            64 	push	descriptor:apdata, b
  :                            65 	pop	q
  :                            66 
  :                            67 	la, xi	43+7+1+2+1
  :                            68 	call	(udp_rtxbuffer)
  :                            69 	jza	fp_release
  :                            70 
  :                            71 	ly	descriptor:apdata, a
  :                            72 	sa	response_axw
  :                            73 	sy	p
  :                            74 	z	WDATAC
  :                            75 	z	WDATA
  :                            76 
  :                            77 	$endif
  :                            78 
00:0050D0 FF0EBE              +79 	call	(floating_scan192)
00:0050D1 47F000              +80 	qs	left
00:0050D2 4F0008              +81 	ql	$residue
00:0050D3 47F004              +82 	qs	left+4
  :                            83 
00:0050D4 FF0EB1              +84 	call	(symbol_scan)
00:0050D5 20F010              +85 	sa	operator
  :                            86 
00:0050D6 FF0EBE              +87 	call	(floating_scan192)
00:0050D7 47F008              +88 	qs	right
00:0050D8 4F0008              +89 	ql	$residue
00:0050D9 47F00C              +90 	qs	right+4
  :                            91 
00:0050DA 450000              +92 	lr, xi	0
00:0050DB 600013              +93 	la	LAST_BYTE_READ	.	LAST_BYTE_READ
00:0050DC C5FFD4              +94 	aa, xi	-','
  :                            95 
00:0050DD D600E3              +96 	jnza	fp_again
00:0050DE FF0EB2              +97 	call	(iscan_skip)
00:0050DF 6D0001              +98 	lb, xi	1		.	nothing scanned
00:0050E0 CDFFFF              +99 	ab, xi	-1
00:0050E1 EE00E3              +100 	jnb	fp_again
00:0050E2 400005              +101 	lr	b
  :                            102 
  :                            103 FP_SIMDOPS	$equ	1
  :                            104 
  :                            105 fp_again
  :                            106 	$if	FP_SIMDOPS
00:0050E3 8F0EBF              +107 	SIMD_CONTROL	(-1, 0, 0, 0q)
00:0050E4 870014              +107 
00:0050E5 050008              +108 	on	fp$r
  :                            109 	$endif
  :                            110 
00:0050E6 60F010              +111 	la	operator
  :                            112 
00:0050E7 680004              +113 	anu, xi	'+'
00:0050E8 DD002B              +113 
00:0050E9 CE00F4              +114 	jzb	fp_add
00:0050EA 680004              +115 	anu, xi	'-'
00:0050EB DD002D              +115 
00:0050EC CE00F7              +116 	jzb	fp_add_negative
00:0050ED 680004              +117 	anu, xi	'*'
00:0050EE DD002A              +117 
00:0050EF CE00FA              +118 	jzb	fp_multiply
00:0050F0 680004              +119 	anu, xi	'/'
00:0050F1 DD002F              +119 
00:0050F2 CE00FD              +120 	jzb	fp_divide
00:0050F3 B60100              +121 	j	fp_nop
  :                            122 
  :                            123 	$if	FP_SIMDOPS	. destination + aource1 is default
  :                            124 				. object left at internal stack top
  :                            125 fp_add
00:0050F4 740EC3              +126 fp_add1	rex	(fa	right)
00:0050F5 1E00F4              +127 	jdr	fp_add1
00:0050F6 B60104              +128 	j	fp_edit
  :                            129 
  :                            130 fp_add_negative
  :                            131 fp_add1_negative
00:0050F7 740EC4              +132 	rex	(fan    right)
00:0050F8 1E00F7              +133 	jdr	fp_add1_negative
00:0050F9 B60104              +134 	j	fp_edit
  :                            135 
  :                            136 fp_multiply
  :                            137 fp_multiply1
00:0050FA 740EC5              +138 	rex	(fm	right)
00:0050FB 1E00FA              +139 	jdr	fp_multiply1
00:0050FC B60104              +140 	j	fp_edit
  :                            141 
  :                            142 fp_divide
  :                            143 fp_divide1
00:0050FD 740EC6              +144 	rex	(fd	right)
00:0050FE 1E00FD              +145 	jdr	fp_divide1
00:0050FF B60104              +146 	j	fp_edit
  :                            147 
  :                            148 	$else			. not FP_SIMOPS then
  :                            149 				. operations are in registers [ a b 6 7 8 9 10 11 ]
  :                            150 fp_add
  :                            151 	ql	left+4
  :                            152 	qs	$residue
  :                            153 	ql	left		. doesn't appear that iscan_skip etc affects $residue 8:9:10:11
  :                            154 
  :                            155 fp_add1
  :                            156 	c	(fp192_add)	right,,i
  :                            157 
  :                            158 	on	fp$r		. supernormalise to avoid accumulating rounding bumps
  :                            159 	fa	$residue
  :                            160 	off	fp$r
  :                            161 	jdr	fp_add1
  :                            162 
  :                            163 	j	fp_edit
  :                            164 
  :                            165 fp_add_negative
  :                            166 	ql	left+4
  :                            167 	qs	$residue
  :                            168 	ql	left		. doesn't appear that iscan_skip etc affects $residue 8:9:10:11
  :                            169 
  :                            170 fp_add_negative1
  :                            171 	c	(fp192_add_negative)	right,,i
  :                            172 
  :                            173 	on	fp$r		. supernormalise to avoid accumulating rounding bumps
  :                            174 	fa	$residue
  :                            175 	off	fp$r
  :                            176 
  :                            177 	jdr	fp_add_negative1
  :                            178 
  :                            179 	j	fp_edit
  :                            180 
  :                            181 fp_multiply			. leaving this one how it was. It's just as good as (fp192_multiply)
  :                            182 	c	(fp192_mfa)	left,,i	right,,i
  :                            183 	jdr	fp_multiply
  :                            184 	ql	left+4		. this doesn't have a supernormalise
  :                            185 	qs	$residue	. if iteratively multiplying change to call (fp192_multiply)
  :                            186 	ql	left		. and add a supernormalise in the jdr loop
  :                            187 	j	fp_edit
  :                            188 
  :                            189 
  :                            190 .	the other 3 functions process two 192-bit inputs
  :                            191 
  :                            192 .	but 192-bit divide must test 
  :                            193 .	whether the divisor is represented in 1 or 2 floating numbers
  :                            194 
  :                            195 .	a 96-bit number sounds big
  :                            196 .	but if the divisor exponent is < 0 or > 31 decimal equivalent
  :                            197 .	then the 2nd divisor floating number is nonzero
  :                            198 .	for now deliver an indicative result in this case
  :                            199 .	by rounding both dividend and divisor to 96 bits
  :                            200 .	(adding their major and minor parts) and delivering a 96-bit quotient
  :                            201 
  :                            202 .	if the divisor is only one floating number (minor part is zero)
  :                            203 .	deliver a 192-bit quotient from a 192-bit dividend 
  :                            204 
  :                            205 fp_divide
  :                            206 	ql	left+4
  :                            207 	qs	$residue
  :                            208 	ql	left		. doesn't appear that iscan_skip etc affects $residue 8:9:10:11
  :                            209 
  :                            210 fp_divide1
  :                            211 	c	(fp192_divide)	right,,i
  :                            212 
  :                            213 	on	fp$r		. supernormalise 
  :                            214 	fa	$residue
  :                            215 	off	fp$r
  :                            216 	jdr	fp_divide1
  :                            217 
  :                            218 	j	fp_edit
  :                            219 
  :                            220 	$endif		. FP_SIMOPS or not
  :                            221 
00:005100 B60104              +222 fp_nop	j	fp_edit
00:005101 4FF004              +223 	ql	left+4		. no operation
00:005102 470008              +224 	qs	$residue	. return scanned number if any
00:005103 4FF000              +225 	ql	left
  :                            226 
  :                            227 fp_edit
  :                            228 	$if	1
  :                            229 
00:005104 50F011              +230 	lx	response_axw
00:005105 50A006              +231 	lx	descriptor:apdata, x
00:005106 FF0EB3              +232 	call	(wstream_start_net)
  :                            233 
  :                            234 	$else
  :                            235 
  :                            236 	z	BYTES
  :                            237 
  :                            238 	$endif
  :                            239 
00:005107 75004E              +240 	ii	FP_XPO$FLAG
00:005108 3E011C              +241 	lcal	fp_reactz
  :                            242 
  :                            243 	$if	FP_SIMDOPS
00:005109 4FF004              +244 	ql	left+4
00:00510A 470008              +245 	qs	$residue
00:00510B 4FF000              +246 	ql	left
00:00510C 0D0008              +247 	off	fp$r
  :                            248 	$endif
  :                            249 	
00:00510D FF0EC7              +250 	call	(floating_edit192)
  :                            251 
00:00510E 600EB9              +252 	la	("":10:0:0)
00:00510F 1D0018              +253 	wsr	24
  :                            254 	
00:005110 50F011              +255 	lx	response_axw
00:005111 600010              +256 	la	BYTES
00:005112 64C001              +257 	la, i	1, a
00:005113 20A003              +258 	sa	descriptor:bytes, x
  :                            259 
  :                            260 
00:005114 FF0EBA              +261 	call	(udp_acw_send)
  :                            262 
  :                            263 fp_release
(+01)0f
00:005115 50041A              +264 	lx	portcb			. port structure in scalar frame
00:005116 FF0EBB              +265 	call	(release_udgram)
(+01)0f
00:005117 68041A              +266 	lb	portcb			. port structure in scalar frame
00:005118 B600C6              +267 	j	fp_rx1
  :                            268 fp_no_traffic
  :                            269 fp_error
00:005119 54F012              +270 	lx, i	$$frame, sp
00:00511A 10000F              +271 	sx	sp
00:00511B 3D0000              +272 	fret	0
  :                            273 	$root
  :                            141: 	$include fp_react
  :                            1 
  :                            2 
  :                            3 fp_reactz
00:00511C 4F0EB4              +4 	ql	(-0.0)
00:00511D 470008              +5 	qs	$residue
00:00511E 350000              +6 	lret	0
  :                            7 
  :                            8 edit_prepend
00:00511F F80004              +9 	push	a
00:005120 600EC8              +10 	la	('* '*/8s)
00:005121 1D0010              +11 	wsr	16
00:005122 650002              +12 	la	2,,xi
00:005123 200010              +13 	sa	BYTES
00:005124 380004              +14 	pop	a
00:005125 350000              +15 	lret	0
  :                            16 
  :                            142 
  :                            143: 	$include telnet
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 .	$include	../fs/fs.def
  :                            41 
  :                            42 $(66::,x)
42:000000                     +43 lookfor_app	filep
42:000001                     +43 
42:000002                     +43 
42:000004                     +43 
  :                            44 
  :                            45 $(3)
03:000006 000000              +46 thandle	+	0
03:000007 FFFFFF              +47 tnetbound -	1
03:000008 FFFFFFFFFFFF        +48 tlsoc_va  -	1:d
03:00000A 000000              +49 telnet_tpaside	0
  :                            50 
                                tn_help		"commands are":HT:"h":HT:"help":LF:;
                                		HT:HT:"e":HT:"echo":LF:;
                                		HT:HT:"m":HT:"memory free":LF:;
                                		HT:HT:"stay":HT:"no timeout":LF:;
                                		HT:HT:"t":HT:"threads active":LF:;
                                		HT:HT:"a":HT:"applications and shells":LF:;
03:00000B 636F6D6D616E64732061726509680968656C700A09096509
                              +57 		HT:HT:"r":HT:"run ":ESC:"[91mname":ESC:"[0m":LF:
03:000013 6563686F0A09096D096D656D6F727920667265650A090973
                              +57 
03:00001B 746179096E6F2074696D656F75740A090974097468726561
                              +57 
03:000023 6473206163746976650A090961096170706C69636174696F
                              +57 
03:00002B 6E7320616E64207368656C6C730A0909720972756E201B5B
                              +57 
03:000033 39316D6E616D651B5B306D0A
                              +57 
  :                            58 
  :                            59 tn_help_bytes  $equ    $bits/$byte
  :                            60 
  :                            61 tn_editline	$res	24
  :                            62 telnet_istring
  :                            63 telnet_run_name	$res	160//3
  :                            64 telnet_repeats	$res	1
  :                            65 telnet_start_time $res	2
  :                            66 telnet_name_words $res	1
  :                            67 
  :                            68 $(0)
  :                            69 telnet_i
  :                            70 
  :                            71 .	lcal	span_mounts
  :                            72 
  :                            73 	$if	TELNET_THREADED
00:005126 4F0EC9              +74 	ql	(telnet_start,,,THREAD_FP(1):q)
00:005127 750047              +75 	ii	THREAD$
00:005128 C6012B              +76 	jza	telnet_zstart
(+03)10
00:005129 6D2621              +77 	lb	$3("*telnet":0),,xi
00:00512A 750049              +78 	ii	TAG$
  :                            79 telnet_zstart
00:00512B 3D0000              +80 	fret	0
  :                            81 
  :                            82 telnet_start
  :                            83 	$endif
  :                            84 
(+03)0f
00:00512C 700006              +85 	tz	thandle
00:00512D B6013B              +86 	j	telnet_tstate?
  :                            87 
00:00512E 600ECD              +88 	la	(IPPROTO_TCP*/16)
00:00512F FF0EAA              +89 	call	(__socket)
00:005130 E60162              +90 	jna	telnet_z
(+03)0f
00:005131 200006              +91 	sa	thandle
  :                            92 
00:005132 9F0ECE              +93 	c	(bind) a (23d),,long
00:005133 F80004              +93 
00:005134 FCF003              +93 
00:005135 FF0EAD              +93 
00:005136 38000F              +93 
  :                            94 
(+03)0f
00:005137 200007              +95 	sa	tnetbound
00:005138 E60162              +96 	jna	telnet_z
00:005139 CF000A              +97 	dl	10
(+03)0f
00:00513A C70008              +98 	ds	tlsoc_va
  :                            99 	
  :                            100 telnet_tstate?
(+03)0f
00:00513B 780007              +101 	tp	tnetbound	
00:00513C B60162              +102 	j	telnet_z
  :                            103 
  :                            104 
(+03)0f
00:00513D CF0008              +105 	dl	tlsoc_va
00:00513E 34002F              +106 	sabr	BSOCKET
00:00513F 500ED0              +107 	lx	(BSOCKET*/12)
00:005140 60D005              +108 	la	s:tcp:tbase, b
00:005141 34002F              +109 	sabr	BSOCKET
  :                            110 
  :                            111 .	lcal	$autorun:autorun
  :                            112 
  :                            113 telnet_walk_on
00:005142 500ED1              +114 	lx	(BSOCKET*/12++tlist:chain(1)+TPORTCHAIN(23))
  :                            115 
  :                            116 telnet_walk
00:005143 60A000              +117 	la	transmission:next
00:005144 C60160              +118 	jza	telnet_x
00:005145 500004              +119 	lx	a
00:005146 480ED2              +120 	lk	(00FFFF)
00:005147 650017              +121 	la, xi	23
00:005148 AFA007              +122 	mta	transmission:socket_address+1
00:005149 B60143              +123 	j	telnet_walk
  :                            124 
00:00514A 60A001              +125 	la	transmission:state
00:00514B A5003F              +126 	and, xi	63
00:00514C 680004              +127 	anu, xi	TCP_ESTABLISHED
00:00514D DD0005              +127 
00:00514E CE015A              +128 	jzb	telnet_traffic?
00:00514F 680004              +129 	anu, xi	TCP_SYNRECEIVED
00:005150 DD0004              +129 
00:005151 DE0155              +130 	jnzb	telnet_state?
  :                            131 
00:005152 FF0ED3              +132 	call	(xaccept)
00:005153 E60143              +133 	jna	telnet_walk	. could not accept
  :                            134 
00:005154 B60143              +135 	j	telnet_walk
  :                            136 
  :                            137 telnet_state?
00:005155 680004              +138 	anu, xi	TCP_CLOSEWAIT
00:005156 DD0008              +138 
00:005157 DE0143              +139 	jnzb	telnet_walk
00:005158 FF0ED4              +140 	call	(xdisco)
00:005159 B60142              +141 	j	telnet_walk_on
  :                            142 
  :                            143 telnet_traffic?
00:00515A 60A010              +144 	la	transmission:receiveq:head
00:00515B C60143              +145 	jza	telnet_walk
00:00515C FF0ED5              +146 	call	(subagent?)
00:00515D B60143              +147 	j	telnet_walk
00:00515E 3E0163              +148 	lcal	telnet_console
00:00515F B60143              +149 	j	telnet_walk
  :                            150 
  :                            151 telnet_x
00:005160 750041              +152 	ii	YIELD$
00:005161 B60142              +153 	j	telnet_walk_on
  :                            154 telnet_z
00:005162 3D0000              +155 	fret	0
  :                            156 
  :                            157 telnet_console
00:005163 3E0166              +158 	lcal	telnet_command
00:005164 FF0ED6              +159 	call	(tcp_release_rxline)
00:005165 350000              +160 	lret	0
  :                            161 
  :                            162 telnet_command
(+03)0f
00:005166 10000A              +163 	sx	telnet_tpaside
00:005167 58A010              +164 	ly	transmission:receiveq:head
  :                            165 
00:005168 60B003              +166 	la	descriptor:bytes, y
00:005169 68B006              +167 	lb	descriptor:apdata, y
00:00516A FF0EAF              +168 	call	(rstream_start_net)
  :                            169 
00:00516B 60800D              +170 	la	*q		. check text or something else
00:00516C A00ED7              +171 	and	(00F000)	. a configuration sequence?
00:00516D B00ED7              +172 	xor	(00F000)
  :                            173 
00:00516E C60262              +174 	jza	telnet_configure
  :                            175 
  :                            176 telnet_text_command
00:00516F 650006              +177 	la, xi	6		. input a command text word
00:005170 6D000A              +178 	lb, xi	10		. max 2 registers in size
00:005171 FF0ED8              +179 	call	(token_net)
  :                            180 
00:005172 CF000A              +181 	dl	10
  :                            182 
00:005173 680004              +183 	anu	('t'*/16:s)
00:005174 D80ED9              +183 
00:005175 CE01A1              +184 	jzb	telnet_threads
00:005176 680004              +185 	anu	('h'*/16:s)
00:005177 D80EDA              +185 
00:005178 CE01A8              +186 	jzb	telnet_help
  :                            187 
00:005179 680004              +188 	anu	('m'*/16:s)
00:00517A D80EDB              +188 
00:00517B CE01DD              +189 	jzb	telnet_memory
  :                            190 
00:00517C 680004              +191 	anu	('e'*/16:s)
00:00517D D80EDC              +191 
00:00517E CE01D8              +192 	jzb	telnet_echo
  :                            193 
00:00517F 680004              +194 	anu	('u'*/16:s)
00:005180 D80EDD              +194 
00:005181 CE01BC              +195 	jzb	telnet_library_speedtest
  :                            196 
00:005182 680004              +197 	anu	('q'*/16s)
00:005183 D80EDE              +197 
00:005184 CE01D4              +198 	jzb	telnet_quicktimeout	. a test
  :                            199 
00:005185 680004              +200 	anu	('r'*/16s)
00:005186 D80EDF              +200 
00:005187 CE01E9              +201 	jzb	telnet_run)
  :                            202 
00:005188 680004              +203 	anu	('z'*/16s)
00:005189 D80EE0              +203 
00:00518A CE0230              +204 	jzb	telnet_thread_term
  :                            205 
00:00518B 680004              +206 	anu	('iq'*/8s)
00:00518C D80EE1              +206 
00:00518D CE0236              +207 	jzb	telnet_ilist
  :                            208 
  :                            209 
00:00518E 680004              +210 	anu	("smp")
00:00518F D80EE2              +210 
00:005190 CE021C              +211 	jzb	telnet_smp
  :                            212 
00:005191 CF000A              +213 	dl	10
  :                            214 	
00:005192 DF0EE3              +215 	dan	("stay")
00:005193 7C01AE              +216 	jdz	telnet_zero_timer1
  :                            217 
00:005194 CF000A              +218 	dl	10
00:005195 DF0EE5              +219 	dan	("time")
00:005196 7C01B2              +220 	jdz	telnet_print_dayclock
  :                            221 
00:005197 CF000A              +222 	dl	10
00:005198 DF0EE7              +223 	dan	("ifsync")
00:005199 7C0214              +224 	jdz	telnet_align_trunk
  :                            225 
00:00519A CF000A              +226 	dl	10
00:00519B DF0EE9              +227 	dan	("ifswap")
00:00519C 7C0218              +228 	jdz	telnet_mirror_trunk
  :                            229 
00:00519D CF000A              +230 	dl	10
00:00519E 570EEB              +231 	dte	("tfree")
00:00519F B601AB              +232 	j	telnet_prompt
00:0051A0 B60222              +233 	j	telnet_free_tcp_port
  :                            234 
  :                            235 telnet_threads
(+03)10
00:0051A1 6D2624              +236 	lb, xi	$3("console threads display":10)
00:0051A2 650018              +237 	la	$bits/$byte,,xi
00:0051A3 F80002              +238 	push	x
00:0051A4 3E0263              +239 	lcal	telnet_respond
00:0051A5 3E0271              +240 	lcal	telnet_threadlist
00:0051A6 380002              +241 	pop	x
00:0051A7 350000              +242 	lret	0
  :                            243 
  :                            244 telnet_help
00:0051A8 650084              +245 	la, xi	tn_help_bytes
(+03)10
00:0051A9 6D000B              +246 	lb, xi	tn_help
00:0051AA B60263              +247 	j	telnet_respond
  :                            248 
  :                            249 telnet_prompt
(+03)10
00:0051AB 6D262C              +250 	lb, xi	$3("key h for command list":10)
00:0051AC 650017              +251 	la	$bits/$byte,,xi
00:0051AD B60263              +252 	j	telnet_respond
  :                            253 
  :                            254 telnet_zero_timer1
00:0051AE 30A004              +255 	z	transmission:timer(1)
(+03)10
00:0051AF 6D2634              +256 	lb, xi	$3("no timeout":10)	
00:0051B0 65000B              +257 	la	$bits/$byte,,xi
00:0051B1 B60263              +258 	j	telnet_respond
  :                            259 
  :                            260 telnet_print_dayclock
  :                            261 
  :                            262 	$if	0
  :                            263 
  :                            264 	c	(date_timef1)	0,,xi	tn_editline,,xi
  :                            265 	la	(10*/16)
  :                            266 	sa	tn_editline+7
  :                            267 	la	3*7+1,,xi
  :                            268 	lb	tn_editline,,xi
  :                            269 
  :                            270 
  :                            271 	$elseif	0
  :                            272 
  :                            273 	c	(date_timef2)	0,,xi	tn_editline,,xi
  :                            274 	la	(10*/16)
  :                            275 	sa	tn_editline+8
  :                            276 	la	3*8+1,,xi
  :                            277 	lb	tn_editline,,xi
  :                            278 
  :                            279 
  :                            280 	$elseif	1
  :                            281 
(+03)10
00:0051B2 FD0037              +282 	c	(date_timef3)	0,,xi	tn_editline,,xi
00:0051B3 FD0000              +282 
00:0051B4 FCF002              +282 
00:0051B5 FF0EED              +282 
00:0051B6 38000F              +282 
00:0051B7 600EB9              +283 	la	(10*/16)
(+03)0f
00:0051B8 20003F              +284 	sa	tn_editline+8
00:0051B9 650019              +285 	la	 3*8+1,,xi
(+03)10
00:0051BA 6D0037              +286 	lb	tn_editline,,xi
  :                            287 
  :                            288 	$else
  :                            289 
  :                            290 	call	(dayclock_ydsm_gmt)
                                	c	(__sprintf)	tn_editline,,xi			;
                                				$3("%d.%d:%d.%d":10:0),,xi	;
  :                            293 				8 9 10 11
  :                            294 
  :                            295 	lx	telnet_tpaside
  :                            296 	lb	tn_editline,,xi
  :                            297 	la	BYTES
  :                            298 	$endif
  :                            299 
00:0051BB B60263              +300 	j	telnet_respond
  :                            301 
  :                            302 telnet_library_speedtest
  :                            303 
00:0051BC FF0EEE              +304 	call	(iscan)
(+03)0f
00:0051BD 280085              +305 	sb	telnet_repeats
  :                            306 
00:0051BE CF0096              +307 	dl	DAYCLOCK$U
(+03)0f
00:0051BF C70086              +308 	ds	telnet_start_time
  :                            309 
  :                            310 telnet_test_repeat
(+03)10
00:0051C0 FD004F              +311 	lc	telnet_atest	telnet_istring,,xi
00:0051C1 FCF001              +311 
00:0051C2 3E02CA              +311 
00:0051C3 38000F              +311 
(+03)0f
00:0051C4 1F0085              +312 	dec	telnet_repeats
(+03)0f
00:0051C5 700085              +313 	tz	telnet_repeats
00:0051C6 B601C0              +314 	j	telnet_test_repeat
  :                            315 
00:0051C7 CF0096              +316 	dl	DAYCLOCK$U
(+03)0f
00:0051C8 DF0086              +317 	dan	telnet_start_time
  :                            318 
(+03)10
00:0051C9 FD004F              +319 	c	(__sprintf)	tn_editline,,xi	$3("%ld mS %s":10:0),,xi    a,,long	telnet_istring,,xi
00:0051CA 9F0004              +319 
(+03)10
00:0051CB FD2638              +319 
(+03)10
00:0051CC FD0037              +319 
00:0051CD FCF005              +319 
00:0051CE FF0EEF              +319 
00:0051CF 38000F              +319 
(+03)10
00:0051D0 6D0037              +320 	lb	tn_editline,,xi
00:0051D1 600010              +321 	la	BYTES
(+03)0f
00:0051D2 50000A              +322 	lx	telnet_tpaside
00:0051D3 B60263              +323 	j	telnet_respond
  :                            324 
  :                            325 telnet_quicktimeout
  :                            326 
  :                            327 	$if	1
00:0051D4 0FA001              +328 	n	transmission:state
  :                            329 	$else
  :                            330 
  :                            331 	la	DAYCLOCK$
  :                            332 	or	1,,xi		. elminate zero = timeout never
  :                            333 
  :                            334 telnet_nonzero
  :                            335 
  :                            336 	sa	transmission:timer(1)
  :                            337 	$endif
  :                            338 
(+03)10
00:0051D5 6D263C              +339 	lb, xi	$3("zero timeout":LF)
00:0051D6 65000D              +340 	la, xi	$bits/$byte
00:0051D7 B60263              +341 	j	telnet_respond
  :                            342 
  :                            343 telnet_echo
00:0051D8 60B003              +344 	la	descriptor:bytes, y
00:0051D9 68B006              +345 	lb	descriptor:apdata, y
00:0051DA FD4520              +346 	push	'E ',,xi
00:0051DB 38D000              +347 	pop	0, b	
00:0051DC B60266              +348 	j	telnet_stream16_respond
  :                            349 
  :                            350 telnet_memory
00:0051DD 750048              +351 	ii	TOTAL$FREE
(+03)10
00:0051DE FD0037              +352 	push,xi	tn_editline
00:0051DF 38000C              +353 	pop	p
00:0051E0 300010              +354 	z	BYTES
00:0051E1 FF0EF0              +355 	call	(iedit48ua)
00:0051E2 1D0010              +356 	wsr	16
00:0051E3 600010              +357 	la	BYTES
(+03)10
00:0051E4 6D0037              +358 	lb, xi	tn_editline
00:0051E5 3E026B              +359 	lcal	telnet_insert
(+03)10
00:0051E6 6D2641              +360 	lb,xi	$3(" words free":10)
  :                            361 
00:0051E7 65000C              +362 	la,xi	$bits/$byte
  :                            363 	
00:0051E8 B60263              +364 	j	telnet_respond
  :                            365 
  :                            366 telnet_run
00:0051E9 6500A0              +367 	la	160,,xi
(+03)10
00:0051EA 6D004F              +368 	lb	telnet_run_name,,xi
00:0051EB FF0ED8              +369 	call	(token_net)
  :                            370 
(+03)0f
00:0051EC 200088              +371 	sa	telnet_name_words
  :                            372 
(+03)0f
00:0051ED 60004F              +373 	la	telnet_run_name
00:0051EE 480EF1              +374 	lk	(255*/$word-$byte:s)
00:0051EF AF0EF2              +375 	mta	('/'*/$word-$byte:s)	. a script name?
00:0051F0 B601F7              +376 	j	telnet_run_binary	. no
(+03)10
00:0051F1 FD004F              +377 	c	(run_start)	telnet_run_name,,xi
00:0051F2 FCF001              +377 
00:0051F3 FF0EF3              +377 
00:0051F4 38000F              +377 
(+03)0f
00:0051F5 50000A              +378 	lx	telnet_tpaside		. recover the connection pointer
00:0051F6 350000              +379 	lret	0
  :                            380 
  :                            381 telnet_run_binary
(+03)0f
00:0051F7 600088              +382 	la	telnet_name_words
(+03)0f
00:0051F8 50000A              +383 	lx	telnet_tpaside		. pick up the connection
00:0051F9 50A010              +384 	lx	transmission:receiveq.head
00:0051FA 17A006              +385 	inc	descriptor:apdata, x	. drop 2 input bytes [ r SP ]
00:0051FB FDFFFE              +386 	push	-2,,xi
00:0051FC 2FA003              +387 	popA	descriptor:bytes, x
  :                            388 
(+03)10
00:0051FD FD004F              +389 	c	(online_xqt)	a	telnet_run_name,,xi
00:0051FE F80004              +389 
00:0051FF FCF002              +389 
00:005200 FF0EF4              +389 
00:005201 38000F              +389 
(+03)0f
00:005202 50000A              +390 	lx	telnet_tpaside
00:005203 C6020A              +391 	jza	telnet_norun
  :                            392 
00:005204 FF0EF5              +393 	call	(tnet_callstring)
(+03)0f
00:005205 50000A              +394 	lx	telnet_tpaside
  :                            395 
00:005206 3E020C              +396         lcal	telnet_run_report
00:005207 750071              +397 	ii	NET2SYM$
00:005208 FF0EF6              +398 	call	(subagent)
  :                            399 
00:005209 350000              +400 	lret	0			. stdin line -> call line in TCB	
  :                            401 					. input consumed, can drop
  :                            402 telnet_norun
00:00520A 3E020C              +403 	lcal	telnet_run_report
00:00520B 350000              +404 	lret	0
  :                            405 
  :                            406 telnet_run_report
(+03)0f
00:00520C 50000A              +407 	lx	telnet_tpaside
00:00520D F80004              +408 	push	a
00:00520E 3E027A              +409 	lcal	telnet_display_quartets
  :                            410 
00:00520F 650001              +411 	la	1,,xi
(+03)10
00:005210 6D2645              +412 	lb	$3("":10),,xi
  :                            413 
00:005211 3E0263              +414 	lcal	telnet_respond
00:005212 380004              +415 	pop	a
00:005213 350000              +416 	lret	0
  :                            417 
  :                            418 telnet_align_trunk
00:005214 3E0305              +419 	lcal	co_ordinate_platform
00:005215 550005              +420 	lx	5,,xi
00:005216 FF0EF7              +421 	call	(__ift2_align)
00:005217 B60232              +422 	j	telnet_zout
  :                            423 
  :                            424 telnet_mirror_trunk
00:005218 3E0305              +425 	lcal	co_ordinate_platform
00:005219 550005              +426 	lx	5,,xi
00:00521A FF0EF8              +427 	call	(__ift2_mirror)
00:00521B B60232              +428 	j	telnet_zout
  :                            429 
  :                            430 telnet_smp
00:00521C 3E0305              +431 	lcal	co_ordinate_platform
00:00521D FF0EF9              +432 	call	(scanhex)
00:00521E A5FFFE              +433 	and	-2,,xi
00:00521F 480004              +434 	lk	a
00:005220 75007E              +435 	ii	$SMP
00:005221 B60232              +436 	j	telnet_zout
  :                            437 					. stopgap until files auto-closed
  :                            438 telnet_free_tcp_port			. free a service listening port
00:005222 3E0305              +439 	lcal	co_ordinate_platform	. if server application did not
00:005223 FF0EEE              +440 	call	(iscan)
00:005224 36000F              +441 	dsl	8+7			. integer in b 7 port-id bits -> a
00:005225 9D001F              +442 	orB	31,,xi			. zone window ++ offset
00:005226 A5007F              +443 	and	127,,xi			. kernel tcp ports vector offset
00:005227 4E000C              +444 	rbr	12			
00:005228 952100              +445 	or	02000++256,,xi		. this a thread of ip process
00:005229 60C000              +446 	la	0, a			. read kernel vector ip port pages
00:00522A C60232              +447 	jza	telnet_zout		. already so free it isn't there?
00:00522B 34001F              +448 	sabr	31			. look in the page of port descriptors
00:00522C 8F0EA5              +449 	qpush	(0q)
00:00522D 87D000              +450 	qpop	s:socket_address	. suppress bound adresss fields b ->
00:00522E 30D004              +451 	z	s:flags			. and flags b ->
00:00522F B60232              +452 	j	telnet_zout		. no need to close window 31
  :                            453 
  :                            454 telnet_thread_term
00:005230 FF0EF9              +455 	call	(scanhex)
00:005231 75007C              +456 	ii	$ZETA
  :                            457 
  :                            458 telnet_zout
(+03)0f
00:005232 50000A              +459 	lx	telnet_tpaside
00:005233 650001              +460 	la	1,,xi
(+03)10
00:005234 6D2646              +461 	lb	$3(">":0:0),,xi
00:005235 B60263              +462 	j	telnet_respond
  :                            463 
  :                            464 telnet_ilist
00:005236 FF0EF9              +465 	call	(scanhex)
00:005237 C6025F              +466 	jza	telnet_thread_not_active
00:005238 750072              +467 	ii	THREAD$STATE
00:005239 B6025F              +468 	j	telnet_thread_not_active
  :                            469 
00:00523A 34001F              +470 	sabr	31
00:00523B 680EFA              +471 	lb	(31*/12++XINTT-01000)
  :                            472 
  :                            473 telnet_uireqs
00:00523C 50D001              +474 	lx	xitable:rcursor		. read cursor
00:00523D F80005              +475 	push	b
00:00523E F80002              +476 	push	x
  :                            477 
  :                            478 telnet_uirnext
00:00523F 800005              +479 	ax	b			. x += working address window
00:005240 CFA000              +480 	dl	0, x			. read table entry
  :                            481 
00:005241 C6025B              +482 	jza	telnet_uireqx		. entry used or not yet written
  :                            483 
00:005242 F80005              +484 	push	b
00:005243 FF0EFB              +485 	call	(display_quartets)
(+03)0f
00:005244 C70037              +486 	ds	tn_editline
00:005245 380004              +487 	pop	a
00:005246 FF0EFB              +488 	call	(display_quartets)
(+03)0f
00:005247 C70039              +489 	ds	tn_editline+2
  :                            490 
(+03)0f
00:005248 50000A              +491 	lx	telnet_tpaside
00:005249 65000C              +492 	la	12,,xi
(+03)10
00:00524A 6D0037              +493 	lb	tn_editline,,xi
00:00524B 3E026B              +494 	lcal	telnet_insert
  :                            495 
00:00524C 650001              +496 	la	1,,xi
(+03)10
00:00524D 6D2645              +497 	lb	$3("":10:0),,xi
00:00524E 3E0263              +498 	lcal	telnet_respond
  :                            499 
00:00524F 50F000              +500 	lx	0, sp			. retrieve table relative read cursor
00:005250 68F001              +501 	lb	1, sp			. retrieve table
  :                            502 
00:005251 40D003              +503 	lr	xitable:limit		. read table size
00:005252 850002              +504 	ax	2,,xi			. advance read cursor
00:005253 10F000              +505 	sx	0, sp
00:005254 F60259              +506 	jxge	telnet_ufirst		. jump to wrap
  :                            507 	
  :                            508 telnet_ulast?
00:005255 600002              +509 	la	x
00:005256 B0D002              +510 	xor	xitable:wcursor		. lapped the write pointer?
00:005257 C6025B              +511 	jza	telnet_uireqx		. yes
00:005258 B6023F              +512 	j	telnet_uirnext		. no
  :                            513 
  :                            514 telnet_ufirst
00:005259 550004              +515 	lx	4,,xi			. table relative 1st entry
00:00525A B60255              +516 	j	telnet_ulast?
  :                            517 
  :                            518 telnet_uireqx
00:00525B 38F000              +519 	pop	0, sp
00:00525C 38F000              +520 	pop	0, sp
(+03)0f
00:00525D 50000A              +521 	lx	telnet_tpaside
00:00525E 350000              +522 	lret	0
  :                            523 
  :                            524 telnet_thread_not_active
(+03)10
00:00525F 6D2647              +525 	lb	$3("thread not active":10),,xi
00:005260 650012              +526 	la	$bits/$byte,,xi
00:005261 B60263              +527 	j	telnet_respond
  :                            528 
  :                            529 telnet_configure
  :                            530 		. something received clearly not keyed text
  :                            531 		. it should include line mode
  :                            532 		. nothing much will happen if not
  :                            533 		. for the moment just lay the welcome mat
  :                            534 
00:005262 3E026E              +535 	lcal	telnet_configuration
  :                            536 
  :                            537 .	fall	thru	
  :                            538 
  :                            539 telnet_respond
  :                            540 .	sb	q
  :                            541 .	push,xi	05000++TCP_ACK++TCP_PSH
  :                            542 .	pop	SOCKET_CALL_FLAGS
  :                            543 
00:005263 4D5018              +544 	lk	05000++TCP_ACK++TCP_PSH,,xi
00:005264 FF0EFC              +545 	call	(tcp_tx)
00:005265 350000              +546 	lret	0
  :                            547 
  :                            548 telnet_stream16_respond
  :                            549 .	sb	q
00:005266 300014              +550 	z	RDATAC
00:005267 050020              +551 	on	b$stream16r
  :                            552 .	push	05000++TCP_ACK++TCP_PSH
  :                            553 .	pop	SOCKET_CALL_FLAGS
  :                            554 
00:005268 4D5018              +555 	lk	05000++TCP_ACK++TCP_PSH,,xi
00:005269 FF0EFD              +556 	call	(tcp_addx)
00:00526A 350000              +557 	lret	0
  :                            558 
  :                            559 telnet_insert
  :                            560 .	sb	q
  :                            561 .	push,xi 05000++TCP_ACK
  :                            562 .	pop	SOCKET_CALL_FLAGS
  :                            563 
00:00526B 4D5010              +564 	lk	05000++TCP_ACK,,xi
00:00526C FF0EFC              +565 	call	(tcp_tx)
00:00526D 350000              +566 	lret	0
  :                            567 
  :                            568 telnet_configuration
  :                            569 		. for the moment no analysis. just encourage
  :                            570 
(+03)10
00:00526E 6D264D              +571 	lb, xi	$3("RTA1 smaragd7 OS shared console":10)
00:00526F 650020              +572 	la, xi	$bits/$byte
00:005270 350000              +573 	lret	0
  :                            574 
  :                            575 
  :                            576 
  :                            577 telnet_threadlist
  :                            578 .	la	(' '*/$word-$byte)
  :                            579 .	sa	tn_editline+2
00:005271 051F00              +580 	on	+(see$7*/MANAGER_BANKS)-see$7
00:005272 40304A              +581 	lr	tdescriptor_high_index
00:005273 583049              +582 	ly	next_tdescriptor_sp
  :                            583 	
  :                            584 telnet_thread1
00:005274 FE0278              +585 	jyge	telnet_threadx
00:005275 3E02A6              +586 	lcal	telnet_thread_display
00:005276 8D0008              +587 	ay	TDESCRIPTOR_WORDS,,xi
00:005277 B60274              +588 	j	telnet_thread1
  :                            589 telnet_threadx	
00:005278 0D1F00              +590 	off	+(see$7*/MANAGER_BANKS)-see$7
00:005279 350000              +591 	lret	0
  :                            592 
  :                            593 telnet_pop2hex* $proc
  :                            594 	pop	a
  :                            595 	lcal	telnet_display_quartets
  :                            596 	$end
  :                            597 
  :                            598 telnet_display_quartets
00:00527A FF0EFB              +599 	call	(display_quartets)
(+03)0f
00:00527B C70037              +600 	ds	tn_editline
00:00527C 650007              +601 	la	7,,xi
(+03)10
00:00527D 6D0037              +602 	lb	tn_editline,,xi
00:00527E 3E026B              +603 	lcal	telnet_insert
00:00527F 350000              +604 	lret	0
  :                            605 
  :                            606 telnet_thread_name
00:005280 F80002              +607 	push	x			. connection
00:005281 780004              +608 	tp	a
00:005282 0F0004              +609 	n	a
00:005283 340020              +610 	sabr	32			. place thread control block
00:005284 500EFE              +611 	lx	(32*/12++TAG-4096)	. in file access space a moment
  :                            612 
00:005285 608EFF              +613 	la	*(32*/12++TDESCRIPTOR-01000)
00:005286 B00003              +614 	xor	y			. is TCB connected to descriptor?
00:005287 C6028C              +615 	jza	telnet_thread_name_clear	. yes fine
  :                            616 
00:005288 608F00              +617 	la	*(32*/12++TCB-TCB)	. is its information overwritten yet?
00:005289 B00F01              +618 	xor	('TCB')
00:00528A C6028C              +619 	jza	telnet_thread_name_clear
(+03)10
00:00528B 552658              +620 	lx	$3("[reused]":0:0:0:0),,xi	. nothing readable likely
  :                            621 
  :                            622 telnet_thread_name_clear
00:00528C 44A024              +623 	lr	36, x, i
00:00528D 4D00FF              +624 	lk	255,,xi
(+03)10
00:00528E 6D0037              +625 	lb	tn_editline,,xi
  :                            626 
  :                            627 telnet_name_display
00:00528F F60296              +628 	jxge	telnet_name_z
00:005290 60A000              +629 	la	0, x
00:005291 20D000              +630 	sa	0, b
00:005292 6CD001              +631 	lb	1, b, i
00:005293 850001              +632 	ax	1,,xi
00:005294 AF0F02              +633 	mta	(0)			. trailing zero in this name?
00:005295 B6028F              +634 	j	telnet_name_display
  :                            635 
  :                            636 telnet_name_z
(+03)10
00:005296 DD0037              +637 	anb	tn_editline,,xi		. words in this part
00:005297 45FFFD              +638 	lr	-3,,xi			. maximum zero bytes last word
  :                            639 
  :                            640 telnet_count
00:005298 660008              +641 	ral	$byte
00:005299 AF0F02              +642 	mtane	(0)
00:00529A B6029C              +642 
00:00529B B6029E              +643 	j	telnet_counted_name
00:00529C 170000              +644 	inc	r
00:00529D B60298              +645 	j	telnet_count
  :                            646 
  :                            647 telnet_counted_name
  :                            648 
00:00529E 600005              +649 	la	b
00:00529F C00000              +650 	aa	r
00:0052A0 2E0001              +651 	sbl	1
00:0052A1 C00005              +652 	aa	b			. 3 * words + bytes
(+03)10
00:0052A2 6D0037              +653 	lb	tn_editline,,xi
00:0052A3 380002              +654 	pop	x
00:0052A4 3E026B              +655 	lcal	telnet_insert
00:0052A5 350000              +656 	lret	0
  :                            657 
  :                            658 telnet_thread_display
  :                            659 
00:0052A6 F80003              +660 	push	y
00:0052A7 F80000              +661 	push	r
00:0052A8 50F004              +662 	lx	4, sp
00:0052A9 051F00              +663 	on	+(see$7*/MANAGER_BANKS)-see$7		. see kernel storage
  :                            664 
  :                            665 	$do	TDESCRIPTOR_WORDS**1,		push	TDESCRIPTOR_WORDS**-2, y
  :                            666 	$do	TDESCRIPTOR_WORDS**2^=0,	dpush	TDESCRIPTOR_WORDS**-4, y
00:0052AA 8FB004              +667 ?	$do	TDESCRIPTOR_WORDS/4,		qpush	+(TDESCRIPTOR_WORDS**-4)-?*4, y
00:0052AB 8FB000              +667 
  :                            668 
00:0052AC 0D1F00              +669 	off	+(see$7*/MANAGER_BANKS)-see$7		. see application storage
  :                            670 
00:0052AD 600F03              +671 	la	(' '*/$word-$byte)
(+03)0f
00:0052AE 200039              +672 	sa	tn_editline+2
  :                            673 
00:0052AF 380004              +674 	$do	TDESCRIPTOR_WORDS,	telnet_pop2hex
00:0052B0 3E027A              +674 
00:0052B1 380004              +674 
00:0052B2 3E027A              +674 
00:0052B3 380004              +674 
00:0052B4 3E027A              +674 
00:0052B5 380004              +674 
00:0052B6 3E027A              +674 
00:0052B7 380004              +674 
00:0052B8 3E027A              +674 
00:0052B9 380004              +674 
00:0052BA 3E027A              +674 
00:0052BB 380004              +674 
00:0052BC 3E027A              +674 
00:0052BD 380004              +674 
00:0052BE 3E027A              +674 
  :                            675 	
00:0052BF 051F00              +676 	on	+(see$7*/MANAGER_BANKS)-see$7
00:0052C0 58F001              +677 	ly	1, sp					. snoop in the
00:0052C1 60B003              +678 	la	3, y					. thread control block
00:0052C2 0D1F00              +679 	off	+(see$7*/MANAGER_BANKS)-see$7
00:0052C3 3E0280              +680 	lcal	telnet_thread_name
  :                            681 
(+03)10
00:0052C4 6D2645              +682 	lb	$3("":LF),,xi
00:0052C5 650001              +683 	la, xi	$bits/$byte
00:0052C6 3E0263              +684 	lcal	telnet_respond
00:0052C7 380000              +685 	pop	r
00:0052C8 380003              +686 	pop	y
00:0052C9 350000              +687 	lret	0
  :                            688 
                                telnet_atest $head_near	 params(tn_ostringp,	int	)	;
                                								;
                                			scalars(save_BYTES,	int,	BYTES	;
                                				save_q,		int,	q	;
                                				save_RDATACD,	long,	RDATAC	;
                                				tn_left,	float		;
                                				tn_right,	float		;
                                				tn_tight_repeat,int		;
00:0052CA F80010              +697 				tn_operation,	int		)
00:0052CB F8000D              +697 
00:0052CC 9F0014              +697 
00:0052CD 8F0EA5              +697 
00:0052CE 8F0EA5              +697 
00:0052CF FD0000              +697 
00:0052D0 FD0000              +697 
  :                            698 
00:0052D1 FF0EB0              +699 	call	(floating_scan)
00:0052D2 47F006              +700 	qs	tn_left
00:0052D3 FF0EB1              +701 	call	(symbol_scan)
00:0052D4 20F000              +702 	sa	tn_operation
00:0052D5 FF0EB0              +703 	call	(floating_scan)
00:0052D6 47F002              +704 	qs	tn_right
  :                            705 
00:0052D7 600013              +706 	la	LAST_BYTE_READ
00:0052D8 C5FFD4              +707 	aa	-',',,xi
00:0052D9 D602DE              +708 	jnza	tn_operate
00:0052DA FF0EEE              +709 	call	(iscan)
00:0052DB CE02DD              +710 	jzb	$+2
00:0052DC CDFFFF              +711 	ab	-1,,xi
00:0052DD 28F001              +712 	sb	tn_tight_repeat
  :                            713 	
  :                            714 tn_operate
00:0052DE 40F001              +715 	lr	tn_tight_repeat
00:0052DF 60F000              +716 	la	tn_operation
00:0052E0 C5FFD5              +717 	aa	-'+',,xi
00:0052E1 C602EA              +718 	jza	tn_add
00:0052E2 C5FFFE              +719 	aa	'+'-'-',,xi
00:0052E3 C602EE              +720 	jza	tn_negadd
00:0052E4 C50003              +721 	aa	'-'-'*',,xi
00:0052E5 C602F2              +722 	jza	tn_mul
00:0052E6 C5FFFB              +723 	aa	'*'-'/',,xi
00:0052E7 C602F6              +724 	jza	tn_div
00:0052E8 4FF006              +725 	ql	tn_left
00:0052E9 B602F9              +726 	j	tn_edit
  :                            727 
00:0052EA 4FF006              +728 tn_add	ql	tn_left
00:0052EB 67F002              +729 	fa	tn_right
00:0052EC 1E02EB              +730 	jdr	$-1
00:0052ED B602F9              +731 	j	tn_edit
  :                            732 
  :                            733 tn_negadd
00:0052EE 4FF006              +734 	ql	tn_left
00:0052EF 6FF002              +735 	fan	tn_right
00:0052F0 1E02EF              +736 	jdr	$-1
00:0052F1 B602F9              +737 	j	tn_edit
  :                            738 
00:0052F2 4FF006              +739 tn_mul	ql	tn_left
00:0052F3 77F002              +740 	fm	tn_right
00:0052F4 1E02F3              +741 	jdr	$-1
00:0052F5 B602F9              +742 	j	tn_edit
  :                            743 
00:0052F6 4FF006              +744 tn_div	ql	tn_left
00:0052F7 7FF002              +745 	fd	tn_right
00:0052F8 1E02F7              +746 	jdr	$-1
  :                            747 
00:0052F9 50F010              +748 tn_edit	lx	tn_ostringp
00:0052FA FF0F04              +749 	call	(wstream_starta)
00:0052FB FF0F05              +750 	call	(fedita)
00:0052FC 650000              +751 	la	0,,xi
00:0052FD 1D0018              +752 	wsr	24
  :                            753 
00:0052FE FCF00A              +754 	push	save_RDATACD,,i
00:0052FF 38000F              +755 	pop	sp
  :                            756 
00:005300 380014              +757 	dpop	RDATAC
00:005301 380015              +757 
  :                            758 
00:005302 38000D              +759 	pop	q
00:005303 380010              +760 	pop	BYTES
00:005304 350000              +761 	lret	0
  :                            762 
  :                            763 co_ordinate_platform
(+03)0f
00:005305 50000A              +764 	lx	telnet_tpaside
00:005306 60A010              +765 	la	transmission:receiveq:head
00:005307 68C002              +766 	lb	descriptor:i_f, a
00:005308 CDFFFE              +767 	ab	-2,,xi
00:005309 DE030C              +768 	jnzb	restricted
00:00530A CF000A              +769 	dl	10
00:00530B 350000              +770 	lret	0
  :                            771 
  :                            772 restricted
(+03)10
00:00530C 6D265C              +773 	lb	$3("platform keeper only":0),,xi
00:00530D 650015              +774 	la	$bits/8,,xi
00:00530E B60263              +775 	j	telnet_respond
  :                            776 
  :                            144: 	$include search_x
  :                            1 
  :                            2 	$if	1
  :                            3 
  :                            4 .	this doesn't need configuring with a file
  :                            5 .	it just walks the nvram iframes to the end of nvram
  :                            6 .	only one vector in kernel vector list is used, vpointer(17)
  :                            7 .	instead of reading vpointer(18...) from a file at startup
  :                            8 
  :                            9 search_onlinexqt
                                	$head_far	 params(search_name_words,	int	;
                                				search_run_namep,	int)	;
                                								;
                                			scalars(nextpx,			int	;
                                				startpx,		int	;	
00:00530F FD0000              +15 				ram_start,		int	)
00:005310 FD0000              +15 
00:005311 FD0000              +15 
  :                            16 
00:005312 04007C              +17 	inA	ram$threshold
00:005313 20F000              +18 	sa	ram_start
  :                            19 
00:005314 052000              +20 	on	see$2
00:005315 602910              +21 	la	vpointer(17)
00:005316 0D2000              +22 	off	see$2
  :                            23 
  :                            24 online_search_app
00:005317 340020              +25 	sabr	32			. load an iframe
00:005318 688F06              +26 	lb	*(32*/12++64)
00:005319 0E0012              +27 	sbr	18			. iframe page high index
00:00531A CCC001              +28 	ab	1, a, i			. point to next iframe
00:00531B C7F001              +29 	ds	startpx			. save this:next iframes
  :                            30 	
00:00531C 480F07              +31 	lk	(0FF00FFs)		. look for a mount pointer
  :                            32 
00:00531D 4F8F08              +33 	ql	*(32*/12++68)		. pointing to load gates directory
00:00531E AF0F09              +34 	mta	(MOUNT$,,3)		. each iframe must have one
00:00531F B60335              +35 	j	search_unbalanced	. unless the chain is ybroken
  :                            36 
00:005320 CF0006              +37 	dl	6			. it points to directory
00:005321 36000C              +38 	dsl	12			. application_templates
00:005322 9D0020              +39 	orB	32,,xi			. inside the embedded file system
00:005323 C0F001              +40 	aa	startpx			. inside the iframe
00:005324 340020              +41 	sabr	32			. construct a pointer to that
00:005325 4E000C              +42 	rbr	12			. in register b
00:005326 CFD002              +43 	dl	2, b			. and retrieve a read offset
00:005327 360006              +44 	dsl	6			. of objects in application_templates
  :                            45 	
                                	c	(qstart)	startpx			;
                                				a,,long			;
                                				search_name_words	;
00:005328 F8F007              +49 				search_run_namep
00:005329 F8F007              +49 
00:00532A 9F0004              +49 
00:00532B F8F005              +49 
00:00532C FCF005              +49 
00:00532D FF0F0A              +49 
00:00532E 38000F              +49 
  :                            50 
00:00532F D60336              +51 	jnza	online_run		. if it found and ran you get the process id
00:005330 50F002              +52 	lx	nextpx			. otherwise pull up the next iframe
00:005331 40F000              +53 	lr	ram_start		. and the ram start page index
00:005332 F60335              +54 	jxge	online_norun		. application not found in nvram pages
00:005333 600002              +55 	la	x			. not searched all of them:
00:005334 B60317              +56 	j	online_search_app	. next
  :                            57 	
  :                            58 search_unbalanced
  :                            59 online_norun
00:005335 650000              +60 	la	0,,xi
  :                            61 online_run
00:005336 FCF003              +62 	$ret
00:005337 38000F              +62 
00:005338 3D0000              +62 
  :                            63 
  :                            64 	$else
  :                            65 
  :                            66 search_onlinexqt
                                	$head_far	 params(search_name_words,	int	; 
                                				search_run_namep,	int)	;
                                								;
                                			scalars(online_devicep,	int,	vpointer(17),,xi	;
  :                            71 				startpx,		int	)
  :                            72 
  :                            73 online_search_app
  :                            74 	la	online_devicep
  :                            75 	on	see$2
  :                            76 	la	0, a
  :                            77 	off	see$2
  :                            78 	jna	online_norun	. at end of pointers?
  :                            79 	inc	online_devicep	. before incrementing
  :                            80 	jza	online_search_app . pointer cancelled. Look for more
  :                            81 
  :                            82 	sabr	32
  :                            83 	sa	startpx
  :                            84 	ql	*(32*/12++68)
  :                            85 	mta	(MOUNT$,,3)
  :                            86 	j	online_search_app
  :                            87 
  :                            88 	dl	6		. -> descriptor word offset application_templates
  :                            89 	dsl	12
  :                            90 	orB	32,,xi
  :                            91 	aa	startpx
  :                            92 	sabr	32
  :                            93 	rbr	12
  :                            94 	dl	2, b		. granule identifier directory block
  :                            95 	dsl	6		. -> word offset in device
  :                            96 
                                	c 	(qstart)	startpx					;
                                				a,,long					;
                                				search_name_words			;
  :                            100 				search_run_namep
  :                            101 
  :                            102 	jza	online_search_app		
  :                            103 	j	online_run	. end of search with process started
  :                            104 
  :                            105 online_norun
  :                            106 	la	0,,xi		. end of search with no hit
  :                            107 online_run
  :                            108 	$ret
  :                            109 
  :                            110 	$endif
  :                            145 .	$include span_rom
  :                            146: 	$include startups
  :                            1 $(66::,x)
42:000000                     +2 fspaxq	fileq
42:000001                     +2 
42:000002                     +2 
42:000004                     +2 
  :                            3 
  :                            4 $(1)
  :                            5 
01:00041B 000000000000        +6 startup_osocket_encoding	0L
  :                            7 
  :                            8 $(0)
  :                            9 
  :                            10 startups	$tree
  :                            11 
  :                            12 USTDOUT	$equ	18		. historic assignement message send
  :                            13 
  :                            14 	.	vector name initial_startups
  :                            15 
00:005339 4F0F0B              +16 initial	ql	(read_startups, 1, 0, THREAD_FP(1)q)
00:00533A 750047              +17 	ii	THREAD$
00:00533B C6033E              +18 	jza	startupz
(+03)10
00:00533C 6D2663              +19 	lb	$3("initial startups":0),,xi
00:00533D 750049              +20 	ii	TAG$
  :                            21 
  :                            22 startupz
00:00533E 3D0000              +23 	fret	0
  :                            24 
  :                            25 read_startups
                                	$head_near	scalars(socko,		int		;
00:00533F FD0000              +27 				config_retry,	int,	40,,xi	)
00:005340 FD0028              +27 
  :                            28 
00:005341 600EA9              +29 	la	(IPPROTO_UDP*/16)
00:005342 FF0EAA              +30 	call	(__socket)
00:005343 E6036B              +31 	jna	no_stdout
00:005344 20F001              +32 	sa	socko
00:005345 9F0F0F              +33 	c	(bind)	a	(0L),,long
00:005346 F80004              +33 
00:005347 FCF003              +33 
00:005348 FF0EAD              +33 
00:005349 38000F              +33 
00:00534A E6036B              +34 	jna	no_stdout
00:00534B 60F001              +35 	la	socko
00:00534C 750055              +36 	ii	READ_SOCKET$
(+01)0f
00:00534D C7041B              +37 	ds	startup_osocket_encoding
00:00534E CF000A              +38 	dl	10
00:00534F 34002F              +39 	sabr	BSOCKET
00:005350 580005              +40 	ly	b
00:005351 CF0F11              +41 	dl	($net_socket	255.255.255.255:USTDOUT)
00:005352 C7B002              +42 	ds	sbind:remote_address, y
  :                            43 					. leave an extra gap for ifconfig
00:005353 750041              +44 config?	ii	YIELD$			. there should have been one already
00:005354 4F0F13              +45 	ql	(00FFFF00FFFFq)
00:005355 FF0F17              +46 	call	(__route)
00:005356 700002              +47 	tnz	x
00:005357 B60359              +47 
00:005358 B6036B              +48 	j	no_stdout		. hopeless and theoretically impossible
00:005359 CFA007              +49 	dl	ro:next_hop
00:00535A 78A002              +50 	tn	ro:i_f			. that's the gateway
00:00535B B6035D              +50 
00:00535C B60361              +51 	j	local_address
  :                            52 
00:00535D 1FF000              +53 	dec	config_retry
00:00535E 70F000              +54 	tz	config_retry
00:00535F B60353              +55 	j	config?
  :                            56 
00:005360 CF0F18              +57 	dl	(00AC1D000707)		. configuration hasn't run
  :                            58 					. or doesn't have a broadcast route
  :                            59 local_address
00:005361 58000B              +60 	ly	11
00:005362 2E0008              +61 	sbl	8
00:005363 360008              +62 	dsl	8
00:005364 480ED2              +63 	lk	(00FFFF)
00:005365 BFB001              +64 	mlb	sbind:socket_address+1, y
00:005366 C7B000              +65 	ds	sbind:socket_address, y
  :                            66 
(+03)10
00:005367 FD2669              +67 	c	(run_start)	$3("/initial/script":0),,xi
00:005368 FCF001              +67 
00:005369 FF0EF3              +67 
00:00536A 38000F              +67 
  :                            68 
  :                            69 no_stdout
00:00536B FCF002              +70 	$ret
00:00536C 38000F              +70 
00:00536D 350000              +70 
  :                            71 
  :                            72 .       read consective text lines from the text file at script path
  :                            73 .	scripts may be nested. A new script name in the text starts /path
  :                            74 .	other text lines are application names + optional following lines of stdin
  :                            75 
  :                            76 .	first stdin line to an application is its own command line
  :                            77 .	no command except application names and nested /script_path is expected
  :                            78 .	but stdin text may be commands to applications like shells
  :                            79 
  :                            80 .	script execution is sequential to make proper sense
  :                            81 .	waiting for each started process to finish before reading more text
  :                            82 .	but you can call run_start from multiple simultaneous threads
  :                            83 
                                run	$head_far	 params(script_path,	int	)	;
                                								;
                                			scalars(file_position,	long		;
                                				siobloc,	int		;
00:00536E 9F0F0F              +88 				zdepth,		int		)
00:00536F FD0000              +88 
00:005370 FD0000              +88 
  :                            89 
00:005371 F8F007              +90 	c	(fspath)	script_path
00:005372 FCF001              +90 
00:005373 FF0F1A              +90 
00:005374 38000F              +90 
00:005375 C60389              +91 	jza	no_run
00:005376 C7F002              +92 	ds	file_position
  :                            93 
00:005377 F80F1B              +94 	c	(fileshare_assign)	(FS$DEVICE$ARRAY,,7s))
00:005378 FCF001              +94 
00:005379 FF0F1C              +94 
00:00537A 38000F              +94 
00:00537B 700002              +95 	tnz	x
00:00537C B6037E              +95 
00:00537D B60389              +96 	j	no_run
  :                            97 
00:00537E 30A006              +98 	z	fspaxq:o:column
00:00537F 10F001              +99 	sx	siobloc
00:005380 9FF002              +100 	lc	runfile_scan	zdepth   x   file_position,,long
00:005381 F80002              +100 
00:005382 F8F003              +100 
00:005383 FCF004              +100 
00:005384 3E038C              +100 
00:005385 38000F              +100 
  :                            101 
00:005386 50F001              +102 	lx	siobloc		 . free shared open file state bloc
00:005387 650007              +103 	la	7,,xi
00:005388 20A000              +104 	sa	0, x
  :                            105 
00:005389 FCF004              +106 no_run	$ret
00:00538A 38000F              +106 
00:00538B 3D0000              +106 
  :                            107 
                                runfile_scan $head_near	 params(depth,		int		;
                                				share_iobloc,	int		;
                                				fposition,	long	)	;
                                								;
                                			scalars(save_fspp,	8,	0, x)	;
                                								;
                                			 xframe(search_name,	80		;
00:00538C 8FA004              +115 				text,		80		)
00:00538D 8FA000              +115 
00:00538E FDFF60              +115 
00:00538F 2F000E              +115 
  :                            116 
00:005390 17F00A              +117 	inc	depth
00:005391 50F00A              +118 	lx	depth
00:005392 450004              +119 	lr	4,,xi
00:005393 F603CA              +120 	jxge	runfile_breakpoint	. 3 nested scripts are plenty
  :                            121 	
00:005394 50F00B              +122 	lx	share_iobloc
00:005395 30A006              +123 	z	fspaxq:o:column
00:005396 9FF00C              +124 	c	(fs24_open)	share_iobloc	fposition,,long
00:005397 F8F00D              +124 
00:005398 FCF003              +124 
00:005399 FF0F1D              +124 
00:00539A 38000F              +124 
  :                            125 
  :                            126 read_script
00:00539B FF0F1E              +127 	call	(fileshare_space_open)
  :                            128 
  :                            129 .	c	(fs24_snoop)	share_iobloc	text,,i	80,,xi
00:00539C FD00F0              +130 	c	(fgets_datafile)	share_iobloc	text,,i	80*3,,xi
00:00539D FCE050              +130 
00:00539E F8F00D              +130 
00:00539F FCF003              +130 
00:0053A0 FF0F1F              +130 
00:0053A1 38000F              +130 
  :                            131 
00:0053A2 E603CA              +132 	jna	runfile_breakpoint
00:0053A3 C603CA              +133 	jza	runfile_breakpoint
  :                            134 
00:0053A4 160018              +135 	dsr	24
00:0053A5 1D0018              +136 	wsr	24
  :                            137 
  :                            138 .	call	(fileshare_space_open)
  :                            139 .	lx	share_iobloc		. get non-snoop read position in open file
  :                            140 					. then pull the string left over whitespace
  :                            141 
00:0053A6 FD0000              +142 	c	(normal_string)   search_name,,i   text,,i   80*3-3,,xi	0,,xi	. fspaxq:o:column
00:0053A7 FD00ED              +142 
00:0053A8 FCE050              +142 
00:0053A9 FCE000              +142 
00:0053AA FCF004              +142 
00:0053AB FF0F20              +142 
00:0053AC 38000F              +142 
  :                            143 
00:0053AD C6039B              +144 	jza	read_script		. blank line read past it
  :                            145 
00:0053AE 400004              +146 	lr	a			. save containing words of extracted token
  :                            147 
00:0053AF 60E000              +148 	la	search_name
00:0053B0 480EF1              +149 	lk	(255*/$word-$byte:s)
00:0053B1 AF0EF2              +150 	mta	('/'*/$word-$byte:s)	. a nested path?
00:0053B2 B603C1              +151 	j	text_command		. no
  :                            152 
  :                            153 					. now consume the snooped text
  :                            154 .	c	(fgets_datafile)   share_iobloc   text,,i   80*3,,xi
  :                            155 .	dsr	24
  :                            156 .	wsr	24			. push last bytes thru WDATA
  :                            157 					. staging register
00:0053B3 FF0F1E              +158 	call	(fileshare_space_open)
00:0053B4 FCE050              +159 	c	(fspath)	text,,i
00:0053B5 FCF001              +159 
00:0053B6 FF0F1A              +159 
00:0053B7 38000F              +159 
00:0053B8 C6039B              +160 	jza	read_script		. skip silently if you can't find it
  :                            161 
00:0053B9 50F00B              +162 	lx	share_iobloc
00:0053BA 9F0004              +163 	lc	runfile_scan	depth   x   a,,long
00:0053BB F80002              +163 
00:0053BC F8F00D              +163 
00:0053BD FCF004              +163 
00:0053BE 3E038C              +163 
00:0053BF 38000F              +163 
  :                            164 					. recurse within limits
00:0053C0 B6039B              +165 	j	read_script
  :                            166 
  :                            167 text_command
  :                            168 
00:0053C1 50F00B              +169 	lx	share_iobloc
  :                            170 
  :                            171 	$if	0
  :                            172 	dl	fspaxq:serialp:absolute_pointer	. mark file position
  :                            173 	ds	fposition			. in case it doesn't move
  :                            174 	$endif
  :                            175 
00:0053C2 FCE050              +176 	lc	action_command	  x	r	search_name,,i	text,,i
00:0053C3 FCE000              +176 
00:0053C4 F80000              +176 
00:0053C5 F80002              +176 
00:0053C6 FCF004              +176 
00:0053C7 3E03D1              +176 
00:0053C8 38000F              +176 
  :                            177 
  :                            178 	$if	0
  :                            179 	lx	share_iobloc
  :                            180 	dl	fspaxq:serialp:absolute_pointer
  :                            181 	dan	fposition
  :                            182 	jdz	text_skip		. so lazy he never read his own name
  :                            183 	j	read_script
  :                            184 
  :                            185 text_skip
  :                            186 	c	(fgets_datafile)	share_iobloc   text,,i	80*3-3,,xi
  :                            187 	$endif
  :                            188 
00:0053C9 B6039B              +189 	j	read_script
  :                            190 
  :                            191 runfile_breakpoint
00:0053CA 50F00B              +192 	lx	share_iobloc
00:0053CB FF0F1E              +193 	call	(fileshare_space_open)
00:0053CC 87A000              +194 	qpop	0, x
00:0053CD 87A004              +195 	qpop	4, x			. retrieve the previous file open state
00:0053CE FDFF60              +196 	push	-80*2,,xi		. clear external stack
00:0053CF 2F000E              +197 	popA	fp
00:0053D0 350000              +198 	lret	0
  :                            199 
  :                            200 
                                action_command	 $head_near	 params(share_ioblocp,	int	;
                                					textw,		int	;
                                					searchp,	int	;
                                					textp,		int)	;
                                								;
00:0053D1 FD0000              +206 				scalars(new_process,	int	)
  :                            207 
00:0053D2 F8F005              +208 	c	(online_xqt)	textw	searchp
00:0053D3 F8F005              +208 
00:0053D4 FCF002              +208 
00:0053D5 FF0EF4              +208 
00:0053D6 38000F              +208 
  :                            209 
00:0053D7 C603EC              +210 	jza	action_skip
00:0053D8 E603EC              +211 	jna	action_skip
00:0053D9 20F000              +212 	sa	new_process
  :                            213 
00:0053DA 340020              +214 	sabr	32				. start with the new thread control block
00:0053DB 58F006              +215 	ly	textp
00:0053DC FF0F21              +216 	call	(forward_callstring)		. called app name + arguments
00:0053DD 608F22              +217 	la	*(32*/12++ABT+2-01000)		. progress to his vector list
00:0053DE 340020              +218 	sabr	32
00:0053DF 600F23              +219 	la	(3*/16)
00:0053E0 68F003              +220 	lb	share_ioblocp			. hand over the shared file open state
00:0053E1 C78F24              +221 	ds	*(32*/12++handle(1)-02000)	. as his stdin
  :                            222 
00:0053E2 750059              +223 	ii	KERNEL$B1_1			. into kernel 1st B1 block
(+01)0f
00:0053E3 CF041B              +224 	dl	startup_osocket_encoding	. hand over UDP broacast socket encoding
00:0053E4 750058              +225 	ii	B1$				. back to application actual B1 block
00:0053E5 C78F25              +226 	ds	*(32*/12++handle(2)-02000)	. as his stdout
00:0053E6 C78F26              +227 	ds	*(32*/12++handle(3)-02000)	. and his stderr
  :                            228 
00:0053E7 60F000              +229 	la	new_process
  :                            230 action_running?
00:0053E8 750041              +231 	ii	YIELD$
00:0053E9 750072              +232 	ii	THREAD$STATE
00:0053EA B603EC              +233 	j	action_concluded		
00:0053EB B603E8              +234 	j	action_running?
  :                            235 
  :                            236 action_concluded
  :                            237 action_skip
00:0053EC FCF001              +238 	$ret
00:0053ED 38000F              +238 
00:0053EE 350000              +238 
  :                            239 
  :                            240 	$endif
  :                            241 
  :                            242 	$root
  :                            147: 	$include normal_s
  :                            1 .	vector_name	normal_string
  :                            2 .	align a string skipping whitespace
  :                            3 
  :                            4 normal_s $tree
                                	$head_far	 params(to,	int		;
                                				from,	int		;
                                				chars,	int		;
  :                            8 				offset,	int		)
  :                            9 
00:0053EF 68F004              +10 	lb	from
00:0053F0 FF0F27              +11 	call	(rstream_starta)
  :                            12 
00:0053F1 50F006              +13 	lx	offset		. columns aready read from 1st word
00:0053F2 450003              +14 	lr	$word/$byte,,xi	. drop the request if column is out of range
00:0053F3 F603F8              +15 	jxge	clear_end
00:0053F4 97A3F9              +16 	ex	align1, x
  :                            17 
00:0053F5 60F005              +18 	la	chars		. maximum output columns
00:0053F6 68F003              +19 	lb	to		. input is zero-terminated whitespace skipped
00:0053F7 FF0ED8              +20 	call	(tokena)
  :                            21 
  :                            22 clear_end
  :                            23 
00:0053F8 3D0000              +24 	$ret
  :                            25 
  :                            26 align1
00:0053F9 150000              +27 ?	$do	$word/$byte,	rsr	?*$byte-$byte
00:0053FA 150008              +27 
00:0053FB 150010              +27 
  :                            28 
  :                            29 	$root
  :                            30 
  :                            148 
  :                            149 	$list	5
  :                            150 
  :                            151: 	$include http.msm
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 HTTP_USER $equ	1		. there may be a second web pages tree
  :                            41 				. for the customer
  :                            42 HTTP_PORT $equ	80
  :                            43 
  :                            44 	$if	0		. moved to ascii.def
  :                            45 CR	$equ	0d
  :                            46 LF	$equ	0a
  :                            47 HT	$equ	09
  :                            48 	$endif
  :                            49 
  :                            50 $(67::,y)
43:000000                     +51 fs_lookup	$filetag
43:000001                     +51 
43:000002                     +51 
43:000004                     +51 
43:000006                     +51 
43:000007                     +51 
  :                            52 
  :                            53 $(3)
03:000089 000000              +54 http_s	+	0
03:00008A FFFFFF              +55 http_bound -	1
03:00008B FFFFFFFFFFFF        +56 http_sla   -	1:d
  :                            57 
03:00008D FFFFFFFFFFFF        +58 fs24_sla   -	1:d
  :                            59 . fs24_cursor -	1:d
  :                            60 
  :                            61 . http_file_octets
  :                            62 .	+	0:d
  :                            63 
  :                            64 	$if	HTTP_USER
03:00008F FFFFFFFFFFFF        +65 fs24_sla2  -	1:d
  :                            66 	$endif
  :                            67 
03:000091 000001              +68 http_threads	1
  :                            69 
  :                            70 http_formation1
                                	"HTTP/1.1 200 OK":CR:LF:;
                                	"Content-Type: text/html; charset=UTF-8":CR:LF:;
03:000092 485454502F312E3120323030204F4B0D0A436F6E74656E74
                              +73 	"Content-Length: "
03:00009A 2D547970653A20746578742F68746D6C3B20636861727365
                              +73 
03:0000A2 743D5554462D380D0A436F6E74656E742D4C656E6774683A
                              +73 
03:0000AA 200000              +73 
  :                            74 http_formation1_length $equ	$bits/$byte
  :                            75 http_formation2
03:0000AB 000000              +76 	$do	8,	+	0
03:0000AC 000000              +76 
03:0000AD 000000              +76 
03:0000AE 000000              +76 
03:0000AF 000000              +76 
03:0000B0 000000              +76 
03:0000B1 000000              +76 
03:0000B2 000000              +76 
  :                            77 
  :                            78 http_listening_transmission
03:0000B3 000000              +79 	+	0
  :                            80 . http_name_buffer
  :                            81 	$res	84/3
  :                            82 
  :                            83 $(0)
  :                            84 http_serve
  :                            85 
  :                            86 	$if	HTTP_THREADED
  :                            87 
00:0053FC 4F0F28              +88 	ql	(http_thread,,,:q)
00:0053FD 750047              +89 	ii	THREAD$
  :                            90 
00:0053FE C60401              +91 	jza	http_zstart
(+03)10
00:0053FF 6D266F              +92 	lb	$3("*http"),,xi
00:005400 750049              +93 	ii	TAG$
  :                            94 
  :                            95 http_zstart
00:005401 3D0000              +96 	fret	0
  :                            97 
  :                            98 http_thread
  :                            99 	$endif
  :                            100 
(+03)0f
00:005402 700089              +101 	tz	http_s
00:005403 B6041B              +102 	j	http_bound?
00:005404 600ECD              +103 	la	(IPPROTO_TCP*/16)
00:005405 FF0EAA              +104 	call	(__socket)
00:005406 E6043F              +105 	jna	http_zserve
(+03)0f
00:005407 200089              +106 	sa	http_s
  :                            107 
00:005408 9F0F2C              +108 	c	(bind) a (HTTP_PORT:d),,long
00:005409 F80004              +108 
00:00540A FCF003              +108 
00:00540B FF0EAD              +108 
00:00540C 38000F              +108 
  :                            109 
  :                            110 .	lb	(HTTP_PORT)
  :                            111 .	sb	7
  :                            112 .	z	6
  :                            113 .	call	(bind)
  :                            114 
(+03)0f
00:00540D 20008A              +115 	sa	http_bound
00:00540E E6043F              +116 	jna	http_zserve
00:00540F CF000A              +117 	dl	10
(+03)0f
00:005410 C7008B              +118 	ds	http_sla
  :                            119 
00:005411 450001              +120 	lr, xi	1
(+01)10
00:005412 5D05ED              +121 	ly, xi	$1("web")
00:005413 160030              +122 	dsr	48
00:005414 FF0F2E              +123 	call	(fs_find)
(+03)0f
00:005415 C7008D              +124 	ds	fs24_sla
  :                            125 
  :                            126 	$if	HTTP_USER
00:005416 450002              +127 	lr	2,,xi
(+01)10
00:005417 5D05EE              +128 	ly, xi	$1("web2")
00:005418 160030              +129 	dsr	48
00:005419 FF0F2E              +130 	call	(fs_find)
(+03)0f
00:00541A C7008F              +131 	ds	fs24_sla2
  :                            132 	$endif
  :                            133 
  :                            134 http_bound?
(+03)0f
00:00541B 78008A              +135 	tp	http_bound
00:00541C B6043F              +136 	j	http_zserve
  :                            137 
(+03)0f
00:00541D CF008B              +138 	dl	http_sla
00:00541E 34002F              +139 	sabr	BSOCKET
00:00541F 60D005              +140 	la	s:tcp:tbase
00:005420 34002F              +141 	sabr	BSOCKET
  :                            142 
  :                            143 .	call	(tcp_hash_localsocket)
  :                            144 
  :                            145 http_walk_q
00:005421 500F2F              +146 	lx	(BSOCKET*/12++tlist:chain(1)+TPORTCHAIN(HTTP_PORT))
  :                            147 
(+03)0f
00:005422 1000B3              +148 	sx	http_listening_transmission
  :                            149 
  :                            150 
  :                            151 http_walk
00:005423 50A000              +152 	lx	transmission:next
00:005424 700002              +153 	tz	x
00:005425 B60427              +154 	j	$+2
00:005426 B6043D              +155 	j	http_xserve
  :                            156 
00:005427 600F30              +157 	la	(HTTP_PORT)
00:005428 480ED2              +158 	lk	(00FFFF)
00:005429 AFA007              +159 	mta	transmission:socket_address+1
00:00542A B60423              +160 	j	http_walk
  :                            161 
(+03)0f
00:00542B 1000B3              +162 	sx	http_listening_transmission
  :                            163 
00:00542C 60A001              +164 	la	transmission:state
00:00542D C5FFFB              +165 	aa, xi	-TCP_ESTABLISHED
00:00542E C60433              +166 	jza	http_traffic?
00:00542F C50001              +167 	aa	TCP_ESTABLISHED-TCP_SYNRECEIVED,,xi
00:005430 D60438              +168 	jnza	http_remote_close?
00:005431 FF0ED3              +169 	call	(xaccept)
00:005432 B60423              +170 	j	http_walk		. next
  :                            171 
  :                            172 http_traffic?
00:005433 FF0F31              +173 	call	(tcpr)			. a message of some sort? 
00:005434 C60423              +174 	jza	http_walk		. far call to read segment queue
  :                            175 
00:005435 10C007              +176 	sx	descriptor:tcbloc, a
  :                            177 
  :                            178 	$if	0			. nothing gained by more threads
  :                            179 	sa	6			. parameter
  :                            180 	z	7
  :                            181 .	ql	(http_request_thread,,,:q)
  :                            182 	dl	(http_request_thread,:d)
  :                            183 				. assign the connection as parameter
  :                            184 	ii	THREAD$
  :                            185 	jnza	http_walk		. thread started
  :                            186 	$endif
  :                            187 
  :                            188 					. thread not started but message read accepted
00:005436 3E0440              +189 	lcal	http_request_thread	. serve request in this thread
00:005437 B60423              +190 	j	http_walk		. if connection not really established
  :                            191 					. the call will return without action
  :                            192 http_remote_close?
00:005438 C5FFFC              +193 	aa, xi	TCP_SYNRECEIVED-TCP_CLOSEWAIT
00:005439 D60423              +194 	jnza	http_walk
00:00543A FF0ED4              +195 	call	(xdisco)
00:00543B 750041              +196 	ii	YIELD$			. in case TCP servicing needed
00:00543C B60421              +197 	j	http_walk_q		. start at the list start
  :                            198 					. after you have done this
  :                            199 http_xserve
  :                            200         $if     HTTP_THREADED
  :                            201 	$if	1
00:00543D 750041              +202 	ii	YIELD$
  :                            203 	$else
  :                            204 	dl	(10d)
  :                            205         ii      TWAIT$
  :                            206 	$endif
00:00543E B60421              +207         j       http_walk_q
  :                            208         $endif
  :                            209 http_zserve
00:00543F 3D0000              +210         fret    0
  :                            211 
  :                            212 
                                http_request_thread $head_near	scalars(http_thread_request, 	int, a		;
                                					http_thread_transmission, int, descriptor:tcbloc, a	;
                                					fs24_cursor,		long		;
                                					http_file_octets,	long		;	
00:005440 F80004              +217 					http_target_name, 	72//3		)
00:005441 F8C007              +217 
00:005442 9F0F0F              +217 
00:005443 9F0F0F              +217 
00:005444 8F0EA5              +217 
00:005445 8FF000              +217 
00:005446 8FF000              +217 
00:005447 8FF000              +217 
00:005448 8FF000              +217 
00:005449 8FF000              +217 
  :                            218 
  :                            219 
(+03)0f
00:00544A 170091              +220 	inc	http_threads
  :                            221 .	lx	desciptor:tcbloc, a
  :                            222 .	sx	http_thread_transmission
  :                            223 
00:00544B 5CF000              +224 	ly	http_target_name,,i
00:00544C 3E04A2              +225 	lcal	http_get_what
  :                            226 
(+03)0f
00:00544D CF008D              +227 	dl	fs24_sla		. fs descriptor from
  :                            228 
  :                            229 	$if	HTTP_USER
00:00544E C60451              +230 	jza	http_search2
  :                            231 	$else
  :                            232 	jza	http_drop_request	. global initialisation
  :                            233 	$endif
  :                            234 
00:00544F FF0F32              +235 	call	(fs_dsearch)
00:005450 D6045C              +236 	jnza	http_located
  :                            237 
  :                            238 	$if	HTTP_USER
  :                            239 http_search2
(+03)0f
00:005451 CF008F              +240 	dl	fs24_sla2		. user pages directory
00:005452 C60497              +241 	jza	http_drop_request
00:005453 FF0F32              +242 	call	(fs_dsearch)
00:005454 D6045C              +243 	jnza	http_located
(+03)0f
00:005455 CF008D              +244 	dl	fs24_sla		. need to ask a second time
00:005456 C60497              +245 	jza	http_drop_request
  :                            246 	$endif
  :                            247 
(+01)10
00:005457 5D05F0              +248 	ly, xi	$1("index.html")
00:005458 450004              +249 	lr, xi	4
  :                            250 
(+03)0f
00:005459 CF008D              +251 	dl	fs24_sla
00:00545A FF0F32              +252 	call	(fs_dsearch)
00:00545B C60497              +253 	jza	http_drop_request	. if you can't find the default page
  :                            254 					. something's wrong with the fs
  :                            255 http_located
00:00545C C7F01A              +256 	ds	fs24_cursor		. fs_dsearch returned fs_lookup in b
  :                            257 					. although it's typed as ,y
  :                            258 
  :                            259 .	dpush	fs_lookup:quanta, b
  :                            260 
  :                            261 	$if	1
(+03)10
00:00545D 6D0092              +262 	lb	http_formation1,,xi
00:00545E 4D5010              +263 	lk	05010,,xi
00:00545F 650049              +264 	la	http_formation1_length,,xi
  :                            265 	$else
  :                            266 
  :                            267 	push,xi	http_formation1
  :                            268 	pop	q
  :                            269 	la, xi	http_formation1_length
  :                            270 
  :                            271 	push,xi	05010
  :                            272 	pop	SOCKET_CALL_FLAGS
  :                            273 	$endif
  :                            274 
00:005460 50F01C              +275 	lx	http_thread_transmission
00:005461 FF0EFC              +276 	call	(tcp_tx)
00:005462 E6049C              +277 	jna	http_hangup
  :                            278 
00:005463 58F01B              +279 	ly	fs24_cursor+1
00:005464 CFB007              +280 	dl	fs_lookup:quanta
00:005465 C7F018              +281 	ds	http_file_octets
  :                            282 
  :                            283 
(+03)10
00:005466 FD00AB              +284 	push, xi http_formation2
00:005467 38000C              +285 	pop	p
  :                            286 
00:005468 300016              +287 	z	WDATAC
00:005469 300010              +288 	z	BYTES
00:00546A FF0EF0              +289 	call	(iedit48ua)
  :                            290 .	la, xi	0
00:00546B 1D0010              +291 	wsr	16
00:00546C 600010              +292 	la	BYTES
  :                            293 
  :                            294 	$if	1
(+03)10
00:00546D 6D00AB              +295 	lb	http_formation2,,xi
00:00546E 4D5010              +296 	lk	05000++TCP_ACK,,xi
  :                            297 	$else
  :                            298 
  :                            299 	push,xi	http_formation2
  :                            300 	pop	q
  :                            301 	$endif
  :                            302 
00:00546F 50F01C              +303 	lx	http_thread_transmission
00:005470 FF0EFC              +304 	call	(tcp_tx)
00:005471 E6049C              +305 	jna	http_hangup
  :                            306 
  :                            307 	$if	1
00:005472 4D5010              +308 	lk	05000++TCP_ACK,,xi
(+03)10
00:005473 6D2671              +309 	lb	$3("":CR:LF:CR:LF),,xi
  :                            310 	$else
  :                            311 
  :                            312 	push,xi $1("":CR:LF:CR:LF)
  :                            313 	pop	q
  :                            314 	$endif
  :                            315 
00:005474 650004              +316 	la, xi	$bits/$byte
00:005475 50F01C              +317 	lx	http_thread_transmission
00:005476 FF0EFC              +318 	call	(tcp_tx)
00:005477 E6049C              +319 	jna	http_hangup
  :                            320 
  :                            321 http_next_extent
00:005478 CFF01A              +322 	dl	fs24_cursor
00:005479 C60490              +323 	jza	http_pushover
00:00547A FF0F33              +324 	call	(fs_xbase)
00:00547B C7F01A              +325 	ds	fs24_cursor		. extent words are in r
  :                            326 					. data address is in y 
  :                            327 .	sy	q
00:00547C 680000              +328 	lb	r
00:00547D E50003              +329 	m, xi	3		
00:00547E C70006              +330 	ds	6
  :                            331 
00:00547F CFF018              +332 	dl	http_file_octets
00:005480 DF0006              +333 	dan	6
00:005481 5E048A              +334 	jnc	http_final_extent
00:005482 C7F018              +335 	ds	http_file_octets
00:005483 600007              +336 	la	7
00:005484 680003              +337 	lb	y
00:005485 4D5010              +338 	lk	05000++TCP_ACK,,xi
  :                            339 
00:005486 50F01C              +340 	lx	http_thread_transmission
00:005487 FF0EFC              +341 	call	(tcp_tx)
00:005488 E6049C              +342 	jna	http_hangup
00:005489 B60478              +343 	j	http_next_extent
  :                            344 
  :                            345 http_final_extent
00:00548A 680003              +346 	lb	y
00:00548B 60F019              +347 	la	http_file_octets+1
00:00548C 50F01C              +348 	lx	http_thread_transmission
00:00548D 4D5010              +349 	lk	05000++TCP_ACK,,xi
00:00548E FF0EFC              +350 	call	(tcp_tx)
00:00548F E6049C              +351 	jna	http_hangup
  :                            352 
  :                            353 http_pushover
  :                            354 	$if	1
(+03)10
00:005490 6D2673              +355 	lb	$3("":CR:LF),,xi
00:005491 650002              +356 	la	2,,xi
00:005492 4D5018              +357 	lk	05000++TCP_ACK++TCP_PSH,,xi
  :                            358 	$else
  :                            359 	push,xi	$1("":CR:LF)
  :                            360 	pop	q
  :                            361 	la, xi	2
  :                            362 	push, xi	05018
  :                            363 	pop		SOCKET_CALL_FLAGS
  :                            364 	$endif
  :                            365 
00:005493 50F01C              +366 	lx	http_thread_transmission
00:005494 FF0EFC              +367 	call	(tcp_tx)
00:005495 E6049C              +368 	jna	http_hangup
  :                            369 
  :                            370 http_norequest
00:005496 B6049C              +371 	j	http_hangup
  :                            372 
  :                            373 http_drop_request
                                	lb, xi	$3("HTTP/1.1 200 OK":CR:LF:;
                                                   "Content-Type: text/html; charset=UTF-8":CR:LF:;
                                		   "Content-Length: 36":CR:LF:CR:LF:;
                                		   "<html><div>":CR:LF:;
(+03)10
00:005497 6D2674              +378 		   "web archive not found":CR:LF:"</div></html>":CR:LF)
  :                            379 
  :                            380 .	sb	q
00:005498 650082              +381 	la	$bits/$byte,,xi
00:005499 50F01C              +382 	lx	http_thread_transmission
00:00549A 4D5018              +383 	lk	05000++TCP_ACK++TCP_PSH,,xi
00:00549B FF0EFC              +384 	call	(tcp_tx)
  :                            385 
  :                            386 http_hangup
  :                            387 http_thread_exit
00:00549C 60F01D              +388 	la	http_thread_request
00:00549D FF0F34              +389 	call	(tcpz)
(+03)0f
00:00549E 1F0091              +390 	dec	http_threads
00:00549F FCF01E              +391 	$ret				.	thread end
00:0054A0 38000F              +391 
00:0054A1 350000              +391 
  :                            392 
  :                            393 
  :                            394 http_get_what				. y = caller's name buffer
  :                            395 					. a = descriptor request message
  :                            396 http_name_buffer $equf	0, y
00:0054A2 F80003              +397 	push	y
00:0054A3 F8C006              +398 	push	descriptor:apdata, a
00:0054A4 38000D              +399 	pop	q
00:0054A5 300014              +400 	z	RDATAC
00:0054A6 050020              +401 	on	b$stream16r
00:0054A7 0D0040              +402 	off	b$streamZR
00:0054A8 150010              +403 	rsr	16
00:0054A9 150008              +404 	rsr	8
00:0054AA 4DFFFF              +405 	lk, xi	-1
00:0054AB AF0F35              +406 	mta	("GET")
00:0054AC B604D8              +407 	j	http_get_default
00:0054AD 150010              +408 	rsr	16
00:0054AE 4D00FF              +409 	lk, xi	255
00:0054AF AF0F36              +410 	mta	('/')
00:0054B0 B604D8              +411 	j	http_get_default
  :                            412 
00:0054B1 150008              +413 	rsr	8
00:0054B2 AF0F37              +414 	mtane	(' ')
00:0054B3 B604B5              +414 
00:0054B4 B604D8              +415 	j	http_get_default
00:0054B5 AF0F38              +416 	mtane	('?')
00:0054B6 B604B8              +416 
00:0054B7 150008              +417 	rsr	8
  :                            418 
00:0054B8 44B018              +419 	lr, i	http_name_buffer+72//3
00:0054B9 A500FF              +420 	and, xi 255
  :                            421 
00:0054BA B604BD              +422 	j	http_name_2nd_read
  :                            423 
  :                            424 http_name
00:0054BB 3E04CD              +425 	lcal	http_name_mark
00:0054BC B604C8              +426 	j	http_name1
  :                            427 http_name_2nd_read
00:0054BD 3E04CD              +428 	lcal	http_name_mark
00:0054BE B604C5              +429 	j	http_name2
00:0054BF 3E04CD              +430 	lcal	http_name_mark
00:0054C0 B604C6              +431 	j	http_name3
  :                            432 
00:0054C1 20B000              +433 	sa	0, y
00:0054C2 650000              +434 	la, xi	0
00:0054C3 8D0001              +435 	ay, xi	1
  :                            436 
00:0054C4 B604BB              +437 	j	http_name
  :                            438 	
  :                            439 
  :                            440 http_name2
00:0054C5 260008              +441 	sal	8
  :                            442 http_name3
00:0054C6 20B000              +443 	sa	0, y
00:0054C7 8D0001              +444 	ay, xi	1
  :                            445 http_name1
00:0054C8 600003              +446 	la	y
00:0054C9 D0F000              +447 	ana	0, sp
00:0054CA 400004              +448 	lr	a
00:0054CB 380003              +449 	pop	y
00:0054CC 350000              +450 	lret	0
  :                            451 
  :                            452 	
  :                            453 http_name_mark
00:0054CD 150008              +454 	rsr	8
00:0054CE AF0F37              +455 	mtane	(' ')
00:0054CF B604D1              +455 
00:0054D0 B604D6              +456 	j	http_name_x		. end, truncate the ASCII space
00:0054D1 AF0F38              +457 	mtane	('?')
00:0054D2 B604D4              +457 
00:0054D3 B604D6              +458 	j	http_name_x		. end, truncate the quizzical
00:0054D4 AF0F39              +459 	mta	('=')			. out of range character?
00:0054D5 350001              +460 	lret	1			. character OK for being in name
  :                            461 http_name_x
00:0054D6 A5FF00              +462 	and,xi	-256			. truncate the out-of-range character
00:0054D7 350000              +463 	lret	0
  :                            464 
  :                            465 
  :                            466 http_get_default
00:0054D8 450004              +467 	lr, xi	4
(+01)10
00:0054D9 5D05F0              +468 	ly, xi	$1("index.html")
00:0054DA 17000F              +469 	inc	sp
00:0054DB 350000              +470 	lret	0
  :                            152: 	$include iserver1
  :                            1 
  :                            2 	$path		../
  :                            3 .	$include	def/rta.def
  :                            4 .	$include	def/ii.def
  :                            5 .	$include	def.sys/banks.def
  :                            6 .	$include	def.sys/base.def
  :                            7 .	$include	language/stack.def
  :                            8 .	$include	lib/alib.def
  :                            9 .	$include	lib/register.def
  :                            10: 	$include	lib/aquiform.def
  :                            1 
  :                            2 READ_STREAM_START* $proc
  :                            3 
  :                            4 	$if	COUNTED_STREAM
  :                            5 	sa	BYTES
  :                            6 	$else
  :                            7 	z	BYTES
  :                            8 	$endif
  :                            9 
  :                            10 	sb	q	. once per input buffer
  :                            11 	z	RDATAC
  :                            12 	READ_START
  :                            13 	la	' ',,xi
  :                            14 	sa	LAST_BYTE_READ
  :                            15 	$end
  :                            16 
  :                            17 WRITE_STREAM_START* $proc
  :                            18 	z	BYTES
  :                            19 	sx	p
  :                            20 	z	WDATAC
  :                            21 	WRITE_START
  :                            22 	$end
  :                            23 
  :                            24 READ_START* $proc	. once per input specification
  :                            25 	$if	AQUIFORM_NET16
  :                            26 	on	b$stream16r++b$streamZR
  :                            27 	off	half$w
  :                            28 	$else
  :                            29 	on	b$streamZR
  :                            30 	off	b$stream16r++half$w
  :                            31 	$endif
  :                            32 	$end		. it is up to the calling application
  :                            33 			. to change b$stream16R back if it needs
  :                            34 
  :                            35 WRITE_START* $proc
  :                            36 	$if	AQUIFORM_NET16
  :                            37 	on	b$stream16w
  :                            38 	off	half$w
  :                            39 	$else
  :                            40 	off	b$stream16w++half$w
  :                            41 	$endif
  :                            42 	$end
  :                            43 
  :                            44 READ_BYTE* $proc *
  :                            45 	la	LAST_BYTE_READ
  :                            46 	jza	thats_all
  :                            47 	rsr	$byte
  :                            48 	sa	LAST_BYTE_READ
  :                            49 	tz	BYTES
  :                            50 	lcal	counted_stream
  :                            51 thats_all
  :                            52 	$end
  :                            53 
  :                            54 p	$proc
  :                            55 WRITE_BYTE* $name
  :                            56 	sal	$word-$byte
  :                            57 WRITE_UBYTE* $name
  :                            58 	wsr	$byte
  :                            59 	inc	BYTES
  :                            60 	$end
  :                            61 
  :                            62 WRITE3_BYTES* $proc		. only works for 3 octets
  :                            63 	wsr	16
  :                            64 	wsr	8
  :                            65 	push	3,,xi
  :                            66 	popA	BYTES
  :                            67 	$end
  :                            68 
  :                            69 WRITE_BYTES* $proc
  :                            70 BITS	$set	WRITE_BYTES(1, 1)*$byte
  :                            71 	$if	BITS>16
  :                            72 	wsr	16
  :                            73 	wsr	BITS-16
  :                            74 	$else
  :                            75 	wsr	BITS
  :                            76 	$endif
  :                            77 	push	BITS/$byte,,xi
  :                            78 	popA	BYTES
  :                            79 	$end
  :                            80 
  :                            81 
  :                            11 .	$include	t77.4/dq.def
  :                            12 .	$include	t77.4/ip.def
  :                            13 .	$include	t77.4/socket.def
  :                            14 	$path
  :                            15 
  :                            16 . AQUIFORM_NET16	$equ	1
  :                            17 . COUNTED_STREAM	$equ	1
  :                            18 ISERVER_PORT	$equ	129
  :                            19 
  :                            20 iserve	$tree
  :                            21 
  :                            22 $(0)
  :                            23 integer_serve
00:0054DC 4F0F3A              +24 	ql	(iserve:i_server1,,,:q)
00:0054DD 750047              +25 	ii	THREAD$
00:0054DE C604E1              +26 	jza	iserver_zstart
(+03)10
00:0054DF 6D26A0              +27 	lb	$3("*iserver":0),,xi
00:0054E0 750049              +28 	ii	TAG$
  :                            29 iserver_zstart
00:0054E1 3D0000              +30 	fret
  :                            31 
  :                            32 $(1)
01:00041D 000000              +33 socketi	+	0
01:00041E FFFFFF              +34 i_bound -	1
01:00041F 000000              +35 portcb_lva	0
01:000420 000000              +36 portcb		0
  :                            37 
  :                            38 $(70::,fp)
  :                            39 descriptor	acw
  :                            40 
  :                            41 $(66::,x)
42:000000                     +42 so	$socket
42:000002                     +42 
42:000004                     +42 
42:000005                     +42 
42:000006                     +42 
42:000007                     +42 
42:000005                     +42 
42:000006                     +42 
42:000007                     +42 
  :                            43 
  :                            44 $(0)
                                i_server1	$head_near	scalars(response_axw,	int	;		
                                					operator,	int	;
                                					left,		float	;
                                					right,		float	;
                                					xtra,		float	;
                                					signs1,		int	;
00:0054E2 FD0000              +51 					signs,		long	)
00:0054E3 FD0000              +51 
00:0054E4 8F0EA5              +51 
00:0054E5 8F0EA5              +51 
00:0054E6 8F0EA5              +51 
00:0054E7 FD0000              +51 
00:0054E8 9F0F0F              +51 
  :                            52 
  :                            53 .	tz	socketi
  :                            54 .	j	i_rx
00:0054E9 600EA9              +55 	la	(IPPROTO_UDP*/16)
00:0054EA FF0EAA              +56 	call	(__socket)
(+01)0f
00:0054EB 20041D              +57 	sa	socketi
00:0054EC E60569              +58 	jna	i_error
  :                            59 
00:0054ED 9F0F3E              +60 	c	(bind) a (ISERVER_PORT:d),,long
00:0054EE F80004              +60 
00:0054EF FCF003              +60 
00:0054F0 FF0EAD              +60 
00:0054F1 38000F              +60 
  :                            61 
  :                            62 .	lb, xi	ISERVER_PORT
  :                            63 .	sb	7
  :                            64 .	z	6
  :                            65 .	call	(bind)
  :                            66 
(+01)0f
00:0054F2 20041E              +67 	sa	i_bound
00:0054F3 E60569              +68 	jna	i_error
  :                            69 
00:0054F4 CF000A              +70 	dl	10
(+01)0f
00:0054F5 C7041F              +71 	ds	portcb_lva
  :                            72 
  :                            73 . i_rx
(+01)0f
00:0054F6 78041E              +74 	tp	i_bound
00:0054F7 B60569              +75 	j	i_error
  :                            76 
(+01)0f
00:0054F8 CF041F              +77 	dl	portcb_lva
00:0054F9 34002F              +78 	sabr	BSOCKET
  :                            79 
00:0054FA 050070              +80 	on	b$stream16r++b$streamZR++b$stream16w
  :                            81 
  :                            82 .	la	(0000000s)
  :                            83 .	ii	FP_GUARD$
  :                            84 
00:0054FB 68D006              +85 i_rx1	lb	so:udp:socket_inq.head, b
00:0054FC CE0566              +86 	jzb	i_no_traffic
  :                            87 
  :                            88 	$if	1
  :                            89 
00:0054FD 28000E              +90 	sb	fp
00:0054FE 600024              +91 	la	5+23+8
00:0054FF FF0EAE              +92 	call	(udp_rtxbuffer)
00:005500 C60562              +93 	jza	i_release
00:005501 20F010              +94 	sa	response_axw
00:005502 60E003              +95 	la	descriptor:bytes
00:005503 68E006              +96 	lb	descriptor:apdata
00:005504 FF0EAF              +97 	call	(rstream_start_net)
  :                            98 
  :                            99 	$else
  :                            100 
  :                            101 	la	descriptor:bytes, b
  :                            102 	sa	BYTES
  :                            103 
  :                            104 	z	RDATAC
  :                            105 
  :                            106 	push	descriptor:apdata, b
  :                            107 	pop	q
  :                            108 
  :                            109 	la, xi	5+23+8
  :                            110 	call	(udp_rtxbuffer)
  :                            111 	jza	i_release
  :                            112 
  :                            113 	ly	descriptor:apdata, a
  :                            114 	sa	response_axw
  :                            115 	sy	p
  :                            116 	z	WDATAC
  :                            117 	z	WDATA
  :                            118 
  :                            119 	$endif
  :                            120 
00:005505 FF0F40              +121 	call	(iscan72)
00:005506 47F00B              +122 	qs	left
  :                            123 
00:005507 FF0EB1              +124 	call	(symbol_scan)
00:005508 20F00F              +125 	sa	operator
  :                            126 
00:005509 FF0F40              +127 	call	(iscan72)
00:00550A 47F007              +128 	qs	right
  :                            129 
  :                            130 
00:00550B 450000              +131 	lr, xi	0
00:00550C 600013              +132 	la	LAST_BYTE_READ	.	LAST_BYTE_READ
00:00550D C5FFD4              +133 	aa, xi	-','
  :                            134 
00:00550E D60514              +135 	jnza	i_again
00:00550F FF0EB2              +136 	call	(iscan_skip)
00:005510 6D0001              +137 	lb, xi	1		.	nothing scanned
00:005511 CDFFFF              +138 	ab, xi	-1
00:005512 EE0514              +139 	jnb	i_again
00:005513 400005              +140 	lr	b
  :                            141 
  :                            142 i_again
00:005514 60F00F              +143 	la	operator
  :                            144 
00:005515 680004              +145 	anu, xi	'+'
00:005516 DD002B              +145 
00:005517 CE0522              +146 	jzb	i_add
00:005518 680004              +147 	anu, xi	'-'
00:005519 DD002D              +147 
00:00551A CE052C              +148 	jzb	i_add_negative
00:00551B 680004              +149 	anu, xi	'*'
00:00551C DD002A              +149 
00:00551D CE0537              +150 	jzb	i_multiply
00:00551E 680004              +151 	anu, xi	'/'
00:00551F DD002F              +151 
00:005520 CE053F              +152 	jzb	i_divide
00:005521 B60548              +153 	j	i_nop
  :                            154 
  :                            155 i_add
  :                            156 i_add_again
00:005522 CFF00D              +157 	dl	left+2
00:005523 D7F009              +158 	da	right+2
00:005524 C7F00D              +159 	ds	left+2
00:005525 B70004              +160 	sc	a
00:005526 68F00C              +161 	lb	left+1
00:005527 C8F008              +162 	ab	right+1
00:005528 C80004              +163 	ab	a
00:005529 28F00C              +164 	sb	left+1
00:00552A 1E0522              +165 	jdr	i_add_again
00:00552B B60548              +166 	j	i_edit
  :                            167 
  :                            168 i_add_negative
  :                            169 i_add_negative_again
00:00552C CFF00D              +170 	dl	left+2
00:00552D DFF009              +171 	dan	right+2
00:00552E C7F00D              +172 	ds	left+2
00:00552F B70004              +173 	sc	a
00:005530 C5FFFF              +174 	aa, xi	-1
00:005531 68F00C              +175 	lb	left+1
00:005532 C80004              +176 	ab	a
00:005533 D8F008              +177 	anb	right+1
00:005534 28F00C              +178 	sb	left+1
00:005535 1E052C              +179 	jdr	i_add_negative_again
00:005536 B60548              +180 	j	i_edit
  :                            181 
  :                            182 i_multiply
  :                            183 i_multiply_again
  :                            184 
  :                            185 	$if	1
  :                            186 
00:005537 FCF00C              +187 	c	(im72_72)	left+1,,i	right+1,,i	left+1,,i
00:005538 FCF009              +187 
00:005539 FCF00E              +187 
00:00553A FCF003              +187 
00:00553B FF0F41              +187 
00:00553C 38000F              +187 
  :                            188 
  :                            189 	$elseif	0
  :                            190 
                                	i72m	left+1		;	. multiplicand
                                		right+3		;	. multiplier
  :                            193 		left+1			. product
  :                            194 
  :                            195 	$else
  :                            196 
  :                            197 	lb	left+3
  :                            198 	mf	right+3
  :                            199 	sb	left+3
  :                            200 	dsa	24
  :                            201 	ds	6
  :                            202 	lb	left+2
  :                            203 	mf	right+3
  :                            204 	da	6
  :                            205 	sb	left+2
  :                            206 	sa	7
  :                            207 	lb	left+1
  :                            208 	m	right+3
  :                            209 	ab	7
  :                            210 	sb	left+1
  :                            211 
  :                            212 	$endif
  :                            213 
00:00553D 1E0537              +214 	jdr	i_multiply_again
00:00553E B60548              +215 	j	i_edit
  :                            216 
  :                            217 	$if	1
  :                            218 				. integer divide instruction executed
  :                            219 				. simply and once gives 48-bit signed
  :                            220 				. quotient and 24-bit signed remainder
  :                            221 				. from 48-bit dividend and 24-bit divisor
  :                            222 
  :                            223 				. quotient high order bits are in register 6
  :                            224 				. quotient low-order bits are in a
  :                            225 				. remainder is in b
  :                            226 
  :                            227 				. this sequence produces 72-bit signed
  :                            228 				. quotient from 72-bit dividend
  :                            229 i_divide
  :                            230 i_divide_again
  :                            231 
  :                            232 	$if	1
  :                            233 
00:00553F FCF004              +234 	c	(id72_72)	left+1,,i	right+1,,i	left+1,,i	xtra+1,,i
00:005540 FCF00D              +234 
00:005541 FCF00A              +234 
00:005542 FCF00F              +234 
00:005543 FCF004              +234 
00:005544 FF0F42              +234 
00:005545 38000F              +234 
  :                            235 
  :                            236 	$elseif	0
  :                            237 
                                	i72d	left+1 		;	. dividend
                                		right+3		;	. divisor
                                		left+1		;	. quotient
  :                            241 		left			. remainder
  :                            242 
  :                            243 	$else
  :                            244 
  :                            245 	dl	left+1		. read first 48 dividend bits
  :                            246 	d	right+3		. only 24 divisor bits can be used
  :                            247 				. with integer divide instruction
  :                            248 				. for more than that use floating point
  :                            249 				. or program a bit-race routine
  :                            250 
  :                            251 	sb	7		. set aside the first remainder
  :                            252 	sa	b		. reassemble the first 48-bit quotient
  :                            253 	la	6		. recover the ms 24 quotient bits
  :                            254 	ds	left+1		. store the upper 48 quotient bits
  :                            255 	la	7		. recover 1st remainder
  :                            256 	lb	left+3		. zone with 3rd dividend word
  :                            257 	d	right+3		. divide stage 2
  :                            258 	sb	left		. store final remainder
  :                            259 	sa	left+3		. store third quotient word
  :                            260 
  :                            261 	la	6		. add ms word 2nd quotient to 1st quotient
  :                            262 	dsa	24		. this part is important in decrementing
  :                            263 	da	left+1		. the 2s complement effect on 
  :                            264 	ds	left+1		. the 1st 2 words of a negative quotient
  :                            265 
  :                            266 	$endif
  :                            267 
  :                            268 i_div_dont
  :                            269 
00:005546 1E053F              +270 	jdr	i_divide_again
  :                            271 
00:005547 B60548              +272 	j	i_edit
  :                            273 
  :                            274 	$else
  :                            275 				. this is a cautious method until
  :                            276 				. the efficient sign-handling version
  :                            277 				. above is checked for all cases
  :                            278 
  :                            279 				. it flips everything to positive
  :                            280 				. magnitude and flips the results
  :                            281 				. back to intended polarities
  :                            282 
  :                            283 				. temporary measure while examining
  :                            284 				. the effects to successive divides
  :                            285 				. in 2s complement
  :                            286 i_divide
  :                            287 	ql	right
  :                            288 	z	right
  :                            289 	jpb	i_divide_p2
  :                            290 	n	right
  :                            291 	call	(n72comp2)
  :                            292 	la	right
  :                            293 	qs	right
  :                            294 i_divide_again
  :                            295 i_divide_p2
  :                            296 	ql	left
  :                            297 	la	b
  :                            298 	saa	24
  :                            299 	sa	left
  :                            300 	jpb	i_divide_p1
  :                            301 	call	(n72comp2)
  :                            302 	la	left
  :                            303 	qs	left
  :                            304 i_divide_p1
  :                            305 	dl	left+1
  :                            306 	d	right+3
  :                            307 	sb	7
  :                            308 	sa	b
  :                            309 	la	6
  :                            310 	ds	left+1
  :                            311 	la	7
  :                            312 	lb	left+3
  :                            313 	d	right+3
  :                            314 	sa	left+3
  :                            315 
  :                            316 	la	left	.	read the dividend sign
  :                            317 	jzb	i_store_remainder
  :                            318 	jpa	i_store_remainder
  :                            319 	xorB,xi	-1	.	if 1s flip the remainder
  :                            320 	ab, xi	1	.	and add 1 to it
  :                            321 i_store_remainder
  :                            322 	sb	left
  :                            323 
  :                            324 	xor	right	.	record mixed or equal signs
  :                            325 	sa	signs	.	
  :                            326 	ql	left
  :                            327 	tp	signs
  :                            328 	call	(n72comp2)
  :                            329 	la	left	.	retrieve the remainder
  :                            330 	qs	left
  :                            331 
  :                            332 	jdr	i_divide_again
  :                            333 	j	i_edit
  :                            334 
  :                            335 	$endif
  :                            336 
  :                            337 i_nop
  :                            338 i_edit
  :                            339 	$if	1
00:005548 50F010              +340 	lx	response_axw
00:005549 50A006              +341 	lx	descriptor:apdata, x
00:00554A FF0EB3              +342 	call	(wstream_start_net)
  :                            343 	$else
  :                            344 	z	BYTES
  :                            345 	$endif
  :                            346 
00:00554B 4FF00B              +347 	ql	left
00:00554C FF0F43              +348 	call	(edit72s)
  :                            349 
00:00554D 60F00F              +350 	la	operator
00:00554E C5FFD1              +351 	aa, xi	-'/'			. operation was divide?
00:00554F D60559              +352 	jnza	i_ecomplete		. no
  :                            353 
  :                            354 	$if	1
  :                            355 
00:005550 68F004              +356 	lb	xtra+1
00:005551 98F005              +357 	orB	xtra+2
00:005552 98F006              +358 	orB	xtra+3
00:005553 CE0559              +359 	jzb	i_ecomplete
00:005554 600F03              +360 	la	(" ":0:0)
00:005555 1D0008              +361 	wsr	$byte
00:005556 170010              +362 	inc	BYTES
00:005557 4FF003              +363 	ql	xtra
00:005558 FF0F43              +364 	call	(edit72s)
  :                            365 
  :                            366 	$else
  :                            367 
  :                            368 	lb	left			. remainder?
  :                            369 	jzb	i_ecomplete		. no
  :                            370 	la	(" ":0:0)
  :                            371 	wsr	$byte			. it's a counted stream 
  :                            372 	inc	BYTES			. but we haven't set macro settings for it
  :                            373 	la	b
  :                            374 	call	(edits)			. sprint the remainder
  :                            375 
  :                            376 	$endif
  :                            377 
  :                            378 i_ecomplete
00:005559 600EB9              +379 	la	("":10:0:0)
00:00555A 1D0010              +380 	wsr	$byte*2			. LF + 8 bits to flush
00:00555B 1D0008              +381 	WRITE_UBYTE
00:00555C 170010              +381 
00:00555D 170010              +382 	inc	BYTES			. count LF but not the 8 flushing bits
  :                            383 	
00:00555E 50F010              +384 	lx	response_axw
00:00555F 600010              +385 	la	BYTES
00:005560 20A003              +386 	sa	descriptor:bytes, x
  :                            387 
  :                            388 
00:005561 FF0EBA              +389 	call	(udp_acw_send)
  :                            390 
  :                            391 i_release
(+01)0f
00:005562 500420              +392 	lx	portcb			. port structure in scalar frame
00:005563 FF0EBB              +393 	call	(release_udgram)
(+01)0f
00:005564 680420              +394 	lb	portcb			. port structure in scalar frame
00:005565 B604FB              +395 	j	i_rx1
  :                            396 i_no_traffic
00:005566 750041              +397 	ii	YIELD$
(+01)0f
00:005567 680420              +398 	lb	portcb
00:005568 B604FB              +399 	j	i_rx1
  :                            400 i_error
  :                            401 
00:005569 54F011              +402 	lx, i	$$frame, sp
00:00556A 10000F              +403 	sx	sp
00:00556B 3D0000              +404 	fret	0
  :                            405 
  :                            406 	$root
  :                            153 
  :                            154 	$path	../fponline
  :                            155: 	$include fponline
  :                            1 
  :                            2 fponline $tree
  :                            3 
  :                            4 UDPQ	$equ	1			. takes less space if you use
  :                            5 					. the socket layer interface
  :                            6 
  :                            7 COMMANDS_EOP $equ d$save1		. high address commands+ in the remote assembly
  :                            8 ZENITH	$equ	d$save			. limit of literal table in the remote assembly
  :                            9 STACK_GUARD $equ d$save2
  :                            10 MESSAGE	$equ	d$save3
  :                            11 
  :                            12 $(3)
03:0000D0 000000              +13 s1		0
03:0000D1 000000000000        +14 socket_lva	0:d
[+0018]18
03:0000D3 000000              +15 editp	+	floating_edit192
  :                            16 buffer	$res	200
  :                            17 
  :                            18 . information	"-0.0":HT:". exponent overflow"
  :                            19 . information_bytes $equ	$bits/$byte
  :                            20 
  :                            21 $(0)
00:00556C 4F0F44              +22 launch	ql	(server,,,:q)
00:00556D 750047              +23 	ii	THREAD$
00:00556E C60571              +24 	jza	zstart
(+03)10
00:00556F 6D26A3              +25 	lb	$3("*fponline":0),,xi
00:005570 750049              +26 	ii	TAG$
00:005571 3D0000              +27 zstart	fret
  :                            28 
00:005572 600EA9              +29 server	la	(IPPROTO_UDP*/16)
00:005573 FF0EAA              +30 	call	(__socket)
00:005574 E605AB              +31 	jna	leave			. you have no socket
(+03)0f
00:005575 2000D0              +32 	sa	s1
  :                            33 
00:005576 9F0F48              +34 	c	(bind) a (FPONLINE_PORT:d),,long
00:005577 F80004              +34 
00:005578 FCF003              +34 
00:005579 FF0EAD              +34 
00:00557A 38000F              +34 
  :                            35 
  :                            36 .	ql	(,,,FPONLINE_PORT:q)
  :                            37 .	la	s1
  :                            38 .	call	(bind)
  :                            39 
00:00557B E605A9              +40 	jna	free_socket		. you could not bind
  :                            41 
  :                            42 	$if	UDPQ
00:00557C CF000A              +43 	dl	10			. this is a thread
(+03)0f
00:00557D C700D1              +44 	ds	socket_lva		. so the socket structure 
  :                            45 	$endif				. should stay based
  :                            46 
  :                            47 
00:00557E 34002F              +48 	sabr	BSOCKET			. this is a thread
  :                            49 					. this must stay in its window
  :                            50 
  :                            51 .	la	(0E00000s)
  :                            52 .	ii	FP_GUARD$
  :                            53 
  :                            54 rxnext
  :                            55 	$if	UDPQ
(+03)0f
00:00557F 6800D2              +56 	lb	socket_lva+1
00:005580 68D006              +57 	lb	s:udp:socket_inq:head, b
00:005581 CE05A5              +58 	jzb	wait
  :                            59 
[+0018]10
00:005582 650000              +60 	la	floating_edit192,,xi	. default output edit
(+03)0f
00:005583 2000D3              +61 	sa	editp
  :                            62 
00:005584 60D003              +63 	la	descriptor:bytes, b
00:005585 200010              +64 	sa	BYTES
00:005586 60D006              +65 	la	descriptor:apdata, b
00:005587 20000D              +66 	sa	q
  :                            67 
00:005588 650036              +68 	la	43+7+1+2+1,,xi		. character columns largest response	
00:005589 FF0EAE              +69 	call	(udp_rtxbuffer)
00:00558A C605A2              +70 	jza	release_request
  :                            71 
00:00558B 20000E              +72 	sa	fp
  :                            73 	
(+03)10
00:00558C 5500D4              +74 	lx	buffer,,xi
00:00558D FF0F4A              +75 	call	(xdr_inopaque24)	. BYTES [q]->[x]
(+03)10
00:00558E 5D00D4              +76 	ly	buffer,,xi
00:00558F 3E05AC              +77 	lcal	pdu
  :                            78 
00:005590 50E006              +79 	lx	descriptor:apdata
00:005591 FF0EB3              +80 	call	(wstream_start_net)
00:005592 300010              +81 	z	BYTES
00:005593 300016              +82 	z	WDATAC
00:005594 300017              +83 	z	WDATA
  :                            84 
00:005595 75004E              +85 	ii	FP_XPO$FLAG
00:005596 B60599              +86 	j	inform
  :                            87 
(+03)0f
00:005597 FF00D3              +88 	call	editp
00:005598 B6059C              +89 	j	respond
  :                            90 
(+03)0f
00:005599 5C26A7              +91 inform	ly	$3("-0.0":HT:HT:". ":01b:05b:"41;1;37m":"exponent overflow":01b:05b:"0m"),,i
00:00559A 450027              +92 	lr	$bits/$byte,,xi
00:00559B FF0F4B              +93 	call	(xdr_outopaque24)
  :                            94 	
  :                            95 
  :                            96 respond
  :                            97 	$if	1
00:00559C 650000              +98 	la	0,,xi
00:00559D 1D0008              +99 	wsr	8
00:00559E 600010              +100 	la	BYTES
  :                            101 	$else
  :                            102 	la	(LF*/16)
  :                            103 	wsr	24
  :                            104 	la	BYTES
  :                            105 	la	1, a, i
  :                            106 	$endif
  :                            107 
00:00559F 20E003              +108 	sa	descriptor:bytes
00:0055A0 50000E              +109 	lx	fp
00:0055A1 FF0EBA              +110 	call	(udp_acw_send)
  :                            111 release_request
(+03)0f
00:0055A2 5000D2              +112 	lx	socket_lva+1
00:0055A3 FF0EBB              +113 	call	(release_udgram)
00:0055A4 B6057F              +114 	j	rxnext
  :                            115 
  :                            116 	$else
                                	c	(recv)	s1		;
                                			buffer,,xi	;
                                			600,,xi		;
  :                            120 			(UDP_AUTO_CONNECT:s)
  :                            121 
  :                            122 
  :                            123 	jna	disengage_free		. bound but not reading
  :                            124 	jza	wait
  :                            125 
  :                            126 	ly	buffer,,xi
  :                            127 	lcal	pdu
  :                            128 	ly	buffer,,xi
  :                            129 	sy	p
  :                            130 	z	BYTES
  :                            131 	z	WDATAC
  :                            132 	z	WDATA
  :                            133 
  :                            134 	ii	FP_XPO$FLAG
  :                            135 	j	complain
  :                            136 
  :                            137 	call	(floating_edit192)
  :                            138 
  :                            139 	la	(LF*/16:s)
  :                            140 	wsr	24
  :                            141 
                                	c	(send)	s1		;
                                			buffer,,xi	;
                                			BYTES		;
  :                            145 			0
  :                            146 	$endif
  :                            147 
00:0055A5 750041              +148 wait	ii	YIELD$
00:0055A6 B6057F              +149 	j	rxnext
  :                            150 
  :                            151 disengage_free
(+03)0f
00:0055A7 6000D0              +152 	la	s1
00:0055A8 FF0F4C              +153 	call	(__net_disengage)
  :                            154 
  :                            155 free_socket
(+03)0f
00:0055A9 6000D0              +156 	la	s1
00:0055AA 750051              +157 	ii	FREE_HANDLE$
00:0055AB 750046              +158 leave	ii	EXIT$
  :                            159 
00:0055AC 50000F              +160 pdu	lx	sp
00:0055AD 100012              +161 	sx	STACK_GUARD
  :                            162 
00:0055AE CFB000              +163 	dl	0, y
00:0055AF C5FFE6              +164 	aa	-X_CODES,,xi		. does it look like an fponline PDU ?
00:0055B0 D60682              +165 	jnza	outrage
  :                            166 
00:0055B1 600005              +167 	la	b			. range test what this says
00:0055B2 C5FF4A              +168 	aa	-FPONLINE_MESSAGE_LIMIT+8*2+2,,xi
00:0055B3 7E0682              +169 	jc	outrage			. test maximum message less 2 operands
  :                            170 
00:0055B4 C80003              +171 	ab	y			. change offset to address
00:0055B5 60D001              +172 	la	1, b			. $zenith function is only real
00:0055B6 C70010              +173 	ds	ZENITH			. after all literals have been generated on 2nd pass
  :                            174 
00:0055B7 C5FF38              +175 	aa	-FPONLINE_MESSAGE_LIMIT,,xi
00:0055B8 7E0682              +176 	jc	outrage
  :                            177 
00:0055B9 180013              +178 	sy	MESSAGE
  :                            179 
00:0055BA 400011              +180 command	lr	COMMANDS_EOP		. high address of commands list+
00:0055BB 8D0002              +181 	ay	2,,xi
00:0055BC FE0684              +182 	jyge	exitu
00:0055BD 50B000              +183 	lx	0, y
00:0055BE 45001A              +184 	lr	X_CODES,,xi		. a known command?
00:0055BF F60682              +185 	jxge	outrage
00:0055C0 400010              +186 	lr	ZENITH			. message-relative end of operands
00:0055C1 B6A5C2              +187 	j	$+1, x
00:0055C2 B60684              +188 	j	exitu
00:0055C3 B605DC              +189 	j	fpo_load
00:0055C4 B605E4              +190 	j	fpo_load_negative
00:0055C5 B605EC              +191 	j	fpo_push
00:0055C6 B605EF              +192 	j	fpo_add
00:0055C7 B605F7              +193 	j	fpo_add_negative
00:0055C8 B605FF              +194 	j	fpo_multiply
00:0055C9 B60607              +195 	j	fpo_divide
00:0055CA B6060F              +196 	j	fpo_pop_add
00:0055CB B60616              +197 	j	fpo_pop_add_negative
00:0055CC B6061D              +198 	j	fpo_pop_multiply
00:0055CD B60624              +199 	j	fpo_pop_divide
00:0055CE B6062B              +200 	j	fpo_square_root
00:0055CF B60643              +201 	j	fpo_sine
00:0055D0 B60631              +202 	j	fpo_square
00:0055D1 B60637              +203 	j	fpo_cube_root
00:0055D2 B6063D              +204 	j	fpo_cube
00:0055D3 B60649              +205 	j	fpo_cosine
00:0055D4 B6064F              +206 	j	fpo_tangent
00:0055D5 B60655              +207 	j	fpo_cotangent
00:0055D6 B6065B              +208 	j	fpo_sine96
00:0055D7 B60661              +209 	j	fpo_cosine96
00:0055D8 B60667              +210 	j	fpo_tangent96
00:0055D9 B6066D              +211 	j	fpo_cotangent96
00:0055DA B60673              +212 	j	fpo_fraction
00:0055DB B60679              +213 	j	fpo_integer
  :                            214 
  :                            215 fpo_load
00:0055DC 50B001              +216 	lx      1, y				. operand index
00:0055DD F60682              +217 	jxge	outrage				. surely some mistake
00:0055DE 800013              +218 	ax	MESSAGE				. change offset to address
00:0055DF F80002              +219 	c	(fp192_load)	x
00:0055E0 FCF001              +219 
00:0055E1 FF0F4D              +219 
00:0055E2 38000F              +219 
00:0055E3 B605BA              +220 	j	command
  :                            221 
  :                            222 fpo_load_negative
00:0055E4 50B001              +223 	lx	1, y				. operand index
00:0055E5 F60682              +224 	jxge	outrage
00:0055E6 800013              +225 	ax	MESSAGE				. change offset to address
00:0055E7 F80002              +226 	c	(fp192_load_negative) x
00:0055E8 FCF001              +226 
00:0055E9 FF0F4E              +226 
00:0055EA 38000F              +226 
00:0055EB B605BA              +227 	j	command
  :                            228 
  :                            229 fpo_push
00:0055EC 8F0008              +230 	qpush	8
00:0055ED 8F0004              +231 	qpush	a
00:0055EE B605BA              +232 	j	command
  :                            233 
00:0055EF 50B001              +234 fpo_add	lx      1, y				. operand index
00:0055F0 F60682              +235 	jxge	outrage
00:0055F1 800013              +236 	ax	MESSAGE				. change offset to address
00:0055F2 F80002              +237 	c	(fp192_add)   x
00:0055F3 FCF001              +237 
00:0055F4 FF0F4F              +237 
00:0055F5 38000F              +237 
00:0055F6 B605BA              +238 	j	command
  :                            239 
  :                            240 fpo_add_negative
00:0055F7 50B001              +241 	lx	1, y
00:0055F8 F60682              +242 	jxge    outrage
00:0055F9 800013              +243 	ax	MESSAGE
00:0055FA F80002              +244 	c       (fp192_add_negative)   x
00:0055FB FCF001              +244 
00:0055FC FF0F50              +244 
00:0055FD 38000F              +244 
  :                            245 
  :                            246 .	on	fp$r
  :                            247 .	fa	$residue
  :                            248 .	off	fp$r
  :                            249 
00:0055FE B605BA              +250 	j	command
  :                            251 
  :                            252 fpo_multiply
00:0055FF 50B001              +253 	lx	1, y
00:005600 F60682              +254 	jxge	outrage
00:005601 800013              +255 	ax	MESSAGE
00:005602 F80002              +256 	c	(fp192_multiply)   x
00:005603 FCF001              +256 
00:005604 FF0F51              +256 
00:005605 38000F              +256 
00:005606 B605BA              +257 	j	command
  :                            258 
  :                            259 fpo_divide
00:005607 50B001              +260 	lx	1, y
00:005608 F60682              +261 	jxge	outrage
00:005609 800013              +262 	ax	MESSAGE
00:00560A F80002              +263 	c	(fp192_divide)	x
00:00560B FCF001              +263 
00:00560C FF0F52              +263 
00:00560D 38000F              +263 
00:00560E B605BA              +264 	j	command
  :                            265 
  :                            266 fpo_pop_add
00:00560F FCF000              +267 	c	(fp192_add)	0, sp, i
00:005610 FCF001              +267 
00:005611 FF0F4F              +267 
00:005612 38000F              +267 
00:005613 54F008              +268 	lx	8, sp, i
00:005614 10000F              +269 	sx	sp
00:005615 B605BA              +270 	j	command
  :                            271 
  :                            272 fpo_pop_add_negative
00:005616 FCF000              +273 	c	(fp192_add_negative)	0, sp, i
00:005617 FCF001              +273 
00:005618 FF0F50              +273 
00:005619 38000F              +273 
00:00561A 54F008              +274 	lx	 8, sp, i
00:00561B 10000F              +275 	sx	sp
00:00561C B605BA              +276 	j	command
  :                            277 
  :                            278 fpo_pop_multiply
00:00561D FCF000              +279 	c	(fp192_multiply)	0, sp, i
00:00561E FCF001              +279 
00:00561F FF0F51              +279 
00:005620 38000F              +279 
00:005621 54F008              +280 	lx	8, sp, i
00:005622 10000F              +281 	sx	sp
00:005623 B605BA              +282 	j	command
  :                            283 
  :                            284 fpo_pop_divide
00:005624 FCF000              +285 	c	 (fp192_divide)	0, sp, i
00:005625 FCF001              +285 
00:005626 FF0F52              +285 
00:005627 38000F              +285 
00:005628 54F008              +286 	lx	8, sp, i
00:005629 10000F              +287 	sx	sp
00:00562A B605BA              +288 	j	command
  :                            289 
  :                            290 fpo_square_root
00:00562B 8F0008              +291 	c	(square_root192)	a,,float192
00:00562C 8F0004              +291 
00:00562D FCF008              +291 
00:00562E FF0F53              +291 
00:00562F 38000F              +291 
00:005630 B605BA              +292 	j	command
  :                            293 
  :                            294 fpo_square
00:005631 8F0008              +295 	c	(square192)	a,,float192
00:005632 8F0004              +295 
00:005633 FCF008              +295 
00:005634 FF0F54              +295 
00:005635 38000F              +295 
00:005636 B605BA              +296 	j	command
  :                            297 
  :                            298 fpo_cube_root
00:005637 8F0008              +299 	c	(cube_root192)	a,,float192
00:005638 8F0004              +299 
00:005639 FCF008              +299 
00:00563A FF0F55              +299 
00:00563B 38000F              +299 
00:00563C B605BA              +300 	j	command
  :                            301 
  :                            302 fpo_cube
00:00563D 8F0008              +303 	c	(cube192)	a,,float192
00:00563E 8F0004              +303 
00:00563F FCF008              +303 
00:005640 FF0F56              +303 
00:005641 38000F              +303 
00:005642 B605BA              +304 	j	command
  :                            305 
  :                            306 fpo_sine
00:005643 8F0008              +307 	c	(sine192)	a,,float192
00:005644 8F0004              +307 
00:005645 FCF008              +307 
00:005646 FF0F57              +307 
00:005647 38000F              +307 
00:005648 B605BA              +308 	j	command
  :                            309 
  :                            310 fpo_cosine
00:005649 8F0008              +311 	c	(cosine192)	a,,float192
00:00564A 8F0004              +311 
00:00564B FCF008              +311 
00:00564C FF0F58              +311 
00:00564D 38000F              +311 
00:00564E B605BA              +312 	j	command
  :                            313 
  :                            314 fpo_tangent
00:00564F 8F0008              +315 	c	(tangent192)	a,,float192
00:005650 8F0004              +315 
00:005651 FCF008              +315 
00:005652 FF0F59              +315 
00:005653 38000F              +315 
00:005654 B605BA              +316 	j	command
  :                            317 
  :                            318 fpo_cotangent
00:005655 8F0008              +319 	c	(cotangent192)	a,,float192
00:005656 8F0004              +319 
00:005657 FCF008              +319 
00:005658 FF0F5A              +319 
00:005659 38000F              +319 
00:00565A B605BA              +320 	j	command
  :                            321 
  :                            322 fpo_sine96
00:00565B 8F0004              +323 	c	(sine96)		a,,float
00:00565C FCF004              +323 
00:00565D FF0F5B              +323 
00:00565E 38000F              +323 
00:00565F 3E067F              +324 	lcal	trigx
00:005660 B605BA              +325 	j	command
  :                            326 
  :                            327 fpo_cosine96
00:005661 8F0004              +328 	c	(cosine96)		a,,float
00:005662 FCF004              +328 
00:005663 FF0F5C              +328 
00:005664 38000F              +328 
00:005665 3E067F              +329 	lcal	trigx
00:005666 B605BA              +330 	j	command
  :                            331 
  :                            332 fpo_tangent96
00:005667 8F0004              +333 	c	(tangent96)	a,,float
00:005668 FCF004              +333 
00:005669 FF0F5D              +333 
00:00566A 38000F              +333 
00:00566B 3E067F              +334 	lcal	trigx
00:00566C B605BA              +335 	j	command
  :                            336 
  :                            337 fpo_cotangent96
00:00566D 8F0004              +338 	c	(cotangent96)	a,,float
00:00566E FCF004              +338 
00:00566F FF0F5E              +338 
00:005670 38000F              +338 
00:005671 3E067F              +339 	lcal	trigx
00:005672 B605BA              +340 	j	command
  :                            341 
  :                            342 fpo_fraction
00:005673 8F0008              +343 	c	(fraction192)	a,,float192
00:005674 8F0004              +343 
00:005675 FCF008              +343 
00:005676 FF0F5F              +343 
00:005677 38000F              +343 
00:005678 B605BA              +344 	j	command
  :                            345 
  :                            346 fpo_integer
00:005679 8F0008              +347 	c	(integer192)	a,,float192
00:00567A 8F0004              +347 
00:00567B FCF008              +347 
00:00567C FF0F60              +347 
00:00567D 38000F              +347 
00:00567E B605BA              +348 	j	command
  :                            349 
  :                            350 trigx
  :                            351 	$if	1
[+0016]10
00:00567F FD0000              +352 	push	floating_edit,,xi
  :                            353 	$else
  :                            354 	push	floating_edit9p,,xi
  :                            355 	$endif
  :                            356 
(+03)0f
00:005680 3800D3              +357 	pop	editp
00:005681 350000              +358 	lret	0
  :                            359 
00:005682 4F0EB4              +360 outrage	ql	(-0.0)			. indicate the command list didn't make sense
00:005683 470008              +361 	qs	8
  :                            362 
00:005684 500012              +363 exitu	lx	STACK_GUARD
00:005685 10000F              +364 	sx	sp
  :                            365 
00:005686 050008              +366 	on	fp$r
00:005687 670008              +367 	fa	8
00:005688 0D0008              +368 	off	fp$r
00:005689 350000              +369 	lret	0
  :                            370 
  :                            371 	$root
  :                            156 	$path	../apps.lib
  :                            157: 	$include aplib192
  :                            1 ap_lib192	$tree
  :                            2 
  :                            3 .	arguments in internal stack
  :                            4 .	as for programming languages
  :                            5 .	read-only arguments may be by pointer
  :                            6 .	return is in registers a:b:mantissa2:mantissa3:8:9:10:11
  :                            7 
  :                            8 square_root
                                	$head_far	 params(magnitude2,	float192)		;
                                			scalars(trial2,		float192, magnitude2	;
                                				diminuition2,	float192, (0.5o)	;
00:00568A 8FF007              +12 				signs2,		int, magnitude2		)
00:00568B 8FF007              +12 
00:00568C 8F0F65              +12 
00:00568D 8F0F61              +12 
00:00568E F8F013              +12 
  :                            13 
  :                            14 .	vector name is square_root
  :                            15 
00:00568F 60F000              +16 	la	signs2
00:005690 A60695              +17 	jpa	square_away
00:005691 54F014              +18 	lx	magnitude2,,i
00:005692 3E073D              +19 	lcal	flip8
00:005693 54F009              +20 	lx	trial2,,i
00:005694 3E073D              +21 	lcal	flip8	
  :                            22 
  :                            23 square_away
  :                            24 
00:005695 600F69              +25 	la	(0400000)
00:005696 D0F009              +26 	ana	trial2
00:005697 7E069E              +27 	jc	uprate			. exponent: 0400000- 
  :                            28 					.        a: 0400000-exponent
  :                            29 
  :                            30 .	some smallest numbers need kinder rounding
  :                            31 .	but leave that to the caller
  :                            32 
00:005698 60F009              +33 	la	trial2
00:005699 A00F6A              +34 	and	(03FFFFF)
00:00569A C50001              +35 	aa	1,,xi			. halve scale above midpoint
00:00569B 060001              +36 	sar	1			. 0400001 changes to 0400001
00:00569C 900F69              +37 	or	(0400000)
  :                            38 
00:00569D B606A1              +39 	j	start_variation
  :                            40 
00:00569E C50001              +41 uprate	aa	1,,xi			. add half the undershot to midpoint
00:00569F 060001              +42 	sar	1			. 0400000 changes to 0400000
00:0056A0 C0F009              +43 	aa	trial2
  :                            44 
  :                            45 start_variation
  :                            46 
00:0056A1 20F001              +47 	sa	diminuition2		. set initial exponent of +- variable
00:0056A2 20F009              +48 	sa	trial2
00:0056A3 C5FFB8              +49 	aa	-72,,xi
00:0056A4 20F00D              +50 	sa	trial2+4
00:0056A5 450090              +51 	lr	144,,xi			. start the fateful count
  :                            52 					. don't worry, you may escape before the count is out
  :                            53 downrate
00:0056A6 4FF00D              +54 	ql	trial2+4
00:0056A7 470008              +55 	qs	8
  :                            56 
  :                            57 downrate_again!
00:0056A8 4FF009              +58 	ql	trial2
  :                            59 
00:0056A9 FCF009              +60 	c	(fp192_multiply)	trial2,,i
00:0056AA FCF001              +60 
00:0056AB FF0F51              +60 
00:0056AC 38000F              +60 
00:0056AD FCF014              +61 	c	(fp192_add_negative)	magnitude2,,i
00:0056AE FCF001              +61 
00:0056AF FF0F50              +61 
00:0056B0 38000F              +61 
  :                            62 
00:0056B1 7C06C7              +63 	jdz	arrive
00:0056B2 A606BB              +64 	jpa	downrate_down
  :                            65 
00:0056B3 4FF00D              +66 	ql	trial2+4
00:0056B4 470008              +67 	qs	8
00:0056B5 4FF009              +68 	ql	trial2
  :                            69 
00:0056B6 FCF001              +70 	c	(fp192_add)		diminuition2,,i
00:0056B7 FCF001              +70 
00:0056B8 FF0F4F              +70 
00:0056B9 38000F              +70 
00:0056BA B606C2              +71 	j	downrate_again?
  :                            72 
  :                            73 downrate_down
  :                            74 
00:0056BB 4FF00D              +75 	ql	trial2+4
00:0056BC 470008              +76 	qs	8
00:0056BD 4FF009              +77 	ql	trial2
  :                            78 
00:0056BE FCF001              +79 	c	(fp192_add_negative)	diminuition2,,i
00:0056BF FCF001              +79 
00:0056C0 FF0F50              +79 
00:0056C1 38000F              +79 
  :                            80 
  :                            81 downrate_again?
00:0056C2 47F009              +82 	qs	trial2			. store the candidate value
00:0056C3 4F0008              +83 	ql	8
00:0056C4 47F00D              +84 	qs	trial2+4
  :                            85 
00:0056C5 1FF001              +86 	dec	diminuition2		. scale of variation
00:0056C6 1E06A8              +87 	jdr	downrate_again!
  :                            88 
00:0056C7 54F009              +89 arrive	lx	trial2,,i
00:0056C8 78F000              +90 	tp	signs2
00:0056C9 3E073D              +91 	lcal	flip8
00:0056CA FCF009              +92 	push	8+1, sp, i
00:0056CB 38000F              +93 	pop	sp
  :                            94 
00:0056CC 870004              +95 	qpop	a
00:0056CD 870008              +96 	qpop	8
00:0056CE 3D0000              +97 	fret	0
  :                            98 
  :                            99 .	vector name square
  :                            100 
                                square	$head_far	 params(root, 		float192)	;
                                			scalars(polar,		int, root	;
00:0056CF F8F003              +103 				caller_x,	int, x)
00:0056D0 F80002              +103 
  :                            104 
00:0056D1 FCF005              +105 	c	(fp192_mfa)	root,,i	root,,i
00:0056D2 FCF006              +105 
00:0056D3 FCF002              +105 
00:0056D4 FF0F6B              +105 
00:0056D5 38000F              +105 
  :                            106 
00:0056D6 4FF005              +107 	ql	root		. load and supernormalise
00:0056D7 050008              +108 	on	fp$r
00:0056D8 67F009              +109 	fa	root+4
00:0056D9 0D0008              +110 	off	fp$r
  :                            111 
00:0056DA 550004              +112 	lx	a,,xi		. retrieve input sign
00:0056DB 78F001              +113 	tp	polar
00:0056DC 3E073D              +114 	lcal	flip8
  :                            115 
00:0056DD 380002              +116 	pop	x		. restore caller x
00:0056DE 17000F              +117 	inc	sp		. clear stack
00:0056DF 3D0000              +118 	fret	0
  :                            119 
  :                            120 
  :                            121 cube_root
                                	$head_far	 params(magnitude3,	float192)		;
                                			scalars(trial3,		float192, magnitude3	;
                                				diminuition3,	float192, (0.5o)	;
00:0056E0 8FF007              +125 				signs3,		int,	  magnitude3	)
00:0056E1 8FF007              +125 
00:0056E2 8F0F65              +125 
00:0056E3 8F0F61              +125 
00:0056E4 F8F013              +125 
  :                            126 
  :                            127 .	vector name cube_root
  :                            128 
00:0056E5 60F014              +129 	la	magnitude3
00:0056E6 A606EB              +130 	jpa	root3_start
  :                            131 
00:0056E7 54F014              +132 	lx	magnitude3,,i		. must work in positive magnitude
00:0056E8 3E073D              +133 	lcal	flip8			. because of subtraction
00:0056E9 54F009              +134 	lx	trial3,,i		. which compares the filtered trial root
00:0056EA 3E073D              +135 	lcal	flip8
  :                            136 
  :                            137 root3_start
00:0056EB 680F69              +138 	lb	(0400000)
00:0056EC D8F009              +139 	anb	trial3
00:0056ED 7E06F4              +140 	jc	up3wards		. scale is midpoint/less
  :                            141 
00:0056EE 68F009              +142 	lb	trial3
00:0056EF A80F6A              +143 	andB	(03FFFFF)		. isolate the net positive scale
  :                            144 
00:0056F0 CD0002              +145 	ab	2,,xi			. 0400001..2 -> 0400001
00:0056F1 E80F6C              +146 	mf	(0555556)		. thirdify the net positive scale
  :                            147 
00:0056F2 900F69              +148 	or	(0400000)		. new exponent in a
00:0056F3 B606F6              +149 	j	scale_away3
  :                            150 
  :                            151 up3wards	. distance up to midpoint is positive in b
  :                            152 
00:0056F4 E80F6C              +153 	mf	(0555556)		. thirdify he and round he down
00:0056F5 C0F009              +154 	aa	trial3			. quotient is in a
  :                            155 
  :                            156 scale_away3
  :                            157 
00:0056F6 20F001              +158 	sa	diminuition3		. set initial exponent of +- variable
00:0056F7 20F009              +159 	sa	trial3
00:0056F8 C5FFB8              +160 	aa	-72,,xi			. minor part is already normalised
00:0056F9 20F00D              +161 	sa	trial3+4
00:0056FA 450090              +162 	lr	144,,xi			. start the fateful count
  :                            163 					. don't worry, you may escape before the count is out
  :                            164 downrate3
00:0056FB 4FF00D              +165 	ql	trial3+4
00:0056FC 470008              +166 	qs	8
  :                            167 downrate3_again!
00:0056FD 4FF009              +168 	ql	trial3
  :                            169 
00:0056FE FCF009              +170 	c	(fp192_multiply)	trial3,,i
00:0056FF FCF001              +170 
00:005700 FF0F51              +170 
00:005701 38000F              +170 
00:005702 FCF009              +171 	c	(fp192_multiply)	trial3,,i
00:005703 FCF001              +171 
00:005704 FF0F51              +171 
00:005705 38000F              +171 
00:005706 FCF014              +172 	c	(fp192_add_negative)	magnitude3,,i
00:005707 FCF001              +172 
00:005708 FF0F50              +172 
00:005709 38000F              +172 
  :                            173 
00:00570A 7C0725              +174 	jdz	arrive3
00:00570B A60718              +175 	jpa	downrate3_down
  :                            176 
00:00570C 4FF009              +177 	ql	trial3
00:00570D 050008              +178 	on	fp$r
00:00570E 67F00D              +179 	fa	trial3+4
00:00570F 0D0008              +180 	off	fp$r
  :                            181 
  :                            182 			. for the benefit of fractions
  :                            183 			. if under, don't diminish the diminuend
  :                            184 			. and don't decrement the count in r
  :                            185 			. just add to the candidate root and loop back
  :                            186 
00:005710 FCF001              +187 	c	(fp192_add)		diminuition3,,i
00:005711 FCF001              +187 
00:005712 FF0F4F              +187 
00:005713 38000F              +187 
00:005714 47F009              +188 	qs	trial3
00:005715 4F0008              +189 	ql	8
00:005716 47F00D              +190 	qs	trial3+4
00:005717 B606FD              +191 	j	downrate3_again!	. _again?
  :                            192 
  :                            193 downrate3_down
  :                            194 
00:005718 4FF009              +195 	ql	trial3
00:005719 050008              +196 	on	fp$r
00:00571A 67F00D              +197 	fa	trial3+4
00:00571B 0D0008              +198 	off	fp$r
  :                            199 
00:00571C FCF001              +200 	c	(fp192_add_negative)	diminuition3,,i
00:00571D FCF001              +200 
00:00571E FF0F50              +200 
00:00571F 38000F              +200 
  :                            201 
00:005720 1FF001              +202 	dec	diminuition3		. scale of variation
  :                            203 
  :                            204 downrate3_again?
  :                            205 
00:005721 47F009              +206 	qs	trial3			. store the candidate value
00:005722 4F0008              +207 	ql	8
00:005723 47F00D              +208 	qs	trial3+4
  :                            209 
  :                            210 .	dec	diminuition3		. scale of variation
00:005724 1E06FD              +211 	jdr	downrate3_again!
  :                            212 
00:005725 54F009              +213 arrive3	lx	trial3,,i
00:005726 78F000              +214 	tp	signs3
00:005727 3E073D              +215 	lcal	flip8
  :                            216 
00:005728 FCF009              +217 	push	8+1, sp, i
00:005729 38000F              +218 	pop	sp
  :                            219 
00:00572A 870004              +220 	qpop	a
00:00572B 870008              +221 	qpop	8
00:00572C 050008              +222 	on	fp$r
00:00572D 670008              +223 	fa	$residue
00:00572E 0D0008              +224 	off	fp$r
00:00572F 3D0000              +225 	fret	0
  :                            226 
  :                            227 .	vector name cube
  :                            228 
  :                            229 cube	$head_far	 params(cubase,	float192)
00:005730 4FF003              +230 	ql	cubase
00:005731 050008              +231 	on	fp$r
00:005732 67F007              +232 	fa	cubase+4
00:005733 0D0008              +233 	off	fp$r
  :                            234 
00:005734 FCF003              +235 	c	(fp192_multiply)	cubase,,i
00:005735 FCF001              +235 
00:005736 FF0F51              +235 
00:005737 38000F              +235 
00:005738 FCF003              +236 	c	(fp192_multiply)	cubase,,i
00:005739 FCF001              +236 
00:00573A FF0F51              +236 
00:00573B 38000F              +236 
00:00573C 3D0000              +237 	fret	0
  :                            238 
00:00573D 0FA000              +239 flip8	n	0, x
00:00573E 0FA001              +240 	n	1, x
00:00573F 0FA002              +241 	n	2, x
00:005740 0FA003              +242 	n	3, x
00:005741 0FA004              +243 	n	4, x
00:005742 0FA005              +244 	n	5, x
00:005743 0FA006              +245 	n	6, x
00:005744 0FA007              +246 	n	7, x
00:005745 350000              +247 	lret	0
  :                            248 
  :                            249 .	vector name fraction
  :                            250 
  :                            251 fraction $tree
                                	$head_far	 params(input,	float192)	;
00:005746 8F0000              +253 			scalars(i_rkxy,	float,	r	)
  :                            254 
00:005747 4FF007              +255 	ql	input		. read and supernormalise
00:005748 050008              +256 	on 	fp$r
00:005749 67F00B              +257 	fa	input+4
00:00574A 0D0008              +258 	off	fp$r
  :                            259 
00:00574B 500004              +260 	lx	a		. obtain exponent magnitude
00:00574C 780002              +261 	tp	x
00:00574D 0F0002              +262 	n	x
  :                            263 
00:00574E 800F6D              +264 	ax	(-0400000)	. obtain relation to midpoint
00:00574F 700002              +265 	tz	x
00:005750 780002              +266 	tp	x
00:005751 B60763              +267 	j	all_fraction	. there is no integer part: return all of it
00:005752 450090              +268 	lr	144,,xi
00:005753 F60760              +269 	jxge	all_integer	. there is no fraction part: return zero
  :                            270 
00:005754 8F0008              +271 	c	(integer192)	a,,float192
00:005755 8F0004              +271 
00:005756 FCF008              +271 
00:005757 FF0F60              +271 
00:005758 38000F              +271 
  :                            272 
00:005759 550004              +273 	lx	a,,xi
00:00575A 3E073D              +274 	lcal	ap_lib192:flip8	. reverse polarity to effect subtract from addend
  :                            275 
00:00575B FCF007              +276 	c	(fp192_add)	input,,i
00:00575C FCF001              +276 
00:00575D FF0F4F              +276 
00:00575E 38000F              +276 
00:00575F B60763              +277 	j	complete
  :                            278 	
  :                            279 all_integer
00:005760 960030              +280 	dsa	48
00:005761 C70006              +281 	ds	6
00:005762 470008              +282 	qs	8
  :                            283 all_fraction
  :                            284 complete
00:005763 870000              +285 	qpop	r
00:005764 3D0000              +286 	fret	0
  :                            287 
  :                            288 	$root
  :                            289 
  :                            290 .	vector name integer
  :                            291 
  :                            292 integer	$tree
                                	$head_far	 params(input,	float192)	;
00:005765 8F0000              +294 			scalars(i_rkxy,	float,	r	)
  :                            295 
00:005766 4FF007              +296 	ql	input		. read and supernormalise
00:005767 050008              +297 	on	fp$r
00:005768 67F00B              +298 	fa	input+4
00:005769 0D0008              +299 	off	fp$r
  :                            300 
00:00576A 500004              +301 	lx	a		. obtain exponent magnitude
00:00576B 780002              +302 	tp	x
00:00576C 0F0002              +303 	n	x
  :                            304 
00:00576D 800F6D              +305 	ax	(-0400000)	. obtain relation to midpoint
00:00576E 700002              +306 	tz	x
00:00576F 780002              +307 	tp	x
00:005770 B60789              +308 	j	all_fraction	. there is no integer part: return 0
00:005771 450090              +309 	lr	144,,xi
00:005772 F6078C              +310 	jxge	all_integer	. there is no fraction part: return all of it
  :                            311 
00:005773 450048              +312 	lr	72,,xi
00:005774 F6077C              +313 	jxge	major_part_plus	. the result includes the major part
  :                            314 				. and possibly some of the minor part
  :                            315 major_part_only
00:005775 C7F007              +316 	ds	input
00:005776 960030              +317 	dsa	48		. some signs for the minor part
00:005777 C70008              +318 	ds	8		. the result is some of the major part
00:005778 C7000A              +319 	ds	10
00:005779 CFF007              +320 	dl	input		.
  :                            321 
00:00577A 3E07B8              +322 	lcal	ap_lib96:sign_around
00:00577B B6078C              +323 	j	complete
  :                            324 
  :                            325 major_part_plus
  :                            326 
00:00577C 500008              +327 	lx	8		. obtain magnitude minor exponent
00:00577D 780002              +328 	tp	x
00:00577E 0F0002              +329 	n	x
  :                            330 
00:00577F 800F6D              +331 	ax	(-0400000)	. obtain relation to midpoint
00:005780 700002              +332 	tz	x
00:005781 780002              +333 	tp	x
00:005782 B60775              +334 	j	major_part_only	. all expected bits were signs
  :                            335 				. and normalised out
  :                            336 
00:005783 47F007              +337 	qs	input
00:005784 4F0008              +338 	ql	8
00:005785 3E07B8              +339 	lcal	ap_lib96:sign_around
00:005786 470008              +340 	qs	8
00:005787 4FF007              +341 	ql	input
00:005788 B6078C              +342 	j	complete
  :                            343 	
  :                            344 all_fraction
00:005789 960030              +345 	dsa	48
00:00578A C70006              +346 	ds	6
00:00578B 470008              +347 	qs	8
  :                            348 all_integer
  :                            349 complete
00:00578C 870000              +350 	qpop	r
00:00578D 3D0000              +351 	fret	0
  :                            352 
  :                            353 	$root		. of routine ap_lib192:integer
  :                            354 
  :                            355 	$root		. of block ap_lib:192
  :                            158: 	$include aplib96
  :                            1 
  :                            2 ap_lib96 $tree
  :                            3 
  :                            4 .	vector name fraction96
  :                            5 
  :                            6 fraction $tree
                                	$head_far	 params(input,	float	)	;
00:00578E 8F0000              +8 			scalars(i_rkxy,	float,	r	)
  :                            9 
00:00578F 4FF007              +10 	ql	input
00:005790 500004              +11 	lx	a
00:005791 780002              +12 	tp	x		. obtain magnitude exponent
00:005792 0F0002              +13 	n	x
00:005793 800F6D              +14 	ax	(-0400000)	. obtain relation to midpoint
00:005794 700002              +15 	tz	x
00:005795 780002              +16 	tp	x
00:005796 B607A5              +17 	j	all_fraction	. no integer part, don't tamper
00:005797 450048              +18 	lr	72,,xi
00:005798 F607A3              +19 	jxge	all_integer	. no fraction part, zero the fraction
  :                            20 
00:005799 8FF007              +21 	c	(integer96)	input,,float
00:00579A FCF004              +21 
00:00579B FF0F6E              +21 
00:00579C 38000F              +21 
00:00579D 0F0004              +22 	n	a
00:00579E 0F0005              +23 	n	b
00:00579F 0F0006              +24 	n	6
00:0057A0 0F0007              +25 	n	7		. subtract the integer part
00:0057A1 67F007              +26 	fa	input		. fromm the fraction
00:0057A2 B607A5              +27 	j	complete
  :                            28 
  :                            29 all_integer
00:0057A3 960030              +30 	dsa	48
00:0057A4 C70006              +31 	ds	6
  :                            32 
  :                            33 all_fraction
  :                            34 complete
00:0057A5 870000              +35 	qpop	r
00:0057A6 3D0000              +36 	fret	0
  :                            37 
  :                            38 	$root
  :                            39 
  :                            40 
  :                            41 .	vector name integer96
  :                            42 
  :                            43 integer	$tree
                                	$head_far	 params(input,	float	)	;	. pointer rto float
00:0057A7 8F0000              +45 			scalars(i_rkxy,	float,	r	)
  :                            46 
00:0057A8 4FF007              +47 	ql	input
00:0057A9 500004              +48 	lx	a
00:0057AA 780002              +49 	tp	x		. obtain magnitude exponent
00:0057AB 0F0002              +50 	n	x
00:0057AC 800F6D              +51 	ax	(-0400000)	. obtain relation to midpoint
00:0057AD 700002              +52 	tz	x
00:0057AE 780002              +53 	tp	x
00:0057AF B607B4              +54 	j	all_fraction	. no integer part, zero the integer
00:0057B0 450048              +55 	lr	72,,xi
00:0057B1 F607B6              +56 	jxge	all_integer	. no fraction part, don't tamper
  :                            57 
00:0057B2 3E07B8              +58 	lcal	ap_lib96:sign_around
  :                            59 
00:0057B3 B607B6              +60 	j	complete
  :                            61 
  :                            62 all_fraction
00:0057B4 960030              +63 	dsa	48
00:0057B5 C70006              +64 	ds	6
  :                            65 
  :                            66 all_integer
  :                            67 complete
00:0057B6 870000              +68 	qpop	r
00:0057B7 3D0000              +69 	fret	0
  :                            70 	$root
  :                            71 
  :                            72 sign_around					. write signs to mantissa bits [x]+
00:0057B8 8F0004              +73 	$head_near	scalars(output,	float,	a)
  :                            74 
00:0057B9 860018              +75 	saa	24
  :                            76 
00:0057BA 450030              +77 	lr	48,,xi
00:0057BB F607CC              +78 	jxge	insert7
00:0057BC 450018              +79 	lr	24,,xi
00:0057BD F607C5              +80 	jxge	insert6
  :                            81 
00:0057BE 20F003              +82 	sa	output+3
00:0057BF 20F002              +83 	sa	output+2
00:0057C0 68F001              +84 	lb	output+1
00:0057C1 76A000              +85 	drl	0, x
00:0057C2 46A000              +86 	rar	0, x
00:0057C3 20F001              +87 	sa	output+1
00:0057C4 B607D1              +88 	j	reload
  :                            89 
00:0057C5 20F003              +90 insert6	sa	output+3
00:0057C6 68F002              +91 	lb	output+2
00:0057C7 85FFE8              +92 	ax	-24,,xi
00:0057C8 76A000              +93 	drl	0, x
00:0057C9 46A000              +94 	rar	0, x
00:0057CA 20F002              +95 	sa	output+2
00:0057CB B607D1              +96 	j	reload
  :                            97 
00:0057CC 68F003              +98 insert7	lb	output+3
00:0057CD 85FFD0              +99 	ax	-48,,xi
00:0057CE 76A000              +100 	drl	0, x
00:0057CF 46A000              +101 	rar	0, x
00:0057D0 20F003              +102 	sa	output+3
  :                            103 	
00:0057D1 870004              +104 reload	qpop	a
00:0057D2 350000              +105 	lret	0
  :                            106 
  :                            107 	$root
  :                            159 
  :                            160: 	$include trig192
  :                            1 trig192	$tree
  :                            2 
  :                            3 RECIPROCAL_READY $equ	1
  :                            4 
  :                            5 	$if	1
  :                            6 _RADIAN_FACTOR $equ	1.7453292519943295769236907684886127134428719z*-2
  :                            7 	$else
  :                            8 _RADIAN_FACTOR $equ 0.01745329252z	. 168-bit expression expression + 24 extra signs
  :                            9 	$endif
  :                            10 
  :                            11 _PASSES	$equ	18
  :                            12 
  :                            13 .	vector name sine
  :                            14 
  :                            15 sine	$tree									. quadrant looks after itself
                                	$head_far	 params(angle,	float192)			;	. trim to % 360 degrees here
00:0057D3 8F0000              +17 			scalars(u_rkxy,	float,		r		)
  :                            18 
00:0057D4 FCF007              +19 	lc	trig192:_sine	angle,,i
00:0057D5 FCF001              +19 
00:0057D6 3E0819              +19 
00:0057D7 38000F              +19 
00:0057D8 870000              +20 	qpop	r
00:0057D9 3D0000              +21 	fret	0
  :                            22 	$root
  :                            23 
  :                            24 
  :                            25 .	vector name cosine
  :                            26 
  :                            27 cosine	$tree
                                	$head_far	 params(angle,	float192)			;
00:0057DA 8F0000              +29 			scalars(u_rkxy,	float,		r		)
  :                            30 
  :                            31 							. trim to % 360 degrees before the next step
  :                            32 							. or values > 180 are negative to infinity
  :                            33 							. instead of retraversing + and - quadrants
  :                            34 
00:0057DB 4F0EA5              +35 	ql	(0.0)				. 	constant 90.0 is loaded up
00:0057DC 470008              +36 	qs	8					. because it can't be pointed in reference
00:0057DD 4F0F6F              +37 	ql	(90.0)					. to a different B0 section, fp192lib
00:0057DE FCF007              +38 	c	(fp192_add_negative)	angle,,i
00:0057DF FCF001              +38 
00:0057E0 FF0F50              +38 
00:0057E1 38000F              +38 
00:0057E2 47F007              +39 	qs	angle
00:0057E3 4F0008              +40 	ql	8
00:0057E4 47F00B              +41 	qs	angle+4
  :                            42 
00:0057E5 FCF007              +43 	lc	trig192:_sine	angle,,i
00:0057E6 FCF001              +43 
00:0057E7 3E0819              +43 
00:0057E8 38000F              +43 
00:0057E9 870000              +44 	qpop	r
00:0057EA 3D0000              +45 	fret	0
  :                            46 	$root
  :                            47 
  :                            48 
  :                            49 .	vector name tangent
  :                            50 
  :                            51 tangent	$tree
                                	$head_far	 params(angle,	float192)		;
                                								;
                                			scalars(cosine,	float192		;
00:0057EB 8F0EA5              +55 				u_rkxy,	float,	r		)
00:0057EC 8FF000              +55 
00:0057ED 8F0000              +55 
  :                            56 
00:0057EE 8FF013              +57 	c	(cosine192)		angle,,float192		. this is a copy on the internal stack
00:0057EF 8FF013              +57 
00:0057F0 FCF008              +57 
00:0057F1 FF0F58              +57 
00:0057F2 38000F              +57 
00:0057F3 47F004              +58 	qs	cosine						. angle gets changed to radian
00:0057F4 4F0008              +59 	ql	8
00:0057F5 47F008              +60 	qs	cosine+4
  :                            61 
00:0057F6 FCF00F              +62 	lc	trig192:_sine		angle,,i		. this is not copied. _sine updates it
00:0057F7 FCF001              +62 
00:0057F8 3E0819              +62 
00:0057F9 38000F              +62 
00:0057FA FCF004              +63 	c	(fp192_divide)	cosine,,i
00:0057FB FCF001              +63 
00:0057FC FF0F52              +63 
00:0057FD 38000F              +63 
  :                            64 
00:0057FE 870000              +65 	qpop	r
00:0057FF FCF008              +66 	push	8,sp,i
00:005800 38000F              +67 	pop	sp
00:005801 3D0000              +68 	fret	0
  :                            69 
  :                            70 	$root
  :                            71 
  :                            72 cotangent $tree
                                	$head_far	 params(angle,	float192)		;
                                								;
                                			scalars(sine,	float192, angle		;
00:005802 8FF007              +76 				u_rkxy,	float,	r		)
00:005803 8FF007              +76 
00:005804 8F0000              +76 
  :                            77 
00:005805 FCF004              +78 	lc	trig192:_sine		sine,,i			. second copy of angle, updated
00:005806 FCF001              +78 
00:005807 3E0819              +78 
00:005808 38000F              +78 
00:005809 47F004              +79 	qs	sine
00:00580A 4F0008              +80 	ql	8
00:00580B 47F008              +81 	qs	sine+4
  :                            82 
00:00580C 8FF013              +83 	c	(cosine192)		angle,,float192		. this is copied and not an address
00:00580D 8FF013              +83 
00:00580E FCF008              +83 
00:00580F FF0F58              +83 
00:005810 38000F              +83 
00:005811 FCF004              +84 	c	(fp192_divide)	sine,,i
00:005812 FCF001              +84 
00:005813 FF0F52              +84 
00:005814 38000F              +84 
  :                            85 
00:005815 870000              +86 	qpop	r
00:005816 FCF008              +87 	push	8, sp, i
00:005817 38000F              +88 	pop	sp
00:005818 3D0000              +89 	fret	0
  :                            90 	$root
  :                            91 
  :                            92 _sine
  :                            93 	$if	RECIPROCAL_READY
  :                            94 
                                	$head_near	 params(anglep, int)			;
                                								;
                                			scalars(power,	float192		;
00:005819 8F0EA5              +98 				square,	float192		)
00:00581A 8FF000              +98 
00:00581B 8F0EA5              +98 
00:00581C 8FF000              +98 
  :                            99 
00:00581D 5D08BF              +100 	ly	reciprocal_factorials,,xi
  :                            101 
  :                            102 	$else
  :                            103 
                                	$head_near	 params(anglep, int)					;
                                										;
                                			 scalars(power,	float192				;
                                				square,	float192				;
                                				factorial, float192 		;
  :                            109 				factor,	float192		)
  :                            110 
  :                            111 	ql	(6.0)
  :                            112 	qs	factorial
  :                            113 	ql	(3.0)
  :                            114 	qs	factor
  :                            115 	ql	(0.0)
  :                            116 	qs	factorial+4
  :                            117 	qs	factor+4
  :                            118 
  :                            119 	$endif
  :                            120 
00:00581E F8F012              +121 	lc	encircle	anglep			. 360 remainder
00:00581F FCF001              +121 
00:005820 3E089E              +121 
00:005821 38000F              +121 
  :                            122 
00:005822 50F012              +123 	lx	anglep
00:005823 4F087A              +124 	ql	_radian_factor+4			. _RADIAN_FACTOR constant is loaded up
00:005824 470008              +125 	qs	8					. because it can't be pointed in reference
00:005825 4F0876              +126 	ql	_radian_factor				. to a different B0 section, fp192lib
  :                            127 
00:005826 F80002              +128 	c	(fp192_multiply)	x
00:005827 FCF001              +128 
00:005828 FF0F51              +128 
00:005829 38000F              +128 
  :                            129 
00:00582A 47A000              +130 	qs	0, x
00:00582B 4F0008              +131 	ql	8
00:00582C 47A004              +132 	qs	4, x
00:00582D 4FA000              +133 	ql	0, x
  :                            134 
00:00582E F80002              +135 	c	(fp192_multiply) x			. square the angle in radians
00:00582F FCF001              +135 
00:005830 FF0F51              +135 
00:005831 38000F              +135 
00:005832 47F000              +136 	qs	square					. square is the power multiplier
00:005833 4F0008              +137 	ql	8
00:005834 47F004              +138 	qs	square+4
00:005835 4FF000              +139 	ql	square
  :                            140 
00:005836 F80002              +141 	c	(fp192_multiply) x			. and cube is the initial power
00:005837 FCF001              +141 
00:005838 FF0F51              +141 
00:005839 38000F              +141 
  :                            142 
00:00583A 47F008              +143 	qs	power
00:00583B 4F0008              +144 	ql	8
00:00583C 47F00C              +145 	qs	power+4					. initially power is cube
00:00583D 4FF008              +146 	ql	power
  :                            147 
00:00583E 450012              +148 	lr	_PASSES,,xi
00:00583F B6085D              +149 	j	_nomial					. start on the minus kick
  :                            150 
  :                            151 _NEXT_FACTORIAL* $proc
  :                            152 	$if	RECIPROCAL_READY
  :                            153 	ay	8,,xi
  :                            154 	$else
  :                            155 	ql	factor
  :                            156 	fa	(1.0)
  :                            157 	qs	factor
  :                            158 	c	(fp192_mfa)	factorial,,i	factor,,i
  :                            159 	ql	factor
  :                            160 	fa	(1.0)
  :                            161 	qs	factor
  :                            162 	c	(fp192_mfa)	factorial,,i	factor,,i
  :                            163 	$endif
  :                            164 	$end
  :                            165 
  :                            166 _NEXT_POWER* $proc
  :                            167 	c	(fp192_mfa)	power,,i	square,,i
  :                            168 	$end
  :                            169 
00:005840 47A000              +170 _poly	qs	0, x					. the plus kick
00:005841 4F0008              +171 	ql	8
00:005842 47A004              +172 	qs	4, x
00:005843 8D0008              +173 	_NEXT_FACTORIAL
00:005844 FCF000              +174 	_NEXT_POWER
00:005845 FCF009              +174 
00:005846 FCF002              +174 
00:005847 FF0F6B              +174 
00:005848 38000F              +174 
  :                            175 
  :                            176 	$if	RECIPROCAL_READY
00:005849 4FB000              +177 	ql	0, y
00:00584A 050008              +178 	on	fp$r
00:00584B 67B004              +179 	fa	4, y
  :                            180 	$else
  :                            181 	c	(reciprocal192)	factorial,,float192
  :                            182 	$endif
00:00584C FCF008              +183 	c	(fp192_multiply)	power,,i	. 
00:00584D FCF001              +183 
00:00584E FF0F51              +183 
00:00584F 38000F              +183 
  :                            184 .	c	(fp192_divide) factorial,,i		. divide power(angle) by factorial
00:005850 F80002              +185 	c	(fp192_add) x			. add quotient to running total
00:005851 FCF001              +185 
00:005852 FF0F4F              +185 
00:005853 38000F              +185 
00:005854 47A000              +186 	qs	0, x
00:005855 4F0008              +187 	ql	8
00:005856 47A004              +188 	qs	4, x
00:005857 8D0008              +189 	_NEXT_FACTORIAL
00:005858 FCF000              +190 	_NEXT_POWER
00:005859 FCF009              +190 
00:00585A FCF002              +190 
00:00585B FF0F6B              +190 
00:00585C 38000F              +190 
  :                            191 _nomial
  :                            192 	$if	RECIPROCAL_READY
00:00585D 4FB000              +193 	ql	0, y
00:00585E 050008              +194 	on	fp$r
00:00585F 67B004              +195 	fa	4, y
  :                            196 	$else
  :                            197 	c	(reciprocal192)	factorial,,float192
  :                            198 	$endif
00:005860 FCF008              +199 	c	(fp192_multiply)	power,,i
00:005861 FCF001              +199 
00:005862 FF0F51              +199 
00:005863 38000F              +199 
  :                            200 .	c	(fp192_divide) factorial,,i		. divide power(angle) by factorial
00:005864 0F0004              +201 	n	a
00:005865 0F0005              +202 	n	b
00:005866 0F0006              +203 	n	6
00:005867 0F0007              +204 	n	7
00:005868 0F0008              +205 	n	8
00:005869 0F0009              +206 	n	9
00:00586A 0F000A              +207 	n	10
00:00586B 0F000B              +208 	n	11
00:00586C F80002              +209 	c	(fp192_add)	x			. subtract quotient from runnning total
00:00586D FCF001              +209 
00:00586E FF0F4F              +209 
00:00586F 38000F              +209 
00:005870 1E0840              +210 	jdr	_poly
  :                            211 
00:005871 3E088E              +212 	lcal	eliminate_microdust
00:005872 3E087E              +213 	lcal	trim
  :                            214 
00:005873 FCF010              +215 	$ret
00:005874 38000F              +215 
00:005875 350000              +215 
  :                            216 
00:005876 3FFFFB8EFA351294E9C8AE0E
                              +217 _radian_factor	major_minor	_RADIAN_FACTOR
00:00587A 3FFFB3C5F66E9485C4D900B8
                              +217 
  :                            218 
  :                            219 	$if	1
00:00587E F80004              +220 trim	push	a		. if 96 mantissa bits are nonsign change it all to nonsign
00:00587F 860018              +221 	saa	24		. it's likely to round up after that
00:005880 4DFFFF              +222 	lk	-1,,xi		. mask = all 24 bits
00:005881 B5FFFF              +223 	xor	-1,,xi		. test = value = not signs
00:005882 AF0005              +224 	mta	b
00:005883 B6088C              +225 	j	trimmed
00:005884 AF0006              +226 	mta	6
00:005885 B6088C              +227 	j	trimmed
00:005886 AF0007              +228 	mta	7
00:005887 B6088C              +229 	j	trimmed
00:005888 AF0009              +230 	mta	9		. don't mess with the normalised position of minor mantissa
00:005889 B6088C              +231 	j	trimmed		. or its exponent in register 8
00:00588A 20000A              +232 	sa	10
00:00588B 20000B              +233 	sa	11
00:00588C 380004              +234 trimmed	pop	a
00:00588D 350000              +235 	lret	0
  :                            236 	$endif
  :                            237 
  :                            238 	$if	1
  :                            239 eliminate_microdust			. change any microscopic number to true result 0
00:00588E 480F73              +240 	lk	(0800000s)
00:00588F AF0005              +241 	mta	b
00:005890 3E0892              +242 	lcal	eliminate_normalised	. it is nonzero so check its range
00:005891 350000              +243 	lret	0
  :                            244 
  :                            245 eliminate_normalised
00:005892 8F0004              +246 	qpush	a
00:005893 960018              +247 	dsa	24
00:005894 B80004              +248 	xorB	a
00:005895 D80F74              +249 	anb	(0400000-112)		
00:005896 7E089C              +250 	jc	eliminated		. it is larger than microscopic
00:005897 200005              +251 	sa	b			. it is microscopic. Change to 192 signs
00:005898 C7F000              +252 	ds	0, sp
00:005899 C7F002              +253 	ds	2, sp
00:00589A C70006              +254 	ds	6
00:00589B 470008              +255 	qs	8
  :                            256 eliminated
00:00589C 870004              +257 	qpop	a
00:00589D 350000              +258 	lret	0
  :                            259 	$endif
  :                            260 
  :                            261 encircle
                                	$head_near	 params(degreep,	int)						;
                                												;
                                			scalars(downward,	float192,					;
00:00589E 8F0F79              +265 				(major_minor 2.777777777777777777777777777777777777777778e-3)	)
00:00589F 8F0F75              +265 
  :                            266 				
00:0058A0 50F00A              +267 	lx	degreep
00:0058A1 CFA000              +268 	dl	0, x
00:0058A2 A608A5              +269 	jpa	magnitude_obtained
00:0058A3 B5FFFF              +270 	xor	-1,,xi
00:0058A4 BDFFFF              +271 	xorB	-1,,xi
  :                            272 
  :                            273 magnitude_obtained
00:0058A5 DF0F7D              +274 	dan	(360.0)			. just the front half of the constant
  :                            275 					. real dirty dancing that
00:0058A6 5E08B2              +276 	jnc	encircled
  :                            277 
00:0058A7 F8F00A              +278 	c	(fp192_mfa)	downward,,i	degreep
00:0058A8 FCF001              +278 
00:0058A9 FCF002              +278 
00:0058AA FF0F6B              +278 
00:0058AB 38000F              +278 
00:0058AC 8FF004              +279 	c	(fraction192)	downward,,float192
00:0058AD 8FF004              +279 
00:0058AE FCF008              +279 
00:0058AF FF0F5F              +279 
00:0058B0 38000F              +279 
  :                            280 
00:0058B1 3E08B5              +281 	lcal	q360
  :                            282 
  :                            283 encircled
00:0058B2 FCF008              +284 	$ret
00:0058B3 38000F              +284 
00:0058B4 350000              +284 
  :                            285 
00:0058B5 8F0008              +286 q360	qpush	8
00:0058B6 050008              +287 	on	fp$r
00:0058B7 770F7D              +288 	fm	(360.0)
00:0058B8 47A000              +289 	qs	0, x
00:0058B9 870004              +290 	qpop	a
00:0058BA 0D0008              +291 	off	fp$r
00:0058BB 770F7D              +292 	fm	(360.0)
00:0058BC 670008              +293 	fa	8
00:0058BD 47A004              +294 	qs	4, x
00:0058BE 350000              +295 	lret	0
  :                            296 	
  :                            297 
  :                            298 	$if	RECIPROCAL_READY
  :                            299 reciprocal_factorials
  :                            300: 	$include	rfactori
  :                            1 .	these are 192-bit floating reciprocals of factorials
  :                            2 .	captured over debug console
  :                            3 
  :                            4 .	they are one tiny bit more precise than dividing
  :                            5 .	the factorials into 1 interactively
  :                            6 
  :                            7 .	because scan library only considers the 43 mantissa digits
  :                            8 .	which it can completely assimilate
  :                            9 .	not the 44 digits it might mostly assimilate
  :                            10 
  :                            11 .	these are the reciprocals of odd-humber factorials
  :                            12 .	starting factorial 3
  :                            13 
00:0058BF 3FFFFEAAAAAAAAAAAAAAAAAA3FFFB6AAAAAAAAAAAAAAAAAB
                              +14 	03FFFFEAAAAAAAAAAAAAAAAAA3FFFB6AAAAAAAAAAAAAAAAABo
00:0058C7 3FFFFA8888888888888888883FFFB2888888888888888889
                              +15 	03FFFFA8888888888888888883FFFB2888888888888888889o
00:0058CF 3FFFF4D00D00D00D00D00D003FFFACD00D00D00D00D00D02
                              +16 	03FFFF4D00D00D00D00D00D003FFFACD00D00D00D00D00D02o
00:0058D7 3FFFEEB8EF1D2AB6399C7D563FFFA2E4472800B8EF1D2AC0
                              +17 	03FFFEEB8EF1D2AB6399C7D563FFFA2E4472800B8EF1D2AC0o
00:0058DF 3FFFE7D7322B3FAA271C7F3A3FFF9DFC9706FB8E3C4056E8
                              +18 	03FFFE7D7322B3FAA271C7F3A3FFF9DFC9706FB8E3C4056E8o
00:0058E7 3FFFE0B092309D43684BE51C3FFF95CC748EBDA134ECDD60
                              +19 	03FFFE0B092309D43684BE51C3FFF95CC748EBDA134ECDD60o
00:0058EF 3FFFD8D73F9F399DC0F88EC33FFF8EAD61DD195FD23D7AC0
                              +20 	03FFFD8D73F9F399DC0F88EC33FFF8EAD61DD195FD23D7AC0o
00:0058F7 3FFFD0CA963B81856A5359303FFF86A32EEE35FFD4EE91A8
                              +21 	03FFFD0CA963B81856A5359303FFF86A32EEE35FFD4EE91A8o
00:0058FF 3FFFC897A4DA340A0AB926503FFF80F61DBDCB3A5ABF5BA1
                              +22 	03FFFC897A4DA340A0AB926503FFF80F61DBDCB3A5ABF5BA1o
00:005907 3FFFBFB8DC77B6E7AB8C5F783FFF77A37E77372290C243D1
                              +23 	03FFFBFB8DC77B6E7AB8C5F783FFF77A37E77372290C243D1o
00:00590F 3FFFB6BB0DA098B1C0CECBDC3FFF6CE09BAFEC4F309ADFE4
                              +24 	03FFFB6BB0DA098B1C0CECBDC3FFF6CE09BAFEC4F309ADFE4o
00:005917 3FFFAD9F9E66E8B2FD46A7223FFF64A419776F10B893FFF4
                              +25 	03FFFAD9F9E66E8B2FD46A7223FFF64A419776F10B893FFF4o
00:00591F 3FFFA3E8D58E16E67519054D3FFF57C78AEA13B9A503A500
                              +26 	03FFFA3E8D58E16E67519054D3FFF57C78AEA13B9A503A500o
00:005927 3FFF9A92CFCC5A1AC56BD5F23FFF51ED51F335965091DD08
                              +27 	03fff9a92cfcc5a1ac56bd5f23fff51ed51f335965091dd08o
00:00592F 3FFF90A1A6973C1FADE217103FFF48F63F7190C8AA0DAF15
                              +28 	03fff90a1a6973c1fade217103fff48f63f7190c8aa0daf15o
00:005937 3FFF869CC092A6E86A8DA9C23FFF3EE544FB6B954B73B068
                              +29 	03fff869cc092a6e86a8da9c23fff3ee544fb6b954b73b068o
00:00593F 3FFF7C86E2CE38B6C8F9419F3FFF34CA23FA32723EF993C0
                              +30 	03fff7c86e2ce38b6c8f9419f3fff34ca23fa32723ef993c0o
00:005947 3FFF71CF6468E4A742D7A6403FFF26B7B21AB59193EFE1F0
                              +31 	03fff71cf6468e4a742d7a6403fff26b7b21ab59193efe1f0o
00:00594F 3FFF678F4CA24D25D66F00853FFF1EEBAF40EFCD83376296
                              +32 	03fff678f4ca24d25d66f00853fff1eebaf40efcd83376296o
00:005957 3FFF5CB2F30E1CE812063F183FFF11E9BF14859B16AEBE30
                              +33 	03fff5cb2f30e1ce812063f183fff11e9bf14859b16aebe30o
00:00595F 3FFF51CAEDA292BF28916E643FFF098435C2B7748B12DB29
                              +34 	03fff51caeda292bf28916e643fff098435c2b7748b12db29o
00:005967 3FFF46D1E5C39110323C701E3FFEFDB178709ACA2662D8D8
                              +35 	03fff46d1e5c39110323c701e3ffefdb178709aca2662d8d8o
00:00596F 3FFF3BC6D4705093F5CDBC623FFEF399C3740B38F438397F
                              +36 	03fff3bc6d4705093f5cdbc623ffef399c3740b38f438397fo
00:005977 3FFF30AD21786FF5842ECA5A3FFEE88C0D33F34BE51568FE
                              +37 	03fff30ad21786ff5842eca5a3ffee88c0d33f34be51568feo
00:00597F 3FFF258B0C395FBDC119BB9E3FFEDDB82FA31E321062A6B0
                              +38 	03fff258b0c395fbdc119bb9e3ffeddb82fa31e321062a6b0o
00:005987 3FFF19CEA7882C33A6FA079C3FFED1E5D67274F6043CDCB0
                              +39 	03fff19cea7882c33a6fa079c3ffed1e5d67274f6043cdcb0o
00:00598F 3FFF0E8E8047D562E281503E3FFEC58D11403E587A45F862
                              +40 	03fff0e8e8047d562e281503e3ffec58d11403e587a45f862o
00:005997 3FFF02B6DBC9E443DCB7E6A63FFEBAB975C700051AAC2C14
                              +41 	03fff02b6dbc9e443dcb7e6a63ffebab975c700051aac2c14o
00:00599F 3FFEF6DADFE0BFD4BE9401613FFEAE827623542631490DB2
                              +42 	03ffef6dadfe0bfd4be9401613ffeae827623542631490db2o
00:0059A7 3FFEEAF4F2B6B24FBB42DFB23FFEA2B8C23DC8DE1B77E842
                              +43 	03ffeeaf4f2b6b24fbb42dfb23ffea2b8c23dc8de1b77e842o
00:0059AF 3FFEDF806E7B519070DDB8CC3FFE97EFDC7FCB8AA858E285
                              +44 	03ffedf806e7b519070ddb8cc3ffe97efdc7fcb8aa858e285o
00:0059B7 3FFED2FCE9515DAA38D811543FFE8AD3C8E0121E1E9C2983
                              +45 	03ffed2fce9515daa38d811543ffe8ad3c8e0121e1e9c2983o
00:0059BF 3FFEC6EA4424ED47A5148E7E3FFE7EA4C98D816B4ECDF5A6
                              +46 	03ffec6ea4424ed47a5148e7e3ffe7ea4c98d816b4ecdf5a6o
00:0059C7 3FFEBACC82330155E571C1253FFE6F95831E3408210BF8C8
                              +47 	03ffebacc82330155e571c1253ffe6f95831e3408210bf8c8o
00:0059CF 3FFEAEA88B71D6DCFDCA6F2C3FFE65E2C13DB0EBB219B464
                              +48 	03ffeaea88b71d6dcfdca6f2c3ffe65e2c13db0ebb219b464o
00:0059D7 3FFEA28358CC0D243B1050673FFE5AD9240036213E1AFE92
                              +49 	03ffea28358cc0d243b1050673ffe5ad9240036213e1afe92o
00:0059DF 3FFE95C1DF698524F6F60A033FFE4CDBFB8E2D564F783DF2
                              +50 	03ffe95c1df698524f6f60a033ffe4cdbfb8e2d564f783df2o
  :                            51 
  :                            301 	$endif
  :                            302 
  :                            303 	$root
  :                            161: 	$include trig96
  :                            1 trig96	$tree
  :                            2 
  :                            3 	$if	1
  :                            4 _RADIAN_FACTOR $equ 1.7453292519943295769236907684886127134428719*-2
  :                            5 	$else
  :                            6 _RADIAN_FACTOR $equ 0.01745329252	. generated as 96-bit float
  :                            7 	$endif
  :                            8 
  :                            9 _PASSES	$equ	11
  :                            10 
  :                            11 .	vector name sine96
  :                            12 
  :                            13 sine	$tree								. quadrant looks after itself
                                	$head_far	 params(angle,	float)			;	. trim to % 360 degrees here
                                			scalars(u_8,	float,	8		;
00:0059E7 8F0008              +16 				u_rkxy,	float,	r		)
00:0059E8 8F0000              +16 
  :                            17 
00:0059E9 FCF00B              +18 	lc	trig96:_sine	angle,,i
00:0059EA FCF001              +18 
00:0059EB 3E0A1E              +18 
00:0059EC 38000F              +18 
00:0059ED 870000              +19 	qpop	r
00:0059EE 870008              +20 	qpop	8
00:0059EF 3D0000              +21 	fret	0
  :                            22 	$root
  :                            23 
  :                            24 cosine	$tree
                                	$head_far	 params(angle,	float)			;
                                			scalars(u_8,	float,	8		;
00:0059F0 8F0008              +27 				u_rkxy,	float,	r		)
00:0059F1 8F0000              +27 
00:0059F2 4F0F6F              +28 	ql	(90.0)							. trim to % 360 degrees 
00:0059F3 6FF00B              +29 	fan	angle							. before this step
00:0059F4 47F00B              +30 	qs	angle
  :                            31 
00:0059F5 FCF00B              +32 	lc	trig96:_sine	angle,,i
00:0059F6 FCF001              +32 
00:0059F7 3E0A1E              +32 
00:0059F8 38000F              +32 
00:0059F9 870000              +33 	qpop	r
00:0059FA 870008              +34 	qpop	8
00:0059FB 3D0000              +35 	fret	0
  :                            36 	$root
  :                            37 
  :                            38 tangent	$tree
                                	$head_far	 params(angle,	float)			;
                                								;
                                			scalars(cosine,	float			;
                                				u_8,	float,	8		;
00:0059FC 8F0EA5              +43 				u_rkxy,	float,	r		)
00:0059FD 8F0008              +43 
00:0059FE 8F0000              +43 
  :                            44 
00:0059FF 8FF00F              +45 	c	(cosine96)	angle,,float			. angle is copied not referenced
00:005A00 FCF004              +45 
00:005A01 FF0F5C              +45 
00:005A02 38000F              +45 
00:005A03 47F008              +46 	qs	cosine
00:005A04 FCF00F              +47 	lc	trig96:_sine	angle,,i			. angle is referenced and changed to a radian
00:005A05 FCF001              +47 
00:005A06 3E0A1E              +47 
00:005A07 38000F              +47 
00:005A08 7FF008              +48 	fd	cosine
00:005A09 870000              +49 	qpop	r
00:005A0A 870008              +50 	qpop	8
00:005A0B 87F000              +51 	qpop	0, sp
00:005A0C 3D0000              +52 	fret	0
  :                            53 	$root
  :                            54 
  :                            55 cotangent $tree
                                	$head_far	 params(angle,	float)			;
                                								;
                                			scalars(sine,	float,	angle		;
                                				u_8,	float,	8		;
00:005A0D 8FF003              +60 				u_rkxy,	float,	r		)
00:005A0E 8F0008              +60 
00:005A0F 8F0000              +60 
  :                            61 
00:005A10 FCF008              +62 	lc	trig96:_sine	sine,,i				. separate copy of angle, updated
00:005A11 FCF001              +62 
00:005A12 3E0A1E              +62 
00:005A13 38000F              +62 
00:005A14 47F008              +63 	qs	sine
00:005A15 8FF00F              +64 	c	(cosine96)	angle,,float
00:005A16 FCF004              +64 
00:005A17 FF0F5C              +64 
00:005A18 38000F              +64 
00:005A19 7FF008              +65 	fd	sine
00:005A1A 870000              +66 	qpop	r
00:005A1B 870008              +67 	qpop	8
00:005A1C 87F000              +68 	qpop	0, sp
00:005A1D 3D0000              +69 	fret	0
  :                            70 	$root
  :                            71 
                                _sine	$head_near	 params(anglep, int)			;
                                								;
                                			scalars(power,	float			;
                                				square,	float			;
                                				factorial, float, 	(6.0)	;
00:005A1E 8F0EA5              +77 				factor,	float,		(3.0)	)
00:005A1F 8F0EA5              +77 
00:005A20 8F0F81              +77 
00:005A21 8F0F85              +77 
  :                            78 
00:005A22 F8F012              +79 	lc	encircle	anglep
00:005A23 FCF001              +79 
00:005A24 3E0A72              +79 
00:005A25 38000F              +79 
  :                            80 
00:005A26 50F012              +81 	lx	anglep
00:005A27 4FA000              +82 	ql	0, x
00:005A28 770F89              +83 	fm	(_RADIAN_FACTOR)
00:005A29 47A000              +84 	qs	0, x
  :                            85 
00:005A2A 77A000              +86 	fm	0, x
00:005A2B 47F008              +87 	qs	square
00:005A2C 77A000              +88 	fm	0, x
00:005A2D 47F00C              +89 	qs	power		. initially power is cube
  :                            90 
00:005A2E 45000B              +91 	lr	_PASSES,,xi
00:005A2F B60A4A              +92 	j	_nomial		. the minus kick
  :                            93 
  :                            94 _NEXT_FACTORIAL* $proc
  :                            95 	ql	factor
  :                            96 	fa	(1.0)
  :                            97 	qs	8
  :                            98 	fa	(1.0)
  :                            99 	qs	factor
  :                            100 	fm	factorial
  :                            101 	fm	8
  :                            102 	qs	factorial
  :                            103 	$end
  :                            104 
  :                            105 _NEXT_POWER* $proc
  :                            106 	ql	power
  :                            107 	fm	square
  :                            108 	qs	power
  :                            109 	$end
  :                            110 
00:005A30 47A000              +111 _poly	qs	0, x		. the plus kick
00:005A31 4FF000              +112 	_NEXT_FACTORIAL
00:005A32 670F8D              +112 
00:005A33 470008              +112 
00:005A34 670F8D              +112 
00:005A35 47F000              +112 
00:005A36 77F004              +112 
00:005A37 770008              +112 
00:005A38 47F004              +112 
00:005A39 4FF00C              +113 	_NEXT_POWER
00:005A3A 77F008              +113 
00:005A3B 47F00C              +113 
00:005A3C 7FF004              +114 	fd	factorial
00:005A3D 67A000              +115 	fa	0, x
00:005A3E 47A000              +116 	qs	0, x
00:005A3F 4FF000              +117 	_NEXT_FACTORIAL
00:005A40 670F8D              +117 
00:005A41 470008              +117 
00:005A42 670F8D              +117 
00:005A43 47F000              +117 
00:005A44 77F004              +117 
00:005A45 770008              +117 
00:005A46 47F004              +117 
00:005A47 4FF00C              +118 	_NEXT_POWER
00:005A48 77F008              +118 
00:005A49 47F00C              +118 
00:005A4A 7FF004              +119 _nomial	fd	factorial
00:005A4B 0F0004              +120 	n	a
00:005A4C 0F0005              +121 	n	b
00:005A4D 0F0006              +122 	n	6
00:005A4E 0F0007              +123 	n	7
00:005A4F 67A000              +124 	fa	0, x
00:005A50 1E0A30              +125 	jdr	_poly
  :                            126 
00:005A51 3E0A64              +127 	lcal	eliminate_microdust
00:005A52 3E0A56              +128 	lcal	trim
  :                            129 
00:005A53 FCF010              +130 	$ret
00:005A54 38000F              +130 
00:005A55 350000              +130 
  :                            131 
  :                            132 	$if	1		. if 64 mantissa bits are nonsign
00:005A56 F80004              +133 trim	push	a		. make all 72 bits nonsign
00:005A57 860018              +134 	saa	24
00:005A58 B5FFFF              +135 	xor	-1,,xi
00:005A59 4DFFFF              +136 	lk	-1,,xi
00:005A5A AF0005              +137 	mta	b		. test mantissa bits 71..48
00:005A5B B60A62              +138 	j	trimmed
00:005A5C AF0006              +139 	mta	6		. test mantissa bits 47..24
00:005A5D B60A62              +140 	j	trimmed
00:005A5E 4DFF00              +141 	lk	-256,,xi
00:005A5F AF0007              +142 	mta	7		. test mantissa bits 23..8
00:005A60 B60A62              +143 	j	trimmed
00:005A61 200007              +144 	sa	7
00:005A62 380004              +145 trimmed	pop	a
00:005A63 350000              +146 	lret	0
  :                            147 	$endif
  :                            148 
  :                            149 eliminate_microdust
00:005A64 480F73              +150 	lk	(0800000s)
00:005A65 AF0005              +151 	mta	b
00:005A66 3E0A68              +152 	lcal	eliminate_normalised
00:005A67 350000              +153 	lret	0
  :                            154 
  :                            155 eliminate_normalised
00:005A68 8F0004              +156 	qpush	a
00:005A69 960018              +157 	dsa	24
00:005A6A B80004              +158 	xorB	a
00:005A6B D80F91              +159 	anb	(0400000-35)
00:005A6C 7E0A70              +160 	jc	eliminated
00:005A6D 200005              +161 	sa	b
00:005A6E C7F000              +162 	ds	0, sp
00:005A6F C7F002              +163 	ds	2, sp
  :                            164 eliminated
00:005A70 870004              +165 	qpop	a
00:005A71 350000              +166 	lret	0
  :                            167 
  :                            168 encircle	$head_near	 params(degreep,	int	)
  :                            169 
00:005A72 50F002              +170 	lx	degreep
00:005A73 CFA000              +171 	dl	0, x
00:005A74 A60A77              +172 	jpa	magnitude_found
  :                            173 
00:005A75 B5FFFF              +174 	xor	-1,,xi
00:005A76 BDFFFF              +175 	xorB	-1,,xi
  :                            176 
  :                            177 magnitude_found
00:005A77 DF0F7D              +178 	dan	(360.0)		. we'll use both halves of that constant later
00:005A78 5E0A81              +179 	jnc	encircled
  :                            180 
00:005A79 4F0F92              +181 	ql	(2.777777777777777777777777777777777777777778e-3)
00:005A7A 77A000              +182 	fm	0, x
00:005A7B 8F0004              +183 	c	(fraction96)	a,,float
00:005A7C FCF004              +183 
00:005A7D FF0F96              +183 
00:005A7E 38000F              +183 
00:005A7F 770F7D              +184 	fm	(360.0)
00:005A80 47A000              +185 	qs	0, x
  :                            186 
  :                            187 encircled
00:005A81 350000              +188 	lret	0
  :                            189 
  :                            190 	$root
  :                            162 
  :                            163 	$path	../mib
  :                            164: 	$include snmpv1
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 AGENT2_TUPLES	$equ	24
  :                            41 A2_WORDS	$equ	500
  :                            42 
  :                            43 $(1)
01:000421 000000              +44 a2_socket	+	0
01:000422 FFFFFF              +45 a2_bound	-	1
01:000423 FFFFFFFFFFFF        +46 a2_sva		-	1:d
  :                            47 
  :                            48 $(3)
  :                            49 
                                ?	$do	AGENT2_TUPLES,;
  :                            51 a2_ber_transient(?)	ber_template
  :                            52 
03:00022C 000000              +53 a2_permission	+	0
03:00022D 000000              +54 a2_ix		+	0
03:00022E 000000              +55 ber_command	+	0
  :                            56 snmp_tferq	$res	A2_WORDS
  :                            57 
  :                            58 $(0)
  :                            59 
  :                            60 	$if	SNMP_AGENT_THREADED
  :                            61 snmp_agent_launch
00:005A82 4F0F97              +62 	ql	(agent_2, 7, 0, 0q)
00:005A83 750047              +63 	ii	THREAD$
(+03)10
00:005A84 6D26B4              +64 	lb	$3("*snmp_agent":0),,xi
00:005A85 750049              +65 	ii	TAG$
00:005A86 3D0000              +66 	fret	0
  :                            67 
  :                            68 	$endif
  :                            69 
00:005A87 3E0A8B              +70 agent_2	lcal	agent_2scan
  :                            71 
  :                            72 	$if	SNMP_AGENT_THREADED
00:005A88 750041              +73 	ii	YIELD$
00:005A89 B60A87              +74 	j	agent_2
  :                            75 	$endif
  :                            76 
00:005A8A 3D0000              +77 	fret	0
  :                            78 
                                agent_2scan $head_near	scalars(snmp_rseq,	24	;
                                				a2_total8,	int	;
                                				a2_highest_tuple, int	;
                                				a2_octets,	int	;
                                				a2_inaxw,	int	;
                                				a2_restartp,	int	;
                                				a2_restartbits,	long	;
00:005A8B 8F0EA5              +86 				a2_axw,		int)
00:005A8C 8FF000              +86 
00:005A8D 8FF000              +86 
00:005A8E 8FF000              +86 
00:005A8F 8FF000              +86 
00:005A90 8FF000              +86 
00:005A91 FD0000              +86 
00:005A92 FD0000              +86 
00:005A93 FD0000              +86 
00:005A94 FD0000              +86 
00:005A95 FD0000              +86 
00:005A96 9F0F0F              +86 
00:005A97 FD0000              +86 
  :                            87 
(+01)0f
00:005A98 700421              +88 	tz	a2_socket
00:005A99 B60AA8              +89 	j	a2_sample
00:005A9A 600EA9              +90 	la	(IPPROTO_UDP*/16)
00:005A9B FF0EAA              +91 	call	(__socket)
00:005A9C E60B3F              +92 	jna	a2_stop
(+01)0f
00:005A9D 200421              +93 	sa	a2_socket
  :                            94 
00:005A9E 9F0F9B              +95 	c	(bind) a (SNMP_PORT:d),,long
00:005A9F F80004              +95 
00:005AA0 FCF003              +95 
00:005AA1 FF0EAD              +95 
00:005AA2 38000F              +95 
  :                            96 
(+01)0f
00:005AA3 200422              +97 	sa	a2_bound
00:005AA4 E60B3F              +98 	jna	a2_stop
00:005AA5 CF000A              +99 	dl	10
(+01)0f
00:005AA6 C70423              +100 	ds	a2_sva
00:005AA7 FF0F9D              +101 	call	(mib_start)	. agent1 did that
  :                            102 a2_sample
(+01)0f
00:005AA8 780422              +103 	tp	a2_bound
00:005AA9 B60B3F              +104 	j	a2_stop
(+01)0f
00:005AAA CF0423              +105 	dl	a2_sva
00:005AAB 34002F              +106 	sabr	BSOCKET
00:005AAC 500005              +107 	lx	b
00:005AAD 68A006              +108 a2_next	lb	s:udp:socket_inq:head, x
00:005AAE CE0B3F              +109 	jzb	a2_defer
  :                            110 
00:005AAF 28F004              +111 	sb	a2_inaxw
00:005AB0 60D003              +112 	la	descriptor:bytes, b
00:005AB1 20F005              +113 	sa	a2_octets
00:005AB2 200010              +114 	sa	BYTES
  :                            115 
00:005AB3 60D006              +116 	la	descriptor:apdata, b
00:005AB4 20000D              +117 	sa	q
00:005AB5 300014              +118 	z	RDATAC
  :                            119 
(+03)0f
00:005AB6 64022F              +120 	la, i	snmp_tferq
00:005AB7 20000C              +121 	sa	p
  :                            122 
00:005AB8 050060              +123 	on	b$streamZR++b$stream16r
00:005AB9 0D0010              +124 	off	b$stream16w
  :                            125 
(+03)0f
00:005ABA 30022D              +126 	z	a2_ix		. error_index, if it is ever needed
  :                            127 
00:005ABB 150008              +128 	rsr	8
00:005ABC 680004              +129 	anu, xi	SNMP_SEQUENCE
00:005ABD DD0030              +129 
00:005ABE DE0B3B              +130 	jnzb	a2_drop
  :                            131 
(+03)0f
00:005ABF 20019C              +132 	sa	a2_ber_transient(1):ojet
00:005AC0 3E0C98              +133 	lcal	ber_swap_compare
(+03)0f
00:005AC1 20019D              +134 	sa	a2_ber_transient(1):bytes
00:005AC2 5E0B3B              +135 	jnc	a2_drop
  :                            136 
(+03)10
00:005AC3 5D01A2              +137 	ly, xi	a2_ber_transient(2)
00:005AC4 3E0CBB              +138 	lcal	ber_ri
00:005AC5 B60B3B              +139 	j	a2_drop
  :                            140 
00:005AC6 150008              +141 	rsr	8
00:005AC7 680004              +142 	anu, xi	SNMP_STRING
00:005AC8 DD0004              +142 
00:005AC9 DE0B3B              +143 	jnzb	a2_drop		. there must be a community string
(+03)0f
00:005ACA 2001A8              +144 	sa	a2_ber_transient(3):ojet
  :                            145 	
  :                            146 
00:005ACB 60000C              +147 	la	p
(+03)0f
00:005ACC 2001AA              +148 	sa	a2_ber_transient(3):data
(+03)10
00:005ACD 5D01A8              +149 	ly, xi	a2_ber_transient(3)
00:005ACE 3E0C9F              +150 	lcal	ber_rs
  :                            151 
  :                            152 
  :                            153 
  :                            154 .	the parts to pull out are
  :                            155 .	_________________________
  :                            156 
  :                            157 .	30LL	binding and length		00..7F 81:80..FF 82:0100..FFFF
  :                            158 .	0201vv	SNMP version	00 = v 1
  :                            159 
  :                            160 .	then for v 1 at least...
  :                            161 
  :                            162 .	04LLalpha community string
  :                            163 
  :                            164 .	AxLL	command byte pdu length		00..7F 81:80..FF 82:0100..FFFF
  :                            165 .	160 = get 161 = getnext 163 = set
  :                            166 
  :                            167 .	0204xxxxxxxx	request ID typically 4 bytes
  :                            168 
  :                            169 .	020100	status
  :                            170 .	020100	error index
  :                            171 
  :                            172 .	30LL	binding and length		00..7F 81:80..FF 82:0100..FFFF
  :                            173 .	30LL-2	maybe another one nested
  :                            174 
  :                            175 .	06LLxxxxxx...0500	oids with NULLtype zeroL for get / getnext
  :                            176 .	06LLxxxxxx...4103yyyyyy	oids with typeLL / value for set
  :                            177 
  :                            178 .	strings may be > 127 bytes, length is encoded
  :                            179 .						00..7F 81:80..FF 82:0100..FFFF
  :                            180 
  :                            181 .	______________________________________________________________
  :                            182 
  :                            183 .	if the command is not A0 A1 A3 the request is dropped silently
  :                            184 
  :                            185 .	if the bindings lengths don't figure with the containing lengths
  :                            186 .	the request is dropped silently
  :                            187 
  :                            188 .	if community string is unknown the request is dropped silently
  :                            189 
  :                            190 
  :                            191 .	the response is as the request except
  :                            192 .	_____________________________________
  :                            193 
  :                            194 .	the command byte or response is SNMP_RESPONSE A2 162
  :                            195 
  :                            196 .	the response to successful get / getnext contains
  :                            197 .	a value encoding, not NULLtype/zeroL 0500
  :                            198 
  :                            199 
  :                            200 .	if anything has went wrong
  :                            201 
  :                            202 .		status is the error
  :                            203 
  :                            204 .		1 = something was too large in some way		tooBig
  :                            205 .		2 = that does not exist				noSuchName
  :                            206 .		3 = value wrong type or out of range		badValue
  :                            207 .		4 = object may not be wrote			readOnly
  :                            208 .		5 = something else was wrong			genErr
  :                            209 
  :                            210 .		error index indicates the [1st] oid binding which is in error
  :                            211 .		relative 1, 1 = 1st oid binding in the PDU
  :                            212 
  :                            213 .	the plan is
  :                            214 .	take all the actions and table the results as BER templates
  :                            215 
  :                            216 .	if anything is wrong, send the bindings back as received
  :                            217 .	with error-code set to the mistake
  :                            218 .	and error-index pointing to the first binding which is in error
  :                            219 
  :                            220 .	(no further ones need be scanned if that happens)
  :                            221 .	this means the update values are returned but not actioned
  :                            222 
  :                            223 .	and the read-requests are returned with null values as received
  :                            224 
  :                            225 .	even multiple get-nexts can be sensibly answered on this principle
  :                            226 
  :                            227 .	and if everything has went right, produce the BER-encoded results
  :                            228 
  :                            229 
00:005ACF 150008              +230 	rsr	8
(+03)0f
00:005AD0 2001AE              +231 	sa	a2_ber_transient(4):ojet
  :                            232 
00:005AD1 680004              +233 	anu, xi	SNMP_GETNEXTREQ
00:005AD2 DD00A1              +233 
00:005AD3 CE0ADA              +234 	jzb	a2_getnext
00:005AD4 680004              +235 	anu, xi	SNMP_SETREQ
00:005AD5 DD00A3              +235 
00:005AD6 CE0ADA              +236 	jzb	a2_set
00:005AD7 680004              +237 	anu, xi	SNMP_GETREQ
00:005AD8 DD00A0              +237 
00:005AD9 DE0B3B              +238 	jnzb	a2_drop
  :                            239 
  :                            240 a2_get
  :                            241 a2_getnext
(+03)0f
00:005ADA 20022E              +242 a2_set	sa	ber_command
00:005ADB 3E0C98              +243 	lcal	ber_swap_compare
(+03)0f
00:005ADC 2001AF              +244 	sa	a2_ber_transient(4):bytes
00:005ADD 5E0B3B              +245 	jnc	a2_drop
  :                            246 
  :                            247 
(+03)10
00:005ADE 5D01B4              +248 	ly, xi	a2_ber_transient(5)
00:005ADF 3E0B42              +249 	lcal	a2_seq_sta_erx
00:005AE0 B60B3B              +250 	j	a2_drop
  :                            251 
00:005AE1 CF0014              +252 	dl	RDATAC		. snapshot the start point
00:005AE2 C7F001              +253 	ds	a2_restartbits	. of the enveloping binding
00:005AE3 60000D              +254 	la	q
00:005AE4 20F003              +255 	sa	a2_restartp	. it might decide to go wrong
  :                            256 				. on a binding which is not the 1st one
  :                            257 a2_getcluster
00:005AE5 150008              +258 	rsr	8
00:005AE6 680004              +259 	anu, xi	SNMP_SEQUENCE
00:005AE7 DD0030              +259 
  :                            260 
00:005AE8 DE0B3B              +261 	jnzb	a2_drop
  :                            262 
00:005AE9 3E0C87              +263 	lcal	ber_rl
00:005AEA 680010              +264 	lb	BYTES
00:005AEB D80004              +265 	anb	a
00:005AEC 280010              +266 	sb	BYTES
  :                            267 
00:005AED FCF008              +268 	lc	ber_sequence_scan	a	snmp_rseq,,i
00:005AEE F80004              +268 
00:005AEF FCF002              +268 
00:005AF0 3E0CF4              +268 
00:005AF1 38000F              +268 
  :                            269 
00:005AF2 D60B13              +270 	jnza	a2_error_response
  :                            271 
00:005AF3 C8F007              +272 	ab	a2_total8
00:005AF4 28F007              +273 	sb	a2_total8
  :                            274 
00:005AF5 5CB006              +275 	ly	BER_TRANSIENT_SIZE, y, i
00:005AF6 780010              +276 	tp	BYTES
00:005AF7 B60AFA              +277 	j	a2_construct_response
00:005AF8 700010              +278 	tz	BYTES
00:005AF9 B60AE5              +279 	j	a2_getcluster
  :                            280 
  :                            281 
  :                            282 a2_construct_response
00:005AFA 18F006              +283 	sy	a2_highest_tuple
  :                            284 
00:005AFB 60F007              +285 	la	a2_total8
00:005AFC 3E0B4C              +286 	lcal	a2_gener8
00:005AFD 20F007              +287 	sa	a2_total8
  :                            288 
(+01)0f
00:005AFE CF0423              +289 	dl	a2_sva
00:005AFF 34002F              +290 	sabr	BSOCKET
00:005B00 68D006              +291 	lb	s:udp:socket_inq:head
  :                            292 
00:005B01 60F007              +293 	la	a2_total8
  :                            294 
00:005B02 FF0EAE              +295 	call	(udp_rtxbuffer)
00:005B03 C60B3B              +296 	jza	a2_drop
00:005B04 20F000              +297 	sa	a2_axw
  :                            298 
00:005B05 68F007              +299 	lb	a2_total8
00:005B06 28C003              +300 	sb	descriptor:bytes, a
  :                            301 
00:005B07 3E0B65              +302 	lcal	a2_write_headers
  :                            303 
(+03)10
00:005B08 5D01C6              +304 	ly, xi	a2_ber_transient(8)
  :                            305 
  :                            306 a2_add_tuple
00:005B09 3E0BE8              +307 	lcal	ber_release_mo
00:005B0A 8D0006              +308 	ay, xi	BER_TRANSIENT_SIZE
00:005B0B 40F006              +309 	lr	a2_highest_tuple
00:005B0C FE0B0E              +310 	jyge	a2_transmit_response1
00:005B0D B60B09              +311 	j	a2_add_tuple
  :                            312 
  :                            313 
  :                            314 a2_transmit_response1
00:005B0E 1D0008              +315 	wsr	$byte	. push the last byte if uneven numbered
  :                            316 
00:005B0F 50F000              +317 	lx	a2_axw
00:005B10 FF0EBA              +318 	call	(udp_acw_send)
  :                            319 
00:005B11 B60B3B              +320 	j	a2_drop
  :                            321 
  :                            322 a2_snmp_gerr
00:005B12 650005              +323 	la, xi	5
  :                            324 a2_error_response			. error response from MIB
(+03)0f
00:005B13 2001BD              +325 	sa	a2_ber_transient(6):data+1
(+03)0f
00:005B14 3001BB              +326 	z	a2_ber_transient(6):bytes	. zero has effect 1
(+03)0f
00:005B15 60022D              +327 	la	a2_ix
(+03)0f
00:005B16 2001C3              +328 	sa	a2_ber_transient(7):data+1
(+03)0f
00:005B17 3001C1              +329 	z	a2_ber_transient(7):bytes	. zero has effect 1
  :                            330 
  :                            331 a2_mirror
00:005B18 60F003              +332 	la	a2_restartp		. retrieve the whole input bindingS
00:005B19 20000D              +333 	sa	q
00:005B1A CFF001              +334 	dl	a2_restartbits
00:005B1B C70014              +335 	ds	RDATAC
  :                            336 
00:005B1C 150008              +337 	rsr	8
00:005B1D C5FFD0              +338 	aa	-SNMP_SEQUENCE,,xi
00:005B1E D60B3B              +339 	jnza	a2_drop
00:005B1F 60F005              +340 	la	a2_octets		. retrieve the input message length
00:005B20 68F004              +341 	lb	a2_inaxw		. it copies addressing
00:005B21 FF0EAE              +342 	call	(udp_rtxbuffer)
00:005B22 C60B3B              +343 	jza	a2_drop
00:005B23 20F000              +344 	sa	a2_axw
00:005B24 68F005              +345 	lb	a2_octets
00:005B25 28C003              +346 	sb	descriptor:bytes, a
00:005B26 50C006              +347 	lx	descriptor:apdata, a
00:005B27 58F004              +348 	ly	a2_inaxw
00:005B28 58B006              +349 	ly	descriptor:apdata, y
00:005B29 CDFFFF              +350 	ab	-1,,xi
00:005B2A 0E0003              +351 	sbr	3			. byte_count//8-1
00:005B2B 400005              +352 	lr	b
  :                            353 a2_qload
00:005B2C 4FB000              +354 	ql	0, y
00:005B2D 47A000              +355 	qs	0, x
00:005B2E 850004              +356 	ax	4,,xi
00:005B2F 8D0004              +357 	ay	4,,xi
00:005B30 1E0B2C              +358 	jdr	a2_qload
  :                            359 
00:005B31 3E0C87              +360 	lcal	ber_rl
00:005B32 680004              +361 	lb	a			. calculate length of length
00:005B33 0E0007              +362 	sbr	7			. 1 extra for 128..255, 1 more extra for 256..65535
00:005B34 C4D002              +363 	aa	2,b,i			. self-include sequence and length of length
  :                            364 
00:005B35 3E0B4C              +365 	lcal	a2_gener8
00:005B36 20F007              +366 	sa	a2_total8
  :                            367 
00:005B37 60F000              +368 	la	a2_axw
00:005B38 3E0B65              +369 	lcal	a2_write_headers
  :                            370 
  :                            371 a2_release
00:005B39 50F000              +372 	lx	a2_axw
00:005B3A FF0EBA              +373 	call	(udp_acw_send)
  :                            374 
(+01)0f
00:005B3B 500424              +375 a2_drop	lx	a2_sva+1
00:005B3C 60F000              +376 	la	a2_axw
00:005B3D FF0EBB              +377 	call	(release_udgram)
00:005B3E B60AAD              +378 	j	a2_next
  :                            379 
  :                            380 a2_defer
00:005B3F FCF020              +381 a2_stop	$ret
00:005B40 38000F              +381 
00:005B41 350000              +381 
  :                            382 
  :                            383 a2_seq_sta_erx
00:005B42 3E0CBB              +384 	lcal	ber_ri
00:005B43 350000              +385 	lret	0
00:005B44 8D0006              +386 	ay, xi	a2_ber_transient(6)-a2_ber_transient(5)
  :                            387 
00:005B45 3E0CBB              +388 	lcal	ber_ri
00:005B46 350000              +389 	lret	0
00:005B47 8D0006              +390 	ay, xi	a2_ber_transient(7)-a2_ber_transient(6)
  :                            391 
00:005B48 3E0CBB              +392 	lcal	ber_ri
00:005B49 350000              +393 	lret	0
00:005B4A 8D0006              +394 	ay, xi	a2_ber_transient(8)-a2_ber_transient(7)
  :                            395 
00:005B4B 350001              +396 	lret	1			.	good return
  :                            397 	
  :                            398 
  :                            399 .	this part writes cluster contents into cluster length tags
  :                            400 .	add adds together the sums of the containing sequences
  :                            401 
  :                            402 a2_gener8
00:005B4C F80004              +403 	push	a			.	data clusters length
(+03)10
00:005B4D 5D01B4              +404 	ly, xi	a2_ber_transient(5)	.	request_id
00:005B4E 3E0CCA              +405 	lcal	ber_edit_semantic_i
00:005B4F F80004              +406 	push	a
(+03)10
00:005B50 5D01BA              +407 	ly, xi	a2_ber_transient(6)	.	status
00:005B51 3E0CCA              +408 	lcal	ber_edit_semantic_i
00:005B52 F80004              +409 	push	a
(+03)10
00:005B53 5D01C0              +410 	ly, xi	a2_ber_transient(7)	.	error_index
00:005B54 3E0CCA              +411 	lcal	ber_edit_semantic_i	
00:005B55 2F0004              +412 	popA	a			.	plus status integr
00:005B56 2F0004              +413 	popA	a			.	plus request ID 
00:005B57 2F0004              +414 	popA	a			.	plus data clusters
  :                            415 
(+03)0f
00:005B58 2001AF              +416 	sa	a2_ber_transient(4):bytes .	PDU Type/Length
  :                            417 
00:005B59 3E0CE4              +418 	lcal	ber_edit_cluster	.	PDU containing length
00:005B5A F80004              +419 	push	a
  :                            420 
(+03)10
00:005B5B 5D01A2              +421 	ly, xi	a2_ber_transient(2)	.	protocol version
00:005B5C 3E0CCA              +422 	lcal	ber_edit_semantic_i	.	protocol version size
00:005B5D F80004              +423 	push	a			
(+03)0f
00:005B5E 6001A9              +424 	la	a2_ber_transient(3):bytes	
00:005B5F 3E0CE4              +425 	lcal	ber_edit_cluster	.	community string effect
  :                            426 
00:005B60 2F0004              +427 	popA	a			.	plus protocol version field
00:005B61 2F0004              +428 	popA	a			.	plus PDU containing length
  :                            429 
(+03)0f
00:005B62 20019D              +430 	sa	a2_ber_transient(1):bytes .	initial sequence content length
  :                            431 
00:005B63 3E0CE4              +432 	lcal	ber_edit_cluster	.	total buffer size
  :                            433 
00:005B64 350000              +434 	lret	0
  :                            435 
  :                            436 a2_write_headers
00:005B65 F8C006              +437 	push	descriptor:apdata, a
00:005B66 38000C              +438 	pop	p
  :                            439 
00:005B67 050010              +440 	on	b$stream16w
00:005B68 300016              +441 	z	WDATAC
  :                            442 
00:005B69 6D00A2              +443 	lb, xi	SNMP_GETRESP
(+03)0f
00:005B6A 2801AE              +444 	sb	a2_ber_transient(4):ojet
  :                            445 
(+03)10
00:005B6B 5D019C              +446 	ly, xi	a2_ber_transient(1)	.	30.length
00:005B6C 3E0CEE              +447 	lcal	ber_release_cluster_p
(+03)10
00:005B6D 5D01A2              +448 	ly, xi	a2_ber_transient(2)	.	protocol version
00:005B6E 3E0BE6              +449 	lcal	ber_release_protocol_i
(+03)10
00:005B6F 5D01A8              +450 	ly, xi	a2_ber_transient(3)	.	community string
00:005B70 3E0C1E              +451 	lcal	ber_release_protocol_s
(+03)10
00:005B71 5D01AE              +452 	ly, xi	a2_ber_transient(4)	.	PDU type.length
00:005B72 3E0CEE              +453 	lcal	ber_release_cluster_p
(+03)10
00:005B73 5D01B4              +454 	ly, xi	a2_ber_transient(5)	.	request ID
00:005B74 3E0BE6              +455 	lcal	ber_release_protocol_i
(+03)10
00:005B75 5D01BA              +456 	ly, xi	a2_ber_transient(6)	.	status
00:005B76 3E0BE6              +457 	lcal	ber_release_protocol_i
(+03)10
00:005B77 5D01C0              +458 	ly, xi	a2_ber_transient(7)	.	error-index
00:005B78 3E0BE6              +459 	lcal	ber_release_protocol_i
  :                            460 
00:005B79 350000              +461 	lret	0
  :                            462 
  :                            165: 	$include ber
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 $(67::,y)
  :                            41 ber_t	ber_template
  :                            42 
  :                            43 $(0)
  :                            44 
  :                            45 ber_edit_mojet
00:005B7A 60A003              +46 	la	mo:type
00:005B7B 20B000              +47 	sa	ber_t:ojet
  :                            48 
00:005B7C 680004              +49 	anu, xi	SNMP_INT
00:005B7D DD0002              +49 
00:005B7E CE0B92              +50 	jzb	ber_edit_integer
00:005B7F 680004              +51 	anu, xi	SNMP_COUNTER
00:005B80 DD0041              +51 
00:005B81 CE0B92              +52 	jzb	ber_edit_integer	. manager does not like ber_edit_unsigned
00:005B82 680004              +53 	anu, xi	SNMP_GAUGE
00:005B83 DD0042              +53 
00:005B84 CE0B92              +54 	jzb	ber_edit_integer	. manager does not like ber_edit_unsigned
00:005B85 680004              +55 	anu, xi	SNMP_TIMETICKS
00:005B86 DD0043              +55 
00:005B87 CE0B92              +56 	jzb	ber_edit_integer	. manager does not like ber_edit_unsigned
00:005B88 680004              +57 	anu, xi	SNMP_STRING
00:005B89 DD0004              +57 
00:005B8A CE0BE0              +58 	jzb	ber_edit_string
00:005B8B 680004              +59 	anu, xi	SNMP_NETWORKADDRESS
00:005B8C DD0040              +59 
00:005B8D CE0BE0              +60 	jzb	ber_edit_string
00:005B8E 680004              +61 	anu, xi	SNMP_OID
00:005B8F DD0006              +61 
00:005B90 CE0BDA              +62 	jzb	ber_edit_oid
00:005B91 350000              +63 	lret	0
  :                            64 
  :                            65 ber_edit_integer
00:005B92 68A001              +66 	lb	mo:data
00:005B93 60A004              +67 	la	mo:bytes
00:005B94 C5FFFC              +68 	aa, xi	-4
00:005B95 7E0BA3              +69 	jc	ber_edit_long	. stored value > 1 word
  :                            70 
00:005B96 F8D000              +71 	push	0, b		. stored value 1 word
00:005B97 A7F000              +72 	lsc	0, sp		. count signs
00:005B98 CDFFFF              +73 	ab, xi	-1		. leave at least one sign
00:005B99 ADFFF8              +74 	andB,xi	-8		. suppress a whole number
00:005B9A 380004              +75 	pop	a		. of leading octets if any
00:005B9B 26D000              +76 	sal	0, b		. suppress by shifting left
00:005B9C 20B002              +77 	sa	ber_t:data
00:005B9D 650018              +78 	la, xi	24		. calculate the number
00:005B9E D00005              +79 	ana	b		. of unsuppressed octets
00:005B9F 060003              +80 	sar	3
00:005BA0 20B001              +81 	sa	ber_t:bytes
00:005BA1 C50002              +82 	aa, xi	2
00:005BA2 350000              +83 	lret	0
  :                            84 
  :                            85 ber_edit_long			. stored value 2 words
00:005BA3 9FD000              +86 	dpush	0, b
00:005BA4 E7F000              +87 	dlsc	0, sp		. count signs
  :                            88 
00:005BA5 600006              +89 	la	6
00:005BA6 C5FFFF              +90 	aa, xi	-1		. leave at least one sign
00:005BA7 A5FFF8              +91 	and,xi	-8		. suppress a whole number
00:005BA8 200006              +92 	sa	6		. of leading octets if any
  :                            93 
00:005BA9 380004              +94 	dpop	a
00:005BAA 380005              +94 
00:005BAB 368006              +95 	dsl	*6		. suppress by shifting left
00:005BAC C7B002              +96 	ds	ber_t:data
00:005BAD 650030              +97 	la, xi	48		. calculate the number
00:005BAE D00006              +98 	ana	6		. of unsuppresed octets
00:005BAF 060003              +99 	sar	3
00:005BB0 20B001              +100 	sa	ber_t:bytes
00:005BB1 C50002              +101 	aa, xi	2
00:005BB2 350000              +102 	lret	0
  :                            103 
  :                            104 
  :                            105 ber_edit_unsigned
00:005BB3 68A001              +106 	lb	mo:data
00:005BB4 60A004              +107 	la	mo:bytes
00:005BB5 C5FFFC              +108 	aa, xi	-4
00:005BB6 7E0BC7              +109 	jc	ber_edit_ul	. stored number > 1 word
  :                            110 				. stored number = 1 word
00:005BB7 F8D000              +111 	push	0, b
00:005BB8 A7F000              +112 	lsc	0, sp		. calculate whole zero octets
00:005BB9 ADFFF8              +113 	andB,xi	-8		. to suppress
00:005BBA 380004              +114 	pop	a		. but 1s are not signs
00:005BBB A60BBD              +115 	jpa	ber_edit_rotate1
00:005BBC 6D0000              +116 	lb, xi	0		. force out 3 unsigned octets
  :                            117 ber_edit_rotate1
00:005BBD 26D000              +118 	sal	0, b
00:005BBE 20B002              +119 	sa	ber_t:data
00:005BBF 650018              +120 	la, xi	24		. calculate output octets
00:005BC0 D00005              +121 	ana	b
00:005BC1 D60BC3              +122 	jnza	ber_edit_length1
00:005BC2 650008              +123 	la, xi	8		. force 1 byte out
  :                            124 ber_edit_length1
00:005BC3 060003              +125 	sar	3
00:005BC4 20B001              +126 	sa	ber_t:bytes
00:005BC5 C50002              +127 	aa, xi	2
00:005BC6 350000              +128 	lret	0
  :                            129 
  :                            130 ber_edit_ul
00:005BC7 9FD000              +131 	dpush	0, b
00:005BC8 E7F000              +132 	dlsc	0, sp		. calculate whole zero octets
00:005BC9 600006              +133 	la	6		. to suppress
00:005BCA A5FFF8              +134 	and, xi	-8
00:005BCB 200006              +135 	sa	6
00:005BCC 380004              +136 	dpop	a		. but 1s are not signs
00:005BCD 380005              +136 
00:005BCE A60BD0              +137 	jpa	ber_edit_rotate2
00:005BCF 300006              +138 	z	6		. force out 6 unsigned octets
  :                            139 ber_edit_rotate2
00:005BD0 368006              +140 	dsl	*6
00:005BD1 C7B002              +141 	ds	ber_t:data
00:005BD2 650030              +142 	la, xi	48		. calculate output octets
00:005BD3 D00006              +143 	ana	6
00:005BD4 D60BD6              +144 	jnza	ber_edit_length2
00:005BD5 650008              +145 	la, xi	8		. force 1 byte out
  :                            146 ber_edit_length2
00:005BD6 060003              +147 	sar	3
00:005BD7 20B001              +148 	sa	ber_t:bytes
00:005BD8 C50002              +149 	aa, xi	2
00:005BD9 350000              +150 	lret	0
  :                            151 	
  :                            152 
  :                            153 
  :                            154 ber_edit_oid
00:005BDA 60A004              +155 	la	mo:bytes
00:005BDB 20B001              +156 	sa	ber_t:bytes
00:005BDC 68A001              +157 	lb	mo:data
00:005BDD 28B003              +158 	sb	ber_t:storage
00:005BDE C50002              +159 	aa, xi	2
00:005BDF 350000              +160 	lret	0
  :                            161 
  :                            162 ber_edit_string
00:005BE0 60A004              +163 	la	mo:bytes
00:005BE1 20B001              +164 	sa	ber_t:bytes
00:005BE2 3E0CE4              +165 	lcal	ber_edit_cluster
00:005BE3 68A001              +166 	lb	mo:data
00:005BE4 28B003              +167 	sb	ber_t:storage
00:005BE5 350000              +168 	lret	0
  :                            169 
  :                            170 ber_release_protocol_i
00:005BE6 650002              +171 	la, xi	SNMP_INT
00:005BE7 B60BF8              +172 	j	ber_release_moi
  :                            173 
  :                            174 ber_release_mo
00:005BE8 60B000              +175 	la	ber_t:ojet
  :                            176 
00:005BE9 680004              +177 	anu, xi	SNMP_SEQUENCE
00:005BEA DD0030              +177 
00:005BEB CE0CEF              +178 	jzb	ber_release_cluster
00:005BEC 680004              +179 	anu, xi	SNMP_STRING
00:005BED DD0004              +179 
00:005BEE CE0C20              +180 	jzb	ber_release_string
00:005BEF 680004              +181 	anu, xi	SNMP_NETWORKADDRESS
00:005BF0 DD0040              +181 
00:005BF1 CE0C20              +182 	jzb	ber_release_netaddress
00:005BF2 680004              +183 	anu, xi	SNMP_OID
00:005BF3 DD0006              +183 
00:005BF4 CE0C20              +184 	jzb	ber_release_oid
  :                            185 
00:005BF5 F80004              +186 	push	a
00:005BF6 3E0C17              +187 	lcal	ber_release_identifier
00:005BF7 380004              +188 	pop	a
  :                            189 
  :                            190 ber_release_moi
00:005BF8 260010              +191 	sal	16
00:005BF9 1D0008              +192 	wsr	8
00:005BFA 60B001              +193 	la	ber_t:bytes
00:005BFB 400004              +194 	lr	a
00:005BFC 260010              +195 	sal	16
00:005BFD 1D0008              +196 	wsr	8
  :                            197 
00:005BFE CFB002              +198 	dl	ber_t:data
00:005BFF B60C03              +199 	j	ber_release_ioctet?
  :                            200 
  :                            201 ber_release_ioctet!
00:005C00 1D0008              +202 	wsr	8
00:005C01 060008              +203 	sar	8
00:005C02 360008              +204 	dsl	8
  :                            205 ber_release_ioctet?
00:005C03 1E0C00              +206 	jdr	ber_release_ioctet!
  :                            207 
00:005C04 350000              +208 	lret	0
  :                            209 
  :                            210 
  :                            211 ber_release_xlength
00:005C05 680004              +212 	anu, xi	128
00:005C06 DD0080              +212 
00:005C07 7E0C0B              +213 	jc	ber_xlength2?
00:005C08 260010              +214 	sal	16
00:005C09 1D0008              +215 	wsr	8
00:005C0A 350000              +216 	lret	0
  :                            217 ber_xlength2?
00:005C0B 680004              +218 	anu, xi	256
00:005C0C DD0100              +218 
00:005C0D 7E0C12              +219 	jc	ber_xlength3!
00:005C0E 958100              +220 	or, xi	08100
00:005C0F 260008              +221 	sal	8
00:005C10 1D0010              +222 	wsr	16
00:005C11 350000              +223 	lret	0
  :                            224 ber_xlength3!
00:005C12 A00ED2              +225 	and	(65535)
00:005C13 900F9E              +226 	or	(0820000:s)
00:005C14 1D0008              +227 	wsr	8
00:005C15 1D0010              +228 	wsr	16
00:005C16 350000              +229 	lret	0
  :                            230 
  :                            231 ber_release_identifier
00:005C17 60B004              +232 	la	ber_t:oidl
00:005C18 160001              +233 	dsr	1
00:005C19 F8B005              +234 	push	ber_t:oid
00:005C1A 38000D              +235 	pop	q
00:005C1B 400004              +236 	lr	a
00:005C1C 300014              +237 	z	RDATAC
00:005C1D B60C32              +238 	j	ber_release16?
  :                            239 
  :                            240 ber_release_protocol_s
00:005C1E 650004              +241 	la, xi	SNMP_STRING
00:005C1F B60C23              +242 	j	ber_release_svalue
  :                            243 
  :                            244 ber_release_oid
  :                            245 ber_release_netaddress
  :                            246 ber_release_string
  :                            247 
00:005C20 F80004              +248 	push	a
00:005C21 3E0C17              +249 	lcal	ber_release_identifier
00:005C22 380004              +250 	pop	a
  :                            251 
  :                            252 ber_release_svalue
00:005C23 260010              +253 	sal	16	. output the type code
00:005C24 1D0008              +254 	wsr	8
  :                            255 
00:005C25 60B001              +256 	la	ber_t:bytes
00:005C26 3E0C05              +257 	lcal	ber_release_xlength
  :                            258 
00:005C27 60B001              +259 	la	ber_t:bytes
00:005C28 160001              +260 	dsr	1
  :                            261 
00:005C29 F8B003              +262 	push	ber_t:storage
00:005C2A 38000D              +263 	pop	q
  :                            264 
00:005C2B 400004              +265 	lr	a
00:005C2C 300014              +266 	z	RDATAC
00:005C2D 0D0020              +267 	off	b$stream16r
  :                            268 
00:005C2E B60C32              +269 	j	ber_release16?
  :                            270 
  :                            271 ber_release16!
00:005C2F 150010              +272 	rsr	16
00:005C30 260008              +273 	sal	8
00:005C31 1D0010              +274 	wsr	16
  :                            275 ber_release16?
00:005C32 1E0C2F              +276 	jdr	ber_release16!
  :                            277 
00:005C33 AE0C37              +278 	jpb	ber_string_released
00:005C34 150008              +279 	rsr	8
00:005C35 260010              +280 	sal	16
00:005C36 1D0008              +281 	wsr	8
  :                            282 ber_string_released
00:005C37 350000              +283 	lret	0
  :                            284 
  :                            285 
  :                            286 
  :                            287 ber_load_oid
00:005C38 150008              +288 	rsr	8
  :                            289 ber_load_oid?
00:005C39 680004              +290 	anu, xi	SNMP_OID
00:005C3A DD0006              +290 
00:005C3B DE0C4D              +291 	jnzb	ber_load_oidx
00:005C3C 20A000              +292 	sa	0, x
00:005C3D 54A002              +293 	lx, i	2, x
00:005C3E 100006              +294 	sx	6		. save the start of the string
  :                            295 				. itself
00:005C3F 4D007F              +296 	lk, xi	127
  :                            297 
00:005C40 150008              +298 	rsr	8		. read the octets length
00:005C41 400004              +299 	lr	a
  :                            300 
00:005C42 680010              +301 	lb	BYTES
00:005C43 DCC002              +302 	anb, i	2, a
00:005C44 280010              +303 	sb	BYTES
  :                            304 
00:005C45 6D0000              +305 	lb, xi	0
  :                            306 
00:005C46 B60C4C              +307 	j	ber_load_oid_octet?
  :                            308 ber_load_oid_octet!
00:005C47 150008              +309 	rsr	8
00:005C48 BF0004              +310 	mlb	a		. place 7 bits in the token
00:005C49 A50080              +311 	and, xi	128		. flagged for more?
00:005C4A C60C4E              +312 	jza	ber_store_oid_token
00:005C4B 2E0007              +313 	sbl	7		. shift to take 7 more bits
  :                            314 
  :                            315 ber_load_oid_octet?
00:005C4C 1E0C47              +316 	jdr	ber_load_oid_octet!
  :                            317 ber_load_oidx
00:005C4D 350000              +318 	lret	0		. OID badly formed, still
  :                            319 				. expecting completion of
  :                            320 				. a token
  :                            321 
  :                            322 				. if there is an agent
  :                            323 				. which wants this result
  :                            324 				. then the last token is
  :                            325 				. in b and */7 positions
  :                            326 
  :                            327 				. and the count of tokens
  :                            328 				. up to there is
  :                            329 				. p minus ber_t:storage
  :                            330 
  :                            331 ber_store_oid_token
00:005C4E 28A000              +332 	sb	0, x
00:005C4F 850001              +333 	ax, xi	1
00:005C50 6D0000              +334 	lb, xi	0
00:005C51 1E0C47              +335 	jdr	ber_load_oid_octet!
  :                            336 
00:005C52 600002              +337 	la	x
00:005C53 680006              +338 	lb	6
00:005C54 D00006              +339 	ana	6		. return buffer in b
00:005C55 CDFFFE              +340 	ab, xi	-2
00:005C56 20D001              +341 	sa	1, b		. and the word count in a
  :                            342 
  :                            343 				. the # tokens must be
  :                            344 				. stored in the list
  :                            345 				. because mib get next
  :                            346 				. writes a new one there
  :                            347 
00:005C57 350001              +348 	lret	1		. well formed OID
  :                            349 
  :                            350 
  :                            351 
00:005C58 40A001              +352 ber_woi	lr	1, x		. edit the list of integer tokens
00:005C59 300017              +353 	z	WDATA		. to a transmission format oid
00:005C5A 650010              +354 	la, xi	16		. force 16 zero bits out first
00:005C5B 200016              +355 	sa	WDATAC
00:005C5C 60000C              +356 	la	p
00:005C5D 200007              +357 	sa	7		. save 1st word address
00:005C5E 300006              +358 	z	6		. start the octets count
  :                            359 
00:005C5F B60C7C              +360 	j	ber_woi_token?
  :                            361 
  :                            362 ber_woi_token!
00:005C60 68A002              +363 	lb	2, x
00:005C61 850001              +364 	ax, xi	1
  :                            365 
00:005C62 360003              +366 	dsl	3
00:005C63 A50007              +367 	and, xi	7
00:005C64 C60C74              +368 	jza	ber_woi21?
00:005C65 950080              +369 	or, xi	128
00:005C66 260010              +370 	sal	16
00:005C67 1D0008              +371 	wsr	8
00:005C68 170006              +372 	inc	6
  :                            373 
00:005C69 360007              +374 	dsl	7
  :                            375 ber_woi21!
00:005C6A 950080              +376 	or, xi	128
00:005C6B 260010              +377 	sal	16
00:005C6C 1D0008              +378 	wsr	8
00:005C6D 170006              +379 	inc	6
  :                            380 
00:005C6E 360007              +381 	dsl	7
  :                            382 ber_woi14!
00:005C6F 950080              +383 	or, xi	128
00:005C70 260010              +384 	sal	16
00:005C71 1D0008              +385 	wsr	8
00:005C72 170006              +386 	inc	6
00:005C73 B60C78              +387 	j	ber_woi7
  :                            388 
  :                            389 ber_woi21?
00:005C74 360007              +390 	dsl	7
00:005C75 D60C6A              +391 	jnza	ber_woi21!
00:005C76 360007              +392 	dsl	7
00:005C77 D60C6F              +393 	jnza	ber_woi14!
  :                            394 
  :                            395 ber_woi7
00:005C78 360007              +396 	dsl	7
00:005C79 260010              +397 	sal	16
00:005C7A 1D0008              +398 	wsr	8
00:005C7B 170006              +399 	inc	6
  :                            400 
  :                            401 ber_woi_token?
00:005C7C 1E0C60              +402 	jdr	ber_woi_token!
  :                            403 
00:005C7D 1D0010              +404 	wsr	16		. force the last word out
  :                            405 
00:005C7E CF0006              +406 	dl	6
00:005C7F 44C002              +407 	lr, i	2, a		. total octets with 06.LL
00:005C80 00B004              +408 	sr	ber_t:oidl
00:005C81 950600              +409 	or, xi	SNMP_OID*/8
00:005C82 260008              +410 	sal	8		. make room for the 1st token
  :                            411 
00:005C83 90D000              +412 	or	0, b		. update the 1st string word written
00:005C84 28B005              +413 	sb	ber_t:oid
00:005C85 20D000              +414 	sa	0, b		. with SNMP_OID.# octets
00:005C86 350000              +415 	lret	0
  :                            416 
  :                            417 
00:005C87 150008              +418 ber_rl	rsr	8
00:005C88 680004              +419 	lb	a
00:005C89 AD0080              +420 	andB,xi	128
00:005C8A DE0C8E              +421 	jnzb	ber_rll
00:005C8B 1F0010              +422 	dec	BYTES	. the command or data type or nest
00:005C8C 1F0010              +423 	dec	BYTES	. the length byte
00:005C8D 350000              +424 	lret	0
  :                            425 
00:005C8E A50003              +426 ber_rll	and, xi	3
00:005C8F 680010              +427 	lb	BYTES
00:005C90 DCC002              +428 	anb, i	2, a	. command/dtype + length bytes
00:005C91 280010              +429 	sb	BYTES
00:005C92 97CC94              +430 	ex	ber_rlx, a	
00:005C93 350000              +431 	lret	0
  :                            432 
00:005C94 150000              +433 ber_rlx	rsr	0
00:005C95 150008              +434 	rsr	8
00:005C96 150010              +435 	rsr	16
00:005C97 350000              +436 	lret	0	. too big error
  :                            437 
  :                            438 ber_swap_compare
00:005C98 3E0C87              +439 	lcal	ber_rl
00:005C99 680010              +440 	lb	BYTES
00:005C9A 200010              +441 	sa	BYTES
00:005C9B D80004              +442 	anb	a
00:005C9C 350000              +443 	lret	0
  :                            444 
  :                            445 ber_read_data
00:005C9D 150008              +446 	rsr	8
  :                            447 ber_read_datai
00:005C9E 20B000              +448 	sa	ber_t:ojet
  :                            449 
00:005C9F 3E0C87              +450 ber_rs	lcal	ber_rl		. subtract encoding + field length 
00:005CA0 680010              +451 	lb	BYTES		. from capsule size
00:005CA1 D80004              +452 	anb	a
00:005CA2 280010              +453 	sb	BYTES
  :                            454 
00:005CA3 400004              +455 	lr	a
00:005CA4 20B001              +456 	sa	ber_t:bytes	. record byte count in dynamic descriptor
00:005CA5 68000C              +457 	lb	p		. and cache start location of savearea
  :                            458 
00:005CA6 300016              +459 	z	WDATAC		. suppress residual store pending bit count
00:005CA7 0D0010              +460 	off	b$stream16w	. write 24 bits per storage word
  :                            461 
00:005CA8 B60CAC              +462 	j	ber_rs?
00:005CA9 150008              +463 ber_rs!	rsr	8		. read input stream
00:005CAA 260010              +464 	sal	16		. shift to high-order positions
00:005CAB 1D0008              +465 	wsr	8		. write store stream		
00:005CAC 1E0CA9              +466 ber_rs?	jdr	ber_rs!		. count down octet count
  :                            467 
00:005CAD 1D0010              +468 	wsr	16		. store last containing word
  :                            469 
  :                            470 	$if	1		. numbers must have word count zero
  :                            471 				. because word count field for strings
  :                            472 				. is allowed ranges for numbers
  :                            473 
  :                            474 				. this is zero for network protocols
  :                            475 				. unless they have a semantic for
  :                            476 				. transmitting range tuples
  :                            477 
  :                            478 
00:005CAE 60B000              +479 	la	ber_t:ojet	. data class
00:005CAF C5FFFE              +480 	aa, xi	-SNMP_INT
00:005CB0 C60CB9              +481 	jza	ber_rs_no_word_count
00:005CB1 C5FFC1              +482 	aa, xi	+SNMP_INT-SNMP_COUNTER
00:005CB2 C60CB9              +483 	jza	ber_rs_no_word_count
00:005CB3 C5FFFF              +484 	aa, xi	+SNMP_COUNTER-SNMP_GAUGE
00:005CB4 C60CB9              +485 	jza	ber_rs_no_word_count
00:005CB5 C5FFFF              +486 	aa, xi	+SNMP_GAUGE-SNMP_TIMETICKS
00:005CB6 C60CB9              +487 	jza	ber_rs_no_word_count
  :                            488 	$endif
  :                            489 
00:005CB7 60000C              +490 	la	p		. calculate word count
00:005CB8 D00005              +491 	ana	b
  :                            492 		.
  :                            493 ber_rs_no_word_count
00:005CB9 C7B002              +494 	ds	ber_t:data	. store word count:location
00:005CBA 350000              +495 	lret	0
  :                            496 
00:005CBB 150008              +497 ber_ri	rsr	8
00:005CBC 680004              +498 	anu, xi	SNMP_INT
00:005CBD DD0002              +498 
00:005CBE CE0CC0              +499 	jzb	ber_rii
00:005CBF 350000              +500 	lret	0		. not an integr
  :                            501 
00:005CC0 3E0C9E              +502 ber_rii	lcal	ber_read_datai	. read a number in the headers
00:005CC1 640006              +503 	la, i	6
00:005CC2 D0B001              +504 	ana	ber_t:bytes
00:005CC3 260003              +505 	sal	3
00:005CC4 500004              +506 	lx	a
00:005CC5 60B003              +507 	la	ber_t:storage
00:005CC6 CFC000              +508 	dl	0, a
00:005CC7 96A000              +509 	dsa	0, x
00:005CC8 C7B002              +510 	ds	ber_t:data
00:005CC9 350001              +511 	lret	1		. an integer
  :                            512 
  :                            513 ber_edit_semantic_i		. write a number in the headers
00:005CCA 60B001              +514 	la	ber_t:bytes
00:005CCB A50007              +515 	and, xi	7
00:005CCC 500004              +516 	lx	a
00:005CCD CFB002              +517 	dl	ber_t:data
00:005CCE 97ACD4              +518 	ex	ber_esi_shift, x
00:005CCF C7B002              +519 	ds	ber_t:data
00:005CD0 60ACDC              +520 	la	ber_esi_effect, x
00:005CD1 20B001              +521 	sa	ber_t:bytes
00:005CD2 C50002              +522 	aa, xi	2
00:005CD3 350000              +523 	lret	0
  :                            524 
  :                            525 ber_esi_shift
00:005CD4 360028              +526 	dsl	40
00:005CD5 360028              +527 	dsl	40
00:005CD6 360020              +528 	dsl	32
00:005CD7 360018              +529 	dsl	24
00:005CD8 360010              +530 	dsl	16
00:005CD9 360008              +531 	dsl	8
00:005CDA 360000              +532 	dsl	0
00:005CDB 360000              +533 	dsl	0
  :                            534 
  :                            535 ber_esi_effect
00:005CDC 000001              +536 	+	1
00:005CDD 000001              +537 	+	1
00:005CDE 000002              +538 	+	2
00:005CDF 000003              +539 	+	3
00:005CE0 000004              +540 	+	4
00:005CE1 000005              +541 	+	5
00:005CE2 000006              +542 	+	6
00:005CE3 000006              +543 	+	6
  :                            544 
  :                            545 
  :                            546 ber_edit_cluster
00:005CE4 F80004              +547 	push	a
00:005CE5 A7F000              +548 	lsc	0, sp
00:005CE6 CDFFF0              +549 	ab, xi	-16
00:005CE7 EE0CE9              +550 	jnb	$+2
00:005CE8 CD0007              +551 	ab, xi	7
00:005CE9 0E0003              +552 	sbr	3
00:005CEA 650003              +553 	la, xi	3
00:005CEB D00005              +554 	ana	b
00:005CEC 2F0004              +555 	popA	a
00:005CED 350000              +556 	lret	0
  :                            557 
  :                            558 ber_release_cluster_p
00:005CEE 60B000              +559 	la	ber_t:ojet
  :                            560 ber_release_cluster
00:005CEF 260010              +561 	sal	16
00:005CF0 1D0008              +562 	wsr	8
00:005CF1 60B001              +563 	la	ber_t:bytes
00:005CF2 3E0C05              +564 	lcal	ber_release_xlength
00:005CF3 350000              +565 	lret	0
  :                            166: 	$include sequo
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
                                ber_sequence_scan	;
                                	$head_near	 params(ber_inbytes,	int		;
                                				ber_oid_array,	int)		;
                                								;
                                			scalars(ber_akku,	int		;
                                				ber_savebytes,	int,	BYTES	;
00:005CF4 FD0000              +46 				ber_transientp,	int,	y	)
00:005CF5 F80010              +46 
00:005CF6 F80003              +46 
  :                            47 
00:005CF7 650030              +48 	la, xi	SNMP_SEQUENCE
00:005CF8 20B000              +49 	sa	ber_t:ojet
  :                            50 
00:005CF9 60F005              +51 	la	ber_inbytes
00:005CFA 200010              +52 	sa	BYTES
  :                            53 
  :                            54 ber_sequence_scan_cluster
  :                            55 .	ay, xi	BER_TRANSIENT_SIZE
00:005CFB 600010              +56 	la	BYTES
00:005CFC E60D43              +57 	jna	ber_sequence_scanx
00:005CFD C60D43              +58 	jza	ber_sequence_scanx
  :                            59 
00:005CFE 150008              +60 	rsr	$byte
00:005CFF 680004              +61 	anu, xi	SNMP_SEQUENCE
00:005D00 DD0030              +61 
00:005D01 DE0D10              +62 	jnzb	ber_sequence_variable?
  :                            63 
00:005D02 3E0C87              +64 	lcal	ber_rl
00:005D03 680010              +65 	lb	BYTES
00:005D04 D80004              +66 	anb	a
00:005D05 280010              +67 	sb	BYTES
  :                            68 
00:005D06 8D0006              +69 	ay, xi	BER_TRANSIENT_SIZE
  :                            70 
00:005D07 F8F006              +71 	lc	ber_sequence_scan	a	ber_oid_array
00:005D08 F80004              +71 
00:005D09 FCF002              +71 
00:005D0A 3E0CF4              +71 
00:005D0B 38000F              +71 
  :                            72 
00:005D0C D60D4A              +73 	jnza	ber_sequence_scanz
  :                            74 .	sb	ber_t:bytes
  :                            75 
00:005D0D C8F002              +76 	ab	ber_akku
00:005D0E 28F002              +77 	sb	ber_akku
00:005D0F B60CFB              +78 	j	ber_sequence_scan_cluster
  :                            79 
  :                            80 ber_sequence_variable?
(+03)0f
00:005D10 17022D              +81 	inc	a2_ix
00:005D11 50F006              +82 	lx	ber_oid_array
00:005D12 3E0C39              +83 	lcal	ber_load_oid?		. SNMP_OID is already read
00:005D13 B60D41              +84 	j	ber_sequence_generr	. it wasn't a good oid
  :                            85 
00:005D14 8D0006              +86 	ay, xi	BER_TRANSIENT_SIZE
  :                            87 
00:005D15 3E0C9D              +88 	lcal	ber_read_data
  :                            89 
(+03)0f
00:005D16 60022E              +90 	la	ber_command
00:005D17 180008              +91 	sy	8			. save the transient descriptor
  :                            92 					. mib walk will overwrite y
  :                            93 
00:005D18 680004              +94 	anu, xi	SNMP_GETNEXTREQ
00:005D19 DD00A1              +94 
00:005D1A CE0D25              +95 	jzb	ber_sequence_getnext
  :                            96 
00:005D1B 680004              +97 	anu, xi	SNMP_SETREQ
00:005D1C DD00A3              +97 
00:005D1D CE0D2C              +98 	jzb	ber_sequence_set
  :                            99 
  :                            100 ber_sequence_scan_get
(+03)0f
00:005D1E F8022C              +101 	c	(mib_get)	ber_oid_array	a2_permission
00:005D1F F8F007              +101 
00:005D20 FCF002              +101 
00:005D21 FF0F9F              +101 
00:005D22 38000F              +101 
00:005D23 D60D4A              +102 	jnza	ber_sequence_scanz
00:005D24 B60D37              +103 	j	ber_sequence_represent
  :                            104 
  :                            105 ber_sequence_getnext
(+03)0f
00:005D25 F8022C              +106 	c	(mib_getnext)	ber_oid_array	a2_permission
00:005D26 F8F007              +106 
00:005D27 FCF002              +106 
00:005D28 FF0FA0              +106 
00:005D29 38000F              +106 
00:005D2A D60D4A              +107 	jnza	ber_sequence_scanz
00:005D2B B60D37              +108 	j	ber_sequence_represent
  :                            109 
  :                            110 ber_sequence_set
                                	c	(mib_set)	ber_oid_array	a2_permission	;
                                				ber_t:ojet	ber_t:bytes	;
                                				ber_t:storage	ber_t:data	;
00:005D2C FD0000              +114 				0,,xi
00:005D2D F8B002              +114 
00:005D2E F8B003              +114 
00:005D2F F8B001              +114 
00:005D30 F8B000              +114 
(+03)0f
00:005D31 F8022C              +114 
00:005D32 F8F00C              +114 
00:005D33 FCF007              +114 
00:005D34 FF0FA1              +114 
00:005D35 38000F              +114 
  :                            115 
00:005D36 D60D4A              +116 	jnza	ber_sequence_scanz
  :                            117 
  :                            118 .	j	ber_sequence_represent
  :                            119 
  :                            120 ber_sequence_represent
00:005D37 580008              +121 	ly	8	.	transient descriptor
00:005D38 280008              +122 	sb	8	.	MIB object descriptor
00:005D39 50F006              +123 	lx	ber_oid_array
00:005D3A 3E0C58              +124 	lcal	ber_woi
  :                            125 
00:005D3B 500008              +126 	lx	8	.	MIB object descriptor
00:005D3C 3E0B7A              +127 	lcal	ber_edit_mojet
  :                            128 
00:005D3D C0B004              +129 	aa	ber_t:oidl
00:005D3E C0F002              +130 	aa	ber_akku
00:005D3F 20F002              +131 	sa	ber_akku
  :                            132 
00:005D40 B60D43              +133 	j	ber_sequence_scanx
  :                            134 
  :                            135 ber_sequence_generr
00:005D41 650005              +136 	la, xi	SNMP_GENERR
00:005D42 B60D4A              +137 	j	ber_sequence_scanz
  :                            138 
  :                            139 ber_sequence_scanx
00:005D43 60F001              +140 	la	ber_savebytes
00:005D44 200010              +141 	sa	BYTES
00:005D45 60F002              +142 	la	ber_akku
00:005D46 68F000              +143 	lb	ber_transientp
00:005D47 20D001              +144 	sa	ber_t:bytes, b
00:005D48 3E0CE4              +145 	lcal	ber_edit_cluster
00:005D49 160018              +146 	dsr	24
  :                            147 
  :                            148 ber_sequence_scanz
00:005D4A 54F003              +149 	lx, i	$$frame, sp
00:005D4B 10000F              +150 	sx	sp
00:005D4C 350000              +151 	lret	0
  :                            167 
  :                            168 	$path	../netapps2
  :                            169: 	$include subagent
  :                            1 $(3)
  :                            2 subagent_ithread
03:000423 000000              +3 	$do	170,	0
03:000424 000000              +3 
03:000425 000000              +3 
03:000426 000000              +3 
03:000427 000000              +3 
03:000428 000000              +3 
03:000429 000000              +3 
03:00042A 000000              +3 
03:00042B 000000              +3 
03:00042C 000000              +3 
03:00042D 000000              +3 
03:00042E 000000              +3 
03:00042F 000000              +3 
03:000430 000000              +3 
03:000431 000000              +3 
03:000432 000000              +3 
03:000433 000000              +3 
03:000434 000000              +3 
03:000435 000000              +3 
03:000436 000000              +3 
03:000437 000000              +3 
03:000438 000000              +3 
03:000439 000000              +3 
03:00043A 000000              +3 
03:00043B 000000              +3 
03:00043C 000000              +3 
03:00043D 000000              +3 
03:00043E 000000              +3 
03:00043F 000000              +3 
03:000440 000000              +3 
03:000441 000000              +3 
03:000442 000000              +3 
03:000443 000000              +3 
03:000444 000000              +3 
03:000445 000000              +3 
03:000446 000000              +3 
03:000447 000000              +3 
03:000448 000000              +3 
03:000449 000000              +3 
03:00044A 000000              +3 
03:00044B 000000              +3 
03:00044C 000000              +3 
03:00044D 000000              +3 
03:00044E 000000              +3 
03:00044F 000000              +3 
03:000450 000000              +3 
03:000451 000000              +3 
03:000452 000000              +3 
03:000453 000000              +3 
03:000454 000000              +3 
03:000455 000000              +3 
03:000456 000000              +3 
03:000457 000000              +3 
03:000458 000000              +3 
03:000459 000000              +3 
03:00045A 000000              +3 
03:00045B 000000              +3 
03:00045C 000000              +3 
03:00045D 000000              +3 
03:00045E 000000              +3 
03:00045F 000000              +3 
03:000460 000000              +3 
03:000461 000000              +3 
03:000462 000000              +3 
03:000463 000000              +3 
03:000464 000000              +3 
03:000465 000000              +3 
03:000466 000000              +3 
03:000467 000000              +3 
03:000468 000000              +3 
03:000469 000000              +3 
03:00046A 000000              +3 
03:00046B 000000              +3 
03:00046C 000000              +3 
03:00046D 000000              +3 
03:00046E 000000              +3 
03:00046F 000000              +3 
03:000470 000000              +3 
03:000471 000000              +3 
03:000472 000000              +3 
03:000473 000000              +3 
03:000474 000000              +3 
03:000475 000000              +3 
03:000476 000000              +3 
03:000477 000000              +3 
03:000478 000000              +3 
03:000479 000000              +3 
03:00047A 000000              +3 
03:00047B 000000              +3 
03:00047C 000000              +3 
03:00047D 000000              +3 
03:00047E 000000              +3 
03:00047F 000000              +3 
03:000480 000000              +3 
03:000481 000000              +3 
03:000482 000000              +3 
03:000483 000000              +3 
03:000484 000000              +3 
03:000485 000000              +3 
03:000486 000000              +3 
03:000487 000000              +3 
03:000488 000000              +3 
03:000489 000000              +3 
03:00048A 000000              +3 
03:00048B 000000              +3 
03:00048C 000000              +3 
03:00048D 000000              +3 
03:00048E 000000              +3 
03:00048F 000000              +3 
03:000490 000000              +3 
03:000491 000000              +3 
03:000492 000000              +3 
03:000493 000000              +3 
03:000494 000000              +3 
03:000495 000000              +3 
03:000496 000000              +3 
03:000497 000000              +3 
03:000498 000000              +3 
03:000499 000000              +3 
03:00049A 000000              +3 
03:00049B 000000              +3 
03:00049C 000000              +3 
03:00049D 000000              +3 
03:00049E 000000              +3 
03:00049F 000000              +3 
03:0004A0 000000              +3 
03:0004A1 000000              +3 
03:0004A2 000000              +3 
03:0004A3 000000              +3 
03:0004A4 000000              +3 
03:0004A5 000000              +3 
03:0004A6 000000              +3 
03:0004A7 000000              +3 
03:0004A8 000000              +3 
03:0004A9 000000              +3 
03:0004AA 000000              +3 
03:0004AB 000000              +3 
03:0004AC 000000              +3 
03:0004AD 000000              +3 
03:0004AE 000000              +3 
03:0004AF 000000              +3 
03:0004B0 000000              +3 
03:0004B1 000000              +3 
03:0004B2 000000              +3 
03:0004B3 000000              +3 
03:0004B4 000000              +3 
03:0004B5 000000              +3 
03:0004B6 000000              +3 
03:0004B7 000000              +3 
03:0004B8 000000              +3 
03:0004B9 000000              +3 
03:0004BA 000000              +3 
03:0004BB 000000              +3 
03:0004BC 000000              +3 
03:0004BD 000000              +3 
03:0004BE 000000              +3 
03:0004BF 000000              +3 
03:0004C0 000000              +3 
03:0004C1 000000              +3 
03:0004C2 000000              +3 
03:0004C3 000000              +3 
03:0004C4 000000              +3 
03:0004C5 000000              +3 
03:0004C6 000000              +3 
03:0004C7 000000              +3 
03:0004C8 000000              +3 
03:0004C9 000000              +3 
03:0004CA 000000              +3 
03:0004CB 000000              +3 
03:0004CC 000000              +3 
  :                            4 
  :                            5 $(0)
  :                            6 
  :                            7 .	routines have static data in IP process so only callable from IP process
  :                            8 
  :                            9 .	far call vector name (subagent)
  :                            10 .	transmission control block x-> is leased to another process a
  :                            11 
  :                            12 subagent_insert
00:005D4D F80004              +13 	push	a
00:005D4E 3E0D67              +14 	lcal	subagent_point
00:005D4F 38C000              +15 	pop	0, a			. store the process control block index
00:005D50 3D0000              +16 	fret	0
  :                            17 
  :                            18 .	far call vector name (subagent?)
  :                            19 .	is transmission control block x-> leased to another process?
  :                            20 
  :                            21 subagent_lookup
00:005D51 3E0D67              +22 	lcal	subagent_point
00:005D52 70C000              +23 	tz	0, a			. has this connection a subagent?
00:005D53 3E0D56              +24 	lcal	subagent_running?	. currently?
00:005D54 3D0001              +25 	fret	1			. either no or not active
00:005D55 3D0000              +26 	fret	0			. yes and still using this handle
  :                            27 
  :                            28 subagent_running?
00:005D56 580004              +29 	ly	a
00:005D57 60C000              +30 	la	0, a
00:005D58 750072              +31 	ii	THREAD$STATE		. is this the thread leasing this connection?
00:005D59 B60D64              +32 	j	subagent_cancel		. either it isn't or it isn't running
  :                            33 
00:005D5A 340020              +34 	sabr	32			. base target threadCB in volatile-use window
00:005D5B 608F22              +35 	la	*(32*/12++ABT-01000+2s)	. pull up vector list pointer
00:005D5C 340020              +36 	sabr	32			. base target process vector list
  :                            37 	
00:005D5D 600002              +38 	la	x			. construct connection handle encoding
00:005D5E 680FA2              +39 	lb	(TCP_TCB*/16)		. from transmission control block pointer x
00:005D5F 76000C              +40 	drl	12
00:005D60 46000C              +41 	rar	12
00:005D61 682185              +42 	lb	tcx_v4(1)		. storage pointer connections memory window[b] into b
  :                            43 
  :                            44 					. compare
00:005D62 DF8F24              +45 	dan	*(32*/12++handle(1)-02000)
00:005D63 7C0D66              +46 	jdz	subagent_running!	. target process got this handle from us
  :                            47 					. or rather no it didn't. This must be a new process
  :                            48 subagent_cancel
00:005D64 30B000              +49 	z	0, y
00:005D65 350000              +50 	lret	0
  :                            51 
  :                            52 subagent_running!
00:005D66 350001              +53 	lret	1
  :                            54 
  :                            55 subagent_point
00:005D67 680002              +56 	lb	x
00:005D68 AD0FFF              +57 	andB	4095,,xi		. maximum connections in one table 169
00:005D69 E80FA3              +58 	mf	(0AAAAAB/*4)		. jerst multiply hee by one liddle ole reciprocal of 24yar
(+03)10
00:005D6A C50423              +59 	aa	subagent_ithread,,xi	. that way you stay inside a table of 170 entries
00:005D6B 350000              +60 	lret	0
  :                            61 
  :                            170: 	$include ../lib/x72_48if
  :                            1 .	calls from 48-radix routines
  :                            2 .	all have leftside operand in register a:b
  :                            3 
  :                            4 "$$swap"
00:005D6C 9F0004              +5 	dpush	a
00:005D6D 9F0006              +6 	dpush	6
00:005D6E 870004              +7 	qpop	a
00:005D6F 350000              +8 	lret	0
  :                            9 
  :                            10 .	vector name x72_xtend
  :                            11 
  :                            12 
  :                            13 	$if	1
  :                            14 x72xtend
00:005D70 9F0004              +15 	dpush	a
00:005D71 960030              +16 	dsa	48
00:005D72 C70006              +17 	ds	6
00:005D73 380004              +18 	dpop	a
00:005D74 380005              +18 
00:005D75 3D0000              +19 	fret	0
  :                            20 	$endif
  :                            21 
  :                            22 .	vector name x72_aU
  :                            23 
  :                            24 x72au	$tree
  :                            25 
                                	$head_far	 params(addend2w,	long		;
                                				signs_length,	int	)	;
                                								;
                                			scalars(carry,	long			;	
                                				i47_0,	long,	a		;
00:005D76 9F0F0F              +31 				caller_x, int,	x		)
00:005D77 9F0004              +31 
00:005D78 F80002              +31 
  :                            32 
00:005D79 B7F004              +33 	sc	carry+1
00:005D7A CFF008              +34 	dl	addend2w
00:005D7B 50F00A              +35 	lx	signs_length
00:005D7C 96A000              +36 	dsa	0, x		. [data word] + extended signs
00:005D7D D70006              +37 	da	6
00:005D7E D7F003              +38 	da	carry
00:005D7F C7F003              +39 	ds	carry
00:005D80 380002              +40 	pop	x
00:005D81 870004              +41 	qpop	a
00:005D82 3D0000              +42 	fret	0
  :                            43 
  :                            44 	$root
  :                            45 	
  :                            46 
  :                            47 .	vector name x72_anU
  :                            48 
  :                            49 x72anu	$tree
                                	$head_far	 params(subtrahend2w,		long	;
                                				signs_length,		int)	;
                                								;
                                			scalars(carry,	long			;
                                				i47_0,	long,	a		;
00:005D83 9F0F0F              +55 				caller_x, int,	x		)
00:005D84 9F0004              +55 
00:005D85 F80002              +55 
  :                            56 
00:005D86 B7F004              +57 	sc	carry+1
00:005D87 CFF008              +58 	dl	subtrahend2w
00:005D88 B5FFFF              +59 	xor	-1,,xi		. add antisigns
00:005D89 BDFFFF              +60 	xorB	-1,,xi
00:005D8A 50F00A              +61 	lx	signs_length
00:005D8B 96A000              +62 	dsa	0, x
00:005D8C D7F003              +63 	da	carry
00:005D8D D70006              +64 	da	6
00:005D8E C7F003              +65 	ds	carry
00:005D8F 380002              +66 	pop	x
00:005D90 870004              +67 	qpop	a
00:005D91 3D0000              +68 	fret	0
  :                            69 	$root
  :                            70 
  :                            71 .	vector name x72_m48_24
  :                            72 
  :                            73 x48m24	$tree
  :                            74 	$head_far	 params(multiplier,	int)
  :                            75 
00:005D92 F8F003              +76 	c	(m48_24)	multiplier
00:005D93 FCF001              +76 
00:005D94 FF0FA4              +76 
00:005D95 38000F              +76 
  :                            77 
00:005D96 3E0D6C              +78 	lcal	$$swap
00:005D97 3D0000              +79 	$ret
  :                            80 	$root
  :                            81 
  :                            82 .	vector name x72_m72_24[]
  :                            83 x72m24	$tree
  :                            84 
  :                            85 	$if	1
  :                            86 
  :                            87 	$head_far	 params(multiplier,	int	)
  :                            88 
00:005D98 F8F003              +89 	c	(i72_multiply)	7	a,,long		multiplier
00:005D99 9F0004              +89 
00:005D9A F80007              +89 
00:005D9B FCF004              +89 
00:005D9C FF0FA5              +89 
00:005D9D 38000F              +89 
00:005D9E 3E0D6C              +90 	lcal	$$swap
00:005D9F 3D0000              +91 	$ret
  :                            92 
  :                            93 	$else
  :                            94 
                                	$head_far	 params(multiplier,	int	)	;
                                								;
                                			scalars(caller_8_11,	float,	8	;
                                				product,	long,	a	;
  :                            99 				productu,	long,	6	)
  :                            100 
  :                            101 	c	(i72_multiply)	productu+1,,triple	multiplier	productu+1,,i
  :                            102 
  :                            103 	pop	a
  :                            104 	pop	a
  :                            105 	dsa	24
  :                            106 	ds	6
  :                            107 	dpop	a
  :                            108 	qpop	8
  :                            109 
  :                            110 	fret	0
  :                            111 
  :                            112 	$endif
  :                            113 
  :                            114 	$root
  :                            115 
  :                            116 
  :                            117 .	vector name x72_m48_48
  :                            118 
  :                            119 x48m48	$tree
  :                            120 	$head_far	 params(multiplier,	long)
  :                            121 
00:005DA0 9FF003              +122 	c	(m48_48)	multiplier,,long
00:005DA1 FCF002              +122 
00:005DA2 FF0FA6              +122 
00:005DA3 38000F              +122 
00:005DA4 3E0D6C              +123 	lcal	$$swap
00:005DA5 3D0000              +124 	$ret
  :                            125 	$root
  :                            126 
  :                            127 
  :                            128 .	vector name x72_m72_48
  :                            129 
  :                            130 x72m48	$tree
                                	$head_far	 params(multiplier_i48,	long		)	;
                                									;
                                			scalars(multiplier,	float			;
                                				caller891011,	float,	8		;
                                				multiplicand,	long,	a		;
                                				multiplicand_u,	long,	6		;
                                				caller_rkxy,	float,	r		;
00:005DA6 8F0EA5              +138 				mguard,		int,	fp$guard	)
00:005DA7 8F0008              +138 
00:005DA8 9F0004              +138 
00:005DA9 9F0006              +138 
00:005DAA 8F0000              +138 
00:005DAB F80093              +138 
  :                            139 
00:005DAC 650000              +140 	la	0,,xi
00:005DAD 75005E              +141 	ii	FP_GUARD$
  :                            142 
00:005DAE CFF014              +143 	dl	multiplier_i48
00:005DAF FF0FA7              +144 	call	(i48_2float)
00:005DB0 47F00D              +145 	qs	multiplier
00:005DB1 54F006              +146 	lx	multiplicand_u+1,,i
00:005DB2 FF0FA8              +147 	call	(tripl2float)
00:005DB3 77F00D              +148 	fm	multiplier
00:005DB4 FF0FA9              +149 	call	(float2i72)
00:005DB5 C7F007              +150 	ds	multiplicand			. multiplicand_u
00:005DB6 CF0006              +151 	dl	6
00:005DB7 C7F005              +152 	ds	multiplicand_u			. multiplicand
  :                            153 
00:005DB8 380004              +154 	pop	a
00:005DB9 75005E              +155 	ii	FP_GUARD$
00:005DBA 870000              +156 	qpop	r
00:005DBB 870004              +157 	qpop	a
00:005DBC 870008              +158 	qpop	8
00:005DBD 87F000              +159 	qpop	0, sp
  :                            160 
00:005DBE 3D0000              +161 	fret	0
  :                            162 	$root
  :                            163 
  :                            164 .	vector name x72_m72_72
  :                            165 
  :                            166 x72m72	$tree
                                	$head_far	 params(multiplierp,	int		)	;
                                									;
                                                        scalars(multiplier,	float			;
                                				caller_891011,	float,	8		;
                                				multiplicand,	long,	a		;
                                				multiplicand_u, long,	6		;
                                				muser_rkxy,	float, 	r		;
00:005DBF 8F0EA5              +174                                 mguard,		int,	fp$guard	)
00:005DC0 8F0008              +174 
00:005DC1 9F0004              +174 
00:005DC2 9F0006              +174 
00:005DC3 8F0000              +174 
00:005DC4 F80093              +174 
  :                            175 
00:005DC5 650000              +176         la      0,,xi                   . everything stays in integer range
00:005DC6 75005E              +177         ii      FP_GUARD$               . with no rounding
  :                            178                                         . scale return > 72 = lost significant bits
  :                            179 
00:005DC7 50F014              +180         lx      multiplierp
00:005DC8 FF0FA8              +181 	call	(tripl2float)
00:005DC9 47F00D              +182         qs      multiplier
  :                            183 
00:005DCA 54F006              +184         lx      multiplicand_u+1,,i
00:005DCB FF0FA8              +185         call    (tripl2float)
  :                            186 
00:005DCC 77F00D              +187         fm      multiplier
00:005DCD FF0FA9              +188         call    (float2i72)
00:005DCE C7F007              +189 	ds	multiplicand		. multiplicand_u
00:005DCF CF0006              +190 	dl	6
00:005DD0 C7F005              +191 	ds	multiplicand_u		. multiplicand
  :                            192 
00:005DD1 380004              +193 	pop	a
00:005DD2 75005E              +194 	ii	FP_GUARD$
00:005DD3 870000              +195 	qpop	r
00:005DD4 870004              +196 	qpop	a
00:005DD5 870008              +197 	qpop	8
00:005DD6 87F000              +198 	qpop	0, sp
00:005DD7 3D0000              +199 	fret	0
  :                            200 	$root
  :                            201 
  :                            202 
  :                            203 .	vector name x72_d72_24[]
  :                            204 
  :                            205 x72d24	$tree
  :                            206 
                                	$head_far	 params(divisor,	int		;
                                				remainderp,	int	)	;
                                								;
                                			scalars(quotient,	long,	a	;
00:005DD8 9F0004              +211 				quotientu,	long,	6	)
00:005DD9 9F0006              +211 
  :                            212 
                                	c	(i72_divide)	quotientu+1,,triple	;
                                				divisor			;
                                				quotientu+1,,i		;
00:005DDA F8F008              +216 				remainderp
00:005DDB FCF002              +216 
00:005DDC F8F009              +216 
00:005DDD 9FF005              +216 
00:005DDE F8F006              +216 
00:005DDF FCF006              +216 
00:005DE0 FF0FAA              +216 
00:005DE1 38000F              +216 
  :                            217 
00:005DE2 380004              +218 	pop	a
00:005DE3 380004              +219 	pop	a
00:005DE4 960018              +220 	dsa	24
00:005DE5 C70006              +221 	ds	6
00:005DE6 380004              +222 	dpop	a
00:005DE7 380005              +222 
  :                            223 
00:005DE8 3D0000              +224 	fret	0
  :                            225 
  :                            226 	$root	
  :                            227 
  :                            228 .	vector name x72_d48_48
  :                            229 
  :                            230 x48d48	$tree
  :                            231 	$head_far	 params(divisor,	long)
  :                            232 
00:005DE9 9FF003              +233 	c	(d48_48)	divisor,,long
00:005DEA FCF002              +233 
00:005DEB FF0FAB              +233 
00:005DEC 38000F              +233 
00:005DED 3E0D6C              +234 	lcal	$$swap
00:005DEE 3D0000              +235 	$ret
  :                            236 	$root
  :                            237 
  :                            238 .	vector name x72_d72_48
  :                            239 
  :                            240 x72d48	$tree
                                	$head_far	 params(divisor48,	long	)	;
                                								;
                                			scalars(divisor,	float		;
                                				caller8_11,	float,	8	;
                                				dividend,	long,	a	;
                                				dividendu,	long,	6	;
                                				caller_rkxy,	float,	r	;
00:005DEF 8F0EA5              +248 				save_fpguard,	int,	fp$guard)
00:005DF0 8F0008              +248 
00:005DF1 9F0004              +248 
00:005DF2 9F0006              +248 
00:005DF3 8F0000              +248 
00:005DF4 F80093              +248 
  :                            249 
00:005DF5 650000              +250 	la	0,,xi
00:005DF6 75005E              +251 	ii	FP_GUARD$
  :                            252 
00:005DF7 CFF014              +253 	dl	divisor48
00:005DF8 FF0FA7              +254 	call	(i48_2float)
00:005DF9 47F00D              +255 	qs	divisor
00:005DFA 54F006              +256 	lx	dividendu+1,,i
00:005DFB FF0FA8              +257 	call	(tripl2float)
00:005DFC 7FF00D              +258 	fd	divisor
00:005DFD FF0FA9              +259 	call	(float2i72)
00:005DFE C7F007              +260 	ds	dividend
00:005DFF CF0006              +261 	dl	6
00:005E00 C7F005              +262 	ds	dividendu
  :                            263 
00:005E01 380004              +264 	pop	a
00:005E02 75005E              +265 	ii	FP_GUARD$
00:005E03 870000              +266 	qpop	r
00:005E04 870004              +267 	qpop	a
00:005E05 870008              +268 	qpop	8
00:005E06 87F000              +269 	qpop	0, sp
00:005E07 3D0000              +270 	fret	0
  :                            271 
  :                            272 	$root
  :                            273 
  :                            274 .	vector name x72_d72_72
  :                            275 
  :                            276 x72d72	$tree
                                	$head_far	 params(divisorp,	int	)	;
                                								;
                                			scalars(divisor,	float		;
                                				caller_891011,	float,	8	;
                                				dividend,	long,	a	;
                                				dividendu,	long,	6	;
                                				caller_rkxy,	long,	r	;
00:005E08 8F0EA5              +284 				save_fpguard,	int,	fp$guard)
00:005E09 8F0008              +284 
00:005E0A 9F0004              +284 
00:005E0B 9F0006              +284 
00:005E0C 9F0000              +284 
00:005E0D F80093              +284 
00:005E0E 650000              +285 	la	0,,xi
00:005E0F 75005E              +286 	ii	FP_GUARD$
  :                            287 
00:005E10 50F012              +288 	lx	divisorp
00:005E11 FF0FA8              +289 	call	(tripl2float)
00:005E12 47F00B              +290 	qs	divisor
00:005E13 54F004              +291 	lx	dividendu+1,,i
00:005E14 FF0FA8              +292 	call	(tripl2float)
00:005E15 7FF00B              +293 	fd	divisor
00:005E16 FF0FA9              +294 	call	(float2i72)
00:005E17 C7F005              +295 	ds	dividend
00:005E18 CF0006              +296 	dl	6
00:005E19 C7F003              +297 	ds	dividendu
  :                            298 
00:005E1A 380004              +299 	pop	a
00:005E1B 75005E              +300 	ii	FP_GUARD$
00:005E1C 870000              +301 	qpop	r
00:005E1D 870004              +302 	qpop	a
00:005E1E 870008              +303 	qpop	8
00:005E1F 87F000              +304 	qpop	0, sp
00:005E20 3D0000              +305 	fret	0
  :                            306 	$root
  :                            307 
  :                            308 .	vector name x72_sl
  :                            309 x72sl	$tree
                                	$head_far	 params(countL,	int	)	;
                                							;
                                			scalars(usr89,	long,	8	;
00:005E21 9F0008              +313 				usrxy,	long,	x	)
00:005E22 9F0002              +313 
  :                            314 
00:005E23 5D0003              +315 	ly	3,,xi
00:005E24 50F007              +316 	lx	countL
00:005E25 C70008              +317 	ds	8			. copy acculumators to data LS positions
  :                            318 
  :                            319 sl_again
00:005E26 85FFE8              +320 	ax	-24,,xi			. any completely jumped data words?
00:005E27 780002              +321 	tp	x
00:005E28 B60E32              +322 	j	sl_round
  :                            323 
00:005E29 9F0008              +324 	dpush	8
00:005E2A 380007              +325 	pop	7
00:005E2B 380008              +326 	pop	8
00:005E2C 300009              +327 	z	9
  :                            328 
00:005E2D 700003              +329 	tz	y
00:005E2E B60E26              +330 	j	sl_again
  :                            331 
00:005E2F 160030              +332 	dsr	48			. no registers in scope of shift
00:005E30 C70006              +333 	ds	6			. 2s complement integer
00:005E31 B60E36              +334 	j	sl_return		. remove anything like signs
  :                            335 
  :                            336 sl_round
00:005E32 850018              +337 	ax	24,,xi
00:005E33 700002              +338 	tz	x
00:005E34 3E0E3B              +339 	lcal	sl_pullup_store
00:005E35 CF0008              +340 	dl	8
  :                            341 
  :                            342 sl_return
00:005E36 380002              +343 	dpop	x
00:005E37 380003              +343 
00:005E38 380008              +344 	dpop	8
00:005E39 380009              +344 
00:005E3A 3D0000              +345 	fret	0
  :                            346 
  :                            347 sl_pullup_store
00:005E3B CF0008              +348 	dl	8
00:005E3C F80004              +349 	push	a
00:005E3D 36A000              +350 	dsl	0, x
00:005E3E C70008              +351 	ds	8
00:005E3F 380005              +352 	pop	b
00:005E40 600007              +353 	la	7
00:005E41 F80004              +354 	push	a
00:005E42 36A000              +355 	dsl	0, x
00:005E43 200007              +356 	sa	7
00:005E44 380005              +357 	pop	b
00:005E45 600006              +358 	la	6
00:005E46 36A000              +359 	dsl	0, x
00:005E47 200006              +360 	sa	6
00:005E48 350000              +361 	lret	0
  :                            362 
Note: ../netapps2/../lib/x72_48if.msm Line 363: $endif not in scope of $if
  :                            363 	$endif
  :                            364 
  :                            365 	$root
  :                            366 
  :                            367 .	vector name x72_sa
  :                            368 x72sa	$tree
                                	$head_far	 params(countR,		int	)	;
                                								;
                                			scalars(caller_89,	long,	8	;
00:005E49 9F0008              +372 				caller_xy,	long,	x	)
00:005E4A 9F0002              +372 
  :                            373 
00:005E4B 5D0003              +374 	ly	3,,xi
00:005E4C 50F007              +375 	lx	countR
00:005E4D C70008              +376 	ds	8			. borrow part of the lookaside area
00:005E4E 600006              +377 	la	mantissa2		. this should be a word of signs
00:005E4F 860018              +378 	saa	24
  :                            379 
  :                            380 sa_again
00:005E50 85FFE8              +381 	ax	-24,,xi			. roll down adding leading signs
00:005E51 780002              +382 	tp	x			. until shift distance <= 1 data word
00:005E52 B60E5D              +383 	j	sa_round
  :                            384 	
00:005E53 9F0007              +385 	dpush	7
00:005E54 380008              +386 	pop	8
00:005E55 380009              +387 	pop	9			. until the stack comes back up
00:005E56 200007              +388 	sa	7			. add 1 word signs in front
  :                            389 
00:005E57 8DFFFF              +390 	ay	-1,,xi
00:005E58 700003              +391 	tz	y
00:005E59 B60E50              +392 	j	sa_again
  :                            393 
00:005E5A 160030              +394 	dsr	48			. shift count out of range
00:005E5B C70006              +395 	ds	6			. 2s complement integer
00:005E5C B60E61              +396 	j	sa_return		. so all - signs is not zero
  :                            397 
  :                            398 sa_round
00:005E5D 850018              +399 	ax	24,,xi
  :                            400 .	sa	6			. signs -> high order shift word. It is anyway
  :                            401 
00:005E5E 700002              +402 	tz	x			. save some work if no net bit offset
00:005E5F 3E0E66              +403 	lcal	sa_pushdown_store	. shift overlapping word pairs right
  :                            404 					. by shift distance /// word size
00:005E60 CF0008              +405 	dl	8			. get manipulated data bits 47..0
  :                            406 					. back into accumulators
  :                            407 sa_return
00:005E61 380002              +408 	dpop	x
00:005E62 380003              +408 
00:005E63 380008              +409 	dpop	8
00:005E64 380009              +409 
00:005E65 3D0000              +410 	fret	0
  :                            411 
  :                            412 sa_pushdown_store
00:005E66 CF0006              +413 	dl	6
00:005E67 F80005              +414 	push	b
00:005E68 96A000              +415 	dsa	0, x
00:005E69 C70006              +416 	ds	6
00:005E6A 380004              +417 	pop	a
00:005E6B 680008              +418 	lb	8
00:005E6C F80005              +419 	push	b
00:005E6D 16A000              +420 	dsr	0, x
00:005E6E 280008              +421 	sb	8
00:005E6F 380004              +422 	pop	a
00:005E70 680009              +423 	lb	9
00:005E71 16A000              +424 	dsr	0, x
00:005E72 280009              +425 	sb	9
00:005E73 350000              +426 	lret	0
  :                            427 
  :                            428 	$root
  :                            429 
  :                            430 .	vector name x72_orU
  :                            431 x72oru	$tree
                                	$head_far	 params(uwords,	long		;
                                				signs_length,	int)	;
                                							;
                                			scalars(ab,	long,	a	;
00:005E74 9F0004              +436 				caller_x, int,	x	)
00:005E75 F80002              +436 
  :                            437 
00:005E76 CFF006              +438 	dl	uwords
00:005E77 50F008              +439 	lx	signs_length
00:005E78 96A000              +440 	dsa	0, x
00:005E79 900006              +441 	or	6
00:005E7A 980007              +442 	orB	7
00:005E7B C70006              +443 	ds	6
00:005E7C 380002              +444 	pop	x
00:005E7D 380004              +445 	dpop	a
00:005E7E 380005              +445 
00:005E7F 3D0000              +446 	fret	0
  :                            447 	$root
  :                            448 
  :                            449 .	vector name x72_andU
  :                            450 
  :                            451 x72andu	$tree
                                	$head_far	 params(uwords,	long		;
                                				signs_length,	int)	;
                                							;
                                			scalars(ab,	long,	a	;
00:005E80 9F0004              +456 				caller_x, int,	x	)
00:005E81 F80002              +456 
  :                            457 
00:005E82 CFF006              +458 	dl	uwords
00:005E83 50F008              +459 	lx	signs_length
00:005E84 96A000              +460 	dsa	0, x
00:005E85 A00006              +461 	and	6
00:005E86 A80007              +462 	andB	7
00:005E87 C70006              +463 	ds	6
00:005E88 380002              +464 	pop	x
00:005E89 380004              +465 	dpop	a
00:005E8A 380005              +465 
00:005E8B 3D0000              +466 	fret	0
  :                            467 	$root
  :                            468 
  :                            469 
  :                            470 .	vector name x72_xorU[]
  :                            471 
  :                            472 x72xoru	$tree
                                	$head_far	 params(uwords,	long		;
                                				signs_length,	int)	;
                                							;
                                			scalars(ab,	long,	a	;
00:005E8C 9F0004              +477 				caller_x, int,	x	)
00:005E8D F80002              +477 
00:005E8E CFF006              +478 	dl	uwords
00:005E8F 50F008              +479 	lx	signs_length
00:005E90 96A000              +480 	dsa	0, x
00:005E91 B00006              +481 	xor	6
00:005E92 B80007              +482 	xorB	7
00:005E93 C70006              +483 	ds	6
00:005E94 380002              +484 	pop	x
00:005E95 380004              +485 	dpop	a
00:005E96 380005              +485 
00:005E97 3D0000              +486 	fret	0
  :                            487 	$root
  :                            171: 	$include sysinfo
  :                            1 sys_info
00:005E98 4F0FAC              +2 	ql	(0, 0, 0, CHAINS:q)	. chains per tcp hash table
00:005E99 04007C              +3 	inA	ram$threshold	. end of ROM / start of RAM
00:005E9A 0C0080              +4 	inB	128		. system memory page high index
00:005E9B A80F6A              +5 	andB	(03FFFFF)	. without memory type flags
00:005E9C 3D0000              +6 	fret	0
  :                            7 
  :                            172 
  :                            173 $(0)
  :                            174 	$do	$<256,$(0:256)
  :                            175 	$do	$zenith>4096,	$flag	A_PROTOS_BANK1 too large
  :                            176 
  :                            177 
00:005e9d+000141
00:005e9e+000140
00:005e9f+000145
00:005ea0+000146
00:005ea1+000144
00:005ea2+00014B
00:005ea3+000142
00:005ea4+000143
00:005ea5+000000000000000000000000
00:005ea9+110000
00:005eaa+000081
00:005eab+000000000080
00:005ead+000085
00:005eae+0000B4
00:005eaf+[002B]18:000000
00:005eb0+[0015]18:000000
00:005eb1+[0019]18:000000
00:005eb2+[0024]18:000000
00:005eb3+[002C]18:000000
00:005eb4+FFFFFFFFFFFFFFFFFFFFFFFF
00:005eb8+[0017]18:000000
00:005eb9+0A0000
00:005eba+0000B7
00:005ebb+000087
00:005ebc+000000000082
00:005ebe+[001A]18:000000
00:005ebf+FFFFFF000000000000000000
00:005ec3+67F008
00:005ec4+6FF008
00:005ec5+77F008
00:005ec6+7FF008
00:005ec7+[0018]18:000000
00:005ec8+2A2000
00:005ec9+00012C000000000000006000
00:005ecd+060000
00:005ece+000000000017
00:005ed0+02F000
00:005ed1+02F01F
00:005ed2+00FFFF
00:005ed3+0000A8
00:005ed4+0000A9
00:005ed5+000148
00:005ed6+0000AD
00:005ed7+00F000
00:005ed8+[002A]18:000000
00:005ed9+740000
00:005eda+680000
00:005edb+6D0000
00:005edc+650000
00:005edd+750000
00:005ede+710000
00:005edf+720000
00:005ee0+7A0000
00:005ee1+697100
00:005ee2+736D70
00:005ee3+737461790000
00:005ee5+74696D650000
00:005ee7+696673796E63
00:005ee9+696673776170
00:005eeb+746672656500
00:005eed+[002D]18:000000
00:005eee+[0025]18:000000
00:005eef+[002E]18:000000
00:005ef0+[001F]18:000000
00:005ef1+FF0000
00:005ef2+2F0000
00:005ef3+00014A
00:005ef4+000149
00:005ef5+[002F]18:000000
00:005ef6+000147
00:005ef7+[0030]18:000000
00:005ef8+[0031]18:000000
00:005ef9+[0032]18:000000
00:005efa+01F200
00:005efb+[0033]18:000000
00:005efc+0000B1
00:005efd+0000B2
00:005efe+020180
00:005eff+020001
00:005f00+020000
00:005f01+544342
00:005f02+000000
00:005f03+200000
00:005f04+[0034]18:000000
00:005f05+[0016]18:000000
00:005f06+020040
00:005f07+FF00FF
00:005f08+020044
00:005f09+4D0003
00:005f0a+[0035]18:000000
00:005f0b+00033F000001000000006000
00:005f0f+000000000000
00:005f11+FFFFFFFF0012
00:005f13+00000000000000FFFF00FFFF
00:005f17+000088
00:005f18+00AC1D000707
00:005f1a+[0036]18:000000
00:005f1b+030007
00:005f1c+[0037]18:000000
00:005f1d+[0038]18:000000
00:005f1e+[0039]18:000000
00:005f1f+[003A]18:000000
00:005f20+00014C
00:005f21+[003B]18:000000
00:005f22+020042
00:005f23+030000
00:005f24+020188
00:005f25+02018A
00:005f26+02018C
00:005f27+[003C]18:000000
00:005f28+000402000000000000000000
00:005f2c+000000000050
00:005f2e+[003D]18:000000
00:005f2f+02F01A
00:005f30+000050
00:005f31+0000AB
00:005f32+[003E]18:000000
00:005f33+[003F]18:000000
00:005f34+0000AC
00:005f35+474554
00:005f36+00002F
00:005f37+000020
00:005f38+00003F
00:005f39+00003D
00:005f3a+0004E2000000000000000000
00:005f3e+000000000081
00:005f40+[0027]18:000000
00:005f41+[0040]18:000000
00:005f42+[0041]18:000000
00:005f43+[0023]18:000000
00:005f44+000572000000000000000000
00:005f48+000000000083
00:005f4a+[0042]18:000000
00:005f4b+[0043]18:000000
00:005f4c+000091
00:005f4d+[0044]18:000000
00:005f4e+[0045]18:000000
00:005f4f+[0046]18:000000
00:005f50+[0047]18:000000
00:005f51+[0048]18:000000
00:005f52+[0049]18:000000
00:005f53+00017D
00:005f54+00017C
00:005f55+00017F
00:005f56+00017E
00:005f57+000174
00:005f58+000175
00:005f59+000176
00:005f5a+000177
00:005f5b+000178
00:005f5c+000179
00:005f5d+00017A
00:005f5e+00017B
00:005f5f+000170
00:005f60+000171
00:005f61+400000800000000000000000000000000000000000000000
00:005f69+400000
00:005f6a+3FFFFF
00:005f6b+[004A]18:000000
00:005f6c+555556
00:005f6d+C00000
00:005f6e+000173
00:005f6f+400007B40000000000000000
00:005f73+800000
00:005f74+3FFF90
00:005f75+3FFFF8B60B60B60B60B60B60
3FFFB0B60B60B60B60B60B62
00:005f7d+400009B40000000000000000
00:005f81+400003C00000000000000000
00:005f85+400002C00000000000000000
00:005f89+3FFFFB8EFA351294E9C8AE0F
00:005f8d+400001800000000000000000
00:005f91+3FFFDD
00:005f92+3FFFF8B60B60B60B60B60B61
00:005f96+000172
00:005f97+000A87000007000000000000
00:005f9b+0000000000A1
00:005f9d+000243
00:005f9e+820000
00:005f9f+000240
00:005fa0+000241
00:005fa1+000242
00:005fa2+3F0000
00:005fa3+0AAAAA
00:005fa4+[004B]18:000000
00:005fa5+[004C]18:000000
00:005fa6+[004D]18:000000
00:005fa7+[004E]18:000000
00:005fa8+[004F]18:000000
00:005fa9+[0050]18:000000
00:005faa+[0051]18:000000
00:005fab+[0052]18:000000
00:005fac+000000000000000000000020
  :                            178 $(0::A_PROTOS_BANK2)
00:009000 B60040              +179 mib_get*	$vector	mib_read
00:009001 B60072              +180 mib_getnext*	$vector	mib_walk
00:009002 B600E3              +181 mib_set*	$vector	mib_write
00:009003 B601D6              +182 mib_start*	$vector	mib_initial
00:009004 B601DF              +183 mib_line*	$vector	mib_wline
00:009005 B60245              +184 mib2ticks*	$vector	mib2tick
  :                            185 
00:009006 B6024D              +186 udp_agent1*	$vector	udpagent_net
00:009007 B6025E              +187 udp_agent2*	$vector	udpagent_port
  :                            188 
00:009008 B6029D              +189 if_agentidx	$vector	ifagent_idx
00:009009 B602BC              +190 if_agentdescr	$vector	ifagent_descr
00:00900A B602C7              +191 if_agenttype	$vector	ifagent_type
00:00900B B602D0              +192 if_agentMTU	$vector	ifagent_MTU
00:00900C B602D9              +193 if_agentspeed	$vector	ifagent_speed
00:00900D B602E0              +194 if_agentphy	$vector	ifagent_phy
00:00900E B602F0              +195 if_agentadmins	$vector	ifagent_admins
00:00900F B602F9              +196 if_agentosta	$vector	ifagent_osta
00:009010 B60302              +197 if_agentlastc	$vector	ifagent_lastc
00:009011 B6030A              +198 if_agentibytes	$vector	ifagent_ibytes
00:009012 B60313              +199 if_agentiucast	$vector	ifagent_iucast
00:009013 B6031C              +200 if_agentimcast	$vector	ifagent_imcast
00:009014 B60325              +201 if_agentidrops	$vector	ifagent_idrops
00:009015 B6032E              +202 if_agentierrs	$vector	ifagent_ierrs
00:009016 B60337              +203 if_agentinoproto $vector ifagent_inoproto
00:009017 B60340              +204 if_agentobytes	$vector	ifagent_obytes
00:009018 B60349              +205 if_agentoucast	$vector	ifagent_oucast
00:009019 B60352              +206 if_agentomcast	$vector	ifagent_omcast
00:00901A B6035B              +207 if_agentodrops	$vector	ifagent_odrops
00:00901B B60364              +208 if_agentoerrs	$vector	ifagent_oerrs
00:00901C B6036D              +209 if_agentoqlen	$vector	ifagent_oqlen
00:00901D B60376              +210 if_agentsmib	$vector	ifagent_smib
  :                            211 
00:00901E B60452              +212 tcp_agent_add	$vector	tcpagent_add
00:00901F B6046F              +213 tcp_agent_free	$vector	tcpagent_free
00:009020 B60480              +214 tcp_agent_state	$vector	tcpagent_state
00:009021 B604A9              +215 tcp_agent_neta	$vector	tcpagent_neta
00:009022 B604B4              +216 tcp_agent_port	$vector	tcpagent_port
00:009023 B604C0              +217 tcp_agent_remote_neta $vector tcpagent_neta_remote
00:009024 B604CB              +218 tcp_agent_remote_port $vector tcpagent_port_remote
00:009025 B60529              +219 tcp_agent_established $vector tcpagent_established
  :                            220 
00:009026 B603AF              +221 ip_agent_address		$vector	ipagent_address
00:009027 B603BE              +222 ip_agent_address_ifidx		$vector	ipagent_address_ifidx
00:009028 B603CB              +223 ip_agent_address_netmask	$vector ipagent_address_netmask
  :                            224 
  :                            225 .	placeholders kept as dummy in case BROADCAST_AND_MAXREASM is switched on
  :                            226 .	place held to avoid displacing subsequent vector locations
  :                            227 .	not that these MIB function names seem to be exported
  :                            228 .	these can be switched on but don't seem necessary in operation
  :                            229 
00:009029 3D0000              +230 ip_agent_address_broadcast	fret	0	. $vector	ipagent_address_broadcast
00:00902A 3D0000              +231 ip_agent_address_maxreasm	fret	0	. $vector	ipagent_address_maxreasm
  :                            232 
00:00902B B60408              +233 ip_agent_route_dest	$vector	ipagent_route_dest
00:00902C B60417              +234 ip_agent_route_ifidx	$vector	ipagent_route_ifidx
00:00902D B60434              +235 ip_agent_route_next_hop	$vector	ipagent_route_next_hop
00:00902E B60443              +236 ip_agent_route_type	$vector	ipagent_route_type
00:00902F B60425              +237 ip_agent_route_mask	$vector	ipagent_route_mask
  :                            238 
00:009030 B6056E              +239 ip_agent_cidr_route_dest_type			$vector	ipagent_cidr_route_dest_type
00:009031 B6057B              +240 ip_agent_cidr_route_dest			$vector	ipagent_cidr_route_dest
00:009032 B6058A              +241 ip_agent_cidr_route_mask_log			$vector	ipagent_cidr_route_mask_log
00:009033 B60597              +242 ip_agent_cidr_route_next_hop_type 		$vector ipagent_cidr_route_next_hop_type
00:009034 B605A5              +243 ip_agent_cidr_route_next_hop			$vector	ipagent_cidr_route_next_hop
00:009035 B605B7              +244 ip_agent_cidr_route_ifidx			$vector	ipagent_cidr_route_ifidx
00:009036 B605C5              +245 ip_agent_cidr_route_type			$vector	ipagent_cidr_route_type
  :                            246 
00:009037 B605D4              +247 at_agentifindex		$vector	net_address2ifidx
00:009038 B605E8              +248 at_agentphysa		$vector	net_address2physa
00:009039 B60604              +249 at_agentnetaddress	$vector	net_addres2net_address
  :                            250 
  :                            251 	$do	$>64,	flag	jump pad overfull A_PROTOS_BANK2
00:00903A 3D0000              +252 	$do	64-$,	fret	0
00:00903B 3D0000              +252 
00:00903C 3D0000              +252 
00:00903D 3D0000              +252 
00:00903E 3D0000              +252 
00:00903F 3D0000              +252 
  :                            253 	
  :                            254 	$path	../mib
  :                            255: 	$include mib-II
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 
  :                            41 $(66::,x)
42:000000                     +42 mo	mobjet
42:000001                     +42 
42:000002                     +42 
42:000003                     +42 
42:000004                     +42 
42:000005                     +42 
42:000006                     +42 
  :                            43 
  :                            44 $(67::,y)
43:000000                     +45 om	mvoi
Note: ../mib/mib-II.msm Line 45: void section literal request dropped
43:000001                     +45 
43:000002                     +45 
Note: ../mib/mib-II.msm Line 45: void section: discarding relocation tuple
43:000003                     +45 
43:000004                     +45 
43:000005                     +45 
  :                            46 
  :                            47 $(3)
  :                            48 mib*	$res	MIB
  :                            49 
  :                            50 $(1)
(+03)18
01:000425 0004CD              +51 mib_floor	+	mib
01:000426 000000              +52 mib_root	mobjet	0 0 SNMP_NULL	
01:000427 000000              +52 
01:000428 000000              +52 
01:000429 000005              +52 
01:00042A 000000              +52 
01:00042B 000000              +52 
01:00042C 000000              +52 
  :                            53 
  :                            54 $(0)
  :                            55 
                                mib_read $head_far	 params(rlist,	int	;
  :                            57 				rflags,	int)
  :                            58 
00:009040 60F003              +59 	la	rlist
00:009041 68C000              +60 	lb	0, a
00:009042 DD0006              +61 	anb, xi	SNMP_OID
00:009043 DE0063              +62 	jnzb	mib_rr_badvalue
  :                            63 
00:009044 40C001              +64 	lr	1, a
00:009045 5CC002              +65 	ly, i	2, a
(+01)10
00:009046 550426              +66 	lx, xi	mib_root
  :                            67 
00:009047 B60059              +68 	j	mib_rr?
  :                            69 
00:009048 60A003              +70 mib_rr!	la	mo:type
00:009049 680004              +71 	anu, xi	MIB_FUNCTION
00:00904A DD0064              +71 
00:00904B CE0069              +72 	jzb	mib_rr_function
00:00904C 680004              +73 	anu,xi	SNMP_NULL
00:00904D DD0005              +73 
00:00904E DE0066              +74 	jnzb	mib_rr_nosuchname
00:00904F 50A001              +75 	lx	mo:down
  :                            76 mib_rr_seq?
00:009050 60A002              +77 	la	mo:seq
00:009051 C60058              +78 	jza	mib_rr_token_pass	. zero is wild card
00:009052 D0B000              +79 	ana	0, y
00:009053 C60058              +80 	jza	mib_rr_token_pass
00:009054 7E0066              +81 	jc	mib_rr_nosuchname
00:009055 50A000              +82 	lx	mo:along
00:009056 700002              +83 	tz	x
00:009057 B60050              +84 	j	mib_rr_seq?
  :                            85 
  :                            86 mib_rr_token_pass
00:009058 8D0001              +87 	ay, xi	1
00:009059 1E0048              +88 mib_rr?	jdr	mib_rr!
  :                            89 
00:00905A 60A003              +90 	la	mo:type
00:00905B 680004              +91 	anu, xi	MIB_FUNCTION
00:00905C DD0064              +91 
00:00905D CE0069              +92 	jzb	mib_rr_function
00:00905E D50005              +93 	ana,xi	SNMP_NULL
00:00905F C60066              +94 	jza	mib_rr_nosuchname
  :                            95 
00:009060 680002              +96 	lb	x
00:009061 650000              +97 	la, xi	0
00:009062 B60071              +98 	j	mib_rr_x
  :                            99 
  :                            100 mib_rr_badvalue
00:009063 650003              +101 	la, xi	SNMP_BADVALUE
00:009064 6D0000              +102 	lb, xi	0
00:009065 B60071              +103 	j	mib_rr_x
  :                            104 
  :                            105 mib_rr_nosuchname
00:009066 650002              +106 	la, xi	SNMP_NOSUCHNAME
00:009067 6D0000              +107 	lb, xi	0
00:009068 B60071              +108 	j	mib_rr_x
  :                            109 
  :                            110 mib_rr_function
00:009069 FD00A0              +111 	c	mo:down	rlist	rflags	SNMP_GETREQ,,xi
00:00906A F8F005              +111 
00:00906B F8F005              +111 
00:00906C FCF003              +111 
00:00906D FFA001              +111 
00:00906E 38000F              +111 
00:00906F 700005              +112 	tz	b
00:009070 300004              +113 	z	a
  :                            114 
  :                            115 mib_rr_x
00:009071 3D0000              +116 	fret	0
  :                            117 
                                mib_walk $head_far	 params(slist,	int	;
                                				sflags,	int)	;
                                						;
                                			scalars(slevel,	20	;
00:009072 8F0A49              +122 				sdepth,	int)
00:009073 8FF000              +122 
00:009074 8FF000              +122 
00:009075 8FF000              +122 
00:009076 8FF000              +122 
00:009077 FD0000              +122 
  :                            123 
  :                            124 
00:009078 60F018              +125 	la	slist
00:009079 68C000              +126 	lb	0, a
00:00907A DD0006              +127 	anb,xi	SNMP_OID
00:00907B DE00CC              +128 	jnzb	mib_ww_badvalue
  :                            129 
00:00907C 40C001              +130 	lr	1, a
00:00907D 5CC001              +131 	ly, i	1, a
(+01)10
00:00907E 550426              +132 	lx, xi	mib_root
  :                            133 .	z	sdepth
  :                            134 
  :                            135 
00:00907F 60F000              +136 mib_ww!	la	sdepth
00:009080 D00000              +137 	ana	r
00:009081 7E00A3              +138 	jc	mib_ww?
  :                            139 
00:009082 60A003              +140 	la	mo:type			. seek down or across
00:009083 D50005              +141 	ana, xi	SNMP_NULL
00:009084 C60089              +142 	jza	mib_ww_down
  :                            143 
00:009085 60A002              +144 	la	mo:seq			. bottomed out on equal
00:009086 D0B000              +145 	ana	0, y			. but longer string
00:009087 C60092              +146 	jza	mib_ww_seek_peer
00:009088 B6009D              +147 	j	mib_ww_peer
  :                            148 mib_ww_down
00:009089 60A001              +149 	la	mo:down
00:00908A C60092              +150 	jza	mib_ww_seek_peer
  :                            151 
00:00908B 6CF001              +152 	lb, i	slevel
00:00908C C8F000              +153 	ab	sdepth
00:00908D 10D000              +154 	sx	0, b
  :                            155 
00:00908E 500004              +156 	lx	a
00:00908F 17F000              +157 	inc	sdepth
00:009090 170003              +158 	inc	y
00:009091 B6009D              +159 	j	mib_ww_peer
  :                            160 
  :                            161 
  :                            162 mib_ww_seek_peer
00:009092 50A000              +163 	lx	mo:along		. it has no down if it
00:009093 700002              +164 	tz	x
00:009094 B6009D              +165 	j	mib_ww_peer		. is an mo = tree leaf
  :                            166 
00:009095 1FF000              +167 	dec	sdepth
00:009096 78F000              +168 	tp	sdepth
00:009097 B600C9              +169 	j	mib_ww_nosuchname
00:009098 54F001              +170 	lx, i	slevel
00:009099 80F000              +171 	ax	sdepth			. contains pointer to pointer!
  :                            172 
00:00909A 50A000              +173 	lx	0, x			. this is the above and you want
  :                            174 					. the along of the above
00:00909B 1F0003              +175 	dec	y
00:00909C B60092              +176 	j	mib_ww_seek_peer
  :                            177 
  :                            178 
  :                            179 mib_ww_peer
00:00909D 60A002              +180 	la	mo:seq
00:00909E C6007F              +181 	jza	mib_ww!			. zero is wild card
00:00909F D0B000              +182 	ana	0, y
00:0090A0 5E0092              +183 	jnc	mib_ww_seek_peer
  :                            184 
00:0090A1 D600A6              +185 	jnza	mib_ww_ruano?
  :                            186 
  :                            187 .	la	mo:type
  :                            188 .	aa, xi	-SNMP_NULL
  :                            189 .	jza	mib_ww_seek_peer
  :                            190 
00:0090A2 B6007F              +191 	j	mib_ww!
  :                            192 
  :                            193 .	jza	mib_ww!
  :                            194 
  :                            195 					. one search never goes back
  :                            196 					. above this line
  :                            197 .	j	mib_ww_ruano?
  :                            198 
00:0090A3 60A003              +199 mib_ww?	la	mo:type
00:0090A4 D50005              +200 	ana, xi	SNMP_NULL
00:0090A5 D600BE              +201 	jnza	mib_ww_along?
  :                            202 
  :                            203 
  :                            204 				
  :                            205 mib_ww_ruano?
00:0090A6 60A003              +206 	la	mo:type		. you now want the next object at all
00:0090A7 680004              +207 	anu, xi	MIB_FUNCTION
00:0090A8 DD0064              +207 
00:0090A9 CE00B5              +208 	jzb	mib_ww_function
00:0090AA 680004              +209 	anu, xi	SNMP_NULL
00:0090AB DD0005              +209 
00:0090AC DE00CF              +210 	jnzb	mib_www
  :                            211 
00:0090AD 60A001              +212 	la	mo:down
00:0090AE C600BE              +213 	jza	mib_ww_along?
  :                            214 
00:0090AF 6CF001              +215 	lb, i	slevel
00:0090B0 C8F000              +216 	ab	sdepth
00:0090B1 10D000              +217 	sx	0, b
00:0090B2 17F000              +218 	inc	sdepth
  :                            219 
00:0090B3 500004              +220 	lx	a
00:0090B4 B600A6              +221 	j	mib_ww_ruano?
  :                            222 
  :                            223 mib_ww_function
00:0090B5 FD00A1              +224 	c	mo:down slist sflags SNMP_GETNEXTREQ,,xi
00:0090B6 F8F01A              +224 
00:0090B7 F8F01A              +224 
00:0090B8 FCF003              +224 
00:0090B9 FFA001              +224 
00:0090BA 38000F              +224 
00:0090BB CE00C0              +225 	jzb	mib_ww_up
00:0090BC 500005              +226 	lx	b
00:0090BD B600CF              +227 	j	mib_www
  :                            228 
  :                            229 mib_ww_along?
00:0090BE 60A000              +230 	la	mo:along
00:0090BF D600C7              +231 	jnza	mib_ww_along!
  :                            232 mib_ww_up
00:0090C0 1FF000              +233 	dec	sdepth
00:0090C1 78F000              +234 	tp	sdepth
00:0090C2 B600C9              +235 	j	mib_ww_nosuchname
00:0090C3 54F001              +236 	lx, i	slevel
00:0090C4 80F000              +237 	ax	sdepth
00:0090C5 50A000              +238 	lx	0, x
00:0090C6 B600BE              +239 	j	mib_ww_along?
  :                            240 
  :                            241 mib_ww_along!
00:0090C7 500004              +242 	lx	a
00:0090C8 B600A6              +243 	j	mib_ww_ruano?
  :                            244 
  :                            245 mib_ww_nosuchname
00:0090C9 650002              +246 	la, xi	SNMP_NOSUCHNAME
00:0090CA 6D0000              +247 	lb, xi	0
00:0090CB B600E0              +248 	j	mib_ww_x
  :                            249 	
  :                            250 mib_ww_badvalue
00:0090CC 650003              +251 	la, xi	SNMP_BADVALUE
00:0090CD 6D0000              +252 	lb, xi	0
00:0090CE B600E0              +253 	j	mib_ww_x
  :                            254 
00:0090CF 60F000              +255 mib_www	la	sdepth
00:0090D0 C4F001              +256 	aa, i	slevel
00:0090D1 10C000              +257 	sx	0, a
  :                            258 
00:0090D2 58F018              +259 	ly	slist
00:0090D3 6CF002              +260 	lb, i	slevel+1
00:0090D4 40F000              +261 	lr	sdepth
00:0090D5 00B001              +262 	sr	1, y
00:0090D6 B600DD              +263 	j	mib_ww_slingback?
  :                            264 
  :                            265 mib_ww_slingback!
00:0090D7 60D000              +266 	la	0, b
00:0090D8 60C002              +267 	la	mo:seq, a
00:0090D9 C600DB              +268 	jza	mib_ww_slungback	. it's in the string already
00:0090DA 20B002              +269 	sa	2, y
  :                            270 mib_ww_slungback
00:0090DB 6CD001              +271 	lb, i	1, b
00:0090DC 8D0001              +272 	ay, xi	1	
  :                            273 
  :                            274 mib_ww_slingback?
00:0090DD 1E00D7              +275 	jdr	mib_ww_slingback!
  :                            276 
00:0090DE 680002              +277 	lb	x
00:0090DF 650000              +278 	la, xi	0
  :                            279 
  :                            280 mib_ww_x
  :                            281 
00:0090E0 54F015              +282 	lx, i	$$frame, sp
00:0090E1 10000F              +283 	sx	sp
00:0090E2 3D0000              +284 	fret	0
  :                            285 
                                mib_write $head_far	 params(olist,	int	;
                                				oflags,	int	;
                                				oclass,	int	;
                                				obytes,	int	;
                                				odata,	int	;
                                				orules, int	;
                                				orange, int)	;
                                						;
                                			scalars(mibw_floorb4,	int,	mib_floor	;
                                				mibw_parent,	int			;
                                				mibw_first,	int			;
(+01)0f
00:0090E3 F80425              +297 				mibw_prior,	int)
00:0090E4 FD0000              +297 
00:0090E5 FD0000              +297 
00:0090E6 FD0000              +297 
  :                            298 
  :                            299 
00:0090E7 60F007              +300 	la	olist
00:0090E8 68C000              +301 	lb	0, a
00:0090E9 DD0006              +302 	anb, xi	SNMP_OID
00:0090EA DE01CF              +303 	jnzb	mib_nowrite
00:0090EB 40C001              +304 	lr	1, a
  :                            305 
00:0090EC 5CC002              +306 	ly, i	2, a
(+01)10
00:0090ED 550426              +307 	lx, xi	mib_root
00:0090EE B6012B              +308 	j	mib_wlocate?
  :                            309 
  :                            310 
  :                            311 mib_wlocate!
  :                            312 
00:0090EF 68A003              +313 	lb	mo:type
00:0090F0 DD0005              +314 	anb, xi	SNMP_NULL
00:0090F1 DE01CC              +315 	jnzb	mib_wbadvalue
  :                            316 
00:0090F2 68B000              +317 	lb	0, y
00:0090F3 8D0001              +318 	ay, xi	1
  :                            319 
00:0090F4 280006              +320 	sb	6		.	sequence
  :                            321 
00:0090F5 60A001              +322 	la	mo:down
00:0090F6 D60100              +323 	jnza	mib_downpathw
  :                            324 
(+01)0f
00:0090F7 600425              +325 	la	mib_floor
00:0090F8 20A001              +326 	sa	mo:down
  :                            327 
00:0090F9 30C001              +328 	z	mo:down, a
00:0090FA 28C002              +329 	sb	mo:seq, a
00:0090FB 30C000              +330 	z	mo:along, a
  :                            331 
00:0090FC 6D0005              +332 	lb, xi	SNMP_NULL
00:0090FD 28C003              +333 	sb	mo:type, a
00:0090FE 6CC004              +334 	lb, i	4, a
(+01)0f
00:0090FF 280425              +335 	sb	mib_floor
  :                            336 
  :                            337 mib_downpathw
00:009100 10F002              +338 	sx	mibw_parent
00:009101 500004              +339 	lx	a
00:009102 10F001              +340 	sx	mibw_first
00:009103 30F000              +341 	z	mibw_prior	. automatically zero
  :                            342 
  :                            343 mib_rightwardw
00:009104 60A002              +344 	la	mo:seq
00:009105 D00006              +345 	ana	6		. seq
00:009106 7E0116              +346 	jc	mib_right_awayw	. new seq not > encountered
  :                            347 				. seq
  :                            348 
00:009107 60A000              +349 	la	mo:along
00:009108 D60113              +350 	jnza	mib_right_onw
(+01)0f
00:009109 600425              +351 	la	mib_floor
00:00910A 20A000              +352 	sa	mo:along
00:00910B 30C001              +353 	z	mo:down, a
00:00910C 680006              +354 	lb	6
00:00910D 28C002              +355 	sb	mo:seq, a
00:00910E 30C000              +356 	z	mo:along, a
00:00910F 6D0005              +357 	lb, xi	SNMP_NULL
00:009110 28C003              +358 	sb	mo:type, a
  :                            359 
00:009111 6CC004              +360 	lb, i	4, a
(+01)0f
00:009112 280425              +361 	sb	mib_floor
  :                            362 
  :                            363 mib_right_onw
  :                            364 	
00:009113 10F000              +365 	sx	mibw_prior
00:009114 500004              +366 	lx	a
00:009115 B60104              +367 	j	mib_rightwardw
  :                            368 
  :                            369 mib_right_awayw
  :                            370 
00:009116 600006              +371 	la	6	. seq
00:009117 680004              +372 	anu	mo:seq
00:009118 D8A002              +372 
00:009119 7E012B              +373 	jc	mib_wlocate?
  :                            374 
(+01)0f
00:00911A 680425              +375 	lb	mib_floor
00:00911B 30D001              +376 	z	mo:down, b
00:00911C 20D002              +377 	sa	mo:seq, b
00:00911D 650005              +378 	la, xi	SNMP_NULL
00:00911E 20D003              +379 	sa	mo:type, b
00:00911F 10D000              +380 	sx	mo:along, b
  :                            381 
00:009120 500005              +382 	lx	b
00:009121 64D004              +383 	la, i	4, b
(+01)0f
00:009122 200425              +384 	sa	mib_floor
  :                            385 
00:009123 60F000              +386 	la	mibw_prior
00:009124 C60127              +387 	jza	mib_firstinroww
00:009125 10C000              +388 	sx	mo:along, a
00:009126 B6012B              +389 	j	mib_setinroww
  :                            390 
  :                            391 mib_firstinroww
00:009127 60F002              +392 	la	mibw_parent
00:009128 10C001              +393 	sx	mo:down, a
00:009129 60F001              +394 	la	mibw_first
00:00912A 20A000              +395 	sa	mo:along
  :                            396 	
  :                            397 mib_setinroww
  :                            398 mib_wlocate?
00:00912B 1E00EF              +399 	jdr	mib_wlocate!
  :                            400 
  :                            401 	.	the header has been found or inserted
  :                            402 	.	found = update
  :                            403 	.	inserted = new
  :                            404 
(+01)0f
00:00912C 600425              +405 	la	mib_floor
00:00912D 680004              +406 	anu	mibw_floorb4
00:00912E D8F003              +406 
  :                            407 
00:00912F CE016B              +408 	jzb	mib_modify
  :                            409 
  :                            410 .	here is a large difference between
  :                            411 .	first and subsequent store of any
  :                            412 .	managed object
  :                            413 
  :                            414 .	when you first store a managed object
  :                            415 .	you store its rules and the address
  :                            416 .	where its data is
  :                            417 
  :                            418 .	when you subsequently store the same
  :                            419 .	managed object, you write new data
  :                            420 .	at the address in the descriptor
  :                            421 .	and the rules initially stored apply
  :                            422 
00:009130 60F009              +423 	la	oclass
00:009131 20A003              +424 	sa	mo:type
  :                            425 
00:009132 68F00B              +426 	lb	odata
00:009133 28A001              +427 	sb	mo:data
  :                            428 
00:009134 68F00A              +429 	lb	obytes
00:009135 28A004              +430 	sb	mo:bytes
  :                            431 
00:009136 68F008              +432 	lb	oflags
00:009137 28A005              +433 	sb	mo:flags
  :                            434 
00:009138 68F00C              +435 	lb	orules
00:009139 28A006              +436 	sb	mo:ranges
  :                            437 
00:00913A 100008              +438 	sx	8
00:00913B 850007              +439 	ax, xi	7
  :                            440 
00:00913C 400005              +441 	lr	b		. a list of allowed size ranges?
  :                            442 
00:00913D 680004              +443 	anu,xi	SNMP_NETWORKADDRESS
00:00913E DD0040              +443 
00:00913F CE0166              +444 	jzb	mib_store_new_x1
00:009140 680004              +445 	anu,xi	SNMP_STRING
00:009141 DD0004              +445 
00:009142 CE0166              +446 	jzb	mib_store_new_x1
00:009143 680004              +447 	anu,xi	SNMP_OID
00:009144 DD0006              +447 
00:009145 CE0166              +448 	jzb	mib_store_new_x1 . none of those has number ranges
  :                            449 				 . but a maxcopy bucket size instead
  :                            450 
00:009146 680004              +451 	anu, xi	MIB_FUNCTION
00:009147 DD0064              +451 
00:009148 CE0160              +452 	jzb	mib_store_new_x
  :                            453 
00:009149 68F00C              +454 	lb	orules
00:00914A CE0168              +455 	jzb	mib_store_new
  :                            456 
00:00914B 58F00D              +457 	ly	orange		. pointer to tuple list
  :                            458 
00:00914C 60F00A              +459 	la	obytes
  :                            460 
00:00914D C601CA              +461 	jza	mib_wgenerr
00:00914E 680004              +462 	anu, xi	7
00:00914F DD0007              +462 
00:009150 7E01C8              +463 	jc	mib_wtoobig
  :                            464 
00:009151 D50004              +465 	ana, xi	4
00:009152 7E0158              +466 	jc	mib_store_long_range?
00:009153 B6015E              +467 	j	mib_store_range?
  :                            468 
  :                            469 .	the method of having signed and unsigned range checks
  :                            470 .	without noticing too much
  :                            471 
  :                            472 .	firstly, if the high-order bit of the upper and lower limit
  :                            473 .	are identical, just do unsigned compares, and that will give
  :                            474 .	the right result whether the candidate integer is meant to
  :                            475 .	be signed or not
  :                            476 
  :                            477 .	secondly, if the high order bits of the two limits are 
  :                            478 .	different, then
  :                            479 
  :                            480 .	if the upper limit interpreted as unsigned is greater than
  :                            481 .	the lower limit interpreted as unsigned (the high order bit
  :                            482 .	of the upper limit is on, and not the high order bit of the
  :                            483 .	lower limit), just do an unsigned compare, because the
  :                            484 .	low-high difference cannot be a negative difference between
  :                            485 .	two signed integers. It can only be a lower limit in the
  :                            486 .	lower half of the number space, and an upper limit in the
  :                            487 .	upper half of the unsigned number space
  :                            488 
  :                            489 .	in all the above cases, the candidate integer is within
  :                            490 .	the range tested, if both carry is generated from the
  :                            491 .	subtraction of the lower limit from the integer, and also
  :                            492 .	carry is generated from the subtraction of the integer from
  :                            493 .	the upper limit
  :                            494 
  :                            495 .	this depends upon carry being consistent with adding the
  :                            496 .	minus of one number to the plus of another
  :                            497 
  :                            498 .	RTA1 is logically correct for this. The result and carried
  :                            499 .	result of
  :                            500 
  :                            501 .		ana	THIS
  :                            502 .		anb	THAT
  :                            503 .		dan	THE_OTHER
  :                            504 
  :                            505 
  :                            506 .	are identical to the result and carried result of
  :                            507 
  :                            508 .		aa	MINUS_THIS
  :                            509 .		ab	MINUS_THAT
  :                            510 .		da	MINUS_THE_OTHER
  :                            511 
  :                            512 .	carry$ set after ana anb dan means the unsigned number in
  :                            513 .	the accumulators was at least as large as the number
  :                            514 .	subtracted from it
  :                            515 .		
  :                            516 .
  :                            517 .	if the high-order bit of the lower limit is on and not the
  :                            518 .	high order bit of the upper limit, this is a signed range
  :                            519 .	which includes the value zero between its upper and lower
  :                            520 .	bounds. Then the candidate integer is within the range
  :                            521 .	tested if both the result of the integer minus the lower limit
  :                            522 .	is of positive polarity, and also the result of the upper limit
  :                            523 .	minus the integer is positive polarity
  :                            524 
  :                            525 .	polarity (and zero) are tested in the registers holding the
  :                            526 .	results, because the only condition flag in RTA1 is carry$
  :                            527 
  :                            528 .	examples of instructions testing results other than carry are
  :                            529 
  :                            530 .		jpa	here
  :                            531 .		jnb	there
  :                            532 .		jdz	everywhere
  :                            533 .		jzb	b_is_zero
  :                            534 .		jpe	a_has_even_parity
  :                            535 
  :                            536 .		tp	location_a_few_million
  :                            537 .		j	the_word_at_location_a_few_million_is_negative
  :                            538 
  :                            539 .		tz	2, sp
  :                            540 .		j	the_third_register_in_the_internal_stack_is_nonzero
  :                            541 
  :                            542 
  :                            543 mib_store_long_range!
00:009154 8FB000              +544 	qpush	0, y
00:009155 87A000              +545 	qpop	0, x
00:009156 850004              +546 	ax, xi	4
00:009157 8D0004              +547 	ay, xi	4
  :                            548 mib_store_long_range?
00:009158 1E0154              +549 	jdr	mib_store_long_range!
00:009159 B60168              +550 	j	mib_store_new
  :                            551 	
  :                            552 mib_store_range!
00:00915A CFB000              +553 	dl	0, y
00:00915B C7A000              +554 	ds	0, x
00:00915C 850002              +555 	ax, xi	2
00:00915D 8D0002              +556 	ay, xi	2
  :                            557 mib_store_range?
00:00915E 1E015A              +558 	jdr	mib_store_range!
00:00915F B60168              +559 	j	mib_store_new
  :                            560 
  :                            561 mib_store_new_x
00:009160 60F00A              +562 	la	obytes		. a function may have a table
00:009161 C60168              +563 	jza	mib_store_new	. row repeat for GETNEXT
00:009162 60F001              +564 	la	mibw_first
00:009163 680008              +565 	lb	8
00:009164 20D000              +566 	sa	mo:along, b
00:009165 B60168              +567 	j	mib_store_new
  :                            568 
  :                            569 mib_store_new_x1		. strings must have a bucket size
00:009166 60F00C              +570 	la	orules		.
00:009167 C601CA              +571 	jza	mib_wgenerr	.
  :                            572 
  :                            573 				. but they can store zero
  :                            574 				. length string in a bucket
  :                            575 				. of nonzero size, whereas
  :                            576 				. numbers always squeeze
  :                            577 				. a byte out
  :                            578 
  :                            579 mib_store_new
00:009168 680008              +580 	lb	8		. managed object header
(+01)0f
00:009169 100425              +581 	sx	mib_floor
00:00916A B601D2              +582 	j	mib_storeb
  :                            583 
  :                            584 mib_modify
00:00916B 60F008              +585 	la	oflags
00:00916C 90A005              +586 	or	mo:flags
00:00916D A50002              +587 	and, xi	MIB_WRITE_ALLOWED
00:00916E C601CE              +588 	jza	mib_wreadonly
  :                            589 
00:00916F 60F009              +590 	la	oclass
00:009170 680004              +591 	anu	mo:type
00:009171 D8A003              +591 
00:009172 DE01CC              +592 	jnzb	mib_wbadvalue
  :                            593 
00:009173 680004              +594 	anu, xi	MIB_FUNCTION
00:009174 DD0064              +594 
00:009175 CE01CE              +595 	jzb	mib_wreadonly
  :                            596 
00:009176 680004              +597 	anu, xi	SNMP_NETWORKADDRESS
00:009177 DD0040              +597 
00:009178 CE01BC              +598 	jzb	mib_checkwlen
00:009179 680004              +599 	anu, xi	SNMP_STRING
00:00917A DD0004              +599 
00:00917B CE01BC              +600 	jzb	mib_checkwlen
00:00917C 680004              +601 	anu, xi	SNMP_OID
00:00917D DD0006              +601 
00:00917E CE01BC              +602 	jzb	mib_checkwlen
  :                            603 
00:00917F 300007              +604 	z	7		. we say, unsigned
00:009180 680004              +605 	anu, xi	SNMP_GAUGE
00:009181 DD0042              +605 
00:009182 CE018D              +606 	jzb	mib_wnumber
00:009183 680004              +607 	anu, xi	SNMP_COUNTER
00:009184 DD0041              +607 
00:009185 CE018D              +608 	jzb	mib_wnumber
00:009186 680004              +609 	anu, xi	SNMP_TIMETICKS
00:009187 DD0043              +609 
00:009188 CE018D              +610 	jzb	mib_wnumber
00:009189 680004              +611 	anu, xi	SNMP_INT
00:00918A DD0002              +611 
00:00918B DE01CC              +612 	jnzb	mib_wbadvalue	. well what else is it then?
00:00918C 0F0007              +613 	n	7		. _INT is the only signed one
  :                            614 
  :                            615 mib_wnumber
00:00918D 60A004              +616 	la	mo:bytes	. start measuring
  :                            617 
00:00918E 680004              +618 	anu, xi	4
00:00918F DD0004              +618 
00:009190 280006              +619 	sb	6		. target > 24 bits or not
  :                            620 
00:009191 680004              +621 	anu	obytes		. more data than the target number?
00:009192 D8F00A              +621 
00:009193 5E01C8              +622 	jnc	mib_wtoobig
  :                            623 
00:009194 2E0003              +624 	sbl	3		. calculate the shift count
00:009195 40A006              +625 	lr	mo:ranges
00:009196 5CA007              +626 	ly, i	mo:range
  :                            627 
00:009197 780006              +628 	tp	6
00:009198 B601A8              +629 	j	mib_store1
  :                            630 
00:009199 280006              +631 	sb	6
00:00919A 68F00B              +632 	lb	odata		. get the input at last
00:00919B CFD000              +633 	dl	0, b
  :                            634 
00:00919C 780007              +635 	tp	7
00:00919D B601A3              +636 	j	mib_long_signed	. signed
  :                            637 
00:00919E 168006              +638 	dsr	*6		. unsigned
  :                            639 
00:00919F 700000              +640 	tz	r		. ranges allowed
00:0091A0 3E022D              +641 	lcal	mib_checkunsigned_l
00:0091A1 B601B9              +642 	j	mib_store_l
00:0091A2 B601CC              +643 	j	mib_wbadvalue
  :                            644 
  :                            645 mib_long_signed
00:0091A3 968006              +646 	dsa	*6		. signed
  :                            647 
00:0091A4 700000              +648 	tz	r		. ranges allowed
00:0091A5 3E0238              +649 	lcal	mib_checksigned_l
00:0091A6 B601B9              +650 	j	mib_store_l
00:0091A7 B601CC              +651 	j	mib_wbadvalue
  :                            652 
  :                            653 mib_store1
00:0091A8 60F00B              +654 	la	odata
00:0091A9 60C000              +655 	la	0, a
  :                            656 	
00:0091AA 780007              +657 	tp	7		. signed?
00:0091AB B601B1              +658 	j	mib_single_signed
  :                            659 
00:0091AC 06D000              +660 	sar	0, b		. unsigned
  :                            661 
00:0091AD 700000              +662 	tz	r		. ranges allowed
00:0091AE 3E0219              +663 	lcal	mib_checkunsigned_s
00:0091AF B601B6              +664 	j	mib_store_s
00:0091B0 B601CC              +665 	j	mib_wbadvalue
  :                            666 
  :                            667 mib_single_signed
00:0091B1 86D000              +668 	saa	0, b
  :                            669 
00:0091B2 700000              +670 	tz	r		. ranges allowed
00:0091B3 3E0223              +671 	lcal	mib_checksigned_s
00:0091B4 B601B6              +672 	j	mib_store_s
00:0091B5 B601CC              +673 	j	mib_wbadvalue
  :                            674 
  :                            675 mib_store_s
00:0091B6 68A001              +676 	lb	mo:data
00:0091B7 20D000              +677 	sa	0, b
00:0091B8 B601D1              +678 	j	mib_store
  :                            679 
  :                            680 mib_store_l
00:0091B9 58A001              +681 	ly	mo:data
00:0091BA C7B000              +682 	ds	0, y
00:0091BB B601D1              +683 	j	mib_store
  :                            684 
  :                            685 mib_checkwlen
00:0091BC 60A006              +686 	la	mo:bucket
00:0091BD D00000              +687 	ana	r
00:0091BE 5E01C8              +688 	jnc	mib_wtoobig
00:0091BF 58F00B              +689 	ly	odata
00:0091C0 60A001              +690 	la	mo:data
00:0091C1 B601C6              +691 	j	mib_warray?
  :                            692 
  :                            693 mib_warray!
00:0091C2 68B000              +694 	lb	0, y
00:0091C3 8D0001              +695 	ay, xi	1
00:0091C4 28C000              +696 	sb	0, a
00:0091C5 64C001              +697 	la, i	1, a
  :                            698 mib_warray?
00:0091C6 1E01C2              +699 	jdr	mib_warray!
  :                            700 	
00:0091C7 B601D1              +701 	j	mib_store
  :                            702 
  :                            703 mib_wtoobig
00:0091C8 65FFFF              +704 	la, xi	-SNMP_TOOBIG
00:0091C9 B601CF              +705 	j	mib_nowrite
  :                            706 
  :                            707 mib_wgenerr
00:0091CA 65FFFB              +708 	la, xi	-SNMP_GENERR
00:0091CB B601CF              +709 	j	mib_nowrite
  :                            710 
  :                            711 mib_wbadvalue
00:0091CC 65FFFD              +712 	la, xi	-SNMP_BADVALUE
00:0091CD B601CF              +713 	j	mib_nowrite
  :                            714 
  :                            715 mib_wreadonly
00:0091CE 65FFFC              +716 	la, xi	-SNMP_READONLY
  :                            717 mib_nowrite
00:0091CF 6D0000              +718 	lb, xi	0		. result no pointer in b
00:0091D0 B601D3              +719 	j	mib_writex	. problem -index in a
  :                            720 
  :                            721 mib_store
00:0091D1 680002              +722 	lb	x
  :                            723 mib_storeb
00:0091D2 650000              +724 	la, xi	0
  :                            725 mib_writex
00:0091D3 54F004              +726 	lx, i	$$frame, sp
00:0091D4 10000F              +727 	sx	sp
00:0091D5 3D0000              +728 	fret	0
  :                            729 
  :                            730 mib_initial
00:0091D6 5D0638              +731 	ly, xi	sysDescr
  :                            732 
  :                            733 mib_initial_next
00:0091D7 60B000              +734 	la	om:words
00:0091D8 C601DE              +735 	jza	mib_initial_x
00:0091D9 FF0A4D              +736 	call	(mib_line)
00:0091DA 60B000              +737 	la	om:words
00:0091DB A500FF              +738 	and, xi	255
00:0091DC 880004              +739 	ay	a
00:0091DD B601D7              +740 	j	mib_initial_next
  :                            741 mib_initial_x
00:0091DE 3D0000              +742 	fret	0
  :                            743 
                                mib_wline 	$head_far	scalars(invoi,	int	;
                                					ityp,	int	;
                                					safety,	4	;
00:0091DF FD0000              +747 					ilist,	24)
00:0091E0 FD0000              +747 
00:0091E1 8F0A49              +747 
00:0091E2 8F0A49              +747 
00:0091E3 8FF000              +747 
00:0091E4 8FF000              +747 
00:0091E5 8FF000              +747 
00:0091E6 8FF000              +747 
00:0091E7 8FF000              +747 
  :                            748 						
00:0091E8 50B001              +749 	lx	om:o			. pointer to oid string
00:0091E9 18F01D              +750 	sy	invoi
  :                            751 
00:0091EA 160010              +752 	dsr	16
00:0091EB 0E0010              +753 	sbr	16
00:0091EC 20F01C              +754 	sa	ityp
  :                            755 
00:0091ED 5CF000              +756 	ly, i	ilist
00:0091EE 650006              +757 	la, xi	SNMP_OID
00:0091EF C7B000              +758 	ds	0, y
  :                            759 
00:0091F0 CCB002              +760 	ab	2, y, i			. high index of store y ->
00:0091F1 400005              +761 	lr	b
  :                            762 
  :                            763 load_oid?
00:0091F2 FE01F5              +764 	jyge	oid_loaded		. until y >= r
00:0091F3 3E0204              +765 	lcal	mib_unpack		. decode oid string
00:0091F4 B601F2              +766 	j	load_oid?		. into internal stack
  :                            767 
  :                            768 oid_loaded
  :                            769 
00:0091F5 58F01D              +770 	ly	invoi
  :                            771 
                                	c	(mib_set)	ilist,,i	om:flags	;
                                				ityp		om:l		;
                                				om:data		om:ranges	;
00:0091F6 FCB006              +775 				om:range,,i
00:0091F7 F8B005              +775 
00:0091F8 F8B003              +775 
00:0091F9 F8B002              +775 
00:0091FA F8F020              +775 
00:0091FB F8B004              +775 
00:0091FC FCF006              +775 
00:0091FD FCF007              +775 
00:0091FE FF0A4E              +775 
00:0091FF 38000F              +775 
  :                            776 
  :                            777 
00:009200 58F01D              +778 	ly	invoi	
00:009201 54F01E              +779 	lx, i	$$frame, sp
00:009202 10000F              +780 	sx	sp
00:009203 3D0000              +781 	fret	0
  :                            782 
  :                            783 mib_unpack
00:009204 4D0080              +784 	lk, xi	128
00:009205 68A000              +785 	lb	0, x
00:009206 850001              +786 	ax, xi	1
  :                            787 
00:009207 3E020B              +788 	lcal	mib_decode
00:009208 3E020B              +789 	lcal	mib_decode
00:009209 3E020B              +790 	lcal	mib_decode
00:00920A 350000              +791 	lret	0
  :                            792 
  :                            793 mib_decode
00:00920B 650000              +794 	la, xi	0
00:00920C 360008              +795 	dsl	8
00:00920D AF0001              +796 	mta	k
00:00920E B60216              +797 	j	mib_decode_simple
00:00920F A5001F              +798 	and, xi	31
00:009210 C60215              +799 	jza	mib_decoded
  :                            800 mib_space
00:009211 30B002              +801 	z	2, y
00:009212 8D0001              +802 	ay, xi	1
00:009213 C5FFFF              +803 	aa, xi	-1
00:009214 D60211              +804 	jnza	mib_space
  :                            805 mib_decoded
00:009215 350000              +806 	lret	0
  :                            807 mib_decode_simple
00:009216 20B002              +808 	sa	2, y
00:009217 8D0001              +809 	ay, xi	1
00:009218 350000              +810 	lret	0
  :                            811 
  :                            812 mib_checkunsigned_s
00:009219 B60221              +813 	j	mib_checkunsigned_s?
  :                            814 mib_checkunsigned_s!
00:00921A 680004              +815 	anu	0, y
00:00921B D8B000              +815 
00:00921C 5E0220              +816 	jnc	mib_checkunsigned_snext
00:00921D 68B001              +817 	lb	1, y
00:00921E D80004              +818 	anb	a
00:00921F 7E0244              +819 	jc	mib_check_good
  :                            820 
  :                            821 mib_checkunsigned_snext
00:009220 8D0002              +822 	ay, xi	2
  :                            823 mib_checkunsigned_s?
00:009221 1E021A              +824 	jdr	mib_checkunsigned_s!
00:009222 350001              +825 	lret	1	. counter_intuitively the bad result
  :                            826 
  :                            827 mib_checksigned_s
00:009223 B6022B              +828 	j	mib_checksigned_s?
  :                            829 mib_checksigned_s!
00:009224 680004              +830 	anu	0, y
00:009225 D8B000              +830 
00:009226 EE022A              +831 	jnb	mib_checksigned_snext
00:009227 68B001              +832 	lb	1, y
00:009228 D80004              +833 	anb	a
00:009229 AE0244              +834 	jpb	mib_check_good
  :                            835 
  :                            836 mib_checksigned_snext
00:00922A 8D0002              +837 	ay, xi	2
  :                            838 mib_checksigned_s?
00:00922B 1E0224              +839 	jdr	mib_checksigned_s!
00:00922C 350001              +840 	lret	1
  :                            841 
  :                            842 mib_checkunsigned_l
00:00922D C70006              +843 	ds	6
00:00922E B60236              +844 	j	mib_checkunsigned_l?
  :                            845 mib_checkunsigned_l!
00:00922F CF0006              +846 	dl	6
00:009230 DFB000              +847 	dan	0, y
00:009231 5E0235              +848 	jnc	mib_checkunsigned_lnext
00:009232 CFB002              +849 	dl	2, y
00:009233 DF0006              +850 	dan	6
00:009234 7E0243              +851 	jc	mib_check_double_good
  :                            852 mib_checkunsigned_lnext
00:009235 8D0004              +853 	ay, xi	4
  :                            854 mib_checkunsigned_l?
00:009236 1E022F              +855 	jdr	mib_checkunsigned_l!
00:009237 350001              +856 	lret	1
  :                            857 
  :                            858 
  :                            859 mib_checksigned_l
00:009238 C70006              +860 	ds	6
00:009239 B60241              +861 	j	mib_checksigned_l?
  :                            862 mib_checksigned_l!
00:00923A CF0006              +863 	dl	6
00:00923B DFB000              +864 	dan	0, y
00:00923C E60240              +865 	jna	mib_checksigned_lnext
00:00923D CFB002              +866 	dl	2, y
00:00923E DF0006              +867 	dan	6
00:00923F A60243              +868 	jpa	mib_check_double_good
  :                            869 mib_checksigned_lnext
00:009240 8D0004              +870 	ay, xi	4
  :                            871 mib_checksigned_l?
00:009241 1E023A              +872 	jdr	mib_checksigned_l!
00:009242 350001              +873 	lret	1
  :                            874 
  :                            875 mib_check_double_good
00:009243 CF0006              +876 	dl	6
  :                            877 mib_check_good
00:009244 350000              +878 	lret	0
  :                            879 
  :                            256: 	$include mib2tick
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 $(1)
                                mib2ticko mobjet 	0	3	SNMP_TIMETICKS	6	;
01:00042D 000000              +42 			1	0	0		ticko
(+01)18
01:00042E 000434              +42 
01:00042F 000003              +42 
01:000430 000043              +42 
01:000431 000006              +42 
01:000432 000001              +42 
01:000433 000001              +42 
  :                            43 
01:000434 000000000000        +44 ticko	+	0:d
  :                            45 
  :                            46 $(0)
                                mib2tick	$head_far	 params(tseq,	int	;
                                					tflags,	int	;
                                					troutine, int	;
  :                            50 					tnext,	int)
  :                            51 
  :                            52 mib2tick_deliver
00:009245 CF0096              +53 	dl	DAYCLOCK$U
00:009246 F5000A              +54 	d, xi	10		. msecs to 100ths
00:009247 200005              +55 	sa	b
00:009248 600006              +56 	la	6
(+01)0f
00:009249 C70434              +57 	ds	ticko
00:00924A 650000              +58 	la, xi	0
(+01)10
00:00924B 6D042D              +59 	lb, xi	mib2ticko
00:00924C 3D0000              +60 	fret	0
  :                            257: 	$include udpagent
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 $(1)
  :                            41 
                                mib_uneto	mobjet		0	1	SNMP_NETWORKADDRESS	4	;
01:000436 000000              +43 				1	0	0		mib_uneta
(+01)18
01:000437 000444              +43 
01:000438 000001              +43 
01:000439 000040              +43 
01:00043A 000004              +43 
01:00043B 000001              +43 
01:00043C 000001              +43 
  :                            44 
                                mib_uporto	mobjet	mib_uneto	2	SNMP_INT		2	;
(+01)18
01:00043D 000436              +46 				1	0	0		mib_uneta+1
(+01)18
01:00043E 000445              +46 
01:00043F 000002              +46 
01:000440 000002              +46 
01:000441 000002              +46 
01:000442 000001              +46 
01:000443 000001              +46 
  :                            47 
01:000444 0000000000A1        +48 mib_uneta	$netp		0,161
  :                            49 
  :                            50 
  :                            51 $(0)
  :                            52 
                                udpagent_net	$head_far	 params(nuseq,		int	;
                                					nuflags,	int	;
  :                            55 					nuroutine,	int)
  :                            56 
00:00924D 60F005              +57 	la	nuroutine
00:00924E D500A0              +58 	ana, xi	SNMP_GETREQ
00:00924F 68F003              +59 	lb	nuseq
00:009250 D60255              +60 	jnza	udpagent_netagain
00:009251 3E0265              +61 	lcal	udpagent_direct
00:009252 CE025D              +62 	jzb	udpagent_nohit
(+01)0f
00:009253 C70444              +63 	ds	mib_uneta
00:009254 B6025B              +64 	j	udpagent_netresult
  :                            65 
  :                            66 udpagent_netagain
00:009255 3E0274              +67 	lcal	udpagent_search_forward
00:009256 CE025D              +68 	jzb	udpagent_nohit
  :                            69 
(+01)0f
00:009257 C70444              +70 	ds	mib_uneta
00:009258 A80A4F              +71 	andB	(65535)
00:009259 60F003              +72 	la	nuseq
00:00925A 28C009              +73 	sb	9, a
  :                            74 
  :                            75 udpagent_netresult
(+01)10
00:00925B 6D0436              +76 	lb, xi	mib_uneto
00:00925C 3D0000              +77 	fret	0
  :                            78 
  :                            79 udpagent_nohit
00:00925D 3D0000              +80 	fret	0
  :                            81 
                                udpagent_port	$head_far	 params(useq,		int	;
                                					uflags, 	int	;
  :                            84 					uroutine	int)
  :                            85 
00:00925E 68F003              +86 	lb	useq
00:00925F 3E0265              +87 	lcal	udpagent_direct
00:009260 CE0264              +88 	jzb	udpagent_nohitp
  :                            89 	
00:009261 A80A4F              +90 	andB	(65535)
(+01)0f
00:009262 C70444              +91 	ds	mib_uneta
(+01)10
00:009263 6D043D              +92 	lb, xi	mib_uporto
  :                            93 
  :                            94 udpagent_nohitp
00:009264 3D0000              +95 	fret	0
  :                            96 
  :                            97 
  :                            98 udpagent_direct
00:009265 60D009              +99 	la	9, b
00:009266 160009              +100 	dsr	9
00:009267 A5007F              +101 	and, xi	127
00:009268 C52080              +102 	aa, xi	usockb(1)
00:009269 60C000              +103 	la	0, a
00:00926A C60271              +104 	jza	udpagent_nodirect
00:00926B 34002F              +105 	sabr	BSOCKET
00:00926C 0E000F              +106 	sbr	15
00:00926D 9D5E00              +107 	orB, xi	BSOCKET*/9
00:00926E 2E0003              +108 	sbl	3
00:00926F CFD000              +109 	dl	0, b
00:009270 350000              +110 	lret	0
  :                            111 
  :                            112 udpagent_nodirect
00:009271 650002              +113 	la, xi	SNMP_NOSUCHNAME
00:009272 6D0000              +114 	lb, xi	0
00:009273 350000              +115 	lret	0
  :                            116 
  :                            117 
  :                            118 udpagent_search_forward
00:009274 60D001              +119 	la	1, b
  :                            120 
00:009275 C5FFF8              +121 	aa, xi	-8
00:009276 5E0283              +122 	jnc	udpagent_start_tree
  :                            123 
00:009277 C5FFFF              +124 	aa, xi	-1
00:009278 5E027C              +125 	jnc	udpagent_search_equal
  :                            126 
00:009279 60D009              +127 	la	9, b
00:00927A C50001              +128 	aa, xi	1
00:00927B B6027D              +129 	j	udpagent_locate
  :                            130 
  :                            131 udpagent_search_equal
00:00927C 60D009              +132 	la	9, b
  :                            133 
  :                            134 udpagent_locate
00:00927D 160009              +135 	dsr	9
00:00927E 0E000F              +136 	sbr	15
00:00927F 9D5E00              +137 	orB, xi	BSOCKET*/9
00:009280 2E0003              +138 	sbl	3
00:009281 C52080              +139 	aa, xi	usockb(1)
00:009282 B60285              +140 	j	udpagent_start_search
  :                            141 
  :                            142 udpagent_start_tree
00:009283 652080              +143 	la, xi  usockb(1)
00:009284 680A50              +144 	lb      (BSOCKET*/12)
  :                            145 
  :                            146 udpagent_start_search
00:009285 F80002              +147 	push	x
00:009286 500005              +148 	lx	b
00:009287 400A51              +149 	lr	(BSOCKET+1*/12))
00:009288 F80004              +150 	push	a
  :                            151 
  :                            152 udpagent_search_on
00:009289 65DF00              +153 	la, xi	-usockb(128)-1
00:00928A C0F000              +154 	aa	0, sp
00:00928B 7E0298              +155 	jc	udpagent_nofind
00:00928C 60F000              +156 	la	0, sp
00:00928D 60C000              +157 	la	0, a
00:00928E C60295              +158 	jza	udpagent_next_bank
00:00928F 34002F              +159 	sabr	BSOCKET
  :                            160 udpagent_next_port
00:009290 CFA000              +161 	dl	0, x
00:009291 DE029A              +162 	jnzb	udpagent_eosearch
00:009292 850008              +163 	ax, xi	8
00:009293 F60295              +164 	jxge	udpagent_next_bank
00:009294 B60290              +165 	j	udpagent_next_port
  :                            166 udpagent_next_bank
00:009295 17F000              +167 	inc	0, sp 
00:009296 500A50              +168 	lx	(BSOCKET*/12)
00:009297 B60289              +169 	j	udpagent_search_on
  :                            170 
  :                            171 udpagent_nofind
00:009298 6D0000              +172 	lb, xi	0
00:009299 650002              +173 	la, xi	SNMP_NOSUCHNAME
  :                            174 udpagent_eosearch
00:00929A 380002              +175 	pop	x
00:00929B 380002              +176 	pop	x
00:00929C 350000              +177 	lret	0
  :                            258: 	$include ifagent
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 IFNUMBER_I* $set	ifNumber:i
  :                            41 
  :                            42 $(1)
  :                            43 
01:000446 000000              +44 ifagent_i24	mobjet	0	0	SNMP_INT	3	1 
01:000447 000000              +44 
01:000448 000000              +44 
01:000449 000002              +44 
01:00044A 000003              +44 
01:00044B 000001              +44 
01:00044C 000000              +44 
01:00044D 000000              +45 ifagent_string	mobjet	0	2	SNMP_STRING	18	1
01:00044E 000000              +45 
01:00044F 000002              +45 
01:000450 000004              +45 
01:000451 000012              +45 
01:000452 000001              +45 
01:000453 000000              +45 
01:000454 000000              +46 ifagent_string48 mobjet	0	6	SNMP_STRING	6	1
01:000455 000000              +46 
01:000456 000006              +46 
01:000457 000004              +46 
01:000458 000006              +46 
01:000459 000001              +46 
01:00045A 000000              +46 
01:00045B 000000              +47 ifagent_t48	mobjet	0	9	SNMP_TIMETICKS	6	1
01:00045C 000000              +47 
01:00045D 000009              +47 
01:00045E 000043              +47 
01:00045F 000006              +47 
01:000460 000001              +47 
01:000461 000000              +47 
01:000462 000000              +48 ifagent_g48	mobjet	0	5	SNMP_GAUGE	5	1
01:000463 000000              +48 
01:000464 000005              +48 
01:000465 000042              +48 
01:000466 000005              +48 
01:000467 000001              +48 
01:000468 000000              +48 
01:000469 000000              +49 ifagent_c48	mobjet	0	0	SNMP_COUNTER	6	1
01:00046A 000000              +49 
01:00046B 000000              +49 
01:00046C 000041              +49 
01:00046D 000006              +49 
01:00046E 000001              +49 
01:00046F 000000              +49 
                                ifagent_onone	mobjet	0	22	SNMP_OID	2	1	;
01:000470 000000              +51 			0	0	ifagent_onone
(+01)18
01:000471 000470              +51 
01:000472 000016              +51 
01:000473 000006              +51 
01:000474 000002              +51 
01:000475 000001              +51 
01:000476 000001              +51 
01:000477 000000000000        +52 ifagent_p48	0L
  :                            53 
  :                            54 $(0)
  :                            55 
                                ifagent_idx	$head_far	 params(ifidxseq,	int	;
                                					ifidxflags,	int	;
  :                            58 					ifidxroutine,	int)
  :                            59 
00:00929D 68F003              +60 	lb	ifidxseq
00:00929E 60F005              +61 	la	ifidxroutine
00:00929F D500A0              +62 	ana, xi	SNMP_GETREQ
  :                            63 
00:0092A0 C602A3              +64 	jza	ifagent_this_row
00:0092A1 3E037B              +65 	lcal	ifagent_find_next_if
  :                            66 
00:0092A2 B602A4              +67 	j	ifagent_row?
  :                            68 
  :                            69 ifagent_this_row
00:0092A3 3E0385              +70 	lcal	ifagent_find_i_f
  :                            71 ifagent_row?
00:0092A4 CE02AD              +72 	jzb	ifagent_noidx
  :                            73 
00:0092A5 64D000              +74 	la, i	this_if:id, b
(+01)0f
00:0092A6 200447              +75 	sa	ifagent_i24:data
  :                            76 
00:0092A7 60C000              +77 	la	0, a
  :                            78 
00:0092A8 68F003              +79 	lb	ifidxseq
00:0092A9 20D009              +80 	sa	9, b
  :                            81 
  :                            82 
00:0092AA 650001              +83 	la, xi	1
(+01)0f
00:0092AB 200448              +84 	sa	ifagent_i24:seq
  :                            85 
  :                            86 .	la, xi	9
  :                            87 .	sa	1, b
  :                            88 
(+01)10
00:0092AC 6D0446              +89 	lb, xi	ifagent_i24
  :                            90 
  :                            91 ifagent_noidx
00:0092AD 3D0000              +92 	fret	0
  :                            93 
00:0092AE 4D00FF              +94 stril	lk, xi	+(1*/$byte)-1
00:0092AF 6D0000              +95 	lb, xi	0
00:0092B0 200006              +96 	sa	6
00:0092B1 608006              +97 strilw*	la	*6
00:0092B2 170006              +98 	inc	6
00:0092B3 CD0003              +99 	ab, xi	$word/$byte
00:0092B4 AF0A52              +100 	mta	(0)
00:0092B5 B602B1              +101 	j	strilw
  :                            102 
00:0092B6 950001              +103 	or, xi	1
  :                            104 
00:0092B7 CDFFFF              +105 strail	ab, xi	-1
00:0092B8 460008              +106 	rar	$byte
00:0092B9 AF0A52              +107 	mta	(0)
00:0092BA 350000              +108 	lret	0
00:0092BB B602B7              +109 	j	strail	
  :                            110 
  :                            111 
                                ifagent_descr	$head_far	 params(ifdescseq,	int	;
                                					ifdescflags,	int	;
  :                            114 					ifdescroutine,	int)
  :                            115 
00:0092BC 68F003              +116 	lb	ifdescseq
00:0092BD 3E0385              +117 	lcal	ifagent_find_i_f
00:0092BE CE02C6              +118 	jzb	ifagent_nodescr
  :                            119 
  :                            120 	$if	0
  :                            121 	la, i	this_if:description, b
  :                            122 	$else
00:0092BF 60D025              +123 	la	this_if:description, b			. this is now a pointer
  :                            124 	$endif
  :                            125 
(+01)0f
00:0092C0 20044E              +126 	sa	ifagent_string:data
  :                            127 
00:0092C1 F8D026              +128 	push	this_if:description_bytes, b
(+01)0f
00:0092C2 380451              +129 	pop	ifagent_string:bytes
  :                            130 
  :                            131 .	lb	ifdescseq
00:0092C3 650002              +132 	la, xi	2
  :                            133 .	sa	10, b
(+01)0f
00:0092C4 20044F              +134 	sa	ifagent_string:seq
  :                            135 
(+01)10
00:0092C5 6D044D              +136 	lb, xi	ifagent_string
  :                            137 ifagent_nodescr
00:0092C6 3D0000              +138 	fret	0
  :                            139 
  :                            140 
                                ifagent_type	$head_far	 params(iftypseq,	int	;
                                					iftypflags,	int	;
  :                            143 					iftyproutine,	int)
  :                            144 
00:0092C7 68F003              +145 	lb	iftypseq
00:0092C8 3E0385              +146 	lcal	ifagent_find_i_f
00:0092C9 CE02CF              +147 	jzb	ifagent_notype
  :                            148 
00:0092CA 64D003              +149 	la, i	this_if:type, b
(+01)0f
00:0092CB 200447              +150 	sa	ifagent_i24:data
  :                            151 
  :                            152 .	lb	iftypseq
00:0092CC 650003              +153 	la, xi	3
  :                            154 .	sa	10, b
(+01)0f
00:0092CD 200448              +155 	sa	ifagent_i24:seq
  :                            156 
(+01)10
00:0092CE 6D0446              +157 	lb, xi	ifagent_i24
  :                            158 ifagent_notype
00:0092CF 3D0000              +159 	fret	0
  :                            160 
  :                            161 
                                ifagent_MTU	$head_far	 params(ifmtuseq,	int	;
                                					ifmtuflags,	int	;
  :                            164 					ifmturoutine,	int)
  :                            165 
00:0092D0 68F003              +166 	lb	ifmtuseq
00:0092D1 3E0385              +167 	lcal	ifagent_find_i_f
00:0092D2 CE02D8              +168 	jzb	ifagent_noMTU
  :                            169 
00:0092D3 64D004              +170 	la, i	this_if:mtu, b
(+01)0f
00:0092D4 200447              +171 	sa	ifagent_i24:data
  :                            172 
  :                            173 .	lb	ifmtuseq
00:0092D5 650004              +174 	la, xi	4
  :                            175 .	sa	10, b
(+01)0f
00:0092D6 200448              +176 	sa	ifagent_i24:seq
  :                            177 
(+01)10
00:0092D7 6D0446              +178 	lb, xi	ifagent_i24
  :                            179 ifagent_noMTU
00:0092D8 3D0000              +180 	fret	0
  :                            181 
  :                            182 
                                ifagent_speed	$head_far	 params(ifrateseq,	int	;
                                					ifrateflags,	int	;
  :                            185 					ifrateroutine,	int)
  :                            186 
00:0092D9 68F003              +187 	lb	ifrateseq
00:0092DA 3E0385              +188 	lcal	ifagent_find_i_f
00:0092DB CE02DF              +189 	jzb	ifagent_nospeed
  :                            190 
00:0092DC 64D006              +191 	la,i	this_if:bitrate, b
(+01)0f
00:0092DD 200463              +192 	sa	ifagent_g48:data
  :                            193 
  :                            194 .	la, xi	5
  :                            195 .	lb	ifrateseq
  :                            196 .	sa	10, b
  :                            197 
(+01)10
00:0092DE 6D0462              +198 	lb, xi	ifagent_g48
  :                            199 
  :                            200 ifagent_nospeed
00:0092DF 3D0000              +201 	fret	0
  :                            202 
  :                            203 
                                ifagent_phy	$head_far	 params(ifphyseq,	int	;
                                					ifphyflags,	int	;
                                					ifphyroutine,	int)	;
00:0092E0 F80002              +207 				scalars(ifphycaller_x,	int, x)
  :                            208 
00:0092E1 68F004              +209 	lb	ifphyseq
00:0092E2 3E0385              +210 	lcal	ifagent_find_i_f
00:0092E3 CE02EE              +211 	jzb	ifagent_nophy
  :                            212 
00:0092E4 500005              +213 	lx	b
00:0092E5 CFA008              +214 	dl	this_if:physa		. BER editing wants this
00:0092E6 2E0008              +215 	sbl	8			. in internal format
00:0092E7 360008              +216 	dsl	8			. and it's in network format
00:0092E8 480A4F              +217 	lk	(00FFFF)
00:0092E9 BFA00A              +218 	mlb	this_if:physa+2		. BER turns it back into network 
(+01)0f
00:0092EA C70477              +219 	ds	ifagent_p48		. format, but packing it here is
(+01)10
00:0092EB 650477              +220 	la	ifagent_p48,,xi		. less extra code than adding an
  :                            221 					. extra data type to BER
(+01)0f
00:0092EC 200455              +222 	sa	ifagent_string48:data
  :                            223 
  :                            224 .	la, xi	6
  :                            225 .	lb	ifphyseq
  :                            226 .	sa	10, b
  :                            227 
(+01)10
00:0092ED 6D0454              +228 	lb, xi	ifagent_string48
  :                            229 
  :                            230 ifagent_nophy
00:0092EE 380002              +231 	pop	x
00:0092EF 3D0000              +232 	fret	0
  :                            233 
  :                            234 
                                ifagent_admins	$head_far	 params(ifastaseq,	int	;
                                					ifastaflags,	int	;
  :                            237 					ifastaroutine,	int)
00:0092F0 68F003              +238 	lb	ifastaseq
00:0092F1 3E0385              +239 	lcal	ifagent_find_i_f
00:0092F2 CE02F8              +240 	jzb	ifagent_noadmins
  :                            241 
00:0092F3 64D005              +242 	la, i	this_if:state, b
(+01)0f
00:0092F4 200447              +243 	sa	ifagent_i24:data
  :                            244 
  :                            245 .	lb	ifastaseq
00:0092F5 650007              +246 	la, xi	7
  :                            247 .	sa	10, b
(+01)0f
00:0092F6 200448              +248 	sa	ifagent_i24:seq
  :                            249 
(+01)10
00:0092F7 6D0446              +250 	lb, xi	ifagent_i24
  :                            251 
  :                            252 ifagent_noadmins
00:0092F8 3D0000              +253 	fret	0
  :                            254 
  :                            255 
                                ifagent_osta	$head_far	 params(ifostaseq,	int	;
                                					ifostaflags,	int	;
  :                            258 					ifostaroutine,	int)
  :                            259 
00:0092F9 68F003              +260 	lb	ifostaseq
00:0092FA 3E0385              +261 	lcal	ifagent_find_i_f
00:0092FB CE0301              +262 	jzb	ifagent_noosta
  :                            263 
00:0092FC 64D005              +264 	la, i	this_if:state, b
(+01)0f
00:0092FD 200447              +265 	sa	ifagent_i24:data
  :                            266 
00:0092FE 650008              +267 	la, xi	8
  :                            268 .	lb	ifostaseq
  :                            269 .	sa	10, b
(+01)0f
00:0092FF 200448              +270 	sa	ifagent_i24:seq
  :                            271 
(+01)10
00:009300 6D0446              +272 	lb, xi	ifagent_i24
  :                            273 
  :                            274 ifagent_noosta
00:009301 3D0000              +275 	fret	0
  :                            276 
  :                            277 
                                ifagent_lastc	$head_far	 params(iflcseq,	int	;
                                					iflcflags,	int	;
  :                            280 					iflcroutine,	int)
00:009302 68F003              +281 	lb	iflcseq
00:009303 3E0385              +282 	lcal	ifagent_find_i_f
00:009304 CE0309              +283 	jzb	ifagent_nolastc
  :                            284 
00:009305 64D00A              +285 	la, i	this_if:lastchange, b
(+01)0f
00:009306 20045C              +286 	sa	ifagent_t48:data
  :                            287 
  :                            288 .	lb	iflcseq
00:009307 650009              +289 	la, xi	9
  :                            290 .	sa	10, b
(+01)10
00:009308 6D045B              +291 	lb, xi	ifagent_t48
  :                            292 
  :                            293 ifagent_nolastc
00:009309 3D0000              +294 	fret	0
  :                            295 
  :                            296 
                                ifagent_ibytes	$head_far	 params(ifibytseq,	int	;
                                					ifibytflags,	int	;
  :                            299 					ifibytroutine,	int)
  :                            300 
00:00930A 68F003              +301 	lb	ifibytseq
00:00930B 3E0385              +302 	lcal	ifagent_find_i_f
00:00930C CE0312              +303 	jzb	ifagent_noibytes
  :                            304 
00:00930D 64D00C              +305 	la, i	this_if:inoctets, b
(+01)0f
00:00930E 20046A              +306 	sa	ifagent_c48:data
  :                            307 
00:00930F 65000A              +308 	la, xi	10
  :                            309 .	lb	ifibytseq
  :                            310 .	sa	10, b
(+01)0f
00:009310 20046B              +311 	sa	ifagent_c48:seq
  :                            312 
(+01)10
00:009311 6D0469              +313 	lb, xi	ifagent_c48
  :                            314 
  :                            315 ifagent_noibytes
00:009312 3D0000              +316 	fret	0
  :                            317 
  :                            318 
                                ifagent_iucast	$head_far	 params(ifiucaseq,	int	;
                                					ifiucaflags,	int	;
  :                            321 					ifiucaroutine,	int)
  :                            322 
  :                            323 
00:009313 68F003              +324 	lb	ifiucaseq
00:009314 3E0385              +325 	lcal	ifagent_find_i_f
00:009315 CE031B              +326 	jzb	ifagent_noiucast
  :                            327 
00:009316 64D010              +328 	la, i	this_if:inpackets, b
(+01)0f
00:009317 20046A              +329 	sa	ifagent_c48:data
  :                            330 
00:009318 65000B              +331 	la, xi	11
  :                            332 .	lb	ifiucaseq
  :                            333 .	sa	10, b
(+01)0f
00:009319 20046B              +334 	sa	ifagent_c48:seq
  :                            335 
(+01)10
00:00931A 6D0469              +336 	lb, xi	ifagent_c48
  :                            337 
  :                            338 ifagent_noiucast
00:00931B 3D0000              +339 	fret	0
  :                            340 
  :                            341 
                                ifagent_imcast	$head_far	 params(ifimcaseq,	int	;
                                					ifimcaflags,	int	;
  :                            344 					ifimcaroutine,	int)
  :                            345 
  :                            346 
  :                            347 
00:00931C 68F003              +348 	lb	ifimcaseq
00:00931D 3E0385              +349 	lcal	ifagent_find_i_f
00:00931E CE0324              +350 	jzb	ifagent_noimcast
  :                            351 
00:00931F 64D014              +352 	la, i	this_if:inmcast, b
(+01)0f
00:009320 20046A              +353 	sa	ifagent_c48:data
  :                            354 
00:009321 65000C              +355 	la, xi	12
  :                            356 .	lb	ifimcaseq
  :                            357 .	sa	10, b
(+01)0f
00:009322 20046B              +358 	sa	ifagent_c48:seq
  :                            359 
(+01)10
00:009323 6D0469              +360 	lb, xi	ifagent_c48
  :                            361 
  :                            362 ifagent_noimcast
00:009324 3D0000              +363 	fret	0
  :                            364 
  :                            365 
                                ifagent_idrops	$head_far	 params(ifidropseq,	int	;
                                					ifidropflags,	int	;
  :                            368 					ifidroproutine,	int)
  :                            369 
  :                            370 
00:009325 68F003              +371 	lb	ifidropseq
00:009326 3E0385              +372 	lcal	ifagent_find_i_f
00:009327 CE032D              +373 	jzb	ifagent_noidrops
  :                            374 
00:009328 64D018              +375 	la, i	this_if:indrops, b
(+01)0f
00:009329 20046A              +376 	sa	ifagent_c48:data
  :                            377 
00:00932A 65000D              +378 	la, xi	13
  :                            379 .	lb	ifidropseq
  :                            380 .	sa	10, b
(+01)0f
00:00932B 20046B              +381 	sa	ifagent_c48:seq
  :                            382 
(+01)10
00:00932C 6D0469              +383 	lb, xi	ifagent_c48
  :                            384 
  :                            385 ifagent_noidrops
00:00932D 3D0000              +386 	fret	0
  :                            387 
  :                            388 
                                ifagent_ierrs	$head_far	 params(ifierseq,	int	;
                                					ifierflags,	int	;
  :                            391 					ifierroutine,	int)
  :                            392 
  :                            393 
00:00932E 68F003              +394 	lb	ifierseq
00:00932F 3E0385              +395 	lcal	ifagent_find_i_f
00:009330 CE0336              +396 	jzb	ifagent_noierrs
  :                            397 
00:009331 64D01C              +398 	la, i	this_if:inerrs, b
(+01)0f
00:009332 20046A              +399 	sa	ifagent_c48:data
  :                            400 
00:009333 65000E              +401 	la, xi	14
  :                            402 .	lb	ifierseq
  :                            403 .	sa	10, b
(+01)0f
00:009334 20046B              +404 	sa	ifagent_c48:seq
  :                            405 
(+01)10
00:009335 6D0469              +406 	lb, xi	ifagent_c48
  :                            407 
  :                            408 ifagent_noierrs
00:009336 3D0000              +409 	fret	0
  :                            410 
  :                            411 
                                ifagent_inoproto $head_far	 params(ifinoproseq,	int	;
                                					ifinoproflags,	int	;
  :                            414 					ifinoproroutine, int)
  :                            415 
  :                            416 
00:009337 68F003              +417 	lb	ifinoproseq
00:009338 3E0385              +418 	lcal	ifagent_find_i_f
00:009339 CE033F              +419 	jzb	ifagent_noinoproto
  :                            420 
00:00933A 64D020              +421 	la, i	this_if:inoproto, b
(+01)0f
00:00933B 20046A              +422 	sa	ifagent_c48:data
  :                            423 
00:00933C 65000F              +424 	la, xi	15
  :                            425 .	lb	ifinoproseq
  :                            426 .	sa	10, b
(+01)0f
00:00933D 20046B              +427 	sa	ifagent_c48:seq
  :                            428 
(+01)10
00:00933E 6D0469              +429 	lb, xi	ifagent_c48
  :                            430 
  :                            431 ifagent_noinoproto
00:00933F 3D0000              +432 	fret	0
  :                            433 
  :                            434 
                                ifagent_obytes	$head_far	 params(ifobytseq,	int	;
                                					ifobytflags,	int	;
  :                            437 					ifobytroutine,	int)
  :                            438 
  :                            439 
00:009340 68F003              +440 	lb	ifobytseq
00:009341 3E0385              +441 	lcal	ifagent_find_i_f
00:009342 CE0348              +442 	jzb	ifagent_noobytes
  :                            443 
00:009343 64D00E              +444 	la, i	this_if:outoctets, b
(+01)0f
00:009344 20046A              +445 	sa	ifagent_c48:data
  :                            446 
00:009345 650010              +447 	la, xi	16
  :                            448 .	lb	ifobytseq
  :                            449 .	sa	10, b
(+01)0f
00:009346 20046B              +450 	sa	ifagent_c48:seq
  :                            451 
(+01)10
00:009347 6D0469              +452 	lb, xi	ifagent_c48
  :                            453 
  :                            454 ifagent_noobytes
00:009348 3D0000              +455 	fret	0
  :                            456 
  :                            457 
                                ifagent_oucast	$head_far	 params(ifoucaseq,	int	;
                                					ifoucaflags,	int	;
  :                            460 					ifoucaroutine,	int)
  :                            461 
  :                            462 
00:009349 68F003              +463 	lb	ifoucaseq
00:00934A 3E0385              +464 	lcal	ifagent_find_i_f
00:00934B CE0351              +465 	jzb	ifagent_nooucast
  :                            466 
00:00934C 64D012              +467 	la, i	this_if:outpackets, b
(+01)0f
00:00934D 20046A              +468 	sa	ifagent_c48:data
  :                            469 
00:00934E 650011              +470 	la, xi	17
  :                            471 .	lb	ifoucaseq
  :                            472 .	sa	10, b
(+01)0f
00:00934F 20046B              +473 	sa	ifagent_c48:seq
  :                            474 
(+01)10
00:009350 6D0469              +475 	lb, xi	ifagent_c48
  :                            476 
  :                            477 ifagent_nooucast
00:009351 3D0000              +478 	fret	0
  :                            479 
  :                            480 
                                ifagent_omcast	$head_far	 params(ifomcaseq,	int	;
                                					ifomcaflags,	int	;
  :                            483 					ifomcaroutine,	int)
  :                            484 
  :                            485 
00:009352 68F003              +486 	lb	ifomcaseq
00:009353 3E0385              +487 	lcal	ifagent_find_i_f
00:009354 CE035A              +488 	jzb	ifagent_noomcast
  :                            489 
00:009355 64D016              +490 	la, i	this_if:outmcast, b
(+01)0f
00:009356 20046A              +491 	sa	ifagent_c48:data
  :                            492 
00:009357 650012              +493 	la, xi	18
  :                            494 .	lb	ifomcaseq
  :                            495 .	sa	10, b
(+01)0f
00:009358 20046B              +496 	sa	ifagent_c48:seq
  :                            497 
(+01)10
00:009359 6D0469              +498 	lb, xi	ifagent_c48
  :                            499 
  :                            500 ifagent_noomcast
00:00935A 3D0000              +501 	fret	0
  :                            502 
  :                            503 
                                ifagent_odrops	$head_far	 params(ifodropseq,	int	;
                                					ifodropflags,	int	;
  :                            506 					ifodroproutine,	int)
  :                            507 
  :                            508 
  :                            509 
00:00935B 68F003              +510 	lb	ifodropseq
00:00935C 3E0385              +511 	lcal	ifagent_find_i_f
00:00935D CE0363              +512 	jzb	ifagent_noodrops
  :                            513 
00:00935E 64D01A              +514 	la, i	this_if:outdrops, b
(+01)0f
00:00935F 20046A              +515 	sa	ifagent_c48:data
  :                            516 
00:009360 650013              +517 	la, xi	19
  :                            518 .	lb	ifodropseq
  :                            519 .	sa	10, b
(+01)0f
00:009361 20046B              +520 	sa	ifagent_c48:seq
  :                            521 
(+01)10
00:009362 6D0469              +522 	lb, xi	ifagent_c48
  :                            523 
  :                            524 ifagent_noodrops
00:009363 3D0000              +525 	fret	0
  :                            526 
  :                            527 
                                ifagent_oerrs	$head_far	 params(ifoerseq,	int	;
                                					ifoerflags,	int	;
  :                            530 					ifoerroutine,	int)
  :                            531 
  :                            532 
  :                            533 
00:009364 68F003              +534 	lb	ifoerseq
00:009365 3E0385              +535 	lcal	ifagent_find_i_f
00:009366 CE036B              +536 	jzb	ifagent_nooerrs
  :                            537 
00:009367 64D01E              +538 	la, i	this_if:outerrs, b
(+01)0f
00:009368 20046A              +539 	sa	ifagent_c48:data
  :                            540 
00:009369 650014              +541 	la, xi	20
  :                            542 .	lb	ifoerseq
  :                            543 .	sa	10, b
(+01)0f
00:00936A 20046B              +544 	sa	ifagent_c48:seq
  :                            545 
  :                            546 ifagent_nooerrs
(+01)10
00:00936B 6D0469              +547 	lb, xi	ifagent_c48
  :                            548 
00:00936C 3D0000              +549 	fret	0
  :                            550 
  :                            551 
                                ifagent_oqlen	$head_far	 params(ifoqlseq,	int	;
                                					ifoqlflags,	int	;
  :                            554 					ifoqlroutine,	int)
  :                            555 
  :                            556 
00:00936D 68F003              +557 	lb	ifoqlseq
00:00936E 3E0385              +558 	lcal	ifagent_find_i_f
00:00936F CE0375              +559 	jzb	ifagent_nooqlen
  :                            560 
00:009370 64D022              +561 	la, i	this_if:oqlen, b
(+01)0f
00:009371 20046A              +562 	sa	ifagent_c48:data
  :                            563 
00:009372 650015              +564 	la, xi	21
  :                            565 .	lb	ifoqlseq
  :                            566 .	sa	10, b
(+01)0f
00:009373 20046B              +567 	sa	ifagent_c48:seq
  :                            568 
(+01)10
00:009374 6D0469              +569 	lb, xi	ifagent_c48
  :                            570 
  :                            571 ifagent_nooqlen
00:009375 3D0000              +572 	fret	0
  :                            573 
  :                            574 
                                ifagent_smib	$head_far	 params(ifsmibseq,	int	;
                                					ifsmibflags,	int	;
  :                            577 					ifsmibroutine,	int)
  :                            578 
00:009376 68F003              +579 	lb	ifsmibseq
00:009377 3E0385              +580 	lcal	ifagent_find_i_f
00:009378 CE037A              +581 	jzb	ifagent_nosmib
  :                            582 
(+01)10
00:009379 6D0470              +583 	lb, xi	ifagent_onone
  :                            584 
  :                            585 ifagent_nosmib
00:00937A 3D0000              +586 	fret	0
  :                            587 
  :                            588 ifagent_find_next_if
00:00937B 60D001              +589 	la	1, b
00:00937C C5FFF8              +590 	aa, xi	-8
00:00937D 7E0380              +591 	jc	ifagent_find_another
(+01)10
00:00937E 6D000A              +592 	lb, xi	interface(1)
00:00937F 350000              +593 	lret	0
  :                            594 
  :                            595 ifagent_find_another			. you have the instance stem
00:009380 C5FFFF              +596 	aa, xi	-1
00:009381 5E0385              +597 	jnc	ifagent_find_i_f
  :                            598 
00:009382 60D009              +599 	la	9, b			. you have the attribute tag
00:009383 44C001              +600 	lr, i	1, a			. so increment the instance stem
00:009384 B60386              +601 	j	ifagent_find
  :                            602 
  :                            603 ifagent_find_i_f
00:009385 40D009              +604 	lr	9, b
  :                            605 ifagent_find
(+01)0f
00:009386 600000              +606 	la	i_f_pointer_array
00:009387 680004              +607 	anu	r
00:009388 D80000              +607 
00:009389 5E038E              +608 	jnc	ifagent_idx_2hi
(+01)10
00:00938A 650000              +609 	la, xi	i_f_pointer_array
00:00938B C00000              +610 	aa	r
00:00938C 68C000              +611 	lb	0, a
00:00938D 350000              +612 	lret	0
  :                            613 ifagent_idx_2hi
00:00938E 650002              +614 	la, xi	SNMP_NOSUCHNAME
00:00938F 6D0000              +615 	lb, xi	0
00:009390 350000              +616 	lret	0
  :                            259: 	$include ipagent
  :                            1 
  :                            2 $(1)
  :                            3 
01:000479 000063              +4 ip_mib_i_f	+	99
01:00047A FFFFFFFFFF9D        +5 ip_mib_xnet	-	99L
  :                            6 
                                ip_mib_oaddress	mobjet	0	1	SNMP_NETWORKADDRESS	4	1	;
01:00047C 000000              +8 			0	0	ip_mib_xnet
(+01)18
01:00047D 00047A              +8 
01:00047E 000001              +8 
01:00047F 000040              +8 
01:000480 000004              +8 
01:000481 000001              +8 
01:000482 000001              +8 
  :                            9 
                                ip_mib_oifidx	mobjet	0	2	SNMP_INT		2	1	;
01:000483 000000              +11 			0	0	ip_mib_i_f
(+01)18
01:000484 000479              +11 
01:000485 000002              +11 
01:000486 000002              +11 
01:000487 000002              +11 
01:000488 000001              +11 
01:000489 000001              +11 
  :                            12 
  :                            13 
  :                            14 $(0)
                                ipagent_tabler		$head_near	 params(iptabseq,	int	;
                                						lexical_list,	int	;
                                						odynamic,	int	;
                                						iptabroutine,	int	;
  :                            19 						table_id,	int)
  :                            20 
00:009391 50F003              +21 	lx	lexical_list
00:009392 60F002              +22 	la	iptabseq			. force first table row
00:009393 68C001              +23 	lb	1, a				. when entering table sequentially
00:009394 CDFFF3              +24 	ab	-13,,xi				. oid including address?
00:009395 5E03AA              +25 	jnc	iptabler_readdress		. no, apply first table row
00:009396 68C008              +26 	lb	8, a
00:009397 B8F006              +27 	xorB	table_id			. oid addressing called table?
00:009398 DE03AA              +28 	jnzb	iptabler_readdress		. no, apply first table row
  :                            29 
00:009399 68F002              +30 	lb	iptabseq
00:00939A 60F005              +31 	la	iptabroutine
00:00939B C5FF60              +32 	aa	-SNMP_GETREQ,,xi
00:00939C D6039F              +33 	jnza	iptabler_address_along
  :                            34 
00:00939D 3E03E5              +35 	lcal	ipagent_search_exact		. get exact
00:00939E B603AD              +36 	j	iptabler_address!		. = hit or none
  :                            37 
  :                            38 iptabler_address_along
00:00939F 3E03EC              +39 	lcal	ipagent_search_forward		. get higher
00:0093A0 680002              +40 	lb	x
00:0093A1 60F002              +41 	la	iptabseq
00:0093A2 DE03AA              +42 	jnzb	iptabler_readdress
  :                            43 
00:0093A3 1FC001              +44 	dec	1, a
00:0093A4 17C00A              +45 	inc	10, a				. next subtable
00:0093A5 30C00B              +46 	z	11, a	
00:0093A6 30C00C              +47 	z	12, a
00:0093A7 30C00D              +48 	z	13, a
00:0093A8 30C00E              +49 	z	14, a
00:0093A9 B603AD              +50 	j	iptabler_noaddress
  :                            51 
  :                            52 iptabler_readdress
00:0093AA 3E03DA              +53 	lcal	ipagent_write_oid_tokens	. write address field oid
00:0093AB 60F004              +54 	la	odynamic			. low order oid knot is in mobjet
00:0093AC 28C002              +55 	sb	mo:seq, a			. whichever mobjet
  :                            56 
  :                            57 iptabler_address!				. whether a cache line is found
  :                            58 iptabler_noaddress				. or not
00:0093AD 680002              +59 	lb	x
00:0093AE 350000              +60 	$ret
  :                            61 
                                ipagent_address		$head_far	 params(ipnetseq,	int	;
                                						ipnetflags,	int	;
  :                            64 						ipnetroutine,	int	)
  :                            65 
                                	lc	ipagent_tabler	ipnetseq		;
                                				net_alexical		;
                                				ip_mib_oaddress,,xi	;
                                				ipnetroutine		;
00:0093AF FD0014              +70 				20,,xi
00:0093B0 F8F006              +70 
(+01)10
00:0093B1 FD047C              +70 
(+01)0f
00:0093B2 F8032E              +70 
00:0093B3 F8F007              +70 
00:0093B4 FCF005              +70 
00:0093B5 3E0391              +70 
00:0093B6 38000F              +70 
  :                            71 
00:0093B7 CE03BD              +72 	jzb	ipagent_noaddress
  :                            73 
00:0093B8 CFA003              +74 	dl	ifaddr:net
00:0093B9 2E0008              +75 	sbl	8
00:0093BA 360008              +76 	dsl	8
(+01)0f
00:0093BB C7047A              +77 	ds	ip_mib_xnet
(+01)10
00:0093BC 6D047C              +78 	lb	ip_mib_oaddress,,xi
  :                            79 
  :                            80 ipagent_noaddress
00:0093BD 3D0000              +81 	fret	0
  :                            82 
  :                            83 
                                ipagent_address_ifidx	$head_far	 params(ipifidxseq,	int	;
                                						ipifidxflags,	int	;
  :                            86 						ifixidxroutine,	int	)
  :                            87 
                                	lc	ipagent_tabler	ipifidxseq		;
                                				net_alexical		;
                                				ip_mib_oifidx,,xi	;
                                				ifidxroutine		;
00:0093BE FD0014              +92 				20,,xi
00:0093BF F8F006              +92 
(+01)10
00:0093C0 FD0483              +92 
(+01)0f
00:0093C1 F8032E              +92 
00:0093C2 F8F007              +92 
00:0093C3 FCF005              +92 
00:0093C4 3E0391              +92 
00:0093C5 38000F              +92 
  :                            93 
00:0093C6 CE03CA              +94 	jzb	ipagent_noifidx
  :                            95 
00:0093C7 60A002              +96 	la	ifaddr:i_f
(+01)0f
00:0093C8 200479              +97 	sa	ip_mib_i_f
(+01)10
00:0093C9 6D0483              +98 	lb	ip_mib_oifidx,,xi
  :                            99 
  :                            100 ipagent_noifidx
00:0093CA 3D0000              +101 	fret	0
  :                            102 
                                ipagent_address_netmask $head_far	 params(ipmaskseq,	int	;
                                						ipmaskflags,	int	;
  :                            105 						ipmaskroutine,	int	)
  :                            106 
  :                            107 
                                	lc	ipagent_tabler	ipmaskseq		;
                                				net_alexical		;
                                				ip_mib_oaddress,,xi	;
                                				ipmaskroutine		;
00:0093CB FD0014              +112 				20,,xi
00:0093CC F8F006              +112 
(+01)10
00:0093CD FD047C              +112 
(+01)0f
00:0093CE F8032E              +112 
00:0093CF F8F007              +112 
00:0093D0 FCF005              +112 
00:0093D1 3E0391              +112 
00:0093D2 38000F              +112 
  :                            113 
00:0093D3 CE03D9              +114 	jzb	ipagent_nomask
  :                            115 
00:0093D4 CFA005              +116 	dl	ifaddr:mask
00:0093D5 2E0008              +117 	sbl	8
00:0093D6 360008              +118 	dsl	8
(+01)0f
00:0093D7 C7047A              +119 	ds	ip_mib_xnet
(+01)10
00:0093D8 6D047C              +120 	lb	ip_mib_oaddress,,xi
  :                            121 
  :                            122 ipagent_nomask
00:0093D9 3D0000              +123 	fret	0
  :                            124 
  :                            125 
  :                            126 	$if	BROADCAST_AND_MAXREASM
  :                            127 
                                ipagent_address_broadcast $head_far	 params(ipbcastseq,	int	;
                                						ipbcastflags,	int	;
  :                            130 						ipbcastroutine,	int	)
  :                            131 
                                	lc	ipagent_tabler	ipbcastseq		net_alexical	;
  :                            133 				ip_mib_oaddress,,xi	ipbcastroutine	20,,xi
  :                            134 	jzb	ipagent_nobcast
  :                            135 
  :                            136 	dl	ifaddr:broadcast
  :                            137 	sbl	8
  :                            138 	dsl	8
  :                            139 	ds	ip_mib_xnet
  :                            140 	lb	ip_mib_oaddress,,xi
  :                            141 
  :                            142 ipagent_nobcast
  :                            143 	fret	0
  :                            144 
                                ipagent_address_maxreasm $head_far	 params(iprasmseq,	int	;
                                						iprasmflags,	int	;
  :                            147 						iprasmroutine,	int	)
  :                            148 
                                	lc	ipagent_tabler	iprasmseq		net_alexical	;
  :                            150 				ip_mib_oifidx,,xi	iprasmroutine	20,,xi
  :                            151 	jzb	ipagent_norasm
  :                            152 
  :                            153 	la	16384,,xi
  :                            154 	sa	ip_mib_i_f
  :                            155 	lb	ip_mib_oifidx,,xi
  :                            156 
  :                            157 ipagent_norasm
  :                            158 	fret	0
  :                            159 
  :                            160 	$endif			. BROADCAST_AND_MAXREASM
  :                            161 
  :                            162 ipagent_write_oid_tokens
00:0093DA 5CC00B              +163 	ly	11, a, i	. input / output oid + 11
00:0093DB CFA003              +164 	dl	ifaddr:net
  :                            165 
  :                            166 ipagent_write2oid		. input is 00nnnn:00nnnn
00:0093DC F80005              +167 	push	b
00:0093DD 160008              +168 	dsr	8
00:0093DE 0E0010              +169 	sbr	16
00:0093DF C7B000              +170 	ds	0, y
00:0093E0 380004              +171 	pop	a
00:0093E1 160008              +172 	dsr	8
00:0093E2 0E0010              +173 	sbr	16
00:0093E3 C7B002              +174 	ds	2, y
00:0093E4 350000              +175 	lret	0
  :                            176 
  :                            177 ipagent_search_exact
00:0093E5 5CD00B              +178 	ly	11, b, i
  :                            179 
  :                            180 ipagent_search_id
00:0093E6 3E03FE              +181 	lcal	ipagent_seek
00:0093E7 700002              +182 	tz	x
00:0093E8 7C03EB              +183 	jdz	ipagent_exact
00:0093E9 550000              +184 	lx	0,,xi		. already zero or encountered > argument
00:0093EA 350000              +185 	lret	0		. x -> none at all
  :                            186 
  :                            187 ipagent_exact
00:0093EB 350000              +188 	lret	0		. x -> correct
  :                            189 
  :                            190 ipagent_search_forward
00:0093EC 5CD00B              +191 	ly	11, b, i
  :                            192 
  :                            193 ipagent_search_nextid
00:0093ED 3E03FE              +194 	lcal	ipagent_seek
00:0093EE 700002              +195 	tz	x
00:0093EF 7C03F1              +196 	jdz	ipagent_1more	. found equal
  :                            197 
00:0093F0 350000              +198 	lret	0		. x -> higher or none at all
  :                            199 
  :                            200 ipagent_1more
00:0093F1 50A001              +201 	lx	ifaddr:lexical	. higher or none at all
00:0093F2 350000              +202 	lret	0
  :                            203 
  :                            204 ipagent_readoid2netform
00:0093F3 CFB000              +205 	dl	0, y		. get 00.00.aa : 00.00.bb from oid
00:0093F4 2E0010              +206 	sbl	16		
00:0093F5 360008              +207 	dsl	8		. 00.aa.bb
00:0093F6 68B002              +208 	lb	2, y
00:0093F7 2E0010              +209 	sbl	16
00:0093F8 360008              +210 	dsl	8		. aa.bb.cc
00:0093F9 68B003              +211 	lb	3, y
00:0093FA 2E0010              +212 	sbl	16		. aa.bb.cc.dd.00.00
00:0093FB 160008              +213 	dsr	8
00:0093FC 0E0008              +214 	sbr	8		. 00.aa.bb.00.cc.dd
00:0093FD 350000              +215 	lret	0
  :                            216 
  :                            217 ipagent_seek
00:0093FE 3E03F3              +218 	lcal	ipagent_readoid2netform
  :                            219 .	lx	net_alexical
00:0093FF C70006              +220 	ds	6
00:009400 B60405              +221 	j	ipagent_seek_nane?
  :                            222 
  :                            223 ipagent_seek_next
00:009401 CFA003              +224 	dl	ifaddr:net
00:009402 DF0006              +225 	dan	6
00:009403 7E0407              +226 	jc	ipagent_find_ge
  :                            227 
00:009404 50A001              +228 	lx	ifaddr:lexical
  :                            229 
  :                            230 ipagent_seek_nane?
00:009405 700002              +231 	tz	x
00:009406 B60401              +232 	j	ipagent_seek_next
  :                            233 
  :                            234 ipagent_find_ge
00:009407 350000              +235 	lret	0
  :                            236 
  :                            260: 	$include roagent
  :                            1 
  :                            2 $(1)
  :                            3 
01:00048A 000063              +4 ipromib_i_f	+	99
01:00048B FFFFFFFFFF9D        +5 ipromib_xnet	-	99L
  :                            6 
                                ipromib_oaddress mobjet 0	1	SNMP_NETWORKADDRESS	4	1	;
01:00048D 000000              +8 			0	0	ipromib_xnet
(+01)18
01:00048E 00048B              +8 
01:00048F 000001              +8 
01:000490 000040              +8 
01:000491 000004              +8 
01:000492 000001              +8 
01:000493 000001              +8 
  :                            9 
                                ipromib_oifidx	mobjet	0	2	SNMP_INT		2	1	;
01:000494 000000              +11 			0	0	ipromib_i_f
(+01)18
01:000495 00048A              +11 
01:000496 000002              +11 
01:000497 000002              +11 
01:000498 000002              +11 
01:000499 000001              +11 
01:00049A 000001              +11 
  :                            12 
  :                            13 
  :                            14 $(0)
  :                            15 
                                ipagent_route_dest	$head_far	 params(ipronetseq,	int	;
                                						ipronetflags,	int	;
  :                            18 						ipronetroutine,	int	)
  :                            19 
                                	lc	ipagent_tabler	ipronetseq		;
                                				route_lexical		;
                                				ipromib_oaddress,,xi	;
                                				ipronetroutine		;
00:009408 FD0015              +24 				21,,xi
00:009409 F8F006              +24 
(+01)10
00:00940A FD048D              +24 
(+01)0f
00:00940B F8023C              +24 
00:00940C F8F007              +24 
00:00940D FCF005              +24 
00:00940E 3E0391              +24 
00:00940F 38000F              +24 
  :                            25 
00:009410 CE0416              +26 	jzb	ipagent_route_nodest
  :                            27 
00:009411 CFA003              +28 	dl	ro:net
00:009412 2E0008              +29 	sbl	8
00:009413 360008              +30 	dsl	8
(+01)0f
00:009414 C7048B              +31 	ds	ipromib_xnet
(+01)10
00:009415 6D048D              +32 	lb	ipromib_oaddress,,xi
  :                            33 
  :                            34 ipagent_route_nodest
00:009416 3D0000              +35 	fret	0
  :                            36 
  :                            37 
                                ipagent_route_ifidx	$head_far	 params(iproifidxseq,	int	;
                                						iproifidxflags,	int	;
  :                            40 						roifidxroutine,	int	)
  :                            41 
                                	lc	ipagent_tabler	iproifidxseq		;
                                				route_lexical		;
                                				ipromib_oifidx,,xi	;
                                				roifidxroutine		;
00:009417 FD0015              +46 				21,,xi
00:009418 F8F006              +46 
(+01)10
00:009419 FD0494              +46 
(+01)0f
00:00941A F8023C              +46 
00:00941B F8F007              +46 
00:00941C FCF005              +46 
00:00941D 3E0391              +46 
00:00941E 38000F              +46 
  :                            47 
00:00941F CE0424              +48 	jzb	ipagent_route_noifidx
  :                            49 
00:009420 60A002              +50 	la	ro:i_f
00:009421 A57FFF              +51 	and	07FFF,,xi
(+01)0f
00:009422 20048A              +52 	sa	ipromib_i_f
(+01)10
00:009423 6D0494              +53 	lb	ipromib_oifidx,,xi
  :                            54 
  :                            55 ipagent_route_noifidx
00:009424 3D0000              +56 	fret	0
  :                            57 
                                ipagent_route_mask $head_far	 params(ipromaskseq,	int	;
                                					ipromaskflags,	int	;
  :                            60 					ipromaskroutine,	int	)
  :                            61 
  :                            62 
                                	lc	ipagent_tabler	ipromaskseq		;
                                				route_lexical		;
                                				ipromib_oaddress,,xi	;
                                				ipromaskroutine		;
00:009425 FD0015              +67 				21,,xi
00:009426 F8F006              +67 
(+01)10
00:009427 FD048D              +67 
(+01)0f
00:009428 F8023C              +67 
00:009429 F8F007              +67 
00:00942A FCF005              +67 
00:00942B 3E0391              +67 
00:00942C 38000F              +67 
  :                            68 
00:00942D CE0433              +69 	jzb	ipagent_route_nomask
  :                            70 
00:00942E CFA005              +71 	dl	ro:mask
00:00942F 2E0008              +72 	sbl	8
00:009430 360008              +73 	dsl	8
(+01)0f
00:009431 C7048B              +74 	ds	ipromib_xnet
(+01)10
00:009432 6D048D              +75 	lb	ipromib_oaddress,,xi
  :                            76 
  :                            77 ipagent_route_nomask
00:009433 3D0000              +78 	fret	0
  :                            79 
  :                            80 
  :                            81 
                                ipagent_route_next_hop	$head_far	 params(iprohopseq,	int	;
                                						iprohopflags,	int	;
  :                            84 						iprohoproutine,	int	)
  :                            85 
                                	lc	ipagent_tabler	iprohopseq		;
                                				route_lexical		;
                                				ipromib_oaddress,,xi	;
                                				iprohoproutine		;
00:009434 FD0015              +90 				21,,xi
00:009435 F8F006              +90 
(+01)10
00:009436 FD048D              +90 
(+01)0f
00:009437 F8023C              +90 
00:009438 F8F007              +90 
00:009439 FCF005              +90 
00:00943A 3E0391              +90 
00:00943B 38000F              +90 
  :                            91 
00:00943C CE0442              +92 	jzb	ipagent_route_nonext_hop
  :                            93 
00:00943D CFA007              +94 	dl	ro:next_hop
00:00943E 2E0008              +95 	sbl	8
00:00943F 360008              +96 	dsl	8
(+01)0f
00:009440 C7048B              +97 	ds	ipromib_xnet
(+01)10
00:009441 6D048D              +98 	lb	ipromib_oaddress,,xi
  :                            99 
  :                            100 ipagent_route_nonext_hop
00:009442 3D0000              +101 	fret	0
  :                            102 
                                ipagent_route_type $head_far	 params(iprotypseq,	int	;
                                					iprotypflags,	int	;
  :                            105 					iprotyproutine,	int	)
  :                            106 
                                	lc	ipagent_tabler	iprotypseq		;
                                				route_lexical		;
                                				ipromib_oifidx,,xi	;
                                				iprotyproutine		;
00:009443 FD0015              +111 				21,,xi
00:009444 F8F006              +111 
(+01)10
00:009445 FD0494              +111 
(+01)0f
00:009446 F8023C              +111 
00:009447 F8F007              +111 
00:009448 FCF005              +111 
00:009449 3E0391              +111 
00:00944A 38000F              +111 
  :                            112 
00:00944B CE0451              +113 	jzb	ipagent_route_notype
  :                            114 
00:00944C 60A002              +115 	la	ro:i_f
00:00944D 060017              +116 	sar	23			. indirect flag
00:00944E 64C003              +117 	la	3, a, i			. make it 3 or 4
(+01)0f
00:00944F 20048A              +118 	sa	ipromib_i_f
(+01)10
00:009450 6D0494              +119 	lb	ipromib_oifidx,,xi
  :                            120 
  :                            121 ipagent_route_notype
00:009451 3D0000              +122 	fret	0
  :                            123 
  :                            261: 	$include tcpagent
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 TCP_MIB		$equ	4096/24*2-2
  :                            41 
  :                            42 $(1)
01:00049B 000000              +43 tcp_mib_chain	+	0
01:00049C 000000              +44 tcp_mib_free	+	0
(+03)18
01:00049D 0024CD              +45 tcp_mib_high	+	tcp_mib
  :                            46 
                                tcp_mib_ostat	mobjet	0	1	SNMP_INT		3	1	;
01:00049E 000000              +48 			0	0	tcp_mib_xstate
(+01)18
01:00049F 0004B3              +48 
01:0004A0 000001              +48 
01:0004A1 000002              +48 
01:0004A2 000003              +48 
01:0004A3 000001              +48 
01:0004A4 000001              +48 
  :                            49 
                                tcp_mib_oneta	mobjet	0	2	SNMP_NETWORKADDRESS	4	1	;
01:0004A5 000000              +51 			0	0	tcp_mib_xnet
(+01)18
01:0004A6 0004B4              +51 
01:0004A7 000002              +51 
01:0004A8 000040              +51 
01:0004A9 000004              +51 
01:0004AA 000001              +51 
01:0004AB 000001              +51 
  :                            52 
                                tcp_mib_oport	mobjet	0	4	SNMP_INT		2	1	;
01:0004AC 000000              +54 			0	0	tcp_mib_xnet+1
(+01)18
01:0004AD 0004B5              +54 
01:0004AE 000004              +54 
01:0004AF 000002              +54 
01:0004B0 000002              +54 
01:0004B1 000001              +54 
01:0004B2 000001              +54 
  :                            55 
01:0004B3 000063              +56 tcp_mib_xstate	+	99
01:0004B4 FFFFFFFFFF9D        +57 tcp_mib_xnet	-	99:d
  :                            58 
  :                            59 $(3)
  :                            60 tcp_mib		$res	TCP_MIB
  :                            61 
  :                            62 .	this is done with a wrapper because 
  :                            63 .	few connections are MIB-visible and 
  :                            64 .	density requires that they don't all
  :                            65 .	have a lexical-order chain pointer
  :                            66 .	as well as a hash link
  :                            67 
  :                            68 .	the new connection pointer is x
  :                            69 
  :                            70 
  :                            71 $(0)
  :                            72 
  :                            73 tcpagent_add
(+01)0f
00:009452 60049C              +74 	la	tcp_mib_free
00:009453 C60457              +75 	jza	tcp_agent_add_new
00:009454 F8C000              +76 	push	0, a
(+01)0f
00:009455 38049C              +77 	pop	tcp_mib_free
00:009456 B6045D              +78 	j	tcpagent_add_assigned
  :                            79 
  :                            80 tcp_agent_add_new
(+01)0f
00:009457 60049D              +81 	la	tcp_mib_high
00:009458 680004              +82 	anu, xi	tcp_mib+TCP_MIB
(+03)10
00:009459 DD261F              +82 
00:00945A 7E046E              +83 	jc	tcpagent_add_x
00:00945B 44C002              +84 	lr, i	2, a
(+01)0f
00:00945C 00049D              +85 	sr	tcp_mib_high
  :                            86 
  :                            87 tcpagent_add_assigned		. the wrapper is assigned
00:00945D 10C001              +88 	sx	1, a		. the connection is wrapped
  :                            89 
00:00945E 400004              +90 	lr	a
00:00945F 4FA006              +91 	ql	transmission:socket_address
00:009460 470008              +92 	qs	8
  :                            93 
00:009461 3E0507              +94 	lcal	tcpagent_search
00:009462 700003              +95 	tz	y		. add on the end?
00:009463 7C0469              +96 	jdz	tcpagent_add_nop . it seeems to be there
  :                            97 				. already
00:009464 00A000              +98 	sr	0, x		. next after before
00:009465 600000              +99 	la	r
00:009466 18C000              +100 	sy	0, a
00:009467 50C001              +101 	lx	1, a		. restore the connection
00:009468 3D0000              +102 	fret	0		. pointer
  :                            103 
  :                            104 tcpagent_add_nop		. listed already
00:009469 600000              +105 	la	r
00:00946A 50C001              +106 	lx	1, a		. restore the connection *
(+01)0f
00:00946B F8049C              +107 	push	tcp_mib_free	. give the wrapper back
00:00946C 38C000              +108 	pop	0, a
(+01)0f
00:00946D 20049C              +109 	sa	tcp_mib_free
  :                            110 tcpagent_add_x
00:00946E 3D0000              +111 	fret	0
  :                            112 
  :                            113 
  :                            114 tcpagent_free
00:00946F F80003              +115 	push	y
00:009470 F80005              +116 	push	b
(+01)10
00:009471 6D049B              +117 	lb, xi	tcp_mib_chain
  :                            118 
  :                            119 tcpagent_free_search
00:009472 580005              +120 	ly	b
00:009473 68D000              +121 	lb	0, b
00:009474 CE047D              +122 	jzb	tcpagent_free_nop
00:009475 60D001              +123 	la	1, b
00:009476 D00002              +124 	ana	x
00:009477 D60472              +125 	jnza	tcpagent_free_search
00:009478 F8D000              +126 	push	0, b
00:009479 38B000              +127 	pop	0, y
  :                            128 
(+01)0f
00:00947A F8049C              +129 	push	tcp_mib_free
00:00947B 38D000              +130 	pop	0, b
(+01)0f
00:00947C 28049C              +131 	sb	tcp_mib_free
  :                            132 tcpagent_free_nop
00:00947D 380005              +133 	pop	b
00:00947E 380003              +134 	pop	y
00:00947F 3D0000              +135 	fret	0
  :                            136 
                                tcpagent_state	$head_far	 params(taseq,		int	;
                                					taflags,	int	;
  :                            139 					taroutine,	int)
  :                            140 
00:009480 602185              +141 	la	tcx_v4(1)
00:009481 34002F              +142 	sabr	BSOCKET
  :                            143 
00:009482 68F003              +144 	lb	taseq
00:009483 60F005              +145 	la	taroutine
00:009484 D500A0              +146 	ana,xi	SNMP_GETREQ
00:009485 D60489              +147 	jnza	tcpagent_state_along
  :                            148 
00:009486 3E04D7              +149 	lcal	tcpagent_search_exact
00:009487 CE0491              +150 	jzb	tcpagent_nostate
00:009488 B6048E              +151 	j	tcpagent_state!
  :                            152 
  :                            153 tcpagent_state_along
00:009489 3E04E3              +154 	lcal	tcpagent_search_forward
00:00948A CE0491              +155 	jzb	tcpagent_nostate
  :                            156 
00:00948B 500005              +157 	lx	b
00:00948C 60F003              +158 	la	taseq
  :                            159 
00:00948D 3E0492              +160 	lcal	tcpagent_write_oid_tokens
  :                            161 
  :                            162 tcpagent_state!
00:00948E 60D001              +163 	la	transmission:state, b
(+01)0f
00:00948F 2004B3              +164 	sa	tcp_mib_xstate
  :                            165 
(+01)10
00:009490 6D049E              +166 	lb, xi	tcp_mib_ostat
  :                            167 tcpagent_nostate
00:009491 3D0000              +168 	fret	0
  :                            169 	
  :                            170 tcpagent_write_oid_tokens
00:009492 F80005              +171 	push	b
00:009493 F80003              +172 	push	y
  :                            173 
00:009494 5CC009              +174 	ly, i	9, a
00:009495 CFA006              +175 	dl	transmission:socket_address
00:009496 3E049D              +176 	lcal	tcpagent_write_address
  :                            177 
00:009497 CFA008              +178 	dl	transmission:remote_address
00:009498 5CB005              +179 	ly, i	5, y
00:009499 3E049D              +180 	lcal	tcpagent_write_address
  :                            181 	
00:00949A 380003              +182 	pop	y
00:00949B 380005              +183 	pop	b
  :                            184 
00:00949C 350000              +185 	lret	0
  :                            186 
  :                            187 tcpagent_write_address		. distribute the address
00:00949D 9F0004              +188 	dpush	a		. into 5 tokens pre-BER
00:00949E 160010              +189 	dsr	16
00:00949F 0E0010              +190 	sbr	16
00:0094A0 C7B000              +191 	ds	0, y
00:0094A1 380004              +192 	pop	a
00:0094A2 A500FF              +193 	and, xi	255
00:0094A3 20B002              +194 	sa	2, y
00:0094A4 380004              +195 	pop	a
00:0094A5 160010              +196 	dsr	16
00:0094A6 0E0008              +197 	sbr	8
00:0094A7 C7B003              +198 	ds	3, y
00:0094A8 350000              +199 	lret	0
  :                            200 
                                tcpagent_neta	$head_far	 params(tanseq,		int	;
                                					tanflags,	int	;
  :                            203 					tanroutine,	int)
  :                            204 
  :                            205 
00:0094A9 602185              +206         la      tcx_v4(1)
00:0094AA 34002F              +207         sabr    BSOCKET
  :                            208 
00:0094AB 68F003              +209 	lb	tanseq
00:0094AC 3E04D7              +210 	lcal	tcpagent_search_exact
00:0094AD CE04B3              +211 	jzb	tcpagent_noneta
  :                            212 
00:0094AE CFD006              +213 	dl	transmission:socket_address, b
(+01)0f
00:0094AF C704B4              +214 	ds	tcp_mib_xnet
  :                            215 
00:0094B0 650002              +216 	la, xi	2
(+01)0f
00:0094B1 2004A7              +217 	sa	tcp_mib_oneta:seq
  :                            218 
(+01)10
00:0094B2 6D04A5              +219 	lb, xi	tcp_mib_oneta
  :                            220 
  :                            221 tcpagent_noneta
00:0094B3 3D0000              +222 	fret	0
  :                            223 
                                tcpagent_port	$head_far	 params(tapseq,		int	;
                                					tapflags,	int	;
  :                            226 					taproutine,	int)
  :                            227 
  :                            228 
00:0094B4 602185              +229         la      tcx_v4(1)
00:0094B5 34002F              +230         sabr    BSOCKET
  :                            231 
00:0094B6 68F003              +232 	lb	tapseq
00:0094B7 3E04D7              +233 	lcal	tcpagent_search_exact
00:0094B8 CE04BF              +234 	jzb	tcpagent_noport
  :                            235 
00:0094B9 CFD006              +236 	dl	transmission:socket_address, b
00:0094BA A80A4F              +237 	andB	(65535)
(+01)0f
00:0094BB C704B4              +238 	ds	tcp_mib_xnet
  :                            239 
00:0094BC 650003              +240 	la, xi	3
(+01)0f
00:0094BD 2004AE              +241 	sa	tcp_mib_oport:seq
  :                            242 
(+01)10
00:0094BE 6D04AC              +243 	lb, xi	tcp_mib_oport
  :                            244 
  :                            245 tcpagent_noport
00:0094BF 3D0000              +246 	fret	0
  :                            247 
  :                            248 
  :                            249 
                                tcpagent_neta_remote	$head_far	 params(tanrseq,	int	;
                                						tanrflags,	int	;
  :                            252 						tanrroutine,	int)
  :                            253 
  :                            254 
00:0094C0 602185              +255         la      tcx_v4(1)
00:0094C1 34002F              +256         sabr    BSOCKET
  :                            257 
00:0094C2 68F003              +258 	lb	tanrseq
00:0094C3 3E04D7              +259 	lcal	tcpagent_search_exact
00:0094C4 CE04CA              +260 	jzb	tcpagent_noneta_remote
  :                            261 
00:0094C5 CFD008              +262 	dl	transmission:remote_address, b
(+01)0f
00:0094C6 C704B4              +263 	ds	tcp_mib_xnet
  :                            264 
00:0094C7 650004              +265 	la, xi	4
(+01)0f
00:0094C8 2004A7              +266 	sa	tcp_mib_oneta:seq
  :                            267 
(+01)10
00:0094C9 6D04A5              +268 	lb, xi	tcp_mib_oneta
  :                            269 
  :                            270 tcpagent_noneta_remote
00:0094CA 3D0000              +271 	fret	0
  :                            272 
                                tcpagent_port_remote	$head_far	 params(taprseq,	int	;
                                						taprflags,	int	;
  :                            275 						taprroutine,	int)
  :                            276 
00:0094CB 602185              +277         la      tcx_v4(1)
00:0094CC 34002F              +278         sabr    BSOCKET
  :                            279 
  :                            280 
00:0094CD 68F003              +281 	lb	taprseq
00:0094CE 3E04D7              +282 	lcal	tcpagent_search_exact
00:0094CF CE04D6              +283 	jzb	tcpagent_noport_remote
  :                            284 
00:0094D0 CFD008              +285 	dl	transmission:remote_address, b
00:0094D1 A80A4F              +286 	andB	(65535)
(+01)0f
00:0094D2 C704B4              +287 	ds	tcp_mib_xnet
  :                            288 
00:0094D3 650005              +289 	la, xi	5
(+01)0f
00:0094D4 2004AE              +290 	sa	tcp_mib_oport:seq
  :                            291 
(+01)10
00:0094D5 6D04AC              +292 	lb, xi	tcp_mib_oport
  :                            293 
  :                            294 tcpagent_noport_remote
00:0094D6 3D0000              +295 	fret	0
  :                            296 
  :                            297 
  :                            298 tcpagent_search_exact
00:0094D7 8F0008              +299 	qpush	8
00:0094D8 3E0517              +300 	lcal	tcpagent_compress_tokens
00:0094D9 3E0507              +301 	lcal	tcpagent_search
00:0094DA 870008              +302 	qpop	8
  :                            303 
00:0094DB 700003              +304 	tz	y
00:0094DC 7C04E0              +305 	jdz	tcpagent_find
  :                            306 
  :                            307 tcpagent_runout
00:0094DD 6D0000              +308 	lb, xi	0
00:0094DE 650002              +309 	la, xi	SNMP_NOSUCHNAME
00:0094DF 350000              +310 	lret	0
  :                            311 
  :                            312 tcpagent_find
00:0094E0 68B001              +313 	lb	1, y
00:0094E1 650000              +314 	la, xi	0
00:0094E2 350000              +315 	lret	0
  :                            316 
  :                            317 tcpagent_search_forward
00:0094E3 60D001              +318 	la	1, b	. < 8 tokens = front of list 
00:0094E4 C5FFF8              +319 	aa, xi	-8	. 8..17 tokens means row
  :                            320 			.	          or row after
  :                            321 			. 18 tokens means row after
  :                            322 
00:0094E5 7E04EA              +323 	jc	tcpagent_search_on
(+01)0f
00:0094E6 58049B              +324 	ly	tcp_mib_chain
00:0094E7 700003              +325 	tz	y
00:0094E8 B604E0              +326 	j	tcpagent_find
00:0094E9 B604DD              +327 	j	tcpagent_runout
  :                            328 
  :                            329 tcpagent_search_on	. 8 or more tokens
00:0094EA C5FFF6              +330 	aa, xi	-10
00:0094EB 7E04FA              +331 	jc	tcpagent_search_higher
  :                            332 	
00:0094EC 58D001              +333 	ly	1, b	. oid length @ oid + 1
00:0094ED 8CD002              +334 	ay, i	2, b	. zero the unsupplied tokens
  :                            335 tcpagent_zerof
00:0094EE C50001              +336 	aa, xi	1
00:0094EF 7E04F3              +337 	jc	tcpagent_search_as_high
00:0094F0 30B000              +338 	z	0, y
00:0094F1 5CB001              +339 	ly, i	1, y
00:0094F2 B604EE              +340 	j	tcpagent_zerof
  :                            341 
  :                            342 tcpagent_search_as_high
00:0094F3 8F0008              +343 	qpush	8
00:0094F4 3E0517              +344 	lcal	tcpagent_compress_tokens
00:0094F5 3E0507              +345 	lcal	tcpagent_search
00:0094F6 870008              +346 	qpop	8
  :                            347 
00:0094F7 700003              +348 	tz	y
00:0094F8 B604E0              +349 	j	tcpagent_find	. found equal or higher = OK
00:0094F9 B604DD              +350 	j	tcpagent_runout	. found lower or none
  :                            351 
  :                            352 tcpagent_search_higher
00:0094FA 8F0008              +353 	qpush	8
00:0094FB 3E0517              +354 	lcal	tcpagent_compress_tokens
00:0094FC 3E0507              +355 	lcal	tcpagent_search
00:0094FD 870008              +356 	qpop	8
  :                            357 
00:0094FE 700003              +358 	tz	y
00:0094FF B60501              +359 	j	$+2
00:009500 B604DD              +360 	j	tcpagent_runout	. found lower or none
00:009501 7C0503              +361 	jdz	$+2		. found equal
00:009502 B604E0              +362 	j	tcpagent_find	. found higher = OK
00:009503 58B000              +363 	ly	0, y		. next
00:009504 700003              +364 	tz	y
00:009505 B604E0              +365 	j	tcpagent_find	. found higher = OK
00:009506 B604DD              +366 	j	tcpagent_runout	
  :                            367 
  :                            368 
  :                            369 tcpagent_search
(+01)10
00:009507 5D049B              +370 	ly, xi	tcp_mib_chain
  :                            371 
  :                            372 tcpagent_search_next	. seach until the connection
00:009508 500003              +373 	lx	y	. in the list is not <
00:009509 58B000              +374 	ly	0, y	. then decide if what you got
  :                            375 			. is what you wanted
00:00950A 700003              +376 	tz	y
00:00950B B6050D              +377 	j	tcpagent_test_local
00:00950C 350000              +378 	lret	0
  :                            379 
  :                            380 tcpagent_test_local
00:00950D 60B001              +381 	la	1, y
00:00950E 4FC006              +382 	ql	transmission:socket_address, a
00:00950F DF0008              +383 	dan	8
00:009510 5E0508              +384 	jnc	tcpagent_search_next
00:009511 7C0513              +385 	jdz	tcpagent_test_remote
00:009512 350000              +386 	lret	0	. connection in list is >
  :                            387 tcpagent_test_remote
00:009513 CF0006              +388 	dl	6
00:009514 DF000A              +389 	dan	10
00:009515 5E0508              +390 	jnc	tcpagent_search_next
00:009516 350000              +391 	lret	0
  :                            392 	
  :                            393 
  :                            394 
  :                            395 tcpagent_compress_tokens
00:009517 480A4F              +396 	lk	(00FFFF)
00:009518 5CD009              +397 	ly, i	9, b
00:009519 3E051F              +398 	lcal	tcpagent_compress_address
00:00951A 5CB005              +399 	ly, i	5, y
00:00951B C70008              +400 	ds	8
00:00951C 3E051F              +401 	lcal	tcpagent_compress_address
00:00951D C7000A              +402 	ds	10
00:00951E 350000              +403 	lret	0
  :                            404 
  :                            405 tcpagent_compress_address
00:00951F CFB000              +406 	dl	0, y
00:009520 2E0010              +407 	sbl	16
00:009521 360008              +408 	dsl	8
00:009522 68B002              +409 	lb	2, y
00:009523 2E0010              +410 	sbl	16
00:009524 360008              +411 	dsl	8
00:009525 68B003              +412 	lb	3, y
00:009526 2E0010              +413 	sbl	16
00:009527 BFB004              +414 	mlb	4, y
00:009528 350000              +415 	lret	0
  :                            262: 	$include tcpagen2
  :                            1 
  :                            2 
  :                            3 $(1)
  :                            4 
                                tco_total_o	mobjet	0	9	SNMP_GAUGE.6	6	;
01:0004B6 000000              +6 			1	0	0	tco_total_i
(+01)18
01:0004B7 0004BD              +6 
01:0004B8 000009              +6 
01:0004B9 000042              +6 
01:0004BA 000006              +6 
01:0004BB 000001              +6 
01:0004BC 000001              +6 
  :                            7 
  :                            8 
01:0004BD 000000000000        +9 tco_total_i	0L
  :                            10 
  :                            11 $(0)
  :                            12 
  :                            13 tcpagent_established $tree
  :                            14 
00:009529 054000              +15 	on	see$1
00:00952A F8106F              +16 	push	ABT+BSOCKET
00:00952B 0D4000              +17 	off	see$1				. save socket page
  :                            18 
00:00952C 3E0533              +19 	lcal	accumulate
(+01)0f
00:00952D C704BD              +20 	ds	tco_total_i
  :                            21 
00:00952E 380004              +22 	pop	a
00:00952F 34002F              +23 	sabr	BSOCKET				. rebase socket page
  :                            24 
00:009530 650000              +25 	la	0,,xi
(+01)10
00:009531 6D04B6              +26 	lb	tco_total_o,,xi
00:009532 3D0000              +27 	fret	0
  :                            28 
  :                            29 accumulate
00:009533 300007              +30 	z	7
00:009534 300006              +31 	z	6
00:009535 602185              +32 	la	tcx_v4(1)
00:009536 500A53              +33 	lx	(BSOCKET*/18++028:s)		. 1st table starts @ + 40
  :                            34 
00:009537 34002F              +35 nextp	sabr	BSOCKET
00:009538 408A54              +36 	lr	*(BSOCKET*/18++tlist:top:s)	. all tables end where they end
  :                            37 
00:009539 F60544              +38 nextc	jxge	along				. possibly before they start
  :                            39 
00:00953A 60A001              +40 	la	transmission:state
00:00953B C5FFFB              +41 	aa	-TCP_ESTABLISHED,,xi
00:00953C C6053F              +42 	jza	upcount
00:00953D C5FFF8              +43 	aa	-TCP_CLOSEWAIT,,xi
00:00953E D60542              +44 	jnza	next
  :                            45 
00:00953F 6D0001              +46 upcount	lb	1,,xi				. 000000 000001 -> [ a b ]
00:009540 D70006              +47 	da	6
00:009541 C70006              +48 	ds	6
  :                            49 
00:009542 850018              +50 next	ax	24,,xi				. next connection
00:009543 B60539              +51 	j	nextc
  :                            52 
00:009544 608A55              +53 along	la	*(BSOCKET*/18++tlist:link:s)	. next table
00:009545 500A56              +54 	lx	(BSOCKET*/18++040:s)	. tables after 1st start @ + 64
00:009546 D60537              +55 	jnza	nextp
  :                            56 
00:009547 CF0006              +57 	dl	6
00:009548 350000              +58 	lret	0
  :                            59 
  :                            60 	$root
  :                            263: 	$include idragent
  :                            1 $(1)
  :                            2 
01:0004BF 000063              +3 inetcidr_gauge	+	99
01:0004C0 FFFFFFFFFF9D        +4 inetcidr_xnet	-	99L
  :                            5 
                                inetcidr_ogauge	mobjet	0	0	SNMP_GAUGE	3	1	;
01:0004C2 000000              +7 			0	0	inetcidr_gauge
(+01)18
01:0004C3 0004BF              +7 
01:0004C4 000000              +7 
01:0004C5 000042              +7 
01:0004C6 000003              +7 
01:0004C7 000001              +7 
01:0004C8 000001              +7 
  :                            8 
                                inetcidr_oaddress mobjet 0	0	SNMP_STRING	4	1	;
01:0004C9 000000              +10 			0	0	inetcidr_xnet
(+01)18
01:0004CA 0004C0              +10 
01:0004CB 000000              +10 
01:0004CC 000004              +10 
01:0004CD 000004              +10 
01:0004CE 000001              +10 
01:0004CF 000001              +10 
  :                            11 
  :                            12 $(0)
  :                            13 
                                ipagent_cidr_tabler	$head_near	 params(ipacidrseq,	int	;
                                						ipacidrlist,	int	;
                                						ipcidro,	int	;
                                						ipcidrroutine,	int	;
  :                            18 						ipcidr_tableidx,int	)
  :                            19 
00:009549 50F003              +20 	lx	ipacidrlist		. entering table sequentially?
00:00954A 60F002              +21 	la	ipacidrseq		. check length of oid
00:00954B 68C001              +22 	lb	1, a
00:00954C CDFFF0              +23 	ab	-16,,xi
00:00954D 5E0562              +24 	jnc	ipagent_cidr_tabler_readdress
  :                            25 
00:00954E 68C008              +26 	lb	8, a			. correct table?
00:00954F B8F006              +27 	xorB	ipcidr_tableidx
00:009550 DE0562              +28 	jnzb	ipagent_cidr_tabler_readdress
  :                            29 
00:009551 68F002              +30 	lb	ipacidrseq
00:009552 60F005              +31 	la	ipcidrroutine
00:009553 C5FF60              +32 	aa	-SNMP_GETREQ,,xi
00:009554 D60557              +33 	jnza	ipagent_cidr_address_along
  :                            34 
00:009555 3E056A              +35 	lcal	ipagent_cidr_search_exact
00:009556 B60565              +36 	j	ipagent_cidr_tabler_address!
  :                            37 		
  :                            38 ipagent_cidr_address_along
00:009557 3E056C              +39 	lcal	ipagent_cidr_search_forward
00:009558 680002              +40 	lb	x
00:009559 60F002              +41 	la	ipacidrseq
00:00955A DE0562              +42 	jnzb	ipagent_cidr_tabler_readdress
  :                            43 
00:00955B 1FC001              +44 	dec	1, a			. tweak oid length to prompt next subtable
00:00955C 17C009              +45 	inc	9, a			. this is the 7 specifier after the 24 specifier
00:00955D 30C00C              +46 	z	12, a
00:00955E 30C00D              +47 	z	13, a
00:00955F 30C00E              +48 	z	14, a
00:009560 30C00F              +49 	z	15, a			. clear the address field of the oid
00:009561 B60565              +50 	j	ipagent_cidr_tabler_noaddress
  :                            51 	
  :                            52 ipagent_cidr_tabler_readdress
00:009562 3E0567              +53 	lcal	ipagent_cidr_write_oid_tokens
00:009563 60F004              +54 	la	ipcidro
00:009564 28C002              +55 	sb	mo:seq, a
  :                            56 
  :                            57 ipagent_cidr_tabler_address!
  :                            58 ipagent_cidr_tabler_noaddress
00:009565 680002              +59 	lb	x
00:009566 350000              +60 	$ret
  :                            61 
  :                            62 ipagent_cidr_write_oid_tokens
00:009567 5CC00E              +63 	ly	14, a, i
00:009568 CFA003              +64 	dl	ro:net
00:009569 B603DC              +65 	j	ipagent_write2oid
  :                            66 
  :                            67 ipagent_cidr_search_exact
00:00956A 5CD00E              +68 	ly	14, b, i
00:00956B B603E6              +69 	j	ipagent_search_id	
  :                            70 
  :                            71 ipagent_cidr_search_forward
00:00956C 5CD00E              +72 	ly	14, b, i
00:00956D B603ED              +73 	j	ipagent_search_nextid
  :                            74 
  :                            75 
  :                            76 ipagent_cidr_route_dest_type		. seq 1 value 1 for ipv4
                                	$head_far		 params(cidrdesttypeseq,	int	;
                                					cidrdesttypeflags,	int	;
  :                            79 					cidrdesttyperoutine,	int	)
  :                            80 
                                	lc	ipagent_cidr_tabler	cidrdesttypeseq		;
                                					route_lexical		;
                                					ipromib_oifidx,,xi	;
                                					cidrdesttyperoutine	;
00:00956E FD0018              +85 					24,,xi
00:00956F F8F006              +85 
(+01)10
00:009570 FD0494              +85 
(+01)0f
00:009571 F8023C              +85 
00:009572 F8F007              +85 
00:009573 FCF005              +85 
00:009574 3E0549              +85 
00:009575 38000F              +85 
  :                            86 
00:009576 CE057A              +87 	jzb	ipagent_cidr_route_dest_notype
00:009577 650001              +88 	la	1,,xi
(+01)0f
00:009578 20048A              +89 	sa	ipromib_i_f
(+01)10
00:009579 6D0494              +90 	lb	ipromib_oifidx,,xi
  :                            91 
  :                            92 ipagent_cidr_route_dest_notype
00:00957A 3D0000              +93 	fret	0
  :                            94 
  :                            95 
  :                            96 ipagent_cidr_route_dest			. seq 2
                                	$head_far		 params(cidrdestseq,		int	;
                                					cidrdestflags,		int	;
  :                            99 					cidrdestroutine,	int	)
  :                            100 
                                	lc	ipagent_cidr_tabler	cidrdestseq		;
                                					route_lexical		;
                                					inetcidr_oaddress,,xi	;
                                					cidrdestroutine		;
00:00957B FD0018              +105 					24,,xi
00:00957C F8F006              +105 
(+01)10
00:00957D FD04C9              +105 
(+01)0f
00:00957E F8023C              +105 
00:00957F F8F007              +105 
00:009580 FCF005              +105 
00:009581 3E0549              +105 
00:009582 38000F              +105 
  :                            106 
00:009583 CE0589              +107 	jzb	ipagent_cidr_route_nodest
00:009584 CFA003              +108 	dl	ro:net
00:009585 2E0008              +109 	sbl	8			. compress 2 halves network address
00:009586 360008              +110 	dsl	8			. giving n.n.n.n : 0000
(+01)0f
00:009587 C704C0              +111 	ds	inetcidr_xnet
(+01)10
00:009588 6D04C9              +112 	lb	inetcidr_oaddress,,xi
  :                            113 
  :                            114 ipagent_cidr_route_nodest
00:009589 3D0000              +115 	fret	0
  :                            116 
  :                            117 ipagent_cidr_route_mask_log		. seq 3
                                	$head_far		 params(cidrmasklogseq,		int	;
                                					cidrmasklogflags,	int	;
  :                            120 					cidrmasklogroutine,	int	)
  :                            121 
                                	lc	ipagent_cidr_tabler	cidrmasklogseq		;
                                					route_lexical		;
                                					inetcidr_ogauge,,xi	;
                                					cidrmasklogroutine	;
00:00958A FD0018              +126 					24,,xi
00:00958B F8F006              +126 
(+01)10
00:00958C FD04C2              +126 
(+01)0f
00:00958D F8023C              +126 
00:00958E F8F007              +126 
00:00958F FCF005              +126 
00:009590 3E0549              +126 
00:009591 38000F              +126 
  :                            127 
00:009592 CE0596              +128 	jzb	ipagent_cidr_route_nomask_log
00:009593 60A009              +129 	la	ro:mask_log
(+01)0f
00:009594 2004BF              +130 	sa	inetcidr_gauge
(+01)10
00:009595 6D04C2              +131 	lb	inetcidr_ogauge,,xi
  :                            132 
  :                            133 ipagent_cidr_route_nomask_log
00:009596 3D0000              +134 	fret	0
  :                            135 
  :                            136 ipagent_cidr_route_next_hop_type	. seq 5 value 0 for local, 1 for for ipv4 remote
                                	$head_far		 params(cidrnexthoptypeseq,	int	;
                                					cidrnexthoptypeflags,	int	;
  :                            139 					cidrnexthoptyperoutine,	int	)
  :                            140 
                                	lc	ipagent_cidr_tabler	cidrnexthoptypeseq	;
                                					route_lexical		;
                                					ipromib_oifidx,,xi	;
                                					cidrnexthoptyperoutine	;
00:009597 FD0018              +145 					24,,xi
00:009598 F8F006              +145 
(+01)10
00:009599 FD0494              +145 
(+01)0f
00:00959A F8023C              +145 
00:00959B F8F007              +145 
00:00959C FCF005              +145 
00:00959D 3E0549              +145 
00:00959E 38000F              +145 
  :                            146 
00:00959F CE05A4              +147 	jzb	ipagent_cidr_route_nonext_hop_type
00:0095A0 60A002              +148 	la	ro:i_f
00:0095A1 060017              +149 	sar	23			. gives 0 for not remote
(+01)0f
00:0095A2 20048A              +150 	sa	ipromib_i_f		. or 1 for ipv4
(+01)10
00:0095A3 6D0494              +151 	lb	ipromib_oifidx,,xi
  :                            152 
  :                            153 ipagent_cidr_route_nonext_hop_type
00:0095A4 3D0000              +154 	fret	0
  :                            155 
  :                            156 ipagent_cidr_route_next_hop		. seq 6 0.0.0.0 for local, gateway for remote
                                	$head_far		 params(cidrnexthopseq,		int	;
                                					cidrnexthopflags,	int	;
  :                            159 					cidrnexthoproutine,	int	)
  :                            160 
                                	lc	ipagent_cidr_tabler	cidrnexthopseq		;
                                					route_lexical		;
                                					inetcidr_oaddress,,xi	;
                                					cidrnexthoproutine	;
00:0095A5 FD0018              +165 					24,,xi
00:0095A6 F8F006              +165 
(+01)10
00:0095A7 FD04C9              +165 
(+01)0f
00:0095A8 F8023C              +165 
00:0095A9 F8F007              +165 
00:0095AA FCF005              +165 
00:0095AB 3E0549              +165 
00:0095AC 38000F              +165 
  :                            166 
00:0095AD CE05B6              +167 	jzb	ipagent_cidr_route_nonext_hop
00:0095AE CFA007              +168 	dl	ro:next_hop
00:0095AF 2E0008              +169 	sbl	8			. compress two halves network address
00:0095B0 360008              +170 	dsl	8			. giving n.n.n.n : 0000
00:0095B1 78A002              +171 	tn	ro:i_f			. remote / indirect route?
00:0095B2 B605B4              +171 
00:0095B3 160030              +172 	dsr	48			. zero for local so they say
(+01)0f
00:0095B4 C704C0              +173 	ds	inetcidr_xnet
(+01)10
00:0095B5 6D04C9              +174 	lb	inetcidr_oaddress,,xi
  :                            175 
  :                            176 ipagent_cidr_route_nonext_hop
00:0095B6 3D0000              +177 	fret	0
  :                            178 
  :                            179 ipagent_cidr_route_ifidx		. seq 7
                                	$head_far		 params(cidrrouteifidxseq,	int	;
                                					cidrrouteifidxflags,	int	;
  :                            182 					cidrrouteifidxroutine,	int	)
  :                            183 
                                	lc	ipagent_cidr_tabler	cidrrouteifidxseq	;
                                					route_lexical		;
                                					ipromib_oifidx,,xi	;
                                					cidrrouteifidxroutine	;
00:0095B7 FD0018              +188 					24,,xi
00:0095B8 F8F006              +188 
(+01)10
00:0095B9 FD0494              +188 
(+01)0f
00:0095BA F8023C              +188 
00:0095BB F8F007              +188 
00:0095BC FCF005              +188 
00:0095BD 3E0549              +188 
00:0095BE 38000F              +188 
  :                            189 
00:0095BF CE05C4              +190 	jzb	ipagent_cidr_route_noifidx
00:0095C0 60A002              +191 	la	ro:i_f
00:0095C1 A57FFF              +192 	and	07FFF,,xi		. drop the indirection bit
(+01)0f
00:0095C2 20048A              +193 	sa	ipromib_i_f		. leaving relative-1 i/f number
(+01)10
00:0095C3 6D0494              +194 	lb	ipromib_oifidx,,xi
  :                            195 
  :                            196 ipagent_cidr_route_noifidx
00:0095C4 3D0000              +197 	fret	0
  :                            198 
  :                            199 ipagent_cidr_route_type			. seq 8 value 3 for local 4 for remote
                                	$head_far		 params(cidrroutetypeseq,	int	;
                                					cidrroutetypeflags,	int	;
  :                            202 					cidrroutetyperoutine,	int	)
  :                            203 
                                	lc	ipagent_cidr_tabler	cidrroutetypeseq	;
                                					route_lexical		;
                                					ipromib_oifidx,,xi	;
                                					cidrroutetyperoutine	;
00:0095C5 FD0018              +208 					24,,xi
00:0095C6 F8F006              +208 
(+01)10
00:0095C7 FD0494              +208 
(+01)0f
00:0095C8 F8023C              +208 
00:0095C9 F8F007              +208 
00:0095CA FCF005              +208 
00:0095CB 3E0549              +208 
00:0095CC 38000F              +208 
  :                            209 
00:0095CD CE05D3              +210 	jzb	ipagent_cidr_route_notype
00:0095CE 60A002              +211 	la	ro:i_f
00:0095CF 060017              +212 	sar	23			. add 3 to the indirection bit
00:0095D0 64C003              +213 	la	3, a, i			. giving 3 direct or 4 indirect
(+01)0f
00:0095D1 20048A              +214 	sa	ipromib_i_f
(+01)10
00:0095D2 6D0494              +215 	lb	ipromib_oifidx,,xi
  :                            216 
  :                            217 ipagent_cidr_route_notype
00:0095D3 3D0000              +218 	fret	0
  :                            264: 	$include atagent
  :                            1 .	protocol address to physical Address Translation
  :                            2 .	this implementation is about ARP cache and local net
  :                            3 
  :                            4 .	local host neta/physa not always reported here
  :                            5 .	but available in ifTable entries
  :                            6 
  :                            7 .	this does both	at Table		MIB-II.3
  :                            8 .	and		ipNettoMedia Table	MIB-II.4.22
  :                            9 
  :                            10 .	in order to take few $vector positions in Page 9
  :                            11 
  :                            12 $(1)
  :                            13 
(+01)18
01:0004D0 0004D7              +14 atagent_ifidx	mobjet	atagent_physa	1  SNMP_INT	3	1	0 0 atagent_if_id
(+01)18
01:0004D1 0004E5              +14 
01:0004D2 000001              +14 
01:0004D3 000002              +14 
01:0004D4 000003              +14 
01:0004D5 000001              +14 
01:0004D6 000001              +14 
01:0004D7 000000              +15 atagent_physa	mobjet	0	2       SNMP_STRING     6       1	0 0 atagent_string
(+01)18
01:0004D8 0004E6              +15 
01:0004D9 000002              +15 
01:0004DA 000004              +15 
01:0004DB 000006              +15 
01:0004DC 000001              +15 
01:0004DD 000001              +15 
01:0004DE 000000              +16 atagent_neta	mobjet	0	3 SNMP_NETWORKADDRESS	4	1
01:0004DF 000000              +16 
01:0004E0 000003              +16 
01:0004E1 000040              +16 
01:0004E2 000004              +16 
01:0004E3 000001              +16 
01:0004E4 000000              +16 
  :                            17 
01:0004E5 000000              +18 atagent_if_id	0	. that could overlap atagent_string
01:0004E6 000000000000        +19 atagent_string	0L	. bit might be useful for debug alongside
  :                            20 
  :                            21 $(0)
  :                            22 net_address2ifidx
                                	$head_far	 params(at_x_oidp,	int	;
                                				at_x_sequence,	int	;
  :                            25 				at_x_action,	int)	
  :                            26 .		scalars(keep1_x,	int,	x)
  :                            27 
00:0095D4 58F003              +28 	ly	at_x_oidp
  :                            29 .	ay	11,, xi
00:0095D5 60F005              +30 	la	at_x_action
00:0095D6 C5FF5F              +31 	aa	-SNMP_GETNEXTREQ,,xi
00:0095D7 C605DB              +32 	jza	net2ifindex_walk
  :                            33 
00:0095D8 3E0606              +34 	lcal	at_lib:at_this
00:0095D9 B605E6              +35 	j	net2ifidx_x		. return + 0, x <- 0
00:0095DA B605DE              +36 	j	net2ifidx_deliver
  :                            37 
  :                            38 net2ifindex_walk
00:0095DB 3E0612              +39 	lcal	at_lib:at_higher
00:0095DC B605E6              +40 	j	net2ifidx_x		.  no object retrieved
  :                            41 
00:0095DD 3E0627              +42 	lcal	at_lib:unpack_neta	. y -> iod + 11
  :                            43 
  :                            44 net2ifidx_deliver
00:0095DE 58F003              +45 	ly	at_x_oidp		. received oid may not include netadddr
  :                            46 
00:0095DF 60B00E              +47 	la	14, y
(+01)0f
00:0095E0 2004D2              +48 	sa	atagent_ifidx:seq
  :                            49 
  :                            50 .	la	13,,xi			. it does now
  :                            51 .	sa	1, y			. write back inclusive oid length
  :                            52 
00:0095E1 CF0A57              +53 	dl	(1, 1L)
00:0095E2 C7B009              +54 	ds	9, y
  :                            55 .	sa	10, y
  :                            56 
00:0095E3 3E0636              +57 	lcal	at_lib:deliver_ifidx	. encapsulated read from structure
(+01)0f
00:0095E4 2004E5              +58 	sa	atagent_if_id		. because part if structure definition
  :                            59 					. is known to at_lib but not here
(+01)10
00:0095E5 5504D0              +60 	lx	atagent_ifidx,,xi	. result <- @ dynamic object descriptor
  :                            61 
  :                            62 net2ifidx_x
00:0095E6 680002              +63 	lb	x			. result -> b
  :                            64 .	pop	x			. restore x <- MIB tree walker
00:0095E7 3D0000              +65 	fret	0			. not $ret macro
  :                            66 
  :                            67 net_address2physa
                                	$head_far	 params(at_physa_oidp,	int	;
                                				at_physa_seq,	int	;
  :                            70 				at_physa_act,	int)
  :                            71 	.		scalars(keep2_x,	int,	x)
  :                            72 
00:0095E8 58F003              +73 	ly	at_physa_oidp
  :                            74 .	ay	11,,xi
  :                            75 
00:0095E9 60F005              +76 	la	at_physa_act
00:0095EA C5FF5F              +77 	aa	-SNMP_GETNEXTREQ,,xi
00:0095EB C605EF              +78 	jza	net2physa_walk
  :                            79 
00:0095EC 3E0606              +80 	lcal	at_lib:at_this
00:0095ED B60602              +81 	j	net2physa_x		. return + 0 = no hit
00:0095EE B605F8              +82 	j	net2physa_deliver
  :                            83 
  :                            84 net2physa_walk
00:0095EF 60B00A              +85 	la	10,y
00:0095F0 B50002              +86 	xor	2,,xi			. have we stepped over from object.1 ?
00:0095F1 C605F5              +87 	jza	net2physa_tree
  :                            88 
00:0095F2 160030              +89 	dsr	48
00:0095F3 C70006              +90 	ds	6
00:0095F4 47B00B              +91 	qs	11, y
  :                            92 
  :                            93 net2physa_tree
  :                            94 
00:0095F5 3E0612              +95 	lcal	at_lib:at_higher
00:0095F6 B60602              +96 	j	net2physa_x
  :                            97 
  :                            98 					. y -> oid + 11
00:0095F7 3E0627              +99 	lcal	at_lib:unpack_neta	. unpack from object x ->
  :                            100 
  :                            101 net2physa_deliver
00:0095F8 58F003              +102 	ly	at_physa_oidp		. received oid may not include netadddr
  :                            103 
00:0095F9 60B00E              +104 	la	14, y
(+01)0f
00:0095FA 2004D9              +105 	sa	atagent_physa:seq
  :                            106 
00:0095FB 65000D              +107 	la	13,,xi			. it does now
00:0095FC 20B001              +108 	sa	1, y			. write back inclusive oid length
  :                            109 
  :                            110 .	dl	(1, 2L)
  :                            111 .	ds	9, y
00:0095FD 650002              +112 	la	2,,xi
00:0095FE 20B00A              +113 	sa	10, y			. 1.1.2 may be missing
  :                            114 
00:0095FF 3E0630              +115 	lcal	at_lib:pack_phy		. pack from object x ->
(+01)0f
00:009600 C704E6              +116 	ds	atagent_string
(+01)10
00:009601 5504D7              +117 	lx	atagent_physa,,xi	. result <- @ dynamic object descriptor
  :                            118 
  :                            119 net2physa_x
00:009602 680002              +120 	lb	x			. result -> b
  :                            121 .	pop	x			. restore x <- MIB tree walker
00:009603 3D0000              +122 	fret	0			. not $ret macro
  :                            123 
  :                            124 net_addres2net_address
                                	$head_far	 params(at_proto_oidp,	int	;
                                				at_proto_seq,	int	;
  :                            127 				at_proto_act,	int	)
  :                            128 
00:009604 6D0000              +129 	lb	0,,xi
00:009605 3D0000              +130 	$ret
  :                            131 
  :                            265: 	$include at_lib
  :                            1 at_lib	$tree
  :                            2 
  :                            3: 	$include	../arp.ext/arp_enet.def
  :                            1 HLEN		$set	6
  :                            2 PLEN		$set	4
  :                            3 HTYPE		$set	ETHERNET_SPACE
  :                            4 PROTOCOL_SUITE  $set    0800
  :                            5 LINK_PROTOCOL   $set    0806
  :                            6 
                                		$do	ARP_POINTER_ARRAY()^=0,;
  :                            8 ENET_POINTER_ARRAY*	$set	ARP_POINTER_ARRAY(1)
  :                            9 
  :                            10 AT_POINTER_ARRAY	$set	ENET_POINTER_ARRAY
  :                            11 
                                		$do	ARP_HASH_LIST()^=0,;
  :                            13 ENET_HASH_LIST*		$set	ARP_HASH_LIST(1)
  :                            14 
  :                            15 AT_HASH_LIST	$set	ENET_HASH_LIST
  :                            16 
  :                            17 ARP_HASH	$set	16
  :                            18 ARP_STORE	$set	3 . 50
  :                            4 
  :                            5 $(66::,x)
  :                            6 arp_row	arp_cache
  :                            7 
  :                            8 $(0)
  :                            9 
00:009606 3E061E              +10 at_this	lcal	pack_neta	. turn BER string to 00.aa.bb.00.cc.dd
  :                            11 				. in 6:7
  :                            12 
00:009607 A5000F              +13 	and	ARP_HASH-1,,xi	. pack_neta leaves low order neta byte in a
[+0055]10
00:009608 550000              +14 	lx	AT_HASH_LIST,,xi
00:009609 800004              +15 	ax	a	
  :                            16 
00:00960A CF0006              +17 	dl	6		. retrieve packed address
  :                            18 
00:00960B 50A000              +19 again	lx	arp_row:next
00:00960C 700002              +20 	tnz	x
00:00960D B6060F              +20 
00:00960E 350000              +21 	lret	0
00:00960F 57A006              +22 	dte	arp_row:tpa
00:009610 B6060B              +23 	j	again
00:009611 350001              +24 	lret	1
  :                            25 
  :                            26 at_higher 
00:009612 3E061E              +27 	lcal	pack_neta	. turn BER string to 00.aa.bb.00.cc.dd
  :                            28 				. in 6:7
  :                            29 
[+0054]10
00:009613 450000              +30 	lr	AT_POINTER_ARRAY,,xi
  :                            31 
00:009614 508000              +32 next?	lx	*r
00:009615 700002              +33 	tnz	x
00:009616 B60618              +33 
00:009617 350000              +34 	lret	0
00:009618 CF0006              +35 	dl	6
00:009619 DFA006              +36 	dan	arp_row:tpa
00:00961A E6061D              +37 	jna	next!
00:00961B 170000              +38 	inc	r
00:00961C B60614              +39 	j	next?
  :                            40 	
00:00961D 350001              +41 next!	lret	1
  :                            42 
  :                            43 pack_neta
00:00961E CFB00B              +44 	dl	11, y		. pack network address from field of oid
00:00961F 2E0010              +45 	sbl	16
00:009620 360008              +46 	dsl	8
00:009621 200006              +47 	sa	6
00:009622 CFB00D              +48 	dl	13, y 
00:009623 2E0010              +49 	sbl	16
00:009624 360008              +50 	dsl	8
00:009625 200007              +51 	sa	7
00:009626 350000              +52 	lret	0
  :                            53 
  :                            54 unpack_neta
00:009627 60A006              +55 	la	arp_row:tpa	. unpack network address to field of oid
00:009628 160008              +56 	dsr	8
00:009629 0E0010              +57 	sbr	16
00:00962A C7B00B              +58 	ds	11, y
00:00962B 60A007              +59 	la	arp_row:tpa+1
00:00962C 160008              +60 	dsr	8
00:00962D 0E0010              +61 	sbr	16
00:00962E C7B00D              +62 	ds	13, y
00:00962F 350000              +63 	lret	0
  :                            64 
  :                            65 pack_phy
00:009630 CFA003              +66 	dl	arp_row:tha
00:009631 2E0008              +67 	sbl	8
00:009632 360008              +68 	dsl	8
00:009633 480A4F              +69 	lk	(00FFFF)
00:009634 BFA005              +70 	mlb	arp_row:tha+2
00:009635 350000              +71 	lret	0
  :                            72 
  :                            73 deliver_ifidx
00:009636 60A002              +74 	la	arp_row:i_f
00:009637 350000              +75 	lret	0
  :                            76 
  :                            77 	$root
  :                            266: 	$include loadplan
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40 	$sterm	'.'
  :                            41 
00:009638 040706              +42 sysDescr	mvo	SNMP_OID.7.43.6.1.2.1.1.1	SNMP_STRING.24	 "RTA1 running OS smaragd7"
00:009639 000A59              +42 
00:00963A 000018              +42 
(+01)18
00:00963B 0004E8              +42 
00:00963C 000001              +42 
00:00963D 000008              +42 
01:0004E8 525441312072756E6E696E67204F5320736D617261676437
                              +42 
00:00963E 060706              +43 sysObjectID	mvo	SNMP_OID.7.43.6.1.2.1.1.2	SNMP_OID.2	 0.0
00:00963F 000A5C              +43 
00:009640 000002              +43 
(+01)18
00:009641 0004F0              +43 
00:009642 000001              +43 
00:009643 000001              +43 
01:0004F0 000A52              +43 
00:009644 640706              +44 sysUpTime	mvo	SNMP_OID.7.43.6.1.2.1.1.3	MIB_FUNCTION	 mib2ticks
00:009645 000A5F              +44 
00:009646 000000              +44 
00:009647 000245              +44 
00:009648 000001              +44 
00:009649 000000              +44 
00:00964A 040706              +45 sysContact	mvo	SNMP_OID.7.43.6.1.2.1.1.4	SNMP_STRING.18	 "TimMilesCox@gmx.ch"
00:00964B 000A62              +45 
00:00964C 000012              +45 
(+01)18
00:00964D 0004F1              +45 
00:00964E 000001              +45 
00:00964F 000006              +45 
01:0004F1 54696D4D696C6573436F7840676D782E6368
                              +45 
00:009650 040706              +46 sysName	mvo	SNMP_OID.7.43.6.1.2.1.1.5	SNMP_STRING.4	 "RTA1"
00:009651 000A65              +46 
00:009652 000004              +46 
(+01)18
00:009653 0004F7              +46 
00:009654 000001              +46 
00:009655 000002              +46 
01:0004F7 525441310000        +46 
00:009656 040706              +47 sysLocation	mvo	SNMP_OID.7.43.6.1.2.1.1.6	SNMP_STRING.9	 "worldwide"
00:009657 000A68              +47 
00:009658 000009              +47 
(+01)18
00:009659 0004F9              +47 
00:00965A 000001              +47 
00:00965B 000003              +47 
01:0004F9 776F726C6477696465  +47 
00:00965C 020706              +48 sysServices	mvo	SNMP_OID.7.43.6.1.2.1.1.7	SNMP_INT.3	 0
00:00965D 000A6B              +48 
00:00965E 000003              +48 
(+01)18
00:00965F 0004FC              +48 
00:009660 000001              +48 
00:009661 000000              +48 
01:0004FC 000000              +48 
  :                            49 
00:009662 020706              +50 ifNumber	mvo	SNMP_OID.7.43.6.1.2.1.2.1	SNMP_INT.3	 0
00:009663 000A6E              +50 
00:009664 000003              +50 
(+01)18
00:009665 0004FD              +50 
00:009666 000001              +50 
00:009667 000000              +50 
01:0004FD 000000              +50 
00:009668 640906              +51 ifIndex		mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.1	MIB_FUNCTION	 if_agentidx
00:009669 000A71              +51 
00:00966A 000000              +51 
00:00966B 000248              +51 
00:00966C 000001              +51 
00:00966D 000000              +51 
00:00966E 640906              +52 ifDescr         mvo     SNMP_OID.9.43.6.1.2.1.2.2.0.2   MIB_FUNCTION	 if_agentdescr 
00:00966F 000A74              +52 
00:009670 000000              +52 
00:009671 000249              +52 
00:009672 000001              +52 
00:009673 000000              +52 
00:009674 640906              +53 ifType		mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.3   MIB_FUNCTION	 if_agenttype
00:009675 000A77              +53 
00:009676 000000              +53 
00:009677 00024A              +53 
00:009678 000001              +53 
00:009679 000000              +53 
00:00967A 640906              +54 ifMTU		mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.4	MIB_FUNCTION	 if_agentMTU
00:00967B 000A7A              +54 
00:00967C 000000              +54 
00:00967D 00024B              +54 
00:00967E 000001              +54 
00:00967F 000000              +54 
00:009680 640906              +55 ifSpeed		mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.5	MIB_FUNCTION	 if_agentspeed
00:009681 000A7D              +55 
00:009682 000000              +55 
00:009683 00024C              +55 
00:009684 000001              +55 
00:009685 000000              +55 
00:009686 640906              +56 ifPhysAddress	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.6	MIB_FUNCTION	 if_agentphy
00:009687 000A80              +56 
00:009688 000000              +56 
00:009689 00024D              +56 
00:00968A 000001              +56 
00:00968B 000000              +56 
00:00968C 640906              +57 ifAdminStatus	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.7	MIB_FUNCTION	 if_agentadmins
00:00968D 000A83              +57 
00:00968E 000000              +57 
00:00968F 00024E              +57 
00:009690 000001              +57 
00:009691 000000              +57 
00:009692 640906              +58 ifOperStatus	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.8	MIB_FUNCTION	 if_agentosta
00:009693 000A86              +58 
00:009694 000000              +58 
00:009695 00024F              +58 
00:009696 000001              +58 
00:009697 000000              +58 
00:009698 640906              +59 ifLastChange	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.9	MIB_FUNCTION	 if_agentlastc
00:009699 000A89              +59 
00:00969A 000000              +59 
00:00969B 000250              +59 
00:00969C 000001              +59 
00:00969D 000000              +59 
00:00969E 640906              +60 ifInOctets	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.10	MIB_FUNCTION	 if_agentibytes
00:00969F 000A8C              +60 
00:0096A0 000000              +60 
00:0096A1 000251              +60 
00:0096A2 000001              +60 
00:0096A3 000000              +60 
00:0096A4 640906              +61 ifInUcastPkts	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.11	MIB_FUNCTION	 if_agentiucast
00:0096A5 000A8F              +61 
00:0096A6 000000              +61 
00:0096A7 000252              +61 
00:0096A8 000001              +61 
00:0096A9 000000              +61 
00:0096AA 640906              +62 ifInNUcastPkts	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.12	MIB_FUNCTION	 if_agentimcast
00:0096AB 000A92              +62 
00:0096AC 000000              +62 
00:0096AD 000253              +62 
00:0096AE 000001              +62 
00:0096AF 000000              +62 
00:0096B0 640906              +63 ifInDiscards	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.13	MIB_FUNCTION	 if_agentidrops
00:0096B1 000A95              +63 
00:0096B2 000000              +63 
00:0096B3 000254              +63 
00:0096B4 000001              +63 
00:0096B5 000000              +63 
00:0096B6 640906              +64 ifInErrors	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.14	MIB_FUNCTION	 if_agentierrs
00:0096B7 000A98              +64 
00:0096B8 000000              +64 
00:0096B9 000255              +64 
00:0096BA 000001              +64 
00:0096BB 000000              +64 
00:0096BC 640906              +65 ifInUnknownProtos mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.15	MIB_FUNCTION	 if_agentinoproto
00:0096BD 000A9B              +65 
00:0096BE 000000              +65 
00:0096BF 000256              +65 
00:0096C0 000001              +65 
00:0096C1 000000              +65 
00:0096C2 640906              +66 ifOutOctets	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.16	MIB_FUNCTION	 if_agentobytes
00:0096C3 000A9E              +66 
00:0096C4 000000              +66 
00:0096C5 000257              +66 
00:0096C6 000001              +66 
00:0096C7 000000              +66 
00:0096C8 640906              +67 ifOutUcastPkts	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.17	MIB_FUNCTION	 if_agentoucast
00:0096C9 000AA1              +67 
00:0096CA 000000              +67 
00:0096CB 000258              +67 
00:0096CC 000001              +67 
00:0096CD 000000              +67 
00:0096CE 640906              +68 ifOutNUcastPkts	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.18	MIB_FUNCTION	 if_agentomcast
00:0096CF 000AA4              +68 
00:0096D0 000000              +68 
00:0096D1 000259              +68 
00:0096D2 000001              +68 
00:0096D3 000000              +68 
00:0096D4 640906              +69 ifOutDiscards	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.19	MIB_FUNCTION	 if_agentodrops
00:0096D5 000AA7              +69 
00:0096D6 000000              +69 
00:0096D7 00025A              +69 
00:0096D8 000001              +69 
00:0096D9 000000              +69 
00:0096DA 640906              +70 ifOutErrors	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.20	MIB_FUNCTION	 if_agentoerrs
00:0096DB 000AAA              +70 
00:0096DC 000000              +70 
00:0096DD 00025B              +70 
00:0096DE 000001              +70 
00:0096DF 000000              +70 
00:0096E0 640906              +71 ifOutQLen	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.21	MIB_FUNCTION	 if_agentoqlen
00:0096E1 000AAD              +71 
00:0096E2 000000              +71 
00:0096E3 00025C              +71 
00:0096E4 000001              +71 
00:0096E5 000000              +71 
00:0096E6 640906              +72 ifSpecific	mvo	SNMP_OID.9.43.6.1.2.1.2.2.0.22	MIB_FUNCTION.7	 if_agentsmib
00:0096E7 000AB0              +72 
00:0096E8 000007              +72 
00:0096E9 00025D              +72 
00:0096EA 000001              +72 
00:0096EB 000000              +72 
  :                            73 
  :                            74 AT_AGENT	$equ	1
  :                            75 	$if	AT_AGENT
00:0096EC 640D06              +76 atIfIndex	mvo	SNMP_OID.13.43.6.1.2.1.3.1.1.1.128++4	MIB_FUNCTION.7	at_agentifindex
00:0096ED 000AB3              +76 
00:0096EE 000007              +76 
00:0096EF 000277              +76 
00:0096F0 000001              +76 
00:0096F1 000000              +76 
00:0096F2 640D06              +77 atPhysAddress	mvo	SNMP_OID.13.43.6.1.2.1.3.1.1.2.128++4	MIB_FUNCTION.7	at_agentphysa
00:0096F3 000AB7              +77 
00:0096F4 000007              +77 
00:0096F5 000278              +77 
00:0096F6 000001              +77 
00:0096F7 000000              +77 
  :                            78 . atNetAddress	mvo	SNMP_OID.13.43.6.1.2.1.3.1.1.3.128++4	MIB_FUNCTION.7	at_agentnetaddress
  :                            79 	$endif
  :                            80 
00:0096F8 020708              +81 ipForwarding	mvo	SNMP_OID.7.43.6.1.2.1.4.1	SNMP_INT.3	 1	1:2
00:0096F9 000ABB              +81 
00:0096FA 000003              +81 
(+01)18
00:0096FB 0004FE              +81 
00:0096FC 000003              +81 
00:0096FD 000001              +81 
00:0096FE 000001000002        +81 
01:0004FE 000001              +81 
00:009700 020706              +82 ipDefaultTTL	mvo	SNMP_OID.7.43.6.1.2.1.4.2	SNMP_INT.3	 60
00:009701 000ABE              +82 
00:009702 000003              +82 
(+01)18
00:009703 0004FF              +82 
00:009704 000001              +82 
00:009705 000000              +82 
01:0004FF 00003C              +82 
00:009706 410706              +83 ipInReceives	mvo	SNMP_OID.7.43.6.1.2.1.4.3	SNMP_COUNTER.6	 0
00:009707 000AC1              +83 
00:009708 000006              +83 
(+01)18
00:009709 000500              +83 
00:00970A 000001              +83 
00:00970B 000000              +83 
01:000500 000000000000        +83 
00:00970C 410706              +84 ipInHdrErrors	mvo	SNMP_OID.7.43.6.1.2.1.4.4	SNMP_COUNTER.6	 0
00:00970D 000AC4              +84 
00:00970E 000006              +84 
(+01)18
00:00970F 000502              +84 
00:009710 000001              +84 
00:009711 000000              +84 
01:000502 000000000000        +84 
00:009712 410706              +85 ipInAddrErrors	mvo	SNMP_OID.7.43.6.1.2.1.4.5	SNMP_COUNTER.6	 0
00:009713 000AC7              +85 
00:009714 000006              +85 
(+01)18
00:009715 000504              +85 
00:009716 000001              +85 
00:009717 000000              +85 
01:000504 000000000000        +85 
00:009718 410706              +86 ipForwDatagrams	mvo	SNMP_OID.7.43.6.1.2.1.4.6	SNMP_COUNTER.6	 0
00:009719 000ACA              +86 
00:00971A 000006              +86 
(+01)18
00:00971B 000506              +86 
00:00971C 000001              +86 
00:00971D 000000              +86 
01:000506 000000000000        +86 
00:00971E 410706              +87 ipInUnknownProtos mvo	SNMP_OID.7.43.6.1.2.1.4.7	SNMP_COUNTER.6	 0
00:00971F 000ACD              +87 
00:009720 000006              +87 
(+01)18
00:009721 000508              +87 
00:009722 000001              +87 
00:009723 000000              +87 
01:000508 000000000000        +87 
00:009724 410706              +88 ipInDiscards	mvo	SNMP_OID.7.43.6.1.2.1.4.8	SNMP_COUNTER.6	 0
00:009725 000AD0              +88 
00:009726 000006              +88 
(+01)18
00:009727 00050A              +88 
00:009728 000001              +88 
00:009729 000000              +88 
01:00050A 000000000000        +88 
00:00972A 410706              +89 ipInDelivers	mvo	SNMP_OID.7.43.6.1.2.1.4.9	SNMP_COUNTER.6	 0
00:00972B 000AD3              +89 
00:00972C 000006              +89 
(+01)18
00:00972D 00050C              +89 
00:00972E 000001              +89 
00:00972F 000000              +89 
01:00050C 000000000000        +89 
00:009730 410706              +90 ipOutRequests	mvo	SNMP_OID.7.43.6.1.2.1.4.10	SNMP_COUNTER.6	 0
00:009731 000AD6              +90 
00:009732 000006              +90 
(+01)18
00:009733 00050E              +90 
00:009734 000001              +90 
00:009735 000000              +90 
01:00050E 000000000000        +90 
00:009736 410706              +91 ipOutDiscards	mvo	SNMP_OID.7.43.6.1.2.1.4.11	SNMP_COUNTER.6	 0
00:009737 000AD9              +91 
00:009738 000006              +91 
(+01)18
00:009739 000510              +91 
00:00973A 000001              +91 
00:00973B 000000              +91 
01:000510 000000000000        +91 
00:00973C 410706              +92 ipOutNoRoutes	mvo	SNMP_OID.7.43.6.1.2.1.4.12	SNMP_COUNTER.6	 0
00:00973D 000ADC              +92 
00:00973E 000006              +92 
(+01)18
00:00973F 000512              +92 
00:009740 000001              +92 
00:009741 000000              +92 
01:000512 000000000000        +92 
00:009742 020706              +93 ipReasmTimeOut	mvo	SNMP_OID.7.43.6.1.2.1.4.13	SNMP_INT.3	 8
00:009743 000ADF              +93 
00:009744 000003              +93 
(+01)18
00:009745 000514              +93 
00:009746 000001              +93 
00:009747 000000              +93 
01:000514 000008              +93 
00:009748 410706              +94 ipReasmReqds	mvo	SNMP_OID.7.43.6.1.2.1.4.14	SNMP_COUNTER.6	 0
00:009749 000AE2              +94 
00:00974A 000006              +94 
(+01)18
00:00974B 000515              +94 
00:00974C 000001              +94 
00:00974D 000000              +94 
01:000515 000000000000        +94 
00:00974E 410706              +95 ipReasmOKs	mvo	SNMP_OID.7.43.6.1.2.1.4.15	SNMP_COUNTER.6	 0
00:00974F 000AE5              +95 
00:009750 000006              +95 
(+01)18
00:009751 000517              +95 
00:009752 000001              +95 
00:009753 000000              +95 
01:000517 000000000000        +95 
00:009754 410706              +96 ipReasmFails	mvo	SNMP_OID.7.43.6.1.2.1.4.16	SNMP_COUNTER.6	 0
00:009755 000AE8              +96 
00:009756 000006              +96 
(+01)18
00:009757 000519              +96 
00:009758 000001              +96 
00:009759 000000              +96 
01:000519 000000000000        +96 
00:00975A 410706              +97 ipFragOKs	mvo	SNMP_OID.7.43.6.1.2.1.4.17	SNMP_COUNTER.6	 0
00:00975B 000AEB              +97 
00:00975C 000006              +97 
(+01)18
00:00975D 00051B              +97 
00:00975E 000001              +97 
00:00975F 000000              +97 
01:00051B 000000000000        +97 
00:009760 410706              +98 ipFragFails	mvo	SNMP_OID.7.43.6.1.2.1.4.18	SNMP_COUNTER.6	 0
00:009761 000AEE              +98 
00:009762 000006              +98 
(+01)18
00:009763 00051D              +98 
00:009764 000001              +98 
00:009765 000000              +98 
01:00051D 000000000000        +98 
00:009766 410706              +99 ipFragCreates	mvo	SNMP_OID.7.43.6.1.2.1.4.19	SNMP_COUNTER.6	 0
00:009767 000AF1              +99 
00:009768 000006              +99 
(+01)18
00:009769 00051F              +99 
00:00976A 000001              +99 
00:00976B 000000              +99 
01:00051F 000000000000        +99 
  :                            100 
  :                            101 IPINDISCARDS_I*	$equ	ipInDiscards.i		. $sterm '.' is in force
  :                            102 IPREASMFAILS_I*	$equ	ipReasmFails.i
  :                            103 
  :                            104 IP_ADDRESS_AGENT $equ	1
  :                            105 IP_ROUTE_AGENT	$equ	1
  :                            106 
  :                            107 		$if	IP_ADDRESS_AGENT
00:00976C 640D06              +108 ipAdEntAddr	mvo	SNMP_OID.13.43.6.1.2.1.4.20.1.1.128++4	MIB_FUNCTION.7	ip_agent_address
00:00976D 000AF4              +108 
00:00976E 000007              +108 
00:00976F 000266              +108 
00:009770 000001              +108 
00:009771 000000              +108 
00:009772 640D06              +109 ipAdEntIfIndex	mvo	SNMP_OID.13.43.6.1.2.1.4.20.1.2.128++4	MIB_FUNCTION.7	ip_agent_address_ifidx
00:009773 000AF8              +109 
00:009774 000007              +109 
00:009775 000267              +109 
00:009776 000001              +109 
00:009777 000000              +109 
00:009778 640D06              +110 ipAdEntNetMask	mvo	SNMP_OID.13.43.6.1.2.1.4.20.1.3.128++4	MIB_FUNCTION.7	ip_agent_address_netmask
00:009779 000AFC              +110 
00:00977A 000007              +110 
00:00977B 000268              +110 
00:00977C 000001              +110 
00:00977D 000000              +110 
  :                            111 
  :                            112 		$if	BROADCAST_AND_MAXREASM	. considered less useful / less necessary
  :                            113 ipAdEntBcastAdr	mvo	SNMP_OID.13.43.6.1.2.1.4.20.1.4.128++4	MIB_FUNCTION.7	ip_agent_address_broadcast
  :                            114 ipAdAntReasmMaxSize mvo	SNMP_OID.13.43.6.1.2.1.4.20.1.5.128++4	MIB_FUNCTION.7	ip_agent_address_maxreasm
  :                            115 		$endif
  :                            116 		$endif
  :                            117 
  :                            118 		$if	IP_ROUTE_AGENT
00:00977E 640D06              +119 ipRouteDest	mvo	SNMP_OID.13.43.6.1.2.1.4.21.1.1.128++4	MIB_FUNCTION.7	ip_agent_route_dest
00:00977F 000B00              +119 
00:009780 000007              +119 
00:009781 00026B              +119 
00:009782 000001              +119 
00:009783 000000              +119 
00:009784 640D06              +120 ipRouteIfIndex	mvo	SNMP_OID.13.43.6.1.2.1.4.21.1.2.128++4	MIB_FUNCTION.7	ip_agent_route_ifidx
00:009785 000B04              +120 
00:009786 000007              +120 
00:009787 00026C              +120 
00:009788 000001              +120 
00:009789 000000              +120 
00:00978A 640D06              +121 ipRouteNextHop	mvo	SNMP_OID.13.43.6.1.2.1.4.21.1.7.128++4	MIB_FUNCTION.7	ip_agent_route_next_hop
00:00978B 000B08              +121 
00:00978C 000007              +121 
00:00978D 00026D              +121 
00:00978E 000001              +121 
00:00978F 000000              +121 
00:009790 640D06              +122 ipRouteType	mvo	SNMP_OID.13.43.6.1.2.1.4.21.1.8.128++4	MIB_FUNCTION.7	ip_agent_route_type
00:009791 000B0C              +122 
00:009792 000007              +122 
00:009793 00026E              +122 
00:009794 000001              +122 
00:009795 000000              +122 
00:009796 640D06              +123 ipRouteNetMask	mvo	SNMP_OID.13.43.6.1.2.1.4.21.1.11.128++4	MIB_FUNCTION.7	ip_agent_route_mask
00:009797 000B10              +123 
00:009798 000007              +123 
00:009799 00026F              +123 
00:00979A 000001              +123 
00:00979B 000000              +123 
  :                            124 		$endif
  :                            125 
  :                            126 IP_NET2_MEDIA_AGENT	$equ	1
  :                            127 
  :                            128 		$if	IP_NET2_MEDIA_AGENT
00:00979C 640D06              +129 ipNetToMediaIfIndex	mvo	SNMP_OID.13.43.6.1.2.1.4.22.1.1.128++4	MIB_FUNCTION.7	at_agentifindex
00:00979D 000B14              +129 
00:00979E 000007              +129 
00:00979F 000277              +129 
00:0097A0 000001              +129 
00:0097A1 000000              +129 
00:0097A2 640D06              +130 ipNetToMediaPhysAddress	mvo	SNMP_OID.13.43.6.1.2.1.4.22.1.2.128++4	MIB_FUNCTION.7	at_agentphysa
00:0097A3 000B18              +130 
00:0097A4 000007              +130 
00:0097A5 000278              +130 
00:0097A6 000001              +130 
00:0097A7 000000              +130 
  :                            131 		$endif
  :                            132 
  :                            133 
00:0097A8 410706              +134 ipRoutingDiscards	mvo	SNMP_OID.7.43.6.1.2.1.4.23	SNMP_COUNTER.6	 0
00:0097A9 000B1C              +134 
00:0097AA 000006              +134 
(+01)18
00:0097AB 000521              +134 
00:0097AC 000001              +134 
00:0097AD 000000              +134 
01:000521 000000000000        +134 
00:0097AE 410706              +135 icmpInMsgs	mvo	SNMP_OID.7.43.6.1.2.1.5.1	SNMP_COUNTER.6	 0
00:0097AF 000B1F              +135 
00:0097B0 000006              +135 
(+01)18
00:0097B1 000523              +135 
00:0097B2 000001              +135 
00:0097B3 000000              +135 
01:000523 000000000000        +135 
00:0097B4 410706              +136 icmpInErrors	mvo	SNMP_OID.7.43.6.1.2.1.5.2	SNMP_COUNTER.6	 0
00:0097B5 000B22              +136 
00:0097B6 000006              +136 
(+01)18
00:0097B7 000525              +136 
00:0097B8 000001              +136 
00:0097B9 000000              +136 
01:000525 000000000000        +136 
00:0097BA 410706              +137 icmpInDestUnReachs	mvo	SNMP_OID.7.43.6.1.2.1.5.3	SNMP_COUNTER.6	 0
00:0097BB 000B25              +137 
00:0097BC 000006              +137 
(+01)18
00:0097BD 000527              +137 
00:0097BE 000001              +137 
00:0097BF 000000              +137 
01:000527 000000000000        +137 
00:0097C0 410706              +138 icmpInTimeExcds	mvo	SNMP_OID.7.43.6.1.2.1.5.4	SNMP_COUNTER.6	 0
00:0097C1 000B28              +138 
00:0097C2 000006              +138 
(+01)18
00:0097C3 000529              +138 
00:0097C4 000001              +138 
00:0097C5 000000              +138 
01:000529 000000000000        +138 
00:0097C6 410706              +139 icmpParmProbs	mvo	SNMP_OID.7.43.6.1.2.1.5.5	SNMP_COUNTER.6	 0
00:0097C7 000B2B              +139 
00:0097C8 000006              +139 
(+01)18
00:0097C9 00052B              +139 
00:0097CA 000001              +139 
00:0097CB 000000              +139 
01:00052B 000000000000        +139 
00:0097CC 410706              +140 icmpInSrcQuenchs	mvo	SNMP_OID.7.43.6.1.2.1.5.6	SNMP_COUNTER.6	 0
00:0097CD 000B2E              +140 
00:0097CE 000006              +140 
(+01)18
00:0097CF 00052D              +140 
00:0097D0 000001              +140 
00:0097D1 000000              +140 
01:00052D 000000000000        +140 
00:0097D2 410706              +141 icmpInRedirects	mvo	SNMP_OID.7.43.6.1.2.1.5.7	SNMP_COUNTER.6	 0
00:0097D3 000B31              +141 
00:0097D4 000006              +141 
(+01)18
00:0097D5 00052F              +141 
00:0097D6 000001              +141 
00:0097D7 000000              +141 
01:00052F 000000000000        +141 
00:0097D8 410706              +142 icmpInEchos	mvo	SNMP_OID.7.43.6.1.2.1.5.8	SNMP_COUNTER.6	 0
00:0097D9 000B34              +142 
00:0097DA 000006              +142 
(+01)18
00:0097DB 000531              +142 
00:0097DC 000001              +142 
00:0097DD 000000              +142 
01:000531 000000000000        +142 
00:0097DE 410706              +143 icmpInEchoReps	mvo	SNMP_OID.7.43.6.1.2.1.5.9	SNMP_COUNTER.6	 0
00:0097DF 000B37              +143 
00:0097E0 000006              +143 
(+01)18
00:0097E1 000533              +143 
00:0097E2 000001              +143 
00:0097E3 000000              +143 
01:000533 000000000000        +143 
00:0097E4 410706              +144 icmpInTimeStamps	mvo	SNMP_OID.7.43.6.1.2.1.5.10	SNMP_COUNTER.6	 0
00:0097E5 000B3A              +144 
00:0097E6 000006              +144 
(+01)18
00:0097E7 000535              +144 
00:0097E8 000001              +144 
00:0097E9 000000              +144 
01:000535 000000000000        +144 
00:0097EA 410706              +145 icmpInTimestampReps	mvo	SNMP_OID.7.43.6.1.2.1.5.11	SNMP_COUNTER.6	 0
00:0097EB 000B3D              +145 
00:0097EC 000006              +145 
(+01)18
00:0097ED 000537              +145 
00:0097EE 000001              +145 
00:0097EF 000000              +145 
01:000537 000000000000        +145 
00:0097F0 410706              +146 icmpInAddrMasks	mvo	SNMP_OID.7.43.6.1.2.1.5.12	SNMP_COUNTER.6	 0
00:0097F1 000B40              +146 
00:0097F2 000006              +146 
(+01)18
00:0097F3 000539              +146 
00:0097F4 000001              +146 
00:0097F5 000000              +146 
01:000539 000000000000        +146 
00:0097F6 410706              +147 icmpInAddrMaskReps	mvo	SNMP_OID.7.43.6.1.2.1.5.13	SNMP_COUNTER.6	 0
00:0097F7 000B43              +147 
00:0097F8 000006              +147 
(+01)18
00:0097F9 00053B              +147 
00:0097FA 000001              +147 
00:0097FB 000000              +147 
01:00053B 000000000000        +147 
00:0097FC 410706              +148 icmpOutMsgs	mvo	SNMP_OID.7.43.6.1.2.1.5.14	SNMP_COUNTER.6	 0
00:0097FD 000B46              +148 
00:0097FE 000006              +148 
(+01)18
00:0097FF 00053D              +148 
00:009800 000001              +148 
00:009801 000000              +148 
01:00053D 000000000000        +148 
00:009802 410706              +149 icmpOutErrors	mvo	SNMP_OID.7.43.6.1.2.1.5.15	SNMP_COUNTER.6	 0
00:009803 000B49              +149 
00:009804 000006              +149 
(+01)18
00:009805 00053F              +149 
00:009806 000001              +149 
00:009807 000000              +149 
01:00053F 000000000000        +149 
00:009808 410706              +150 icmpOutDestUnreaches	mvo	SNMP_OID.7.43.6.1.2.1.5.16	SNMP_COUNTER.6	 0
00:009809 000B4C              +150 
00:00980A 000006              +150 
(+01)18
00:00980B 000541              +150 
00:00980C 000001              +150 
00:00980D 000000              +150 
01:000541 000000000000        +150 
00:00980E 410706              +151 icmpOutTimeExcds	mvo	SNMP_OID.7.43.6.1.2.1.5.17	SNMP_COUNTER.6	 0
00:00980F 000B4F              +151 
00:009810 000006              +151 
(+01)18
00:009811 000543              +151 
00:009812 000001              +151 
00:009813 000000              +151 
01:000543 000000000000        +151 
00:009814 410706              +152 icmpOutParmProbs	mvo	SNMP_OID.7.43.6.1.2.1.5.18	SNMP_COUNTER.6	 0
00:009815 000B52              +152 
00:009816 000006              +152 
(+01)18
00:009817 000545              +152 
00:009818 000001              +152 
00:009819 000000              +152 
01:000545 000000000000        +152 
00:00981A 410706              +153 icmpOutSrcQuenchs	mvo	SNMP_OID.7.43.6.1.2.1.5.19	SNMP_COUNTER.6	 0
00:00981B 000B55              +153 
00:00981C 000006              +153 
(+01)18
00:00981D 000547              +153 
00:00981E 000001              +153 
00:00981F 000000              +153 
01:000547 000000000000        +153 
00:009820 410706              +154 icmpOutRedirects	mvo	SNMP_OID.7.43.6.1.2.1.5.20	SNMP_COUNTER.6	 0
00:009821 000B58              +154 
00:009822 000006              +154 
(+01)18
00:009823 000549              +154 
00:009824 000001              +154 
00:009825 000000              +154 
01:000549 000000000000        +154 
00:009826 410706              +155 icmpOutEchos	mvo	SNMP_OID.7.43.6.1.2.1.5.21	SNMP_COUNTER.6	 0
00:009827 000B5B              +155 
00:009828 000006              +155 
(+01)18
00:009829 00054B              +155 
00:00982A 000001              +155 
00:00982B 000000              +155 
01:00054B 000000000000        +155 
00:00982C 410706              +156 icmpOutEchoReps	mvo	SNMP_OID.7.43.6.1.2.1.5.22	SNMP_COUNTER.6	 0
00:00982D 000B5E              +156 
00:00982E 000006              +156 
(+01)18
00:00982F 00054D              +156 
00:009830 000001              +156 
00:009831 000000              +156 
01:00054D 000000000000        +156 
00:009832 410706              +157 icmpOutTimeStamps	mvo	SNMP_OID.7.43.6.1.2.1.5.23	SNMP_COUNTER.6	 0
00:009833 000B61              +157 
00:009834 000006              +157 
(+01)18
00:009835 00054F              +157 
00:009836 000001              +157 
00:009837 000000              +157 
01:00054F 000000000000        +157 
00:009838 410706              +158 icmpOutTimestampReps	mvo	SNMP_OID.7.43.6.1.2.1.5.24	SNMP_COUNTER.6	 0
00:009839 000B64              +158 
00:00983A 000006              +158 
(+01)18
00:00983B 000551              +158 
00:00983C 000001              +158 
00:00983D 000000              +158 
01:000551 000000000000        +158 
00:00983E 410706              +159 icmpOutAddrMasks	mvo	SNMP_OID.7.43.6.1.2.1.5.25	SNMP_COUNTER.6	 0
00:00983F 000B67              +159 
00:009840 000006              +159 
(+01)18
00:009841 000553              +159 
00:009842 000001              +159 
00:009843 000000              +159 
01:000553 000000000000        +159 
00:009844 410706              +160 icmpOutAddrMaskReps	mvo	SNMP_OID.7.43.6.1.2.1.5.26	SNMP_COUNTER.6	 0
00:009845 000B6A              +160 
00:009846 000006              +160 
(+01)18
00:009847 000555              +160 
00:009848 000001              +160 
00:009849 000000              +160 
01:000555 000000000000        +160 
00:00984A 020706              +161 tcpRtoAlgorithm	mvo	SNMP_OID.7.43.6.1.2.1.6.1	SNMP_INT.3	 0
00:00984B 000B6D              +161 
00:00984C 000003              +161 
(+01)18
00:00984D 000557              +161 
00:00984E 000001              +161 
00:00984F 000000              +161 
01:000557 000000              +161 
00:009850 020706              +162 tcpRtoMin	mvo	SNMP_OID.7.43.6.1.2.1.6.2	SNMP_INT.3	 0
00:009851 000B70              +162 
00:009852 000003              +162 
(+01)18
00:009853 000558              +162 
00:009854 000001              +162 
00:009855 000000              +162 
01:000558 000000              +162 
00:009856 020706              +163 tcpRtoMax	mvo	SNMP_OID.7.43.6.1.2.1.6.3	SNMP_INT.3	 0
00:009857 000B73              +163 
00:009858 000003              +163 
(+01)18
00:009859 000559              +163 
00:00985A 000001              +163 
00:00985B 000000              +163 
01:000559 000000              +163 
00:00985C 020706              +164 tcpMaxConn	mvo	SNMP_OID.7.43.6.1.2.1.6.4	SNMP_INT.6	 7500000
00:00985D 000B76              +164 
00:00985E 000006              +164 
(+01)18
00:00985F 00055A              +164 
00:009860 000001              +164 
00:009861 000000              +164 
01:00055A 0000007270E0        +164 
00:009862 410706              +165 tcpActiveOpens	mvo	SNMP_OID.7.43.6.1.2.1.6.5	SNMP_COUNTER.6	 0
00:009863 000B79              +165 
00:009864 000006              +165 
(+01)18
00:009865 00055C              +165 
00:009866 000001              +165 
00:009867 000000              +165 
01:00055C 000000000000        +165 
00:009868 410706              +166 tcpPassiveOpens	mvo	SNMP_OID.7.43.6.1.2.1.6.6	SNMP_COUNTER.6	 0
00:009869 000B7C              +166 
00:00986A 000006              +166 
(+01)18
00:00986B 00055E              +166 
00:00986C 000001              +166 
00:00986D 000000              +166 
01:00055E 000000000000        +166 
00:00986E 410706              +167 tcpAttemptFails	mvo	SNMP_OID.7.43.6.1.2.1.6.7	SNMP_COUNTER.6	 0
00:00986F 000B7F              +167 
00:009870 000006              +167 
(+01)18
00:009871 000560              +167 
00:009872 000001              +167 
00:009873 000000              +167 
01:000560 000000000000        +167 
00:009874 410706              +168 tcpEstabResets	mvo	SNMP_OID.7.43.6.1.2.1.6.8	SNMP_COUNTER.6	 0
00:009875 000B82              +168 
00:009876 000006              +168 
(+01)18
00:009877 000562              +168 
00:009878 000001              +168 
00:009879 000000              +168 
01:000562 000000000000        +168 
00:00987A 640706              +169 tcpCurrEstab	mvo	SNMP_OID.7.43.6.1.2.1.6.9	MIB_FUNCTION	 tcp_agent_established
00:00987B 000B85              +169 
00:00987C 000000              +169 
00:00987D 000265              +169 
00:00987E 000001              +169 
00:00987F 000000              +169 
00:009880 410706              +170 tcpInSegs	mvo	SNMP_OID.7.43.6.1.2.1.6.10	SNMP_COUNTER.6	 0
00:009881 000B88              +170 
00:009882 000006              +170 
(+01)18
00:009883 000564              +170 
00:009884 000001              +170 
00:009885 000000              +170 
01:000564 000000000000        +170 
00:009886 410706              +171 tcpOutSegs	mvo	SNMP_OID.7.43.6.1.2.1.6.11	SNMP_COUNTER.6	 0
00:009887 000B8B              +171 
00:009888 000006              +171 
(+01)18
00:009889 000566              +171 
00:00988A 000001              +171 
00:00988B 000000              +171 
01:000566 000000000000        +171 
00:00988C 410706              +172 tcpRetransSegs	mvo	SNMP_OID.7.43.6.1.2.1.6.12	SNMP_COUNTER.6	 0
00:00988D 000B8E              +172 
00:00988E 000006              +172 
(+01)18
00:00988F 000568              +172 
00:009890 000001              +172 
00:009891 000000              +172 
01:000568 000000000000        +172 
  :                            173 
  :                            174 
                                tcpConnState	mvo	SNMP_OID.18.43.6.1.2.1.6.13.128++10.1	;
00:009892 641206              +176 			MIB_FUNCTION	tcp_agent_state
00:009893 000B91              +176 
00:009894 000000              +176 
00:009895 000260              +176 
00:009896 000001              +176 
00:009897 000000              +176 
  :                            177 
                                tcpConnLocalAddress mvo	SNMP_OID.18.43.6.1.2.1.6.13.128++10.2	;
00:009898 641206              +179 			MIB_FUNCTION	tcp_agent_neta
00:009899 000B94              +179 
00:00989A 000000              +179 
00:00989B 000261              +179 
00:00989C 000001              +179 
00:00989D 000000              +179 
  :                            180 
                                tcpConnLocalPort    mvo	SNMP_OID.18.43.6.1.2.1.6.13.128++10.3	;
00:00989E 641206              +182 			MIB_FUNCTION	tcp_agent_port
00:00989F 000B97              +182 
00:0098A0 000000              +182 
00:0098A1 000262              +182 
00:0098A2 000001              +182 
00:0098A3 000000              +182 
  :                            183 
                                tcpConnRemAddress   mvo	SNMP_OID.18.43.6.1.2.1.6.13.128++10.4	;
00:0098A4 641206              +185 			MIB_FUNCTION	tcp_agent_remote_neta
00:0098A5 000B9A              +185 
00:0098A6 000000              +185 
00:0098A7 000263              +185 
00:0098A8 000001              +185 
00:0098A9 000000              +185 
  :                            186 
                                tcpConnRemPort	mvo	SNMP_OID.18.43.6.1.2.1.6.13.128++10.5	;
00:0098AA 641206              +188 			MIB_FUNCTION.7	tcp_agent_remote_port
00:0098AB 000B9D              +188 
00:0098AC 000007              +188 
00:0098AD 000264              +188 
00:0098AE 000001              +188 
00:0098AF 000000              +188 
  :                            189 
00:0098B0 410706              +190 tcpInErrs	mvo	SNMP_OID.7.43.6.1.2.1.6.14	SNMP_COUNTER.6	 0
00:0098B1 000BA0              +190 
00:0098B2 000006              +190 
(+01)18
00:0098B3 00056A              +190 
00:0098B4 000001              +190 
00:0098B5 000000              +190 
01:00056A 000000000000        +190 
00:0098B6 410706              +191 tcpOutRsts	mvo	SNMP_OID.7.43.6.1.2.1.6.15	SNMP_COUNTER.6	 0
00:0098B7 000BA3              +191 
00:0098B8 000006              +191 
(+01)18
00:0098B9 00056C              +191 
00:0098BA 000001              +191 
00:0098BB 000000              +191 
01:00056C 000000000000        +191 
00:0098BC 410706              +192 tcpAddWait	mvo	SNMP_OID.7.43.6.1.2.1.6.16	SNMP_COUNTER.6	0
00:0098BD 000BA6              +192 
00:0098BE 000006              +192 
(+01)18
00:0098BF 00056E              +192 
00:0098C0 000001              +192 
00:0098C1 000000              +192 
01:00056E 000000000000        +192 
00:0098C2 410706              +193 tcpAddRelinquish mvo	SNMP_OID.7.43.6.1.2.1.6.21	SNMP_COUNTER.6	0
00:0098C3 000BA9              +193 
00:0098C4 000006              +193 
(+01)18
00:0098C5 000570              +193 
00:0098C6 000001              +193 
00:0098C7 000000              +193 
01:000570 000000000000        +193 
00:0098C8 410706              +194 tcpInDrops	mvo	SNMP_OID.7.43.6.1.2.1.6.22	SNMP_COUNTER.6	0
00:0098C9 000BAC              +194 
00:0098CA 000006              +194 
(+01)18
00:0098CB 000572              +194 
00:0098CC 000001              +194 
00:0098CD 000000              +194 
01:000572 000000000000        +194 
00:0098CE 410706              +195 tcpDupDrops	mvo	SNMP_OID.7.43.6.1.2.1.6.23	SNMP_COUNTER.6	0
00:0098CF 000BAF              +195 
00:0098D0 000006              +195 
(+01)18
00:0098D1 000574              +195 
00:0098D2 000001              +195 
00:0098D3 000000              +195 
01:000574 000000000000        +195 
00:0098D4 410706              +196 tcpOutAckDrops	mvo	SNMP_OID.7.43.6.1.2.1.6.24	SNMP_COUNTER.6	0
00:0098D5 000BB2              +196 
00:0098D6 000006              +196 
(+01)18
00:0098D7 000576              +196 
00:0098D8 000001              +196 
00:0098D9 000000              +196 
01:000576 000000000000        +196 
  :                            197 
00:0098DA 410706              +198 udpInDatagrams	mvo	SNMP_OID.7.43.6.1.2.1.7.1	SNMP_COUNTER.6	 0
00:0098DB 000BB5              +198 
00:0098DC 000006              +198 
(+01)18
00:0098DD 000578              +198 
00:0098DE 000001              +198 
00:0098DF 000000              +198 
01:000578 000000000000        +198 
00:0098E0 410706              +199 udpNoPorts	mvo	SNMP_OID.7.43.6.1.2.1.7.2	SNMP_COUNTER.3	 65536
00:0098E1 000BB8              +199 
00:0098E2 000003              +199 
(+01)18
00:0098E3 00057A              +199 
00:0098E4 000001              +199 
00:0098E5 000000              +199 
01:00057A 010000              +199 
00:0098E6 410706              +200 udpInErrors	mvo	SNMP_OID.7.43.6.1.2.1.7.3	SNMP_COUNTER.6	 0
00:0098E7 000BBB              +200 
00:0098E8 000006              +200 
(+01)18
00:0098E9 00057B              +200 
00:0098EA 000001              +200 
00:0098EB 000000              +200 
01:00057B 000000000000        +200 
00:0098EC 410706              +201 udpOutDatagrams	mvo	SNMP_OID.7.43.6.1.2.1.7.4	SNMP_COUNTER.6	 0
00:0098ED 000BBE              +201 
00:0098EE 000006              +201 
(+01)18
00:0098EF 00057D              +201 
00:0098F0 000001              +201 
00:0098F1 000000              +201 
01:00057D 000000000000        +201 
00:0098F2 640906              +202 udpLocalAddress	mvo	SNMP_OID.9.43.6.1.2.1.7.5.0.1	MIB_FUNCTION	 udp_agent1
00:0098F3 000BC1              +202 
00:0098F4 000000              +202 
00:0098F5 000246              +202 
00:0098F6 000001              +202 
00:0098F7 000000              +202 
00:0098F8 640906              +203 udpLocalPort	mvo	SNMP_OID.9.43.6.1.2.1.7.5.0.2	MIB_FUNCTION.7	 udp_agent2
00:0098F9 000BC4              +203 
00:0098FA 000007              +203 
00:0098FB 000247              +203 
00:0098FC 000001              +203 
00:0098FD 000000              +203 
00:0098FE 410706              +204 egpInMsgs	mvo	SNMP_OID.7.43.6.1.2.1.8.1	SNMP_COUNTER.6	 0
00:0098FF 000BC7              +204 
00:009900 000006              +204 
(+01)18
00:009901 00057F              +204 
00:009902 000001              +204 
00:009903 000000              +204 
01:00057F 000000000000        +204 
00:009904 410706              +205 egpInErrors	mvo	SNMP_OID.7.43.6.1.2.1.8.2	SNMP_COUNTER.6	 0
00:009905 000BCA              +205 
00:009906 000006              +205 
(+01)18
00:009907 000581              +205 
00:009908 000001              +205 
00:009909 000000              +205 
01:000581 000000000000        +205 
00:00990A 410706              +206 egpOutMsgs	mvo	SNMP_OID.7.43.6.1.2.1.8.3	SNMP_COUNTER.6	 0
00:00990B 000BCD              +206 
00:00990C 000006              +206 
(+01)18
00:00990D 000583              +206 
00:00990E 000001              +206 
00:00990F 000000              +206 
01:000583 000000000000        +206 
00:009910 410706              +207 egpOutErrors	mvo	SNMP_OID.7.43.6.1.2.1.8.4	SNMP_COUNTER.6	 0
00:009911 000BD0              +207 
00:009912 000006              +207 
(+01)18
00:009913 000585              +207 
00:009914 000001              +207 
00:009915 000000              +207 
01:000585 000000000000        +207 
00:009916 020906              +208 egpNeighState	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.1	SNMP_INT.3	 0
00:009917 000BD3              +208 
00:009918 000003              +208 
(+01)18
00:009919 000587              +208 
00:00991A 000001              +208 
00:00991B 000000              +208 
01:000587 000000              +208 
00:00991C 400906              +209 egpNeighAddr	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.2	SNMP_NETWORKADDRESS.4
00:00991D 000BD6              +209 
00:00991E 000004              +209 
(+01)18
00:00991F 000588              +209 
00:009920 000001              +209 
00:009921 000002              +209 
01:000588 000000000000        +209 
00:009922 020906              +210 egpNeighAs	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.3	SNMP_INT.3	 0
00:009923 000BD9              +210 
00:009924 000003              +210 
(+01)18
00:009925 00058A              +210 
00:009926 000001              +210 
00:009927 000000              +210 
01:00058A 000000              +210 
00:009928 410906              +211 egpNeighInMsgs	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.4	SNMP_COUNTER.6	 0
00:009929 000BDC              +211 
00:00992A 000006              +211 
(+01)18
00:00992B 00058B              +211 
00:00992C 000001              +211 
00:00992D 000000              +211 
01:00058B 000000000000        +211 
00:00992E 410906              +212 egpNeighInErrs	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.5	SNMP_COUNTER.6	 0
00:00992F 000BDF              +212 
00:009930 000006              +212 
(+01)18
00:009931 00058D              +212 
00:009932 000001              +212 
00:009933 000000              +212 
01:00058D 000000000000        +212 
00:009934 410906              +213 egpNeighOutMsgs	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.6	SNMP_COUNTER.6	 0
00:009935 000BE2              +213 
00:009936 000006              +213 
(+01)18
00:009937 00058F              +213 
00:009938 000001              +213 
00:009939 000000              +213 
01:00058F 000000000000        +213 
00:00993A 410906              +214 egpNeighOutErrs	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.7	SNMP_COUNTER.6	 0
00:00993B 000BE5              +214 
00:00993C 000006              +214 
(+01)18
00:00993D 000591              +214 
00:00993E 000001              +214 
00:00993F 000000              +214 
01:000591 000000000000        +214 
00:009940 410906              +215 egpNeighInErrMsgs	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.8	SNMP_COUNTER.6	 0
00:009941 000BE8              +215 
00:009942 000006              +215 
(+01)18
00:009943 000593              +215 
00:009944 000001              +215 
00:009945 000000              +215 
01:000593 000000000000        +215 
00:009946 410906              +216 egpNeighOutErrMsgs	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.9	SNMP_COUNTER.6	 0
00:009947 000BEB              +216 
00:009948 000006              +216 
(+01)18
00:009949 000595              +216 
00:00994A 000001              +216 
00:00994B 000000              +216 
01:000595 000000000000        +216 
00:00994C 410906              +217 egpNeighStateUps	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.10	SNMP_COUNTER.6	 0
00:00994D 000BEE              +217 
00:00994E 000006              +217 
(+01)18
00:00994F 000597              +217 
00:009950 000001              +217 
00:009951 000000              +217 
01:000597 000000000000        +217 
00:009952 410906              +218 egpNeighStateDowns	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.11	SNMP_COUNTER.6	 0
00:009953 000BF1              +218 
00:009954 000006              +218 
(+01)18
00:009955 000599              +218 
00:009956 000001              +218 
00:009957 000000              +218 
01:000599 000000000000        +218 
00:009958 020906              +219 egpNeighIntervalHello	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.12	SNMP_INT.3	 0
00:009959 000BF4              +219 
00:00995A 000003              +219 
(+01)18
00:00995B 00059B              +219 
00:00995C 000001              +219 
00:00995D 000000              +219 
01:00059B 000000              +219 
00:00995E 020906              +220 egpNeighIntervalPoll	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.13	SNMP_INT.3	 0
00:00995F 000BF7              +220 
00:009960 000003              +220 
(+01)18
00:009961 00059C              +220 
00:009962 000001              +220 
00:009963 000000              +220 
01:00059C 000000              +220 
00:009964 020906              +221 egpNeighMode	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.14	SNMP_INT.3	 0
00:009965 000BFA              +221 
00:009966 000003              +221 
(+01)18
00:009967 00059D              +221 
00:009968 000001              +221 
00:009969 000000              +221 
01:00059D 000000              +221 
00:00996A 020906              +222 egpNeighEventTrigger	mvo	SNMP_OID.9.43.6.1.2.1.8.5.1.15	SNMP_INT.3	 0
00:00996B 000BFD              +222 
00:00996C 000003              +222 
(+01)18
00:00996D 00059E              +222 
00:00996E 000001              +222 
00:00996F 000000              +222 
01:00059E 000000              +222 
00:009970 020706              +223 egpAs	mvo	SNMP_OID.7.43.6.1.2.1.8.6	SNMP_INT.3	 0
00:009971 000C00              +223 
00:009972 000003              +223 
(+01)18
00:009973 00059F              +223 
00:009974 000001              +223 
00:009975 000000              +223 
01:00059F 000000              +223 
00:009976 410706              +224 snmpInPkts	mvo	SNMP_OID.7.43.6.1.2.1.11.1	SNMP_COUNTER.6	 0
00:009977 000C03              +224 
00:009978 000006              +224 
(+01)18
00:009979 0005A0              +224 
00:00997A 000001              +224 
00:00997B 000000              +224 
01:0005A0 000000000000        +224 
00:00997C 410706              +225 snmpOutPkts	mvo	SNMP_OID.7.43.6.1.2.1.11.2	SNMP_COUNTER.6	 0
00:00997D 000C06              +225 
00:00997E 000006              +225 
(+01)18
00:00997F 0005A2              +225 
00:009980 000001              +225 
00:009981 000000              +225 
01:0005A2 000000000000        +225 
00:009982 410706              +226 snmpInBadVersions	mvo	SNMP_OID.7.43.6.1.2.1.11.3	SNMP_COUNTER.6	 0
00:009983 000C09              +226 
00:009984 000006              +226 
(+01)18
00:009985 0005A4              +226 
00:009986 000001              +226 
00:009987 000000              +226 
01:0005A4 000000000000        +226 
00:009988 410706              +227 snmpInBadCommunityNames	mvo	SNMP_OID.7.43.6.1.2.1.11.4	SNMP_COUNTER.6	 0
00:009989 000C0C              +227 
00:00998A 000006              +227 
(+01)18
00:00998B 0005A6              +227 
00:00998C 000001              +227 
00:00998D 000000              +227 
01:0005A6 000000000000        +227 
00:00998E 410706              +228 snmpInBadCommunityUses	mvo	SNMP_OID.7.43.6.1.2.1.11.5	SNMP_COUNTER.6	 0
00:00998F 000C0F              +228 
00:009990 000006              +228 
(+01)18
00:009991 0005A8              +228 
00:009992 000001              +228 
00:009993 000000              +228 
01:0005A8 000000000000        +228 
00:009994 410706              +229 snmpInASNParseErrors	mvo	SNMP_OID.7.43.6.1.2.1.11.6	SNMP_COUNTER.6	 0
00:009995 000C12              +229 
00:009996 000006              +229 
(+01)18
00:009997 0005AA              +229 
00:009998 000001              +229 
00:009999 000000              +229 
01:0005AA 000000000000        +229 
00:00999A 410706              +230 snmpInTooBigs	mvo	SNMP_OID.7.43.6.1.2.1.11.8	SNMP_COUNTER.6	 0
00:00999B 000C15              +230 
00:00999C 000006              +230 
(+01)18
00:00999D 0005AC              +230 
00:00999E 000001              +230 
00:00999F 000000              +230 
01:0005AC 000000000000        +230 
00:0099A0 410706              +231 snmpInNoSuchNames	mvo	SNMP_OID.7.43.6.1.2.1.11.9	SNMP_COUNTER.6	 0
00:0099A1 000C18              +231 
00:0099A2 000006              +231 
(+01)18
00:0099A3 0005AE              +231 
00:0099A4 000001              +231 
00:0099A5 000000              +231 
01:0005AE 000000000000        +231 
00:0099A6 410706              +232 snmpInBadValues	mvo	SNMP_OID.7.43.6.1.2.1.11.10	SNMP_COUNTER.6	 0
00:0099A7 000C1B              +232 
00:0099A8 000006              +232 
(+01)18
00:0099A9 0005B0              +232 
00:0099AA 000001              +232 
00:0099AB 000000              +232 
01:0005B0 000000000000        +232 
00:0099AC 410706              +233 snmpInReadOnlys	mvo	SNMP_OID.7.43.6.1.2.1.11.11	SNMP_COUNTER.6	 0
00:0099AD 000C1E              +233 
00:0099AE 000006              +233 
(+01)18
00:0099AF 0005B2              +233 
00:0099B0 000001              +233 
00:0099B1 000000              +233 
01:0005B2 000000000000        +233 
00:0099B2 410706              +234 snmpInGenErrs	mvo	SNMP_OID.7.43.6.1.2.1.11.12	SNMP_COUNTER.6	 0
00:0099B3 000C21              +234 
00:0099B4 000006              +234 
(+01)18
00:0099B5 0005B4              +234 
00:0099B6 000001              +234 
00:0099B7 000000              +234 
01:0005B4 000000000000        +234 
00:0099B8 410706              +235 snmpInTotalReqVars	mvo	SNMP_OID.7.43.6.1.2.1.11.13	SNMP_COUNTER.6	 0
00:0099B9 000C24              +235 
00:0099BA 000006              +235 
(+01)18
00:0099BB 0005B6              +235 
00:0099BC 000001              +235 
00:0099BD 000000              +235 
01:0005B6 000000000000        +235 
00:0099BE 410706              +236 snmpInTotalSetVars	mvo	SNMP_OID.7.43.6.1.2.1.11.14	SNMP_COUNTER.6	 0
00:0099BF 000C27              +236 
00:0099C0 000006              +236 
(+01)18
00:0099C1 0005B8              +236 
00:0099C2 000001              +236 
00:0099C3 000000              +236 
01:0005B8 000000000000        +236 
00:0099C4 410706              +237 snmpInGetRequests	mvo	SNMP_OID.7.43.6.1.2.1.11.15	SNMP_COUNTER.6	 0
00:0099C5 000C2A              +237 
00:0099C6 000006              +237 
(+01)18
00:0099C7 0005BA              +237 
00:0099C8 000001              +237 
00:0099C9 000000              +237 
01:0005BA 000000000000        +237 
00:0099CA 410706              +238 snmpInGetNexts	mvo	SNMP_OID.7.43.6.1.2.1.11.16	SNMP_COUNTER.6	 0
00:0099CB 000C2D              +238 
00:0099CC 000006              +238 
(+01)18
00:0099CD 0005BC              +238 
00:0099CE 000001              +238 
00:0099CF 000000              +238 
01:0005BC 000000000000        +238 
00:0099D0 410706              +239 snmpInSetRequests	mvo	SNMP_OID.7.43.6.1.2.1.11.17	SNMP_COUNTER.6	 0
00:0099D1 000C30              +239 
00:0099D2 000006              +239 
(+01)18
00:0099D3 0005BE              +239 
00:0099D4 000001              +239 
00:0099D5 000000              +239 
01:0005BE 000000000000        +239 
00:0099D6 410706              +240 snmpInGetResponses	mvo	SNMP_OID.7.43.6.1.2.1.11.18	SNMP_COUNTER.6	 0
00:0099D7 000C33              +240 
00:0099D8 000006              +240 
(+01)18
00:0099D9 0005C0              +240 
00:0099DA 000001              +240 
00:0099DB 000000              +240 
01:0005C0 000000000000        +240 
00:0099DC 410706              +241 snmpInTraps	mvo	SNMP_OID.7.43.6.1.2.1.11.19	SNMP_COUNTER.6	 0
00:0099DD 000C36              +241 
00:0099DE 000006              +241 
(+01)18
00:0099DF 0005C2              +241 
00:0099E0 000001              +241 
00:0099E1 000000              +241 
01:0005C2 000000000000        +241 
00:0099E2 410706              +242 snmpOutTooBigs	mvo	SNMP_OID.7.43.6.1.2.1.11.20	SNMP_COUNTER.6	 0
00:0099E3 000C39              +242 
00:0099E4 000006              +242 
(+01)18
00:0099E5 0005C4              +242 
00:0099E6 000001              +242 
00:0099E7 000000              +242 
01:0005C4 000000000000        +242 
00:0099E8 410706              +243 snmpOutNoSuchNames	mvo	SNMP_OID.7.43.6.1.2.1.11.21	SNMP_COUNTER.6	 0
00:0099E9 000C3C              +243 
00:0099EA 000006              +243 
(+01)18
00:0099EB 0005C6              +243 
00:0099EC 000001              +243 
00:0099ED 000000              +243 
01:0005C6 000000000000        +243 
00:0099EE 410706              +244 snmpOutBadValues	mvo	SNMP_OID.7.43.6.1.2.1.11.22	SNMP_COUNTER.6	 0
00:0099EF 000C3F              +244 
00:0099F0 000006              +244 
(+01)18
00:0099F1 0005C8              +244 
00:0099F2 000001              +244 
00:0099F3 000000              +244 
01:0005C8 000000000000        +244 
00:0099F4 410706              +245 snmpOutGenErrs	mvo	SNMP_OID.7.43.6.1.2.1.11.24	SNMP_COUNTER.6	 0
00:0099F5 000C42              +245 
00:0099F6 000006              +245 
(+01)18
00:0099F7 0005CA              +245 
00:0099F8 000001              +245 
00:0099F9 000000              +245 
01:0005CA 000000000000        +245 
00:0099FA 410706              +246 snmpOutGetRequests	mvo	SNMP_OID.7.43.6.1.2.1.11.25	SNMP_COUNTER.6	 0
00:0099FB 000C45              +246 
00:0099FC 000006              +246 
(+01)18
00:0099FD 0005CC              +246 
00:0099FE 000001              +246 
00:0099FF 000000              +246 
01:0005CC 000000000000        +246 
00:009A00 410706              +247 snmpOutGetNexts	mvo	SNMP_OID.7.43.6.1.2.1.11.26	SNMP_COUNTER.6	 0
00:009A01 000C48              +247 
00:009A02 000006              +247 
(+01)18
00:009A03 0005CE              +247 
00:009A04 000001              +247 
00:009A05 000000              +247 
01:0005CE 000000000000        +247 
00:009A06 410706              +248 snmpOutSetRequests	mvo	SNMP_OID.7.43.6.1.2.1.11.27	SNMP_COUNTER.6	 0
00:009A07 000C4B              +248 
00:009A08 000006              +248 
(+01)18
00:009A09 0005D0              +248 
00:009A0A 000001              +248 
00:009A0B 000000              +248 
01:0005D0 000000000000        +248 
00:009A0C 410706              +249 snmpOutGetResponses	mvo	SNMP_OID.7.43.6.1.2.1.11.28	SNMP_COUNTER.6	 0
00:009A0D 000C4E              +249 
00:009A0E 000006              +249 
(+01)18
00:009A0F 0005D2              +249 
00:009A10 000001              +249 
00:009A11 000000              +249 
01:0005D2 000000000000        +249 
00:009A12 410706              +250 snmpOutTraps	mvo	SNMP_OID.7.43.6.1.2.1.11.29	SNMP_COUNTER.6	 0
00:009A13 000C51              +250 
00:009A14 000006              +250 
(+01)18
00:009A15 0005D4              +250 
00:009A16 000001              +250 
00:009A17 000000              +250 
01:0005D4 000000000000        +250 
00:009A18 020706              +251 snmpEnableAuthenTraps	mvo	SNMP_OID.7.43.6.1.2.1.11.30	SNMP_INT.3	 0
00:009A19 000C54              +251 
00:009A1A 000003              +251 
(+01)18
00:009A1B 0005D6              +251 
00:009A1C 000001              +251 
00:009A1D 000000              +251 
01:0005D6 000000              +251 
  :                            252 
  :                            253 	$list		5
  :                            254: 	$include	loadp2
  :                            1 IP_CIDR_ROUTE_AGENT	$equ	1
  :                            2 
  :                            3 			$if	IP_CIDR_ROUTE_AGENT
00:009A1E 641006              +4 inetCidrRouteDestType	mvo	SNMP_OID.16.43.6.1.2.1.4.24.7.1.1.1.6.128++4	MIB_FUNCTION.7	ip_agent_cidr_route_dest_type	. 1
00:009A1F 000C57              +4 
00:009A20 000007              +4 
00:009A21 000270              +4 
00:009A22 000001              +4 
00:009A23 000000              +4 
00:009A24 641006              +5 inetCidrRouteDest	mvo	SNMP_OID.16.43.6.1.2.1.4.24.7.1.2.1.6.128++4	MIB_FUNCTION.7	ip_agent_cidr_route_dest
00:009A25 000C5C              +5 
00:009A26 000007              +5 
00:009A27 000271              +5 
00:009A28 000001              +5 
00:009A29 000000              +5 
00:009A2A 641006              +6 inetCidrRoutePfxLen	mvo	SNMP_OID.16.43.6.1.2.1.4.24.7.1.3.1.6.128++4	MIB_FUNCTION.7	ip_agent_cidr_route_mask_log	. /LOG
00:009A2B 000C61              +6 
00:009A2C 000007              +6 
00:009A2D 000272              +6 
00:009A2E 000001              +6 
00:009A2F 000000              +6 
00:009A30 641006              +7 inetCidrRouteNextHopType mvo	SNMP_OID.16.43.6.1.2.1.4.24.7.1.5.1.6.128++4	MIB_FUNCTION.7	ip_agent_cidr_route_next_hop_type . 0 / 1
00:009A31 000C66              +7 
00:009A32 000007              +7 
00:009A33 000273              +7 
00:009A34 000001              +7 
00:009A35 000000              +7 
00:009A36 641006              +8 inetCidrRouteNextHop	mvo	SNMP_OID.16.43.6.1.2.1.4.24.7.1.6.1.6.128++4	MIB_FUNCTION.7	ip_agent_cidr_route_next_hop	. 0.0.0.0 / gateway
00:009A37 000C6B              +8 
00:009A38 000007              +8 
00:009A39 000274              +8 
00:009A3A 000001              +8 
00:009A3B 000000              +8 
00:009A3C 641006              +9 inetCidrRouteIfIndex	mvo	SNMP_OID.16.43.6.1.2.1.4.24.7.1.7.1.6.128++4	MIB_FUNCTION.7	ip_agent_cidr_route_ifidx
00:009A3D 000C70              +9 
00:009A3E 000007              +9 
00:009A3F 000275              +9 
00:009A40 000001              +9 
00:009A41 000000              +9 
00:009A42 641006              +10 inetCidrRouteType	mvo	SNMP_OID.16.43.6.1.2.1.4.24.7.1.8.1.6.128++4	MIB_FUNCTION.7	ip_agent_cidr_route_type	. 3 / 4
00:009A43 000C75              +10 
00:009A44 000007              +10 
00:009A45 000276              +10 
00:009A46 000001              +10 
00:009A47 000000              +10 
  :                            11 			$endif
  :                            255 	$list		4
  :                            256 
01:0005D7 000000              +257 	0
  :                            258 	$sterm	':'
  :                            259 $(0)
00:009A48 000000              +260 	+	0
  :                            261 
  :                            267 
  :                            268 $(0)
  :                            269 	$do	$<256,$(0:256)
  :                            270 	$do	$zenith>4096,	$flag	ap_bank2 overflow
  :                            271 
  :                            272 IP_NEXT_DGRAM_ID* $equ  ipOutRequests:i
  :                            273 
  :                            128 
  :                            129 b1_high	$set	$(1)
[b1_high][0000000000000000000000000000000000000000000005d8]
  :                            130 	$trace	b1_high
  :                            131 
[$zenith(3)][0000000000000000000000000000000000000000000026b8]
  :                            132 	$trace	$zenith(3)
  :                            133 
  :                            1491 	$path
*EOF*
00:009a49+000000000000000000000000
00:009a4d+000244
00:009a4e+000242
00:009a4f+00FFFF
00:009a50+02F000
00:009a51+030000
00:009a52+000000
00:009a53+BC0028
00:009a54+BC0002
00:009a55+BC0000
00:009a56+BC0040
00:009a57+000001000001
00:009a59+2B0601020101010000
00:009a5c+2B0601020101020000
00:009a5f+2B0601020101030000
00:009a62+2B0601020101040000
00:009a65+2B0601020101050000
00:009a68+2B0601020101060000
00:009a6b+2B0601020101070000
00:009a6e+2B0601020102010000
00:009a71+2B0601020102020001
00:009a74+2B0601020102020002
00:009a77+2B0601020102020003
00:009a7a+2B0601020102020004
00:009a7d+2B0601020102020005
00:009a80+2B0601020102020006
00:009a83+2B0601020102020007
00:009a86+2B0601020102020008
00:009a89+2B0601020102020009
00:009a8c+2B060102010202000A
00:009a8f+2B060102010202000B
00:009a92+2B060102010202000C
00:009a95+2B060102010202000D
00:009a98+2B060102010202000E
00:009a9b+2B060102010202000F
00:009a9e+2B0601020102020010
00:009aa1+2B0601020102020011
00:009aa4+2B0601020102020012
00:009aa7+2B0601020102020013
00:009aaa+2B0601020102020014
00:009aad+2B0601020102020015
00:009ab0+2B0601020102020016
00:009ab3+2B0601020103010101840000
00:009ab7+2B0601020103010102840000
00:009abb+2B0601020104010000
00:009abe+2B0601020104020000
00:009ac1+2B0601020104030000
00:009ac4+2B0601020104040000
00:009ac7+2B0601020104050000
00:009aca+2B0601020104060000
00:009acd+2B0601020104070000
00:009ad0+2B0601020104080000
00:009ad3+2B0601020104090000
00:009ad6+2B06010201040A0000
00:009ad9+2B06010201040B0000
00:009adc+2B06010201040C0000
00:009adf+2B06010201040D0000
00:009ae2+2B06010201040E0000
00:009ae5+2B06010201040F0000
00:009ae8+2B0601020104100000
00:009aeb+2B0601020104110000
00:009aee+2B0601020104120000
00:009af1+2B0601020104130000
00:009af4+2B0601020104140101840000
00:009af8+2B0601020104140102840000
00:009afc+2B0601020104140103840000
00:009b00+2B0601020104150101840000
00:009b04+2B0601020104150102840000
00:009b08+2B0601020104150107840000
00:009b0c+2B0601020104150108840000
00:009b10+2B060102010415010B840000
00:009b14+2B0601020104160101840000
00:009b18+2B0601020104160102840000
00:009b1c+2B0601020104170000
00:009b1f+2B0601020105010000
00:009b22+2B0601020105020000
00:009b25+2B0601020105030000
00:009b28+2B0601020105040000
00:009b2b+2B0601020105050000
00:009b2e+2B0601020105060000
00:009b31+2B0601020105070000
00:009b34+2B0601020105080000
00:009b37+2B0601020105090000
00:009b3a+2B06010201050A0000
00:009b3d+2B06010201050B0000
00:009b40+2B06010201050C0000
00:009b43+2B06010201050D0000
00:009b46+2B06010201050E0000
00:009b49+2B06010201050F0000
00:009b4c+2B0601020105100000
00:009b4f+2B0601020105110000
00:009b52+2B0601020105120000
00:009b55+2B0601020105130000
00:009b58+2B0601020105140000
00:009b5b+2B0601020105150000
00:009b5e+2B0601020105160000
00:009b61+2B0601020105170000
00:009b64+2B0601020105180000
00:009b67+2B0601020105190000
00:009b6a+2B06010201051A0000
00:009b6d+2B0601020106010000
00:009b70+2B0601020106020000
00:009b73+2B0601020106030000
00:009b76+2B0601020106040000
00:009b79+2B0601020106050000
00:009b7c+2B0601020106060000
00:009b7f+2B0601020106070000
00:009b82+2B0601020106080000
00:009b85+2B0601020106090000
00:009b88+2B06010201060A0000
00:009b8b+2B06010201060B0000
00:009b8e+2B06010201060C0000
00:009b91+2B06010201060D8A01
00:009b94+2B06010201060D8A02
00:009b97+2B06010201060D8A03
00:009b9a+2B06010201060D8A04
00:009b9d+2B06010201060D8A05
00:009ba0+2B06010201060E0000
00:009ba3+2B06010201060F0000
00:009ba6+2B0601020106100000
00:009ba9+2B0601020106150000
00:009bac+2B0601020106160000
00:009baf+2B0601020106170000
00:009bb2+2B0601020106180000
00:009bb5+2B0601020107010000
00:009bb8+2B0601020107020000
00:009bbb+2B0601020107030000
00:009bbe+2B0601020107040000
00:009bc1+2B0601020107050001
00:009bc4+2B0601020107050002
00:009bc7+2B0601020108010000
00:009bca+2B0601020108020000
00:009bcd+2B0601020108030000
00:009bd0+2B0601020108040000
00:009bd3+2B0601020108050101
00:009bd6+2B0601020108050102
00:009bd9+2B0601020108050103
00:009bdc+2B0601020108050104
00:009bdf+2B0601020108050105
00:009be2+2B0601020108050106
00:009be5+2B0601020108050107
00:009be8+2B0601020108050108
00:009beb+2B0601020108050109
00:009bee+2B060102010805010A
00:009bf1+2B060102010805010B
00:009bf4+2B060102010805010C
00:009bf7+2B060102010805010D
00:009bfa+2B060102010805010E
00:009bfd+2B060102010805010F
00:009c00+2B0601020108060000
00:009c03+2B060102010B010000
00:009c06+2B060102010B020000
00:009c09+2B060102010B030000
00:009c0c+2B060102010B040000
00:009c0f+2B060102010B050000
00:009c12+2B060102010B060000
00:009c15+2B060102010B080000
00:009c18+2B060102010B090000
00:009c1b+2B060102010B0A0000
00:009c1e+2B060102010B0B0000
00:009c21+2B060102010B0C0000
00:009c24+2B060102010B0D0000
00:009c27+2B060102010B0E0000
00:009c2a+2B060102010B0F0000
00:009c2d+2B060102010B100000
00:009c30+2B060102010B110000
00:009c33+2B060102010B120000
00:009c36+2B060102010B130000
00:009c39+2B060102010B140000
00:009c3c+2B060102010B150000
00:009c3f+2B060102010B160000
00:009c42+2B060102010B180000
00:009c45+2B060102010B190000
00:009c48+2B060102010B1A0000
00:009c4b+2B060102010B1B0000
00:009c4e+2B060102010B1C0000
00:009c51+2B060102010B1D0000
00:009c54+2B060102010B1E0000
00:009c57+2B0601020104180701010106840000
00:009c5c+2B0601020104180701020106840000
00:009c61+2B0601020104180701030106840000
00:009c66+2B0601020104180701050106840000
00:009c6b+2B0601020104180701060106840000
00:009c70+2B0601020104180701070106840000
00:009c75+2B0601020104180701080106840000
01:0005d8+736F6674776172654C6F6F706261636B0000
01:0005de+706C6174666F726D5F72656C617900
01:0005e3+65746865726E65745F72656C617900
01:0005e8+706C6174666F726D5F72656C617932
01:0005ed+
01:0005ed+776562
01:0005ee+776562320000
01:0005f0+696E6465782E68746D6C0000
03:00261f+2A6970000000
03:002621+2A74656C6E65740000
03:002624+636F6E736F6C65207468726561647320646973706C61790A
03:00262c+6B6579206820666F7220636F6D6D616E64206C6973740A00
03:002634+6E6F2074696D656F75740A00
03:002638+256C64206D532025730A0000
03:00263c+7A65726F2074696D656F75740A0000
03:002641+20776F72647320667265650A
03:002645+0A0000
03:002646+3E0000
03:002647+746872656164206E6F74206163746976650A
03:00264d+5254413120736D617261676437204F532073686172656420
636F6E736F6C650A00
03:002658+5B7265757365645D00000000
03:00265c+706C6174666F726D206B6565706572206F6E6C7900
03:002663+696E697469616C2073746172747570730000
03:002669+2F696E697469616C2F736372697074000000
03:00266f+2A6874747000
03:002671+0D0A0D0A0000
03:002673+0D0A00
03:002674+485454502F312E3120323030204F4B0D0A436F6E74656E74
2D547970653A20746578742F68746D6C3B20636861727365
743D5554462D380D0A436F6E74656E742D4C656E6774683A
2033360D0A0D0A3C68746D6C3E3C6469763E0D0A77656220
61726368697665206E6F7420666F756E640D0A3C2F646976
3E3C2F68746D6C3E0D0A0000
03:0026a0+2A6973657276657200
03:0026a3+2A66706F6E6C696E65000000
03:0026a7+2D302E3009092E201B5B34313B313B33376D6578706F6E65
6E74206F766572666C6F771B5B306D
03:0026b4+2A736E6D705F6167656E7400
$$call_space=000003
$$frame=000000
$$list=000006
$$params=000003
$$swap=$00:000D6C
$$xframe=$46:000000
$$zero_stack=000000
$0p1=$00:000007
$1=$01:000007
$192=:N65:F:0:000000
$3=$03:000007
$FINESSE=000001
$LOCK_SWITCH=000001
$SMP+=$00:00007E
$ZETA+=$00:00007C
$bind=$00:000EA6
$bind:construct_port_block=$00:000EA6
$bind:zero_port_block=$00:000EAC
$bind:bind_in_block=$00:000EB3
$bind:ports_block_up=$00:000EBA
$bind:ports_block_online=$00:000EBC
$bind:seek_random_free_port=$00:000EBF
$bind:another_random_port=$00:000ECC
$bind:bind_show_random_result=$00:000ECE
$bind:find_in_blocks_range=$00:000ECF
$bind:find_in_blocks_exit=$00:000ED6
$bind:network_bind=$00:000ED7
$bind:handle=000003,00000F
$bind:sockaddress=000004,00000F
$bind:network_bindz=$00:000EE4
$bind:autobind=$00:000EE6
$bind:encoding=000004,00000F
$bind:sockad=000005,00000F
$bind:connections_tablep=000000,00000F
$bind:net_bind_tcp?=$00:000EED
$bind:assign_port=$00:000EF4
$bind:net_bind_memory_up=$00:000EFF
$bind:net_bind_memory_online=$00:000F01
$bind:assign_wildcard_socket=$00:000F07
$bind:assign_socket=$00:000F0E
$bind:net_nontcp=$00:000F1B
$bind:net_result_confirm=$00:000F1D
$bind:net_bind_no_protocol=$00:000F21
$bind:already_bound=$00:000F23
$bind:net_bind_no_storage=$00:000F25
$bind:net_bind_z=$00:000F26
$bits=000048
$command=.24.24
$fraction=:N65:F:0:000002
$i_f_part=:N65:F:0:000000
$if0p+=$01:000000
$if2p+=$01:000002
$ifzp+=$01:000009
$initial_ift1
$integer=:N65:F:0:000001
$light_flight
$net_ipv4=:N65:F:0:000000
$net_socket=:N129:P:0:000000
$neta=:F1:000053
$netp=.32.16
$normalised=:N65:F:0:000000
$p0=$00:000007
$rxtx_ift1
$rxtx_lo
$sockaddr=:N129:P:0:000000
$socket=:N129:P:0:000000
$sockif+=$00:000A1B
$sockif:socket_connect=$00:000A1B
$sockif:handle1=000007,00000F
$sockif:target_address=000008,00000F
$sockif:socket_address=000002,00000F
$sockif:handle_encoding=000000,00000F
$sockif:connection_port_bound=$00:000A33
$sockif:write_derived_source=$00:000A3E
$sockif:no_new_source=$00:000A42
$sockif:udp_connect_status=$00:000A53
$sockif:socket_nane=$00:000A56
$sockif:tcp_connect=$00:000A58
$sockif:update_tcp_handle=$00:000A66
$sockif:connect_x=$00:000A69
$sockif:connect_y=$00:000A6A
$sockif:active_connect=$00:000A6E
$sockif:addresses=000007,00000F
$sockif:fast_release=00000B,00000F
$sockif:connect_socketpointer=000002,00000F
$sockif:default_ifp=000001,00000F
$sockif:send_syn_tries=000000,00000F
$sockif:connect_local_wildcard=$00:000A88
$sockif:connect_fixport=$00:000A93
$sockif:connect_socket_storage_assigned=$00:000A96
$sockif:connect_bound_source?=$00:000A9C
$sockif:connect_routed_source=$00:000A9C
$sockif:connect_source_net=$00:000AA1
$sockif:connect_syn_tx=$00:000AB4
$sockif:connect_no_tx=$00:000ABB
$sockif:connect_syn_sent=$00:000AC3
$sockif:connect_review=$00:000ACE
$sockif:connections_tank_unprepared=$00:000ADA
$sockif:you_may_not=$00:000ADC
$sockif:connect_reverse=$00:000ADD
$sockif:connect_no_path=$00:000AE7
$sockif:connect_bad_argument=$00:000AE9
$sockif:connect_return=$00:000AEA
$sockif:tcp_await_connection=$00:000AEE
$sockif:port_socket=000004,00000F
$sockif:txarray_bank=000000,00000F
$sockif:tcp_search_new=$00:000B06
$sockif:tcp_test_new=$00:000B0C
$sockif:tcp_porthandle_wrong=$00:000B15
$sockif:tcp_awaitx=$00:000B16
$sockif:tcp_newhandle=$00:000B1B
$sockif:tcp_newhandle_x=$00:000B1F
$sockif:net_disengage=$00:000B20
$sockif:close_handle=000003,00000F
$sockif:traffic_free?=$00:000B29
$sockif:traffic_gate=$00:000B2F
$sockif:disengage_port?=$00:000B34
$sockif:disengage_tcp_port?=$00:000B3C
$sockif:disengage_handle=$00:000B43
$sockif:port_disengage_udp=$00:000B47
$sockif:port_disengage=$00:000B4B
$sockif:port_disengage_z=$00:000B4D
$sockif:disconnect_free=$00:000B4E
$sockif:free_tcp_port=$00:000B4F
$sockif:free_tcp_port_z=$00:000B56
$sockif:app_tcp_port=$00:000B57
$sockif:app_tcp_port_x=$00:000B5A
$sockif:tcp_fin1=$00:000B5B
$sockif:tcp_fin=$00:000B5C
$sockif:tcp_disconnect_z=$00:000B5E
$sockif:sock_structure_connection=$00:000B60
$sockif:sock_structure_port=$00:000B61
$sockif:tcp_port_socket=$00:000B67
$x_=:N129:P:0:000000
$x_add=:N129:P:0:000000
$x_divide=:N129:P:0:000000
$x_load=:N129:P:0:000000
$x_load_negative=:N129:P:0:000000
$x_multiply=:N129:P:0:000000
$x_reserve=:N129:P:0:000000
$x_retrieve_add=:N129:P:0:000000
$x_retrieve_divide=:N129:P:0:000000
$x_retrieve_multiply=:N129:P:0:000000
$x_retrieve_subtract=:N129:P:0:000000
$x_subtract=:N129:P:0:000000
$xbase=:P1:0:00003E
A$IDX+=$00:000073
A2_WORDS=0001F4
ACTIVITY_SPACE=000001
ACW_SIZE=$46:000008
AF_INET=000002
AGENT1_PORT=000000
AGENT2_TUPLES=000018
ALREADY_CONNECTED=000038
ANYNET=000000
APPLICATION(1)=00B000
APPLICATION(2)=00C000
APPLICATION_HEADER_WORDS=080000
APPLICATION_PROTOCOLS=:N129:P:0:000000
AP_DATA=000010
ARP=000806
ARP_HASH=000010
ARP_REFRESH=124F80
ARP_REPLY=000002
ARP_REQUEST=000001
ARP_STORE=000003
AT_AGENT=000001
AT_HASH_LIST=[0055]000000
AT_POINTER_ARRAY=[0054]000000
B$IDX+=$00:000074
B4=000088
BAD_ADDRESS=00000E
BAD_ARGUMENT=000016
BANKS=000086
BER_TRANSIENT_SIZE=000006
BROADCAST_AND_MAXREASM
BYTES=000010
CACHE_NETB$+=$00:00006C
CALIBRATE_PORT=000000
CHAINS=000020
CHAINS_LOG=000005
CHAINS_MASK=00001F
COULD_NOT=000023
CR=00000D
D0_WORDS=003000
DFRAME$+=$00:000064
DFRAME$FREE+=$00:000065
DIRECTORY=000015
DISALLOWED=000001
DLT_E10MB=000001
DLT_FDDI=00000A
DLT_IEEE802_11=000069
DLT_LOOP=00006C
DLT_NULL=000000
DLT_SLIP=000008
DLT_TRUNK=000258
DMAXINB=0A0000
DMAXINP=002800
DYNAMIC_CHAIN_HEAD=000006
DYNAMIC_CHAIN_TAIL=000007
DYNAMIC_IP_HEADER=000000
ENERGY$+=$00:00007D
ENET_HASH_LIST
ENET_POINTER_ARRAY
ESC=00001B
ETHERNET_CSMACD=000006
ETHERNET_SPACE=000001
EXISTS=000011
F$FRAMES=[0001]000000
FILE$HANDLE+=$00:00007B
FILE_NOT_OPEN=000020
FLAGS_FRAGMENT=000008
FO$FRAME+=$00:000079
FO$HEAP+=$00:00007A
FPONLINE_MESSAGE_LIMIT=0000C8
FPONLINE_PORT=000083
FPSERVER_PORT=000080
FPSERVER_PORT2=000082
FREE=:P1:0:000065
FREE_DEVB$+=$00:00006E
FREE_NETB$+=$00:000070
FREE_SOCKB$+=$00:00006F
HEADER_BYTES=000010
HEADER_LONGWORDS=000010
HEADER_SUM=000006
HLEN=000006
HL_FLAGS=00001B
HORIZONTAL_TAB=000009
HT=000009
HTTP_PORT=000050
HTTP_THREADED=000001
HTTP_USER=000001
HTYPE=000001
HVBANK=000000
HVSOCKET=000001
HVSOCKET_LOG=000003
ICMP_DESTINATION_UNREACHABLE=000003
ICMP_DU_DF=000004
ICMP_DU_HOST=000001
ICMP_DU_NET=000000
ICMP_DU_PORT=000003
ICMP_DU_PROTOCOL=000002
ICMP_DU_SRF=000005
ICMP_ECHO_REQUEST=000008
ICMP_ECHO_RESPONSE=000000
ICMP_REDIRECT=000005
IFCONFIG=006969
IFGW=000004
IFNUMBER_I+=$01:0004FD
IF_WORDS=$42:000046,000002
II_FREE=:N129:P:0:000000
II_LOCK=:N129:P:0:000000
INTERFACES=000008
INTERFACES_HIGH_INDEX+=$01:0001F4
INT_SYSCALL=000004
IO_ERROR=000005
IP=000800
IPINDISCARDS_I+=$01:00050A
IPPROTO_ICMP=000001
IPPROTO_TCP=000006
IPPROTO_UDP=000011
IPREASMFAILS_I+=$01:000519
IPV4_DINITIAL_BANK=003000
IPV4_FRAGMENTED_DGRAMS=000000
IPV4_OVERHAUL=0000A0
IP_ADDRESS_AGENT=000001
IP_CIDR_ROUTE_AGENT=000001
IP_DEFAULT_TTL=003C00
IP_DNF=004000
IP_MORE=002000
IP_NET2_MEDIA_AGENT=000001
IP_NEXT_DGRAM_ID+=$01:00050E
IP_OFFSET_MASK=001FFF
IP_ROUTE_AGENT=000001
ISERVER_PORT=000081
I_F=000012
I_F_IDX=00000A
I_F_P=000008
I_SERVER_THREADED=000001
JUMBOMAX=00404C
LAST_BYTE_READ=000013
LF=00000A
LIBRARY=006000
LINK_PROTOCOL=000806
LOCK=:P1:0:000064
LOG=:F1:000041
LOG1BIT=:F1:00005F
LONGEST_LL_HEADER=000007
MAXIMUM=002000
MIB=002000
MIB_ACOUNT48=:N129:P:0:000000
MIB_FUNCTION=000064
MIB_FUNCTION_RETRIEVE=000063
MIB_ICOUNT48=:N129:P:0:000000
MIB_READ_ALLOWED=000001
MIB_WRITE_ALLOWED=000002
MSG_NONBLOCK=000080
MSG_WAITALL=000040
MSS=00001A
MTU=000011
NET2SYM$+=$00:000071
NETBUF_MAX=002040
NETMASK_ABSOLUTE=000007
NETSERVER_INTENSIVE$=000001
NETWORK_D=003000
NET_ADAPTING=000001
NET_ADDRESSES=000018
NET_ATTENTION_PORT=000079
NET_BANKS=000010
NET_BASE=000030
NET_BUFFER_THRESHOLD=000080
NET_FREECHAINS=000102
NET_GRANULE=000020
NET_LOG=000005
NON_BLOCKING=00001B
NOT_DEVICE=000013
NOT_DIRECTORY=000014
NOT_THERE=000002
NOT_YOU=00000D
NO_CONNECTION=000020
NO_DATA=000060
NO_DEVICE=000006
NO_FILE_TYPE=000009
NO_HANDLE=000016
NO_PATH=000041
NO_PIPE=000020
NO_PROTOCOL=00002A
NO_STORAGE=00000C
ONETIME_SAVE$=$00:000076
ONE_TIME_SAVE1=000091
ON_NETB$+=$00:00006D
OPEN=:P1:0:000066
OUTSIZE=000087
OVERSIZE=000028
PD_INET=000800
PER_SECOND=00003B9ACA00
PF_INET=000002
PLATFORM_RELAY=000064
PLATFORM_RELAY2=000065
PLEN=000004
PORT_ALREADY_BOUND=00003A
PORT_NOT_BOUND=000039
PROTOCOL_SUITE=000800
QSIMULTANEOUS=000001
QUAD=000008
QUIET_SAVE=:P1:0:00003B
READ_BYTE=:P3:0:0000BE
READ_START=:P1:0:0000BC
READ_STREAM_START=:P1:0:0000BA
REBOUND75=:P1:0:00003A
RECORD_MARK=000011
RECORD_MARK_FLAG=000010
RELAY_ROUTE=000800
REMOTE_REFUSED=00003D
REPACKED=000001
REQUIRED=000086
RESTART_EI$=$00:000075
REST_GRANULE=0001F4
ROUTES=000018
ROUTE_CONFIG=006767
ROUTING_HEADER=000010
RPAGES=000080
RPAGEW=000400
RX_APDATA=000010
RX_BANKS=00000C
RX_BASE=000020
RX_BUFFER=000000C00000
RX_FRAGMENTS=000000
RX_LL_HL=000010
SCALE=000012
SCALE_TRIPPED=000012
SHUT=:P1:0:000067
SIGALERT=000000
SIGNS=000011
SIMD_CONTROL=:N129:P:0:000000
SIMD_TARGET=:N129:P:0:000000
SIZE=000086
SNMP_AGENT_THREADED=000001
SNMP_BADVALUE=000003
SNMP_COUNTER=000041
SNMP_GAUGE=000042
SNMP_GENERIC_TRAP_6=000006
SNMP_GENERR=000005
SNMP_GETNEXTREQ=0000A1
SNMP_GETREQ=0000A0
SNMP_GETRESP=0000A2
SNMP_INT=000002
SNMP_NETWORKADDRESS=000040
SNMP_NOSUCHNAME=000002
SNMP_NULL=000005
SNMP_OID=000006
SNMP_PORT=0000A1
SNMP_READONLY=000004
SNMP_SEQUENCE=000030
SNMP_SETREQ=0000A3
SNMP_STRING=000004
SNMP_TIMETICKS=000043
SNMP_TOOBIG=000001
SNMP_TRAPREQ=0000A4
SNMP_TRAP_PORT=0000A2
SOCKET_CALL_FLAGS=00001B
SOCKET_ENGAGED=FFFFFE
SOCKET_LPOINTER=000012
SOCKET_NO_PROTOCOL=FFFFFF
SOFTWARELOOPBACK=000018
SOFTWARE_I_F=000001
SOFT_I_F_CAPACITY=004000
STACKED_ITEST=000000
SUB=00001A
SUMMIT$3
T77_DRIVERS_THREADED=000000
TCP_5WORDH=005000
TCP_6WORDH=006000
TCP_ACK=000010
TCP_ALIGN_ON_REJECT=000000
TCP_CLOSED=000001
TCP_CLOSEWAIT=000008
TCP_CLOSING=00000A
TCP_DELETETCB=00000C
TCP_ESTABLISHED=000005
TCP_FIN=000001
TCP_FINWAIT1=000006
TCP_FINWAIT2=000007
TCP_FLAGS=000FFF
TCP_HL=00F000
TCP_LASTACK=000009
TCP_LISTEN=000002
TCP_MIB=000152
TCP_NOQ=000001
TCP_PSH=000008
TCP_REFLEX_SEQUENCE_ON_REJECT=000001
TCP_RELINQUISHED=000040
TCP_RST=000004
TCP_SEEK_ANOMALY=000000
TCP_STATES_BEAT=00000A
TCP_SYN=000002
TCP_SYNRECEIVED=000004
TCP_SYNSENT=000003
TCP_TCB=00003F
TCP_TIMER1=0927C0
TCP_TIMER2=000BB8
TCP_TIMEWAIT=00000B
TCP_TIMEWAIT_MS=002710
TCP_URG=000020
TCP_WINDOW_ON_REJECT=000000
TELNET_THREADED=000001
TERAFRAME$+=$00:000077
THREAD$STATE+=$00:000072
THREAD_FP(1)=006000
THRESHOLD_PACKETS=005DC0
TIMED_OUT=00003C
TPAYLOAD_BYTES=000012
TPORTCHAIN=:F1:000061
TP_HEADER=000011
TRANSFER_PAGE_HIGH=$00:0008CA
TRIPLE=000009
TX_AXW=000008
TX_BANKS=000004
TX_BASE=000020
TX_BUFFER=000000F00000
TX_DATAGRAM=000013
TX_DATAGRAML=00000B
TX_DESCRIPTORS=000003
TX_FLAG_OFFSET=00000A
TX_FRAGMENTS=000000
TX_FRAME=000009
UDP_AUTO_CONNECT=100000
UDP_NOSOURCENET=000027
UDP_NO_CHECKSUM=200000
UDP_TX_KEEP=000000800000
UPROTOCOL_BYTES=00000B
USOCKET$+=$00:000078
WINDOW=000013
WRITE3_BYTES=:P1:0:0000C0
WRITE_BYTE=:N129:P:0:000000
WRITE_BYTES=:P1:0:0000C1
WRITE_START=:P1:0:0000BD
WRITE_STREAM_START=:P1:0:0000BB
WRITE_UBYTE=:N129:P:0:000000
XDR_TCP_INLINE=000000
X_ADD=000004
X_ADD_NEGATIVE=000005
X_CODES=00001A
X_COSINE=000011
X_COSINE96=000015
X_COTANGENT=000013
X_COTANGENT96=000017
X_CUBE=000010
X_CUBE_ROOT=00000F
X_DEVICE=000012
X_DIVIDE=000007
X_EXIT=000000
X_FRACTION=000018
X_INTEGER=000019
X_LOAD=000001
X_LOAD_NEGATIVE=000002
X_MULTIPLY=000006
X_POP_ADD=000008
X_POP_ADD_NEGATIVE=000009
X_POP_DIVIDE=00000B
X_POP_MULTIPLY=00000A
X_PUSH=000003
X_SINE=00000D
X_SINE96=000014
X_SQUARE=00000E
X_SQUARE_ROOT=00000C
X_TANGENT=000012
X_TANGENT96=000016
__ALERTS=$00:000003
__II_LOCK=000000
__PANGA=00003C
__REMOTE_ACK=000001,00000F
__SOCHECK=000001
__accept+=$00:00008F
__bind+=$00:000082
__connect+=$00:000083
__cosine=:N129:P:0:000000
__cotan=:N129:P:0:000000
__disconnect_free_tcp+=$00:000095
__free_tcp_port+=$00:000094
__ifconfig
__ift2_align
__ift2_mirror
__initial_ift2
__net_disengage+=$00:000091
__port_disengage+=$00:000092
__port_disengage_udp+=$00:000093
__route+=$00:000088
__route_config
__rxtx_ift2
__sine=:N129:P:0:000000
__socket+=$00:000081
__sprintf
__tangent=:N129:P:0:000000
__tcp_connect+=$00:00008C
__tcp_socket+=$00:000096
_cosine=:N129:P:0:000000
_cotan=:N129:P:0:000000
_cube=:N129:P:0:000000
_fraction=:N129:P:0:000000
_integer=:N129:P:0:000000
_root=:N129:P:0:000000
_root3=:N129:P:0:000000
_sine=:N129:P:0:000000
_square=:N129:P:0:000000
_tangent=:N129:P:0:000000
a2_add_tuple=$00:000B09
a2_axw=000000,00000F
a2_ber_transient(1)=$03:00019C
a2_ber_transient(1):ojet=$03:00019C
a2_ber_transient(1):bytes=$03:00019D
a2_ber_transient(1):data=$03:00019E
a2_ber_transient(1):storage=$03:00019F
a2_ber_transient(1):oidl=$03:0001A0
a2_ber_transient(1):oid=$03:0001A1
a2_ber_transient(10)=$03:0001D2
a2_ber_transient(10):ojet=$03:0001D2
a2_ber_transient(10):bytes=$03:0001D3
a2_ber_transient(10):data=$03:0001D4
a2_ber_transient(10):storage=$03:0001D5
a2_ber_transient(10):oidl=$03:0001D6
a2_ber_transient(10):oid=$03:0001D7
a2_ber_transient(11)=$03:0001D8
a2_ber_transient(11):ojet=$03:0001D8
a2_ber_transient(11):bytes=$03:0001D9
a2_ber_transient(11):data=$03:0001DA
a2_ber_transient(11):storage=$03:0001DB
a2_ber_transient(11):oidl=$03:0001DC
a2_ber_transient(11):oid=$03:0001DD
a2_ber_transient(12)=$03:0001DE
a2_ber_transient(12):ojet=$03:0001DE
a2_ber_transient(12):bytes=$03:0001DF
a2_ber_transient(12):data=$03:0001E0
a2_ber_transient(12):storage=$03:0001E1
a2_ber_transient(12):oidl=$03:0001E2
a2_ber_transient(12):oid=$03:0001E3
a2_ber_transient(13)=$03:0001E4
a2_ber_transient(13):ojet=$03:0001E4
a2_ber_transient(13):bytes=$03:0001E5
a2_ber_transient(13):data=$03:0001E6
a2_ber_transient(13):storage=$03:0001E7
a2_ber_transient(13):oidl=$03:0001E8
a2_ber_transient(13):oid=$03:0001E9
a2_ber_transient(14)=$03:0001EA
a2_ber_transient(14):ojet=$03:0001EA
a2_ber_transient(14):bytes=$03:0001EB
a2_ber_transient(14):data=$03:0001EC
a2_ber_transient(14):storage=$03:0001ED
a2_ber_transient(14):oidl=$03:0001EE
a2_ber_transient(14):oid=$03:0001EF
a2_ber_transient(15)=$03:0001F0
a2_ber_transient(15):ojet=$03:0001F0
a2_ber_transient(15):bytes=$03:0001F1
a2_ber_transient(15):data=$03:0001F2
a2_ber_transient(15):storage=$03:0001F3
a2_ber_transient(15):oidl=$03:0001F4
a2_ber_transient(15):oid=$03:0001F5
a2_ber_transient(16)=$03:0001F6
a2_ber_transient(16):ojet=$03:0001F6
a2_ber_transient(16):bytes=$03:0001F7
a2_ber_transient(16):data=$03:0001F8
a2_ber_transient(16):storage=$03:0001F9
a2_ber_transient(16):oidl=$03:0001FA
a2_ber_transient(16):oid=$03:0001FB
a2_ber_transient(17)=$03:0001FC
a2_ber_transient(17):ojet=$03:0001FC
a2_ber_transient(17):bytes=$03:0001FD
a2_ber_transient(17):data=$03:0001FE
a2_ber_transient(17):storage=$03:0001FF
a2_ber_transient(17):oidl=$03:000200
a2_ber_transient(17):oid=$03:000201
a2_ber_transient(18)=$03:000202
a2_ber_transient(18):ojet=$03:000202
a2_ber_transient(18):bytes=$03:000203
a2_ber_transient(18):data=$03:000204
a2_ber_transient(18):storage=$03:000205
a2_ber_transient(18):oidl=$03:000206
a2_ber_transient(18):oid=$03:000207
a2_ber_transient(19)=$03:000208
a2_ber_transient(19):ojet=$03:000208
a2_ber_transient(19):bytes=$03:000209
a2_ber_transient(19):data=$03:00020A
a2_ber_transient(19):storage=$03:00020B
a2_ber_transient(19):oidl=$03:00020C
a2_ber_transient(19):oid=$03:00020D
a2_ber_transient(2)=$03:0001A2
a2_ber_transient(2):ojet=$03:0001A2
a2_ber_transient(2):bytes=$03:0001A3
a2_ber_transient(2):data=$03:0001A4
a2_ber_transient(2):storage=$03:0001A5
a2_ber_transient(2):oidl=$03:0001A6
a2_ber_transient(2):oid=$03:0001A7
a2_ber_transient(20)=$03:00020E
a2_ber_transient(20):ojet=$03:00020E
a2_ber_transient(20):bytes=$03:00020F
a2_ber_transient(20):data=$03:000210
a2_ber_transient(20):storage=$03:000211
a2_ber_transient(20):oidl=$03:000212
a2_ber_transient(20):oid=$03:000213
a2_ber_transient(21)=$03:000214
a2_ber_transient(21):ojet=$03:000214
a2_ber_transient(21):bytes=$03:000215
a2_ber_transient(21):data=$03:000216
a2_ber_transient(21):storage=$03:000217
a2_ber_transient(21):oidl=$03:000218
a2_ber_transient(21):oid=$03:000219
a2_ber_transient(22)=$03:00021A
a2_ber_transient(22):ojet=$03:00021A
a2_ber_transient(22):bytes=$03:00021B
a2_ber_transient(22):data=$03:00021C
a2_ber_transient(22):storage=$03:00021D
a2_ber_transient(22):oidl=$03:00021E
a2_ber_transient(22):oid=$03:00021F
a2_ber_transient(23)=$03:000220
a2_ber_transient(23):ojet=$03:000220
a2_ber_transient(23):bytes=$03:000221
a2_ber_transient(23):data=$03:000222
a2_ber_transient(23):storage=$03:000223
a2_ber_transient(23):oidl=$03:000224
a2_ber_transient(23):oid=$03:000225
a2_ber_transient(24)=$03:000226
a2_ber_transient(24):ojet=$03:000226
a2_ber_transient(24):bytes=$03:000227
a2_ber_transient(24):data=$03:000228
a2_ber_transient(24):storage=$03:000229
a2_ber_transient(24):oidl=$03:00022A
a2_ber_transient(24):oid=$03:00022B
a2_ber_transient(3)=$03:0001A8
a2_ber_transient(3):ojet=$03:0001A8
a2_ber_transient(3):bytes=$03:0001A9
a2_ber_transient(3):data=$03:0001AA
a2_ber_transient(3):storage=$03:0001AB
a2_ber_transient(3):oidl=$03:0001AC
a2_ber_transient(3):oid=$03:0001AD
a2_ber_transient(4)=$03:0001AE
a2_ber_transient(4):ojet=$03:0001AE
a2_ber_transient(4):bytes=$03:0001AF
a2_ber_transient(4):data=$03:0001B0
a2_ber_transient(4):storage=$03:0001B1
a2_ber_transient(4):oidl=$03:0001B2
a2_ber_transient(4):oid=$03:0001B3
a2_ber_transient(5)=$03:0001B4
a2_ber_transient(5):ojet=$03:0001B4
a2_ber_transient(5):bytes=$03:0001B5
a2_ber_transient(5):data=$03:0001B6
a2_ber_transient(5):storage=$03:0001B7
a2_ber_transient(5):oidl=$03:0001B8
a2_ber_transient(5):oid=$03:0001B9
a2_ber_transient(6)=$03:0001BA
a2_ber_transient(6):ojet=$03:0001BA
a2_ber_transient(6):bytes=$03:0001BB
a2_ber_transient(6):data=$03:0001BC
a2_ber_transient(6):storage=$03:0001BD
a2_ber_transient(6):oidl=$03:0001BE
a2_ber_transient(6):oid=$03:0001BF
a2_ber_transient(7)=$03:0001C0
a2_ber_transient(7):ojet=$03:0001C0
a2_ber_transient(7):bytes=$03:0001C1
a2_ber_transient(7):data=$03:0001C2
a2_ber_transient(7):storage=$03:0001C3
a2_ber_transient(7):oidl=$03:0001C4
a2_ber_transient(7):oid=$03:0001C5
a2_ber_transient(8)=$03:0001C6
a2_ber_transient(8):ojet=$03:0001C6
a2_ber_transient(8):bytes=$03:0001C7
a2_ber_transient(8):data=$03:0001C8
a2_ber_transient(8):storage=$03:0001C9
a2_ber_transient(8):oidl=$03:0001CA
a2_ber_transient(8):oid=$03:0001CB
a2_ber_transient(9)=$03:0001CC
a2_ber_transient(9):ojet=$03:0001CC
a2_ber_transient(9):bytes=$03:0001CD
a2_ber_transient(9):data=$03:0001CE
a2_ber_transient(9):storage=$03:0001CF
a2_ber_transient(9):oidl=$03:0001D0
a2_ber_transient(9):oid=$03:0001D1
a2_bound=$01:000422
a2_construct_response=$00:000AFA
a2_defer=$00:000B3F
a2_drop=$00:000B3B
a2_error_response=$00:000B13
a2_gener8=$00:000B4C
a2_get=$00:000ADA
a2_getcluster=$00:000AE5
a2_getnext=$00:000ADA
a2_highest_tuple=000006,00000F
a2_inaxw=000004,00000F
a2_ix=$03:00022D
a2_mirror=$00:000B18
a2_next=$00:000AAD
a2_octets=000005,00000F
a2_permission=$03:00022C
a2_qload=$00:000B2C
a2_release=$00:000B39
a2_restartbits=000001,00000F
a2_restartp=000003,00000F
a2_sample=$00:000AA8
a2_seq_sta_erx=$00:000B42
a2_set=$00:000ADA
a2_snmp_gerr=$00:000B12
a2_socket=$01:000421
a2_stop=$00:000B3F
a2_sva=$01:000423
a2_total8=000007,00000F
a2_transmit_response1=$00:000B0E
a2_write_headers=$00:000B65
a_protos_inline=$00:000047
ack_request+=$00:000097
activate_exit=$00:000100
activate_thread=$00:0000F6
activity_revision=$03:000004
acw=:P1:0:000046
add_chain=$00:0001C2
add_chain_total=$00:0001C9
add_large_bank=$00:000229
affinity_ii=$00:000622
agent2+=$00:000146
agent_2=$00:000A87
agent_2scan=$00:000A8B
akt=$03:000000
alert_ii=$00:000103
alert_iix=$00:000136
alert_index22=$00:00010D
alerts=$00:000111
anomaly=$00:00004A
ap_lib192=$00:00068A
ap_lib192:square_root=$00:00068A
ap_lib192:magnitude2=000014,00000F
ap_lib192:trial2=000009,00000F
ap_lib192:diminuition2=000001,00000F
ap_lib192:signs2=000000,00000F
ap_lib192:square_away=$00:000695
ap_lib192:uprate=$00:00069E
ap_lib192:start_variation=$00:0006A1
ap_lib192:downrate=$00:0006A6
ap_lib192:downrate_again!=$00:0006A8
ap_lib192:downrate_down=$00:0006BB
ap_lib192:downrate_again?=$00:0006C2
ap_lib192:arrive=$00:0006C7
ap_lib192:square=$00:0006CF
ap_lib192:root=000005,00000F
ap_lib192:polar=000001,00000F
ap_lib192:caller_x=000000,00000F
ap_lib192:cube_root=$00:0006E0
ap_lib192:magnitude3=000014,00000F
ap_lib192:trial3=000009,00000F
ap_lib192:diminuition3=000001,00000F
ap_lib192:signs3=000000,00000F
ap_lib192:root3_start=$00:0006EB
ap_lib192:up3wards=$00:0006F4
ap_lib192:scale_away3=$00:0006F6
ap_lib192:downrate3=$00:0006FB
ap_lib192:downrate3_again!=$00:0006FD
ap_lib192:downrate3_down=$00:000718
ap_lib192:downrate3_again?=$00:000721
ap_lib192:arrive3=$00:000725
ap_lib192:cube=$00:000730
ap_lib192:cubase=000003,00000F
ap_lib192:flip8=$00:00073D
ap_lib192:fraction=$00:000746
ap_lib192:fraction:input=000007,00000F
ap_lib192:fraction:i_rkxy=000000,00000F
ap_lib192:fraction:all_integer=$00:000760
ap_lib192:fraction:all_fraction=$00:000763
ap_lib192:fraction:complete=$00:000763
ap_lib192:integer=$00:000765
ap_lib192:integer:input=000007,00000F
ap_lib192:integer:i_rkxy=000000,00000F
ap_lib192:integer:major_part_only=$00:000775
ap_lib192:integer:major_part_plus=$00:00077C
ap_lib192:integer:all_fraction=$00:000789
ap_lib192:integer:all_integer=$00:00078C
ap_lib192:integer:complete=$00:00078C
ap_lib96=$00:00078E
ap_lib96:fraction=$00:00078E
ap_lib96:fraction:input=000007,00000F
ap_lib96:fraction:i_rkxy=000000,00000F
ap_lib96:fraction:all_integer=$00:0007A3
ap_lib96:fraction:all_fraction=$00:0007A5
ap_lib96:fraction:complete=$00:0007A5
ap_lib96:integer=$00:0007A7
ap_lib96:integer:input=000007,00000F
ap_lib96:integer:i_rkxy=000000,00000F
ap_lib96:integer:all_fraction=$00:0007B4
ap_lib96:integer:all_integer=$00:0007B6
ap_lib96:integer:complete=$00:0007B6
ap_lib96:sign_around=$00:0007B8
ap_lib96:output=000000,00000F
ap_lib96:insert6=$00:0007C5
ap_lib96:insert7=$00:0007CC
ap_lib96:reload=$00:0007D1
app_protos+=$00:000160
app_threads+=$00:00015F
arp_cache=:N129:P:0:000000
arp_dgram=:N129:P:0:000000
arp_rx=$00:000F6F
arp_store=:N65:F:0:000000
array=$00:0001FF
array_high_ix=$00:000201
array_ii=$00:00004E
assign_xvector_ii=$00:0005CF
atIfIndex=$00:0006EC
atIfIndex:rw_typ_tokens_words=$00:0006EC
atIfIndex:o=$00:0006ED
atIfIndex:l=$00:0006EE
atIfIndex:data=$00:0006EF
atIfIndex:flags=$00:0006F0
atIfIndex:bucket=$00:0006F1
atIfIndex:ranges=$00:0006F1
atIfIndex:range=$00:0006F2
atIfIndex:advance=$00:0006F2
atIfIndex:netstring=:N129:P:0:000000
atPhysAddress=$00:0006F2
atPhysAddress:rw_typ_tokens_words=$00:0006F2
atPhysAddress:o=$00:0006F3
atPhysAddress:l=$00:0006F4
atPhysAddress:data=$00:0006F5
atPhysAddress:flags=$00:0006F6
atPhysAddress:bucket=$00:0006F7
atPhysAddress:ranges=$00:0006F7
atPhysAddress:range=$00:0006F8
atPhysAddress:advance=$00:0006F8
atPhysAddress:netstring=:N129:P:0:000000
at_agentifindex=$00:000277
at_agentnetaddress=$00:000279
at_agentphysa=$00:000278
at_lib=$00:000606
at_lib:arp_row=$42:000000,000002
at_lib:arp_row:next=$42:000000,000002
at_lib:arp_row:refresh=$42:000001,000002
at_lib:arp_row:i_f=$42:000002,000002
at_lib:arp_row:tha=$42:000003,000002
at_lib:arp_row:tpa=$42:000006,000002
at_lib:at_this=$00:000606
at_lib:again=$00:00060B
at_lib:at_higher=$00:000612
at_lib:next?=$00:000614
at_lib:next!=$00:00061D
at_lib:pack_neta=$00:00061E
at_lib:unpack_neta=$00:000627
at_lib:pack_phy=$00:000630
at_lib:deliver_ifidx=$00:000636
at_physa_act=000005,00000F
at_physa_oidp=000003,00000F
at_physa_seq=000004,00000F
at_proto_act=000005,00000F
at_proto_oidp=000003,00000F
at_proto_seq=000004,00000F
at_x_action=000005,00000F
at_x_oidp=000003,00000F
at_x_sequence=000004,00000F
atagent_if_id=$01:0004E5
atagent_ifidx=$01:0004D0
atagent_ifidx:along=$01:0004D0
atagent_ifidx:data=$01:0004D1
atagent_ifidx:down=$01:0004D1
atagent_ifidx:seq=$01:0004D2
atagent_ifidx:type=$01:0004D3
atagent_ifidx:bytes=$01:0004D4
atagent_ifidx:flags=$01:0004D5
atagent_ifidx:bucket=$01:0004D6
atagent_ifidx:ranges=$01:0004D6
atagent_ifidx:range=$01:0004D7
atagent_neta=$01:0004DE
atagent_neta:along=$01:0004DE
atagent_neta:data=$01:0004DF
atagent_neta:down=$01:0004DF
atagent_neta:seq=$01:0004E0
atagent_neta:type=$01:0004E1
atagent_neta:bytes=$01:0004E2
atagent_neta:flags=$01:0004E3
atagent_neta:bucket=$01:0004E4
atagent_neta:ranges=$01:0004E4
atagent_neta:range=$01:0004E5
atagent_physa=$01:0004D7
atagent_physa:along=$01:0004D7
atagent_physa:data=$01:0004D8
atagent_physa:down=$01:0004D8
atagent_physa:seq=$01:0004D9
atagent_physa:type=$01:0004DA
atagent_physa:bytes=$01:0004DB
atagent_physa:flags=$01:0004DC
atagent_physa:bucket=$01:0004DD
atagent_physa:ranges=$01:0004DD
atagent_physa:range=$01:0004DE
atagent_string=$01:0004E6
athreads_start=$00:000040
available_banks=$00:0001BB
axw=$43:000000,000003
axw:next=$43:000000,000003
axw:frame=$43:000001,000003
axw:i_f=$43:000002,000003
axw:bytes=$43:000003,000003
axw:dgram=$43:000004,000003
axw:uproto=$43:000005,000003
axw:sobdi=$43:000006,000003
axw:apdata=$43:000006,000003
axw:tcbloc=$43:000007,000003
axw:ifql=$43:000007,000003
axw:lso=$43:000007,000003
axw:total_bytes=$43:000007,000003
axw:readpoint=$43:000007,000003
axw:next_bdi=$43:000007,000003
b1_high=$01:0005D8
b1_ii=$00:0005F2
b1_stack_given=$00:000376
bank=$00:0001D0
bank_free=$00:000160
bank_free_ii=$00:000057
bank_free_return=$00:0001B9
bank_free_sysmem=$00:00005F
bank_freed=$00:00006C
bank_freewheel=$00:000063
bank_ii=$00:000045
bank_is_free=$00:00018B
bank_not_obtained=$00:00022F
banks_lock_cell=$41:003003
base_management_bank=$00:00010B
base_management_page=$00:0000F4
base_standard_netbuf_ii=$00:000689
ber_akku=000002,00000F
ber_command=$03:00022E
ber_edit_cluster=$00:000CE4
ber_edit_integer=$00:000B92
ber_edit_length1=$00:000BC3
ber_edit_length2=$00:000BD6
ber_edit_long=$00:000BA3
ber_edit_mojet=$00:000B7A
ber_edit_oid=$00:000BDA
ber_edit_rotate1=$00:000BBD
ber_edit_rotate2=$00:000BD0
ber_edit_semantic_i=$00:000CCA
ber_edit_string=$00:000BE0
ber_edit_ul=$00:000BC7
ber_edit_unsigned=$00:000BB3
ber_esi_effect=$00:000CDC
ber_esi_shift=$00:000CD4
ber_inbytes=000005,00000F
ber_load_oid=$00:000C38
ber_load_oid?=$00:000C39
ber_load_oid_octet!=$00:000C47
ber_load_oid_octet?=$00:000C4C
ber_load_oidx=$00:000C4D
ber_oid_array=000006,00000F
ber_read_data=$00:000C9D
ber_read_datai=$00:000C9E
ber_release16!=$00:000C2F
ber_release16?=$00:000C32
ber_release_cluster=$00:000CEF
ber_release_cluster_p=$00:000CEE
ber_release_identifier=$00:000C17
ber_release_ioctet!=$00:000C00
ber_release_ioctet?=$00:000C03
ber_release_mo=$00:000BE8
ber_release_moi=$00:000BF8
ber_release_netaddress=$00:000C20
ber_release_oid=$00:000C20
ber_release_protocol_i=$00:000BE6
ber_release_protocol_s=$00:000C1E
ber_release_string=$00:000C20
ber_release_svalue=$00:000C23
ber_release_xlength=$00:000C05
ber_ri=$00:000CBB
ber_rii=$00:000CC0
ber_rl=$00:000C87
ber_rll=$00:000C8E
ber_rlx=$00:000C94
ber_rs=$00:000C9F
ber_rs!=$00:000CA9
ber_rs?=$00:000CAC
ber_rs_no_word_count=$00:000CB9
ber_savebytes=000001,00000F
ber_sequence_generr=$00:000D41
ber_sequence_getnext=$00:000D25
ber_sequence_represent=$00:000D37
ber_sequence_scan=$00:000CF4
ber_sequence_scan_cluster=$00:000CFB
ber_sequence_scan_get=$00:000D1E
ber_sequence_scanx=$00:000D43
ber_sequence_scanz=$00:000D4A
ber_sequence_set=$00:000D2C
ber_sequence_variable?=$00:000D10
ber_store_oid_token=$00:000C4E
ber_string_released=$00:000C37
ber_swap_compare=$00:000C98
ber_t=$43:000000,000003
ber_t:ojet=$43:000000,000003
ber_t:bytes=$43:000001,000003
ber_t:data=$43:000002,000003
ber_t:storage=$43:000003,000003
ber_t:oidl=$43:000004,000003
ber_t:oid=$43:000005,000003
ber_template=:N129:P:0:000000
ber_transientp=000000,00000F
ber_woi=$00:000C58
ber_woi14!=$00:000C6F
ber_woi21!=$00:000C6A
ber_woi21?=$00:000C74
ber_woi7=$00:000C78
ber_woi_token!=$00:000C60
ber_woi_token?=$00:000C7C
ber_xlength2?=$00:000C0B
ber_xlength3!=$00:000C12
bfound=$00:000222
bfound1=$00:000223
big_spiral=$00:0001A8
bind+=$00:000085
bsearch=$00:00020A
buy1=$00:000E20
buy1_complete=$00:000E45
buy1_never=$00:000E22
buy1_new=$00:000E36
buy1_new_now=$00:000E40
buy1_soon=$00:000E24
cache_netb=:P1:0:00003F
cache_standard_netbuf_ii=$00:00067B
call_ifconfig=$00:0000B7
call_route_config=$00:0000B9
cannot_add_bank=$00:000230
chain_insert=$00:00019F
chains_added=$00:0001C8
check8in=:P1:0:000073
check_complete=$00:00026E
check_handle=$00:00056B
check_part1=$00:00023D
check_part1_go=$00:000242
check_part1s=$00:00023F
check_payload=$00:000497
check_payload_tx=$00:000496
check_updword(10)=$00:000266
check_updword(11)=$00:000265
check_updword(12)=$00:000264
check_updword(13)=$00:000263
check_updword(14)=$00:000262
check_updword(15)=$00:000261
check_updword(16)=$00:000260
check_updword(17)=$00:00025F
check_updword(18)=$00:00025E
check_updword(19)=$00:00025D
check_updword(20)=$00:00025C
check_updword(21)=$00:00025B
check_updword(22)=$00:00025A
check_updword(23)=$00:000259
check_updword(24)=$00:000258
check_updword(25)=$00:000257
check_updword(26)=$00:000256
check_updword(27)=$00:000255
check_updword(28)=$00:000254
check_updword(29)=$00:000253
check_updword(30)=$00:000252
check_updword(31)=$00:000251
check_updword(32)=$00:000250
check_updword(33)=$00:00024F
check_updword(34)=$00:00024E
check_updword(35)=$00:00024D
check_updword(36)=$00:00024C
check_updword(37)=$00:00024B
check_updword(38)=$00:00024A
check_updword(39)=$00:000249
check_updword(40)=$00:000248
check_updword(6)=$00:00026A
check_updword(7)=$00:000269
check_updword(8)=$00:000268
check_updword(9)=$00:000267
choose=$00:0002F5
cidrdestflags=000004,00000F
cidrdestroutine=000005,00000F
cidrdestseq=000003,00000F
cidrdesttypeflags=000004,00000F
cidrdesttyperoutine=000005,00000F
cidrdesttypeseq=000003,00000F
cidrmasklogflags=000004,00000F
cidrmasklogroutine=000005,00000F
cidrmasklogseq=000003,00000F
cidrnexthopflags=000004,00000F
cidrnexthoproutine=000005,00000F
cidrnexthopseq=000003,00000F
cidrnexthoptypeflags=000004,00000F
cidrnexthoptyperoutine=000005,00000F
cidrnexthoptypeseq=000003,00000F
cidrrouteifidxflags=000004,00000F
cidrrouteifidxroutine=000005,00000F
cidrrouteifidxseq=000003,00000F
cidrroutetypeflags=000004,00000F
cidrroutetyperoutine=000005,00000F
cidrroutetypeseq=000003,00000F
co_ordinate_platform=$00:000305
connect+=$00:000084
construct_xdgram=$00:00011F
core_resume=$00:0002F0
core_resume1=$00:0002F3
cosine192+=$00:000175
cosine96+=$00:000179
cotangent192+=$00:000177
cotangent96+=$00:00017B
cube192+=$00:00017E
cube_root192+=$00:00017F
d48_48
datagram=:N129:P:0:000000
date_timef3
dayclock_u=$00:000114
dayclock_w_ii=$00:0005F6
delete=$00:000269
delete_another=$00:00026A
delivery=:N129:P:0:000000
descriptor=$46:000000,00000E
descriptor:next=$46:000000,00000E
descriptor:frame=$46:000001,00000E
descriptor:i_f=$46:000002,00000E
descriptor:bytes=$46:000003,00000E
descriptor:dgram=$46:000004,00000E
descriptor:uproto=$46:000005,00000E
descriptor:sobdi=$46:000006,00000E
descriptor:apdata=$46:000006,00000E
descriptor:tcbloc=$46:000007,00000E
descriptor:ifql=$46:000007,00000E
descriptor:lso=$46:000007,00000E
descriptor:total_bytes=$46:000007,00000E
descriptor:readpoint=$46:000007,00000E
descriptor:next_bdi=$46:000007,00000E
device_activate=$00:00011A
device_key(1)=$41:003070
device_key(10)=$41:003082
device_key(11)=$41:003084
device_key(12)=$41:003086
device_key(13)=$41:003088
device_key(14)=$41:00308A
device_key(15)=$41:00308C
device_key(16)=$41:00308E
device_key(17)=$41:003090
device_key(18)=$41:003092
device_key(19)=$41:003094
device_key(2)=$41:003072
device_key(20)=$41:003096
device_key(21)=$41:003098
device_key(22)=$41:00309A
device_key(23)=$41:00309C
device_key(24)=$41:00309E
device_key(25)=$41:0030A0
device_key(26)=$41:0030A2
device_key(27)=$41:0030A4
device_key(28)=$41:0030A6
device_key(29)=$41:0030A8
device_key(3)=$41:003074
device_key(30)=$41:0030AA
device_key(31)=$41:0030AC
device_key(32)=$41:0030AE
device_key(33)=$41:0030B0
device_key(34)=$41:0030B2
device_key(35)=$41:0030B4
device_key(36)=$41:0030B6
device_key(37)=$41:0030B8
device_key(38)=$41:0030BA
device_key(39)=$41:0030BC
device_key(4)=$41:003076
device_key(40)=$41:0030BE
device_key(41)=$41:0030C0
device_key(42)=$41:0030C2
device_key(43)=$41:0030C4
device_key(44)=$41:0030C6
device_key(45)=$41:0030C8
device_key(46)=$41:0030CA
device_key(47)=$41:0030CC
device_key(48)=$41:0030CE
device_key(49)=$41:0030D0
device_key(5)=$41:003078
device_key(50)=$41:0030D2
device_key(51)=$41:0030D4
device_key(52)=$41:0030D6
device_key(53)=$41:0030D8
device_key(54)=$41:0030DA
device_key(55)=$41:0030DC
device_key(56)=$41:0030DE
device_key(57)=$41:0030E0
device_key(58)=$41:0030E2
device_key(59)=$41:0030E4
device_key(6)=$41:00307A
device_key(60)=$41:0030E6
device_key(61)=$41:0030E8
device_key(62)=$41:0030EA
device_key(63)=$41:0030EC
device_key(7)=$41:00307C
device_key(8)=$41:00307E
device_key(9)=$41:003080
dframe=$00:0007EA
dframe:dframe_ii=$00:0007EA
dframe:dframe_sample_p1=$00:000806
dframe:dframe_p1_base=$00:00080A
dframe:dframe_large=$00:00080F
dframe:dframe_sample_b1=$00:000823
dframe:dframe_b1_base=$00:000827
dframe:__CLUSTER_LOG=000088
dframe:__BASE=000089
dframe:__CLUSTER_LOG_PLUS_6=00008A
dframe:__CLUSTER_MASK=00008B
dframe:dframe_cluster=$00:00082C
dframe:cluster_granules=$00:00084D
dframe:cluster_loaded=$00:000857
dframe:dframe_zero=$00:00085D
dframe:dframe_complete=$00:00085E
dframe:dframe_range=$00:00085F
dframe:bid=$00:000862
dframe:bidden=$00:000869
dframe:win=$00:000872
dframe:wan=$00:000877
dframe:won=$00:000877
dframe:dframe_resource=$00:00087A
dframe:dframe_bid=$00:00087D
dframe:dframe_bidden=$00:000884
dframe:dframe_distribute=$00:00088B
dframe:dframe_distributed=$00:000890
dframe:dframe_cluster_request=$00:000893
dframe:dframe_cluster_all=$00:00089C
dframe:dframe_cluster_part=$00:00089E
dframe:dframe_free_ii=$00:0008A8
dframe:free_dframe=$00:0008B1
dframe:next_vector=$00:0008B6
dframe:dframes_freed=$00:0008B9
dframe:dframe_cancel=$00:0008BA
dframe:dframe_cancel_sysmem=$00:0008C2
dframe:dframe_cancel_arraymem=$00:0008C6
dframe:dframe_cancelled=$00:0008C7
dgram=$47:000000,00000F
dgram:vers_ihl_tos=$47:000000,00000F
dgram:bytes=$47:000001,00000F
dgram:id=$47:000002,00000F
dgram:flags_fragment=$47:000003,00000F
dgram:ttl_protocol=$47:000004,00000F
dgram:checksum=$47:000005,00000F
dgram:ipsource=$47:000006,00000F
dgram:ipdest=$47:000008,00000F
dgram_load(1)=$00:000182
dgram_load(10)=$00:000179
dgram_load(11)=$00:000178
dgram_load(12)=$00:000177
dgram_load(13)=$00:000176
dgram_load(14)=$00:000175
dgram_load(15)=$00:000174
dgram_load(16)=$00:000173
dgram_load(17)=$00:000172
dgram_load(18)=$00:000171
dgram_load(19)=$00:000170
dgram_load(2)=$00:000181
dgram_load(20)=$00:00016F
dgram_load(3)=$00:000180
dgram_load(4)=$00:00017F
dgram_load(5)=$00:00017E
dgram_load(6)=$00:00017D
dgram_load(7)=$00:00017C
dgram_load(8)=$00:00017B
dgram_load(9)=$00:00017A
display_quartets
dq=:P1:0:000042
e$E=:N65:F:0:000000
edit=[001c]000000
edit48=[001e]000000
edit48s=[0020]000000
edit48u=[001f]000000
edit72=[0021]000000
edit72s=[0023]000000
edit72u=[0022]000000
edit_prepend=$00:00011F
edits=[001d]000000
egpAs=$00:000970
egpAs:rw_typ_tokens_words=$00:000970
egpAs:o=$00:000971
egpAs:l=$00:000972
egpAs:data=$00:000973
egpAs:flags=$00:000974
egpAs:bucket=$00:000975
egpAs:ranges=$00:000975
egpAs:range=$00:000976
egpAs:advance=$00:000976
egpAs:netstring=:N129:P:0:000000
egpAs:i=$01:00059F
egpInErrors=$00:000904
egpInErrors:rw_typ_tokens_words=$00:000904
egpInErrors:o=$00:000905
egpInErrors:l=$00:000906
egpInErrors:data=$00:000907
egpInErrors:flags=$00:000908
egpInErrors:bucket=$00:000909
egpInErrors:ranges=$00:000909
egpInErrors:range=$00:00090A
egpInErrors:advance=$00:00090A
egpInErrors:netstring=:N129:P:0:000000
egpInErrors:i=$01:000581
egpInMsgs=$00:0008FE
egpInMsgs:rw_typ_tokens_words=$00:0008FE
egpInMsgs:o=$00:0008FF
egpInMsgs:l=$00:000900
egpInMsgs:data=$00:000901
egpInMsgs:flags=$00:000902
egpInMsgs:bucket=$00:000903
egpInMsgs:ranges=$00:000903
egpInMsgs:range=$00:000904
egpInMsgs:advance=$00:000904
egpInMsgs:netstring=:N129:P:0:000000
egpInMsgs:i=$01:00057F
egpNeighAddr=$00:00091C
egpNeighAddr:rw_typ_tokens_words=$00:00091C
egpNeighAddr:o=$00:00091D
egpNeighAddr:l=$00:00091E
egpNeighAddr:data=$00:00091F
egpNeighAddr:flags=$00:000920
egpNeighAddr:bucket=$00:000921
egpNeighAddr:ranges=$00:000921
egpNeighAddr:advance=$00:000922
egpNeighAddr:netstring=:N129:P:0:000000
egpNeighAddr:n=$01:000588
egpNeighAs=$00:000922
egpNeighAs:rw_typ_tokens_words=$00:000922
egpNeighAs:o=$00:000923
egpNeighAs:l=$00:000924
egpNeighAs:data=$00:000925
egpNeighAs:flags=$00:000926
egpNeighAs:bucket=$00:000927
egpNeighAs:ranges=$00:000927
egpNeighAs:range=$00:000928
egpNeighAs:advance=$00:000928
egpNeighAs:netstring=:N129:P:0:000000
egpNeighAs:i=$01:00058A
egpNeighEventTrigger=$00:00096A
egpNeighEventTrigger:rw_typ_tokens_words=$00:00096A
egpNeighEventTrigger:o=$00:00096B
egpNeighEventTrigger:l=$00:00096C
egpNeighEventTrigger:data=$00:00096D
egpNeighEventTrigger:flags=$00:00096E
egpNeighEventTrigger:bucket=$00:00096F
egpNeighEventTrigger:ranges=$00:00096F
egpNeighEventTrigger:range=$00:000970
egpNeighEventTrigger:advance=$00:000970
egpNeighEventTrigger:netstring=:N129:P:0:000000
egpNeighEventTrigger:i=$01:00059E
egpNeighInErrMsgs=$00:000940
egpNeighInErrMsgs:rw_typ_tokens_words=$00:000940
egpNeighInErrMsgs:o=$00:000941
egpNeighInErrMsgs:l=$00:000942
egpNeighInErrMsgs:data=$00:000943
egpNeighInErrMsgs:flags=$00:000944
egpNeighInErrMsgs:bucket=$00:000945
egpNeighInErrMsgs:ranges=$00:000945
egpNeighInErrMsgs:range=$00:000946
egpNeighInErrMsgs:advance=$00:000946
egpNeighInErrMsgs:netstring=:N129:P:0:000000
egpNeighInErrMsgs:i=$01:000593
egpNeighInErrs=$00:00092E
egpNeighInErrs:rw_typ_tokens_words=$00:00092E
egpNeighInErrs:o=$00:00092F
egpNeighInErrs:l=$00:000930
egpNeighInErrs:data=$00:000931
egpNeighInErrs:flags=$00:000932
egpNeighInErrs:bucket=$00:000933
egpNeighInErrs:ranges=$00:000933
egpNeighInErrs:range=$00:000934
egpNeighInErrs:advance=$00:000934
egpNeighInErrs:netstring=:N129:P:0:000000
egpNeighInErrs:i=$01:00058D
egpNeighInMsgs=$00:000928
egpNeighInMsgs:rw_typ_tokens_words=$00:000928
egpNeighInMsgs:o=$00:000929
egpNeighInMsgs:l=$00:00092A
egpNeighInMsgs:data=$00:00092B
egpNeighInMsgs:flags=$00:00092C
egpNeighInMsgs:bucket=$00:00092D
egpNeighInMsgs:ranges=$00:00092D
egpNeighInMsgs:range=$00:00092E
egpNeighInMsgs:advance=$00:00092E
egpNeighInMsgs:netstring=:N129:P:0:000000
egpNeighInMsgs:i=$01:00058B
egpNeighIntervalHello=$00:000958
egpNeighIntervalHello:rw_typ_tokens_words=$00:000958
egpNeighIntervalHello:o=$00:000959
egpNeighIntervalHello:l=$00:00095A
egpNeighIntervalHello:data=$00:00095B
egpNeighIntervalHello:flags=$00:00095C
egpNeighIntervalHello:bucket=$00:00095D
egpNeighIntervalHello:ranges=$00:00095D
egpNeighIntervalHello:range=$00:00095E
egpNeighIntervalHello:advance=$00:00095E
egpNeighIntervalHello:netstring=:N129:P:0:000000
egpNeighIntervalHello:i=$01:00059B
egpNeighIntervalPoll=$00:00095E
egpNeighIntervalPoll:rw_typ_tokens_words=$00:00095E
egpNeighIntervalPoll:o=$00:00095F
egpNeighIntervalPoll:l=$00:000960
egpNeighIntervalPoll:data=$00:000961
egpNeighIntervalPoll:flags=$00:000962
egpNeighIntervalPoll:bucket=$00:000963
egpNeighIntervalPoll:ranges=$00:000963
egpNeighIntervalPoll:range=$00:000964
egpNeighIntervalPoll:advance=$00:000964
egpNeighIntervalPoll:netstring=:N129:P:0:000000
egpNeighIntervalPoll:i=$01:00059C
egpNeighMode=$00:000964
egpNeighMode:rw_typ_tokens_words=$00:000964
egpNeighMode:o=$00:000965
egpNeighMode:l=$00:000966
egpNeighMode:data=$00:000967
egpNeighMode:flags=$00:000968
egpNeighMode:bucket=$00:000969
egpNeighMode:ranges=$00:000969
egpNeighMode:range=$00:00096A
egpNeighMode:advance=$00:00096A
egpNeighMode:netstring=:N129:P:0:000000
egpNeighMode:i=$01:00059D
egpNeighOutErrMsgs=$00:000946
egpNeighOutErrMsgs:rw_typ_tokens_words=$00:000946
egpNeighOutErrMsgs:o=$00:000947
egpNeighOutErrMsgs:l=$00:000948
egpNeighOutErrMsgs:data=$00:000949
egpNeighOutErrMsgs:flags=$00:00094A
egpNeighOutErrMsgs:bucket=$00:00094B
egpNeighOutErrMsgs:ranges=$00:00094B
egpNeighOutErrMsgs:range=$00:00094C
egpNeighOutErrMsgs:advance=$00:00094C
egpNeighOutErrMsgs:netstring=:N129:P:0:000000
egpNeighOutErrMsgs:i=$01:000595
egpNeighOutErrs=$00:00093A
egpNeighOutErrs:rw_typ_tokens_words=$00:00093A
egpNeighOutErrs:o=$00:00093B
egpNeighOutErrs:l=$00:00093C
egpNeighOutErrs:data=$00:00093D
egpNeighOutErrs:flags=$00:00093E
egpNeighOutErrs:bucket=$00:00093F
egpNeighOutErrs:ranges=$00:00093F
egpNeighOutErrs:range=$00:000940
egpNeighOutErrs:advance=$00:000940
egpNeighOutErrs:netstring=:N129:P:0:000000
egpNeighOutErrs:i=$01:000591
egpNeighOutMsgs=$00:000934
egpNeighOutMsgs:rw_typ_tokens_words=$00:000934
egpNeighOutMsgs:o=$00:000935
egpNeighOutMsgs:l=$00:000936
egpNeighOutMsgs:data=$00:000937
egpNeighOutMsgs:flags=$00:000938
egpNeighOutMsgs:bucket=$00:000939
egpNeighOutMsgs:ranges=$00:000939
egpNeighOutMsgs:range=$00:00093A
egpNeighOutMsgs:advance=$00:00093A
egpNeighOutMsgs:netstring=:N129:P:0:000000
egpNeighOutMsgs:i=$01:00058F
egpNeighState=$00:000916
egpNeighState:rw_typ_tokens_words=$00:000916
egpNeighState:o=$00:000917
egpNeighState:l=$00:000918
egpNeighState:data=$00:000919
egpNeighState:flags=$00:00091A
egpNeighState:bucket=$00:00091B
egpNeighState:ranges=$00:00091B
egpNeighState:range=$00:00091C
egpNeighState:advance=$00:00091C
egpNeighState:netstring=:N129:P:0:000000
egpNeighState:i=$01:000587
egpNeighStateDowns=$00:000952
egpNeighStateDowns:rw_typ_tokens_words=$00:000952
egpNeighStateDowns:o=$00:000953
egpNeighStateDowns:l=$00:000954
egpNeighStateDowns:data=$00:000955
egpNeighStateDowns:flags=$00:000956
egpNeighStateDowns:bucket=$00:000957
egpNeighStateDowns:ranges=$00:000957
egpNeighStateDowns:range=$00:000958
egpNeighStateDowns:advance=$00:000958
egpNeighStateDowns:netstring=:N129:P:0:000000
egpNeighStateDowns:i=$01:000599
egpNeighStateUps=$00:00094C
egpNeighStateUps:rw_typ_tokens_words=$00:00094C
egpNeighStateUps:o=$00:00094D
egpNeighStateUps:l=$00:00094E
egpNeighStateUps:data=$00:00094F
egpNeighStateUps:flags=$00:000950
egpNeighStateUps:bucket=$00:000951
egpNeighStateUps:ranges=$00:000951
egpNeighStateUps:range=$00:000952
egpNeighStateUps:advance=$00:000952
egpNeighStateUps:netstring=:N129:P:0:000000
egpNeighStateUps:i=$01:000597
egpOutErrors=$00:000910
egpOutErrors:rw_typ_tokens_words=$00:000910
egpOutErrors:o=$00:000911
egpOutErrors:l=$00:000912
egpOutErrors:data=$00:000913
egpOutErrors:flags=$00:000914
egpOutErrors:bucket=$00:000915
egpOutErrors:ranges=$00:000915
egpOutErrors:range=$00:000916
egpOutErrors:advance=$00:000916
egpOutErrors:netstring=:N129:P:0:000000
egpOutErrors:i=$01:000585
egpOutMsgs=$00:00090A
egpOutMsgs:rw_typ_tokens_words=$00:00090A
egpOutMsgs:o=$00:00090B
egpOutMsgs:l=$00:00090C
egpOutMsgs:data=$00:00090D
egpOutMsgs:flags=$00:00090E
egpOutMsgs:bucket=$00:00090F
egpOutMsgs:ranges=$00:00090F
egpOutMsgs:range=$00:000910
egpOutMsgs:advance=$00:000910
egpOutMsgs:netstring=:N129:P:0:000000
egpOutMsgs:i=$01:000583
encode_handle=$00:00054B
end_big_spiral=$00:0001B9
energy$advise=$41:003002
energy_ii=$00:000703
engage=$00:000040
established_count=000001,00000F
ethernet_relay=000006
event_free_ii=$00:000511
event_free_iix=$00:000521
event_time_limit=$00:00052A
event_wait_ii=$00:000522
exit=$00:000260
exit_ii=$00:000271
external_interrupts=$00:00006F
external_ix=$00:00009F
external_ixx=$00:0000A1
external_next=$00:00007B
external_zx=$00:00009E
extract_if=$00:000E00
far_ack=$00:000F28
far_initpool+=$00:000099
far_q2+=$00:00009D
far_readq+=$00:00009C
fedit192a
fedita
feditia
fflush=:N129:P:0:000000
fgets=:N129:P:0:000000
fgets_datafile
fhandle_add_pointer=$00:000584
file_handle_ii=$00:000578
file_open_frame_ii=$00:0006D9
file_open_heap=$00:0006E6
files_open_heap_ii=$00:0006E2
fileshare_assign
fileshare_space_open
find_higher_point=$00:000182
first_bdx=$41:0030F0
float2i72
floating_edit=[0016]000000
floating_edit192=[0018]000000
floating_iedit=[0017]000000
floating_scan=[0015]000000
floating_scan192=[001a]000000
forward=$00:0002FA
forward2thread=$00:000307
forward_callstring
found_higher_point=$00:000189
found_tdescriptor=$00:000482
fp192_add
fp192_add_negative
fp192_divide
fp192_load
fp192_load_negative
fp192_mfa
fp192_multiply
fp_192=$00:0000AD
fp_192:socket1=$01:000417
fp_192:fp_bound=$01:000418
fp_192:portcb_lva=$01:000419
fp_192:portcb=$01:00041A
fp_192:fp_server=$00:0000AD
fp_192:response_axw=000011,00000F
fp_192:operator=000010,00000F
fp_192:right=000008,00000F
fp_192:left=000000,00000F
fp_192:fp_rx=$00:0000C2
fp_192:fp_rx1=$00:0000C6
fp_192:FP_SIMDOPS=000001
fp_192:fp_again=$00:0000E3
fp_192:fp_add=$00:0000F4
fp_192:fp_add1=$00:0000F4
fp_192:fp_add_negative=$00:0000F7
fp_192:fp_add1_negative=$00:0000F7
fp_192:fp_multiply=$00:0000FA
fp_192:fp_multiply1=$00:0000FA
fp_192:fp_divide=$00:0000FD
fp_192:fp_divide1=$00:0000FD
fp_192:fp_nop=$00:000100
fp_192:fp_edit=$00:000104
fp_192:fp_release=$00:000115
fp_192:fp_no_traffic=$00:000119
fp_192:fp_error=$00:000119
fp_96=$00:00004A
fp_96:socket1=$01:000413
fp_96:fp_bound=$01:000414
fp_96:portcb_lva=$01:000415
fp_96:portcb=$01:000416
fp_96:fp_server=$00:00004A
fp_96:response_axw=000009,00000F
fp_96:operator=000008,00000F
fp_96:left=000004,00000F
fp_96:right=000000,00000F
fp_96:fp_rx=$00:00005D
fp_96:fp_rx1=$00:000061
fp_96:fp_again=$00:00007A
fp_96:fp_add=$00:000088
fp_96:fp_add_again=$00:000089
fp_96:fp_add_negative=$00:00008C
fp_96:fp_add_negative_again=$00:00008D
fp_96:fp_multiply=$00:000090
fp_96:fp_multiply_again=$00:000091
fp_96:fp_divide=$00:000094
fp_96:fp_divide_again=$00:000095
fp_96:fp_nop=$00:000098
fp_96:fp_edit=$00:000099
fp_96:fp_release=$00:0000A6
fp_96:fp_no_traffic=$00:0000AA
fp_96:fp_error=$00:0000AA
fp_reactz=$00:00011C
fp_server=$00:000142
fp_server_192=$00:000143
fponline=$00:000145
fponline:UDPQ=000001
fponline:COMMANDS_EOP=000011
fponline:ZENITH=000010
fponline:STACK_GUARD=000012
fponline:MESSAGE=000013
fponline:s1=$03:0000D0
fponline:socket_lva=$03:0000D1
fponline:editp=$03:0000D3
fponline:buffer=$03:0000D4
fponline:launch=$00:00056C
fponline:zstart=$00:000571
fponline:server=$00:000572
fponline:rxnext=$00:00057F
fponline:inform=$00:000599
fponline:respond=$00:00059C
fponline:release_request=$00:0005A2
fponline:wait=$00:0005A5
fponline:disengage_free=$00:0005A7
fponline:free_socket=$00:0005A9
fponline:leave=$00:0005AB
fponline:pdu=$00:0005AC
fponline:command=$00:0005BA
fponline:fpo_load=$00:0005DC
fponline:fpo_load_negative=$00:0005E4
fponline:fpo_push=$00:0005EC
fponline:fpo_add=$00:0005EF
fponline:fpo_add_negative=$00:0005F7
fponline:fpo_multiply=$00:0005FF
fponline:fpo_divide=$00:000607
fponline:fpo_pop_add=$00:00060F
fponline:fpo_pop_add_negative=$00:000616
fponline:fpo_pop_multiply=$00:00061D
fponline:fpo_pop_divide=$00:000624
fponline:fpo_square_root=$00:00062B
fponline:fpo_square=$00:000631
fponline:fpo_cube_root=$00:000637
fponline:fpo_cube=$00:00063D
fponline:fpo_sine=$00:000643
fponline:fpo_cosine=$00:000649
fponline:fpo_tangent=$00:00064F
fponline:fpo_cotangent=$00:000655
fponline:fpo_sine96=$00:00065B
fponline:fpo_cosine96=$00:000661
fponline:fpo_tangent96=$00:000667
fponline:fpo_cotangent96=$00:00066D
fponline:fpo_fraction=$00:000673
fponline:fpo_integer=$00:000679
fponline:trigx=$00:00067F
fponline:outrage=$00:000682
fponline:exitu=$00:000684
fprintf=:N129:P:0:000000
fpxpo_idx=$00:0000C7
fpxpo_ii=$00:0000BF
fpxpo_iix=$00:0000D1
fpxpo_read_clear_ii=$00:000602
fraction192+=$00:000170
fraction96+=$00:000172
frame2p=$00:0000A5
frame2proto=$00:0000A7
frame_to_protocol+=$00:000098
frames=$00:000075
framet1=:P1:0:00004B
fread=:N129:P:0:000000
free_chain(1)=$41:003007
free_chain(10)=$41:003010
free_chain(11)=$41:003011
free_chain(12)=$41:003012
free_chain(13)=$41:003013
free_chain(14)=$41:003014
free_chain(15)=$41:003015
free_chain(16)=$41:003016
free_chain(17)=$41:003017
free_chain(18)=$41:003018
free_chain(19)=$41:003019
free_chain(2)=$41:003008
free_chain(20)=$41:00301A
free_chain(21)=$41:00301B
free_chain(22)=$41:00301C
free_chain(23)=$41:00301D
free_chain(24)=$41:00301E
free_chain(25)=$41:00301F
free_chain(26)=$41:003020
free_chain(27)=$41:003021
free_chain(28)=$41:003022
free_chain(29)=$41:003023
free_chain(3)=$41:003009
free_chain(30)=$41:003024
free_chain(31)=$41:003025
free_chain(32)=$41:003026
free_chain(33)=$41:003027
free_chain(34)=$41:003028
free_chain(35)=$41:003029
free_chain(36)=$41:00302A
free_chain(37)=$41:00302B
free_chain(38)=$41:00302C
free_chain(39)=$41:00302D
free_chain(4)=$41:00300A
free_chain(40)=$41:00302E
free_chain(41)=$41:00302F
free_chain(42)=$41:003030
free_chain(43)=$41:003031
free_chain(44)=$41:003032
free_chain(45)=$41:003033
free_chain(46)=$41:003034
free_chain(47)=$41:003035
free_chain(48)=$41:003036
free_chain(49)=$41:003037
free_chain(5)=$41:00300B
free_chain(50)=$41:003038
free_chain(51)=$41:003039
free_chain(52)=$41:00303A
free_chain(53)=$41:00303B
free_chain(54)=$41:00303C
free_chain(55)=$41:00303D
free_chain(56)=$41:00303E
free_chain(57)=$41:00303F
free_chain(58)=$41:003040
free_chain(59)=$41:003041
free_chain(6)=$41:00300C
free_chain(60)=$41:003042
free_chain(61)=$41:003043
free_chain(62)=$41:003044
free_chain(63)=$41:003045
free_chain(64)=$41:003046
free_chain(7)=$41:00300D
free_chain(8)=$41:00300E
free_chain(9)=$41:00300F
free_handle_ii=$00:000557
free_handle_test=$00:000562
free_tdescriptor=$41:003048
freetotal_ii=$00:000040
fs24_cursor=00001A,00000F
fs24_open
fs24_sla=$03:00008D
fs24_sla2=$03:00008F
fs_dsearch
fs_find
fs_lookup=$43:000000,000003
fs_lookup:e=$43:000000,000003
fs_lookup:e:rfw=$43:000000,000003
fs_lookup:e:granules=$43:000001,000003
fs_lookup:e:granule=$43:000002,000003
fs_lookup:e:next=$43:000004,000003
fs_lookup:e:next_offset=$43:000006,000003
fs_lookup:quanta=$43:000007,000003
fs_lookup:name=$43:000009,000003
fs_xbase
fscan192a
fscana
fscanf=:N129:P:0:000000
fsearch=$00:000191
fspath
fspaxq=$42:000000,000002
fspaxq:serialp=$42:000000,000002
fspaxq:serialp:fs_type=$42:000000,000002
fspaxq:serialp:device=$42:000001,000002
fspaxq:serialp:bank=$42:000001,000002
fspaxq:serialp:extent=$42:000002,000002
fspaxq:serialp:absolute_pointer=$42:000004,000002
fspaxq:o=$42:000006,000002
fspaxq:o:column=$42:000006,000002
fspaxq:o:flags=$42:000007,000002
fspaxq:rewind_extentp=$42:000008,000002
fspaxq:quantum_pointer=$42:00000A,000002
fsymbola
fwrite=:N129:P:0:000000
g_ibuffer=$00:000280
gate=$00:0003B2
gets=:N129:P:0:000000
guard_ii=$00:0002A3
handle_free_already=$00:00056A
handle_ii=$00:00053F
handle_out_of_range=$00:000573
http_bound=$03:00008A
http_bound?=$00:00041B
http_drop_request=$00:000497
http_file_octets=000018,00000F
http_final_extent=$00:00048A
http_formation1=$03:000092
http_formation1_length=000049
http_formation2=$03:0000AB
http_get_default=$00:0004D8
http_get_what=$00:0004A2
http_hangup=$00:00049C
http_listening_transmission=$03:0000B3
http_located=$00:00045C
http_name=$00:0004BB
http_name1=$00:0004C8
http_name2=$00:0004C5
http_name3=$00:0004C6
http_name_2nd_read=$00:0004BD
http_name_buffer=000000,000003
http_name_mark=$00:0004CD
http_name_x=$00:0004D6
http_next_extent=$00:000478
http_norequest=$00:000496
http_pushover=$00:000490
http_remote_close?=$00:000438
http_request_thread=$00:000440
http_s=$03:000089
http_search2=$00:000451
http_serve=$00:0003FC
http_server=$00:000141
http_sla=$03:00008B
http_target_name=000000,00000F
http_thread=$00:000402
http_thread_exit=$00:00049C
http_thread_request=00001D,00000F
http_thread_transmission=00001C,00000F
http_threads=$03:000091
http_traffic?=$00:000433
http_walk=$00:000423
http_walk_q=$00:000421
http_xserve=$00:00043D
http_zserve=$00:00043F
http_zstart=$00:000401
hvdq=:P1:0:000044
hvsocket_storage
hvsocket_write_rxq
i48_2float
i48d48=:N129:P:0:000000
i48m=:N129:P:0:000000
i48m48=:N129:P:0:000000
i72_divide
i72_multiply
i72a=:N129:P:0:000000
i72a48=:N129:P:0:000000
i72a48_48=:N129:P:0:000000
i72an=:N129:P:0:000000
i72an48=:N129:P:0:000000
i72an48_48=:N129:P:0:000000
i72compare=:N129:P:0:000000
i72compare48=:N129:P:0:000000
i72d=:N129:P:0:000000
i72d48=:N129:P:0:000000
i72d72=:N129:P:0:000000
i72m=:N129:P:0:000000
i72m48=:N129:P:0:000000
i72m72=:N129:P:0:000000
i_f=:P1:0:00004C
i_f_last=$01:000009
i_f_leave=$00:00007C
i_f_pointer_array=$01:000000
i_timer=$00:0000D2
iattend=$00:000F2B
iattended=$00:000F38
iattendu=$00:000F2D
ibuffer=$00:000282
ibufferx=$00:000294
icapsule=$00:000F3B
icarryalong=$00:000F4C
icarryon=$00:000F49
icmp=$00:00032D
icmpInAddrMaskReps=$00:0007F6
icmpInAddrMaskReps:rw_typ_tokens_words=$00:0007F6
icmpInAddrMaskReps:o=$00:0007F7
icmpInAddrMaskReps:l=$00:0007F8
icmpInAddrMaskReps:data=$00:0007F9
icmpInAddrMaskReps:flags=$00:0007FA
icmpInAddrMaskReps:bucket=$00:0007FB
icmpInAddrMaskReps:ranges=$00:0007FB
icmpInAddrMaskReps:range=$00:0007FC
icmpInAddrMaskReps:advance=$00:0007FC
icmpInAddrMaskReps:netstring=:N129:P:0:000000
icmpInAddrMaskReps:i=$01:00053B
icmpInAddrMasks=$00:0007F0
icmpInAddrMasks:rw_typ_tokens_words=$00:0007F0
icmpInAddrMasks:o=$00:0007F1
icmpInAddrMasks:l=$00:0007F2
icmpInAddrMasks:data=$00:0007F3
icmpInAddrMasks:flags=$00:0007F4
icmpInAddrMasks:bucket=$00:0007F5
icmpInAddrMasks:ranges=$00:0007F5
icmpInAddrMasks:range=$00:0007F6
icmpInAddrMasks:advance=$00:0007F6
icmpInAddrMasks:netstring=:N129:P:0:000000
icmpInAddrMasks:i=$01:000539
icmpInDestUnReachs=$00:0007BA
icmpInDestUnReachs:rw_typ_tokens_words=$00:0007BA
icmpInDestUnReachs:o=$00:0007BB
icmpInDestUnReachs:l=$00:0007BC
icmpInDestUnReachs:data=$00:0007BD
icmpInDestUnReachs:flags=$00:0007BE
icmpInDestUnReachs:bucket=$00:0007BF
icmpInDestUnReachs:ranges=$00:0007BF
icmpInDestUnReachs:range=$00:0007C0
icmpInDestUnReachs:advance=$00:0007C0
icmpInDestUnReachs:netstring=:N129:P:0:000000
icmpInDestUnReachs:i=$01:000527
icmpInEchoReps=$00:0007DE
icmpInEchoReps:rw_typ_tokens_words=$00:0007DE
icmpInEchoReps:o=$00:0007DF
icmpInEchoReps:l=$00:0007E0
icmpInEchoReps:data=$00:0007E1
icmpInEchoReps:flags=$00:0007E2
icmpInEchoReps:bucket=$00:0007E3
icmpInEchoReps:ranges=$00:0007E3
icmpInEchoReps:range=$00:0007E4
icmpInEchoReps:advance=$00:0007E4
icmpInEchoReps:netstring=:N129:P:0:000000
icmpInEchoReps:i=$01:000533
icmpInEchos=$00:0007D8
icmpInEchos:rw_typ_tokens_words=$00:0007D8
icmpInEchos:o=$00:0007D9
icmpInEchos:l=$00:0007DA
icmpInEchos:data=$00:0007DB
icmpInEchos:flags=$00:0007DC
icmpInEchos:bucket=$00:0007DD
icmpInEchos:ranges=$00:0007DD
icmpInEchos:range=$00:0007DE
icmpInEchos:advance=$00:0007DE
icmpInEchos:netstring=:N129:P:0:000000
icmpInEchos:i=$01:000531
icmpInErrors=$00:0007B4
icmpInErrors:rw_typ_tokens_words=$00:0007B4
icmpInErrors:o=$00:0007B5
icmpInErrors:l=$00:0007B6
icmpInErrors:data=$00:0007B7
icmpInErrors:flags=$00:0007B8
icmpInErrors:bucket=$00:0007B9
icmpInErrors:ranges=$00:0007B9
icmpInErrors:range=$00:0007BA
icmpInErrors:advance=$00:0007BA
icmpInErrors:netstring=:N129:P:0:000000
icmpInErrors:i=$01:000525
icmpInMsgs=$00:0007AE
icmpInMsgs:rw_typ_tokens_words=$00:0007AE
icmpInMsgs:o=$00:0007AF
icmpInMsgs:l=$00:0007B0
icmpInMsgs:data=$00:0007B1
icmpInMsgs:flags=$00:0007B2
icmpInMsgs:bucket=$00:0007B3
icmpInMsgs:ranges=$00:0007B3
icmpInMsgs:range=$00:0007B4
icmpInMsgs:advance=$00:0007B4
icmpInMsgs:netstring=:N129:P:0:000000
icmpInMsgs:i=$01:000523
icmpInRedirects=$00:0007D2
icmpInRedirects:rw_typ_tokens_words=$00:0007D2
icmpInRedirects:o=$00:0007D3
icmpInRedirects:l=$00:0007D4
icmpInRedirects:data=$00:0007D5
icmpInRedirects:flags=$00:0007D6
icmpInRedirects:bucket=$00:0007D7
icmpInRedirects:ranges=$00:0007D7
icmpInRedirects:range=$00:0007D8
icmpInRedirects:advance=$00:0007D8
icmpInRedirects:netstring=:N129:P:0:000000
icmpInRedirects:i=$01:00052F
icmpInSrcQuenchs=$00:0007CC
icmpInSrcQuenchs:rw_typ_tokens_words=$00:0007CC
icmpInSrcQuenchs:o=$00:0007CD
icmpInSrcQuenchs:l=$00:0007CE
icmpInSrcQuenchs:data=$00:0007CF
icmpInSrcQuenchs:flags=$00:0007D0
icmpInSrcQuenchs:bucket=$00:0007D1
icmpInSrcQuenchs:ranges=$00:0007D1
icmpInSrcQuenchs:range=$00:0007D2
icmpInSrcQuenchs:advance=$00:0007D2
icmpInSrcQuenchs:netstring=:N129:P:0:000000
icmpInSrcQuenchs:i=$01:00052D
icmpInTimeExcds=$00:0007C0
icmpInTimeExcds:rw_typ_tokens_words=$00:0007C0
icmpInTimeExcds:o=$00:0007C1
icmpInTimeExcds:l=$00:0007C2
icmpInTimeExcds:data=$00:0007C3
icmpInTimeExcds:flags=$00:0007C4
icmpInTimeExcds:bucket=$00:0007C5
icmpInTimeExcds:ranges=$00:0007C5
icmpInTimeExcds:range=$00:0007C6
icmpInTimeExcds:advance=$00:0007C6
icmpInTimeExcds:netstring=:N129:P:0:000000
icmpInTimeExcds:i=$01:000529
icmpInTimeStamps=$00:0007E4
icmpInTimeStamps:rw_typ_tokens_words=$00:0007E4
icmpInTimeStamps:o=$00:0007E5
icmpInTimeStamps:l=$00:0007E6
icmpInTimeStamps:data=$00:0007E7
icmpInTimeStamps:flags=$00:0007E8
icmpInTimeStamps:bucket=$00:0007E9
icmpInTimeStamps:ranges=$00:0007E9
icmpInTimeStamps:range=$00:0007EA
icmpInTimeStamps:advance=$00:0007EA
icmpInTimeStamps:netstring=:N129:P:0:000000
icmpInTimeStamps:i=$01:000535
icmpInTimestampReps=$00:0007EA
icmpInTimestampReps:rw_typ_tokens_words=$00:0007EA
icmpInTimestampReps:o=$00:0007EB
icmpInTimestampReps:l=$00:0007EC
icmpInTimestampReps:data=$00:0007ED
icmpInTimestampReps:flags=$00:0007EE
icmpInTimestampReps:bucket=$00:0007EF
icmpInTimestampReps:ranges=$00:0007EF
icmpInTimestampReps:range=$00:0007F0
icmpInTimestampReps:advance=$00:0007F0
icmpInTimestampReps:netstring=:N129:P:0:000000
icmpInTimestampReps:i=$01:000537
icmpOutAddrMaskReps=$00:000844
icmpOutAddrMaskReps:rw_typ_tokens_words=$00:000844
icmpOutAddrMaskReps:o=$00:000845
icmpOutAddrMaskReps:l=$00:000846
icmpOutAddrMaskReps:data=$00:000847
icmpOutAddrMaskReps:flags=$00:000848
icmpOutAddrMaskReps:bucket=$00:000849
icmpOutAddrMaskReps:ranges=$00:000849
icmpOutAddrMaskReps:range=$00:00084A
icmpOutAddrMaskReps:advance=$00:00084A
icmpOutAddrMaskReps:netstring=:N129:P:0:000000
icmpOutAddrMaskReps:i=$01:000555
icmpOutAddrMasks=$00:00083E
icmpOutAddrMasks:rw_typ_tokens_words=$00:00083E
icmpOutAddrMasks:o=$00:00083F
icmpOutAddrMasks:l=$00:000840
icmpOutAddrMasks:data=$00:000841
icmpOutAddrMasks:flags=$00:000842
icmpOutAddrMasks:bucket=$00:000843
icmpOutAddrMasks:ranges=$00:000843
icmpOutAddrMasks:range=$00:000844
icmpOutAddrMasks:advance=$00:000844
icmpOutAddrMasks:netstring=:N129:P:0:000000
icmpOutAddrMasks:i=$01:000553
icmpOutDestUnreaches=$00:000808
icmpOutDestUnreaches:rw_typ_tokens_words=$00:000808
icmpOutDestUnreaches:o=$00:000809
icmpOutDestUnreaches:l=$00:00080A
icmpOutDestUnreaches:data=$00:00080B
icmpOutDestUnreaches:flags=$00:00080C
icmpOutDestUnreaches:bucket=$00:00080D
icmpOutDestUnreaches:ranges=$00:00080D
icmpOutDestUnreaches:range=$00:00080E
icmpOutDestUnreaches:advance=$00:00080E
icmpOutDestUnreaches:netstring=:N129:P:0:000000
icmpOutDestUnreaches:i=$01:000541
icmpOutEchoReps=$00:00082C
icmpOutEchoReps:rw_typ_tokens_words=$00:00082C
icmpOutEchoReps:o=$00:00082D
icmpOutEchoReps:l=$00:00082E
icmpOutEchoReps:data=$00:00082F
icmpOutEchoReps:flags=$00:000830
icmpOutEchoReps:bucket=$00:000831
icmpOutEchoReps:ranges=$00:000831
icmpOutEchoReps:range=$00:000832
icmpOutEchoReps:advance=$00:000832
icmpOutEchoReps:netstring=:N129:P:0:000000
icmpOutEchoReps:i=$01:00054D
icmpOutEchos=$00:000826
icmpOutEchos:rw_typ_tokens_words=$00:000826
icmpOutEchos:o=$00:000827
icmpOutEchos:l=$00:000828
icmpOutEchos:data=$00:000829
icmpOutEchos:flags=$00:00082A
icmpOutEchos:bucket=$00:00082B
icmpOutEchos:ranges=$00:00082B
icmpOutEchos:range=$00:00082C
icmpOutEchos:advance=$00:00082C
icmpOutEchos:netstring=:N129:P:0:000000
icmpOutEchos:i=$01:00054B
icmpOutErrors=$00:000802
icmpOutErrors:rw_typ_tokens_words=$00:000802
icmpOutErrors:o=$00:000803
icmpOutErrors:l=$00:000804
icmpOutErrors:data=$00:000805
icmpOutErrors:flags=$00:000806
icmpOutErrors:bucket=$00:000807
icmpOutErrors:ranges=$00:000807
icmpOutErrors:range=$00:000808
icmpOutErrors:advance=$00:000808
icmpOutErrors:netstring=:N129:P:0:000000
icmpOutErrors:i=$01:00053F
icmpOutMsgs=$00:0007FC
icmpOutMsgs:rw_typ_tokens_words=$00:0007FC
icmpOutMsgs:o=$00:0007FD
icmpOutMsgs:l=$00:0007FE
icmpOutMsgs:data=$00:0007FF
icmpOutMsgs:flags=$00:000800
icmpOutMsgs:bucket=$00:000801
icmpOutMsgs:ranges=$00:000801
icmpOutMsgs:range=$00:000802
icmpOutMsgs:advance=$00:000802
icmpOutMsgs:netstring=:N129:P:0:000000
icmpOutMsgs:i=$01:00053D
icmpOutParmProbs=$00:000814
icmpOutParmProbs:rw_typ_tokens_words=$00:000814
icmpOutParmProbs:o=$00:000815
icmpOutParmProbs:l=$00:000816
icmpOutParmProbs:data=$00:000817
icmpOutParmProbs:flags=$00:000818
icmpOutParmProbs:bucket=$00:000819
icmpOutParmProbs:ranges=$00:000819
icmpOutParmProbs:range=$00:00081A
icmpOutParmProbs:advance=$00:00081A
icmpOutParmProbs:netstring=:N129:P:0:000000
icmpOutParmProbs:i=$01:000545
icmpOutRedirects=$00:000820
icmpOutRedirects:rw_typ_tokens_words=$00:000820
icmpOutRedirects:o=$00:000821
icmpOutRedirects:l=$00:000822
icmpOutRedirects:data=$00:000823
icmpOutRedirects:flags=$00:000824
icmpOutRedirects:bucket=$00:000825
icmpOutRedirects:ranges=$00:000825
icmpOutRedirects:range=$00:000826
icmpOutRedirects:advance=$00:000826
icmpOutRedirects:netstring=:N129:P:0:000000
icmpOutRedirects:i=$01:000549
icmpOutSrcQuenchs=$00:00081A
icmpOutSrcQuenchs:rw_typ_tokens_words=$00:00081A
icmpOutSrcQuenchs:o=$00:00081B
icmpOutSrcQuenchs:l=$00:00081C
icmpOutSrcQuenchs:data=$00:00081D
icmpOutSrcQuenchs:flags=$00:00081E
icmpOutSrcQuenchs:bucket=$00:00081F
icmpOutSrcQuenchs:ranges=$00:00081F
icmpOutSrcQuenchs:range=$00:000820
icmpOutSrcQuenchs:advance=$00:000820
icmpOutSrcQuenchs:netstring=:N129:P:0:000000
icmpOutSrcQuenchs:i=$01:000547
icmpOutTimeExcds=$00:00080E
icmpOutTimeExcds:rw_typ_tokens_words=$00:00080E
icmpOutTimeExcds:o=$00:00080F
icmpOutTimeExcds:l=$00:000810
icmpOutTimeExcds:data=$00:000811
icmpOutTimeExcds:flags=$00:000812
icmpOutTimeExcds:bucket=$00:000813
icmpOutTimeExcds:ranges=$00:000813
icmpOutTimeExcds:range=$00:000814
icmpOutTimeExcds:advance=$00:000814
icmpOutTimeExcds:netstring=:N129:P:0:000000
icmpOutTimeExcds:i=$01:000543
icmpOutTimeStamps=$00:000832
icmpOutTimeStamps:rw_typ_tokens_words=$00:000832
icmpOutTimeStamps:o=$00:000833
icmpOutTimeStamps:l=$00:000834
icmpOutTimeStamps:data=$00:000835
icmpOutTimeStamps:flags=$00:000836
icmpOutTimeStamps:bucket=$00:000837
icmpOutTimeStamps:ranges=$00:000837
icmpOutTimeStamps:range=$00:000838
icmpOutTimeStamps:advance=$00:000838
icmpOutTimeStamps:netstring=:N129:P:0:000000
icmpOutTimeStamps:i=$01:00054F
icmpOutTimestampReps=$00:000838
icmpOutTimestampReps:rw_typ_tokens_words=$00:000838
icmpOutTimestampReps:o=$00:000839
icmpOutTimestampReps:l=$00:00083A
icmpOutTimestampReps:data=$00:00083B
icmpOutTimestampReps:flags=$00:00083C
icmpOutTimestampReps:bucket=$00:00083D
icmpOutTimestampReps:ranges=$00:00083D
icmpOutTimestampReps:range=$00:00083E
icmpOutTimestampReps:advance=$00:00083E
icmpOutTimestampReps:netstring=:N129:P:0:000000
icmpOutTimestampReps:i=$01:000551
icmpParmProbs=$00:0007C6
icmpParmProbs:rw_typ_tokens_words=$00:0007C6
icmpParmProbs:o=$00:0007C7
icmpParmProbs:l=$00:0007C8
icmpParmProbs:data=$00:0007C9
icmpParmProbs:flags=$00:0007CA
icmpParmProbs:bucket=$00:0007CB
icmpParmProbs:ranges=$00:0007CB
icmpParmProbs:range=$00:0007CC
icmpParmProbs:advance=$00:0007CC
icmpParmProbs:netstring=:N129:P:0:000000
icmpParmProbs:i=$01:00052B
icmp_buy_msg=$00:0002C9
icmp_buy_msg_optional=$00:0002CA
icmp_buy_response=$00:0002D4
icmp_drop=$00:000348
icmp_du_port=$00:00034D
icmp_echo=:N129:P:0:000000
icmp_exact=$00:0002F2
icmp_header=:N129:P:0:000000
icmp_iquick=$00:000300
icmp_mask=:N129:P:0:000000
icmp_noproto=$00:00034D
icmp_noreply=$00:0002D3
icmp_noresponse=$00:0002E8
icmp_nosocket=$00:00034E
icmp_redirect_du=:N129:P:0:000000
icmp_rx_routinfo?=$00:000348
icmp_rxq=$00:0002E9
icmp_rxqlong=$00:000304
icmp_rxqq=$00:000325
icmpq=$01:000408
icmpq:head=$01:000408
icmpq:tail=$01:000409
icmpx=$00:00034C
icool=$00:000F3A
id72_72
iedit48a
iedit48as
iedit48ua
iedit72a
iedit72as
iedit72ua
iedita
ieditas
ieditua
ifAdminStatus=$00:00068C
ifAdminStatus:rw_typ_tokens_words=$00:00068C
ifAdminStatus:o=$00:00068D
ifAdminStatus:l=$00:00068E
ifAdminStatus:data=$00:00068F
ifAdminStatus:flags=$00:000690
ifAdminStatus:bucket=$00:000691
ifAdminStatus:ranges=$00:000691
ifAdminStatus:range=$00:000692
ifAdminStatus:advance=$00:000692
ifAdminStatus:netstring=:N129:P:0:000000
ifDescr=$00:00066E
ifDescr:rw_typ_tokens_words=$00:00066E
ifDescr:o=$00:00066F
ifDescr:l=$00:000670
ifDescr:data=$00:000671
ifDescr:flags=$00:000672
ifDescr:bucket=$00:000673
ifDescr:ranges=$00:000673
ifDescr:range=$00:000674
ifDescr:advance=$00:000674
ifDescr:netstring=:N129:P:0:000000
ifInDiscards=$00:0006B0
ifInDiscards:rw_typ_tokens_words=$00:0006B0
ifInDiscards:o=$00:0006B1
ifInDiscards:l=$00:0006B2
ifInDiscards:data=$00:0006B3
ifInDiscards:flags=$00:0006B4
ifInDiscards:bucket=$00:0006B5
ifInDiscards:ranges=$00:0006B5
ifInDiscards:range=$00:0006B6
ifInDiscards:advance=$00:0006B6
ifInDiscards:netstring=:N129:P:0:000000
ifInErrors=$00:0006B6
ifInErrors:rw_typ_tokens_words=$00:0006B6
ifInErrors:o=$00:0006B7
ifInErrors:l=$00:0006B8
ifInErrors:data=$00:0006B9
ifInErrors:flags=$00:0006BA
ifInErrors:bucket=$00:0006BB
ifInErrors:ranges=$00:0006BB
ifInErrors:range=$00:0006BC
ifInErrors:advance=$00:0006BC
ifInErrors:netstring=:N129:P:0:000000
ifInNUcastPkts=$00:0006AA
ifInNUcastPkts:rw_typ_tokens_words=$00:0006AA
ifInNUcastPkts:o=$00:0006AB
ifInNUcastPkts:l=$00:0006AC
ifInNUcastPkts:data=$00:0006AD
ifInNUcastPkts:flags=$00:0006AE
ifInNUcastPkts:bucket=$00:0006AF
ifInNUcastPkts:ranges=$00:0006AF
ifInNUcastPkts:range=$00:0006B0
ifInNUcastPkts:advance=$00:0006B0
ifInNUcastPkts:netstring=:N129:P:0:000000
ifInOctets=$00:00069E
ifInOctets:rw_typ_tokens_words=$00:00069E
ifInOctets:o=$00:00069F
ifInOctets:l=$00:0006A0
ifInOctets:data=$00:0006A1
ifInOctets:flags=$00:0006A2
ifInOctets:bucket=$00:0006A3
ifInOctets:ranges=$00:0006A3
ifInOctets:range=$00:0006A4
ifInOctets:advance=$00:0006A4
ifInOctets:netstring=:N129:P:0:000000
ifInUcastPkts=$00:0006A4
ifInUcastPkts:rw_typ_tokens_words=$00:0006A4
ifInUcastPkts:o=$00:0006A5
ifInUcastPkts:l=$00:0006A6
ifInUcastPkts:data=$00:0006A7
ifInUcastPkts:flags=$00:0006A8
ifInUcastPkts:bucket=$00:0006A9
ifInUcastPkts:ranges=$00:0006A9
ifInUcastPkts:range=$00:0006AA
ifInUcastPkts:advance=$00:0006AA
ifInUcastPkts:netstring=:N129:P:0:000000
ifInUnknownProtos=$00:0006BC
ifInUnknownProtos:rw_typ_tokens_words=$00:0006BC
ifInUnknownProtos:o=$00:0006BD
ifInUnknownProtos:l=$00:0006BE
ifInUnknownProtos:data=$00:0006BF
ifInUnknownProtos:flags=$00:0006C0
ifInUnknownProtos:bucket=$00:0006C1
ifInUnknownProtos:ranges=$00:0006C1
ifInUnknownProtos:range=$00:0006C2
ifInUnknownProtos:advance=$00:0006C2
ifInUnknownProtos:netstring=:N129:P:0:000000
ifIndex=$00:000668
ifIndex:rw_typ_tokens_words=$00:000668
ifIndex:o=$00:000669
ifIndex:l=$00:00066A
ifIndex:data=$00:00066B
ifIndex:flags=$00:00066C
ifIndex:bucket=$00:00066D
ifIndex:ranges=$00:00066D
ifIndex:range=$00:00066E
ifIndex:advance=$00:00066E
ifIndex:netstring=:N129:P:0:000000
ifLastChange=$00:000698
ifLastChange:rw_typ_tokens_words=$00:000698
ifLastChange:o=$00:000699
ifLastChange:l=$00:00069A
ifLastChange:data=$00:00069B
ifLastChange:flags=$00:00069C
ifLastChange:bucket=$00:00069D
ifLastChange:ranges=$00:00069D
ifLastChange:range=$00:00069E
ifLastChange:advance=$00:00069E
ifLastChange:netstring=:N129:P:0:000000
ifMTU=$00:00067A
ifMTU:rw_typ_tokens_words=$00:00067A
ifMTU:o=$00:00067B
ifMTU:l=$00:00067C
ifMTU:data=$00:00067D
ifMTU:flags=$00:00067E
ifMTU:bucket=$00:00067F
ifMTU:ranges=$00:00067F
ifMTU:range=$00:000680
ifMTU:advance=$00:000680
ifMTU:netstring=:N129:P:0:000000
ifNumber=$00:000662
ifNumber:rw_typ_tokens_words=$00:000662
ifNumber:o=$00:000663
ifNumber:l=$00:000664
ifNumber:data=$00:000665
ifNumber:flags=$00:000666
ifNumber:bucket=$00:000667
ifNumber:ranges=$00:000667
ifNumber:range=$00:000668
ifNumber:advance=$00:000668
ifNumber:netstring=:N129:P:0:000000
ifNumber:i=$01:0004FD
ifOperStatus=$00:000692
ifOperStatus:rw_typ_tokens_words=$00:000692
ifOperStatus:o=$00:000693
ifOperStatus:l=$00:000694
ifOperStatus:data=$00:000695
ifOperStatus:flags=$00:000696
ifOperStatus:bucket=$00:000697
ifOperStatus:ranges=$00:000697
ifOperStatus:range=$00:000698
ifOperStatus:advance=$00:000698
ifOperStatus:netstring=:N129:P:0:000000
ifOutDiscards=$00:0006D4
ifOutDiscards:rw_typ_tokens_words=$00:0006D4
ifOutDiscards:o=$00:0006D5
ifOutDiscards:l=$00:0006D6
ifOutDiscards:data=$00:0006D7
ifOutDiscards:flags=$00:0006D8
ifOutDiscards:bucket=$00:0006D9
ifOutDiscards:ranges=$00:0006D9
ifOutDiscards:range=$00:0006DA
ifOutDiscards:advance=$00:0006DA
ifOutDiscards:netstring=:N129:P:0:000000
ifOutErrors=$00:0006DA
ifOutErrors:rw_typ_tokens_words=$00:0006DA
ifOutErrors:o=$00:0006DB
ifOutErrors:l=$00:0006DC
ifOutErrors:data=$00:0006DD
ifOutErrors:flags=$00:0006DE
ifOutErrors:bucket=$00:0006DF
ifOutErrors:ranges=$00:0006DF
ifOutErrors:range=$00:0006E0
ifOutErrors:advance=$00:0006E0
ifOutErrors:netstring=:N129:P:0:000000
ifOutNUcastPkts=$00:0006CE
ifOutNUcastPkts:rw_typ_tokens_words=$00:0006CE
ifOutNUcastPkts:o=$00:0006CF
ifOutNUcastPkts:l=$00:0006D0
ifOutNUcastPkts:data=$00:0006D1
ifOutNUcastPkts:flags=$00:0006D2
ifOutNUcastPkts:bucket=$00:0006D3
ifOutNUcastPkts:ranges=$00:0006D3
ifOutNUcastPkts:range=$00:0006D4
ifOutNUcastPkts:advance=$00:0006D4
ifOutNUcastPkts:netstring=:N129:P:0:000000
ifOutOctets=$00:0006C2
ifOutOctets:rw_typ_tokens_words=$00:0006C2
ifOutOctets:o=$00:0006C3
ifOutOctets:l=$00:0006C4
ifOutOctets:data=$00:0006C5
ifOutOctets:flags=$00:0006C6
ifOutOctets:bucket=$00:0006C7
ifOutOctets:ranges=$00:0006C7
ifOutOctets:range=$00:0006C8
ifOutOctets:advance=$00:0006C8
ifOutOctets:netstring=:N129:P:0:000000
ifOutQLen=$00:0006E0
ifOutQLen:rw_typ_tokens_words=$00:0006E0
ifOutQLen:o=$00:0006E1
ifOutQLen:l=$00:0006E2
ifOutQLen:data=$00:0006E3
ifOutQLen:flags=$00:0006E4
ifOutQLen:bucket=$00:0006E5
ifOutQLen:ranges=$00:0006E5
ifOutQLen:range=$00:0006E6
ifOutQLen:advance=$00:0006E6
ifOutQLen:netstring=:N129:P:0:000000
ifOutUcastPkts=$00:0006C8
ifOutUcastPkts:rw_typ_tokens_words=$00:0006C8
ifOutUcastPkts:o=$00:0006C9
ifOutUcastPkts:l=$00:0006CA
ifOutUcastPkts:data=$00:0006CB
ifOutUcastPkts:flags=$00:0006CC
ifOutUcastPkts:bucket=$00:0006CD
ifOutUcastPkts:ranges=$00:0006CD
ifOutUcastPkts:range=$00:0006CE
ifOutUcastPkts:advance=$00:0006CE
ifOutUcastPkts:netstring=:N129:P:0:000000
ifPhysAddress=$00:000686
ifPhysAddress:rw_typ_tokens_words=$00:000686
ifPhysAddress:o=$00:000687
ifPhysAddress:l=$00:000688
ifPhysAddress:data=$00:000689
ifPhysAddress:flags=$00:00068A
ifPhysAddress:bucket=$00:00068B
ifPhysAddress:ranges=$00:00068B
ifPhysAddress:range=$00:00068C
ifPhysAddress:advance=$00:00068C
ifPhysAddress:netstring=:N129:P:0:000000
ifSpecific=$00:0006E6
ifSpecific:rw_typ_tokens_words=$00:0006E6
ifSpecific:o=$00:0006E7
ifSpecific:l=$00:0006E8
ifSpecific:data=$00:0006E9
ifSpecific:flags=$00:0006EA
ifSpecific:bucket=$00:0006EB
ifSpecific:ranges=$00:0006EB
ifSpecific:range=$00:0006EC
ifSpecific:advance=$00:0006EC
ifSpecific:netstring=:N129:P:0:000000
ifSpeed=$00:000680
ifSpeed:rw_typ_tokens_words=$00:000680
ifSpeed:o=$00:000681
ifSpeed:l=$00:000682
ifSpeed:data=$00:000683
ifSpeed:flags=$00:000684
ifSpeed:bucket=$00:000685
ifSpeed:ranges=$00:000685
ifSpeed:range=$00:000686
ifSpeed:advance=$00:000686
ifSpeed:netstring=:N129:P:0:000000
ifType=$00:000674
ifType:rw_typ_tokens_words=$00:000674
ifType:o=$00:000675
ifType:l=$00:000676
ifType:data=$00:000677
ifType:flags=$00:000678
ifType:bucket=$00:000679
ifType:ranges=$00:000679
ifType:range=$00:00067A
ifType:advance=$00:00067A
ifType:netstring=:N129:P:0:000000
if_agentMTU=$00:00024B
if_agentadmins=$00:00024E
if_agentdescr=$00:000249
if_agentibytes=$00:000251
if_agentidrops=$00:000254
if_agentidx=$00:000248
if_agentierrs=$00:000255
if_agentimcast=$00:000253
if_agentinoproto=$00:000256
if_agentiucast=$00:000252
if_agentlastc=$00:000250
if_agentobytes=$00:000257
if_agentodrops=$00:00025A
if_agentoerrs=$00:00025B
if_agentomcast=$00:000259
if_agentoqlen=$00:00025C
if_agentosta=$00:00024F
if_agentoucast=$00:000258
if_agentphy=$00:00024D
if_agentsmib=$00:00025D
if_agentspeed=$00:00024C
if_agenttype=$00:00024A
if_buy1+=$00:00009B
if_initpool=$00:0000BB
if_q2ifree+=$00:00009E
if_rx_nocheck+=$00:00009F
if_sell1+=$00:00009A
if_tx_nocheck+=$00:00009F
ifaddr=$42:000000,000002
ifaddr:next=$42:000000,000002
ifaddr:lexical=$42:000001,000002
ifaddr:i_f=$42:000002,000002
ifaddr:net=$42:000003,000002
ifaddr:mask=$42:000005,000002
ifaddr:broadcast=$42:000007,000002
ifagent_MTU=$00:0002D0
ifagent_admins=$00:0002F0
ifagent_c48=$01:000469
ifagent_c48:along=$01:000469
ifagent_c48:data=$01:00046A
ifagent_c48:down=$01:00046A
ifagent_c48:seq=$01:00046B
ifagent_c48:type=$01:00046C
ifagent_c48:bytes=$01:00046D
ifagent_c48:flags=$01:00046E
ifagent_c48:bucket=$01:00046F
ifagent_c48:ranges=$01:00046F
ifagent_c48:range=$01:000470
ifagent_descr=$00:0002BC
ifagent_find=$00:000386
ifagent_find_another=$00:000380
ifagent_find_i_f=$00:000385
ifagent_find_next_if=$00:00037B
ifagent_g48=$01:000462
ifagent_g48:along=$01:000462
ifagent_g48:data=$01:000463
ifagent_g48:down=$01:000463
ifagent_g48:seq=$01:000464
ifagent_g48:type=$01:000465
ifagent_g48:bytes=$01:000466
ifagent_g48:flags=$01:000467
ifagent_g48:bucket=$01:000468
ifagent_g48:ranges=$01:000468
ifagent_g48:range=$01:000469
ifagent_i24=$01:000446
ifagent_i24:along=$01:000446
ifagent_i24:data=$01:000447
ifagent_i24:down=$01:000447
ifagent_i24:seq=$01:000448
ifagent_i24:type=$01:000449
ifagent_i24:bytes=$01:00044A
ifagent_i24:flags=$01:00044B
ifagent_i24:bucket=$01:00044C
ifagent_i24:ranges=$01:00044C
ifagent_i24:range=$01:00044D
ifagent_ibytes=$00:00030A
ifagent_idrops=$00:000325
ifagent_idx=$00:00029D
ifagent_idx_2hi=$00:00038E
ifagent_ierrs=$00:00032E
ifagent_imcast=$00:00031C
ifagent_inoproto=$00:000337
ifagent_iucast=$00:000313
ifagent_lastc=$00:000302
ifagent_noMTU=$00:0002D8
ifagent_noadmins=$00:0002F8
ifagent_nodescr=$00:0002C6
ifagent_noibytes=$00:000312
ifagent_noidrops=$00:00032D
ifagent_noidx=$00:0002AD
ifagent_noierrs=$00:000336
ifagent_noimcast=$00:000324
ifagent_noinoproto=$00:00033F
ifagent_noiucast=$00:00031B
ifagent_nolastc=$00:000309
ifagent_noobytes=$00:000348
ifagent_noodrops=$00:000363
ifagent_nooerrs=$00:00036B
ifagent_noomcast=$00:00035A
ifagent_nooqlen=$00:000375
ifagent_noosta=$00:000301
ifagent_nooucast=$00:000351
ifagent_nophy=$00:0002EE
ifagent_nosmib=$00:00037A
ifagent_nospeed=$00:0002DF
ifagent_notype=$00:0002CF
ifagent_obytes=$00:000340
ifagent_odrops=$00:00035B
ifagent_oerrs=$00:000364
ifagent_omcast=$00:000352
ifagent_onone=$01:000470
ifagent_onone:along=$01:000470
ifagent_onone:data=$01:000471
ifagent_onone:down=$01:000471
ifagent_onone:seq=$01:000472
ifagent_onone:type=$01:000473
ifagent_onone:bytes=$01:000474
ifagent_onone:flags=$01:000475
ifagent_onone:bucket=$01:000476
ifagent_onone:ranges=$01:000476
ifagent_onone:range=$01:000477
ifagent_oqlen=$00:00036D
ifagent_osta=$00:0002F9
ifagent_oucast=$00:000349
ifagent_p48=$01:000477
ifagent_phy=$00:0002E0
ifagent_row?=$00:0002A4
ifagent_smib=$00:000376
ifagent_speed=$00:0002D9
ifagent_string=$01:00044D
ifagent_string:along=$01:00044D
ifagent_string:data=$01:00044E
ifagent_string:down=$01:00044E
ifagent_string:seq=$01:00044F
ifagent_string:type=$01:000450
ifagent_string:bytes=$01:000451
ifagent_string:flags=$01:000452
ifagent_string:bucket=$01:000453
ifagent_string:ranges=$01:000453
ifagent_string:range=$01:000454
ifagent_string48=$01:000454
ifagent_string48:along=$01:000454
ifagent_string48:data=$01:000455
ifagent_string48:down=$01:000455
ifagent_string48:seq=$01:000456
ifagent_string48:type=$01:000457
ifagent_string48:bytes=$01:000458
ifagent_string48:flags=$01:000459
ifagent_string48:bucket=$01:00045A
ifagent_string48:ranges=$01:00045A
ifagent_string48:range=$01:00045B
ifagent_t48=$01:00045B
ifagent_t48:along=$01:00045B
ifagent_t48:data=$01:00045C
ifagent_t48:down=$01:00045C
ifagent_t48:seq=$01:00045D
ifagent_t48:type=$01:00045E
ifagent_t48:bytes=$01:00045F
ifagent_t48:flags=$01:000460
ifagent_t48:bucket=$01:000461
ifagent_t48:ranges=$01:000461
ifagent_t48:range=$01:000462
ifagent_this_row=$00:0002A3
ifagent_type=$00:0002C7
ifastaflags=000004,00000F
ifastaroutine=000005,00000F
ifastaseq=000003,00000F
ifbuy=$00:0000BF
ifconfig_frame=:N129:P:0:000000
ifdescflags=000004,00000F
ifdescroutine=000005,00000F
ifdescseq=000003,00000F
ifibytflags=000004,00000F
ifibytroutine=000005,00000F
ifibytseq=000003,00000F
ifidropflags=000004,00000F
ifidroproutine=000005,00000F
ifidropseq=000003,00000F
ifidxflags=000004,00000F
ifidxroutine=000005,00000F
ifidxseq=000003,00000F
ifierflags=000004,00000F
ifierroutine=000005,00000F
ifierseq=000003,00000F
ifimcaflags=000004,00000F
ifimcaroutine=000005,00000F
ifimcaseq=000003,00000F
ifinoproflags=000004,00000F
ifinoproroutine=000005,00000F
ifinoproseq=000003,00000F
ifiucaflags=000004,00000F
ifiucaroutine=000005,00000F
ifiucaseq=000003,00000F
ifixidxroutine=000005,00000F
iflcflags=000004,00000F
iflcroutine=000005,00000F
iflcseq=000003,00000F
ifmtuflags=000004,00000F
ifmturoutine=000005,00000F
ifmtuseq=000003,00000F
ifobytflags=000004,00000F
ifobytroutine=000005,00000F
ifobytseq=000003,00000F
ifodropflags=000004,00000F
ifodroproutine=000005,00000F
ifodropseq=000003,00000F
ifoerflags=000004,00000F
ifoerroutine=000005,00000F
ifoerseq=000003,00000F
ifomcaflags=000004,00000F
ifomcaroutine=000005,00000F
ifomcaseq=000003,00000F
ifoqlflags=000004,00000F
ifoqlroutine=000005,00000F
ifoqlseq=000003,00000F
ifostaflags=000004,00000F
ifostaroutine=000005,00000F
ifostaseq=000003,00000F
ifoucaflags=000004,00000F
ifoucaroutine=000005,00000F
ifoucaseq=000003,00000F
ifphycaller_x=000000,00000F
ifphyflags=000005,00000F
ifphyroutine=000006,00000F
ifphyseq=000004,00000F
ifq2=$00:0000C3
ifq2ifree=$00:0000C5
ifrateflags=000004,00000F
ifrateroutine=000005,00000F
ifrateseq=000003,00000F
ifrq=$00:0000C1
ifsellmsg=$00:0000BD
ifsmibflags=000004,00000F
ifsmibroutine=000005,00000F
ifsmibseq=000003,00000F
iftx_nocheck=$00:0000C7
iftypflags=000004,00000F
iftyproutine=000005,00000F
iftypseq=000003,00000F
ifxpointer(1)=$01:000001
ifxpointer(2)=$01:000002
ifxpointer(3)=$01:000003
ifxpointer(4)=$01:000004
ifxpointer(5)=$01:000005
ifxpointer(6)=$01:000006
ifxpointer(7)=$01:000007
ifxpointer(8)=$01:000008
ilist=000000,00000F
im72_72
image_in_rom=$00:000049
in8nocheck=:P1:0:000074
in_freechain_already=$00:0001A1
in_order=$00:0002E9
inactive_thread=$00:000100
inetCidrRouteDest=$00:000A24
inetCidrRouteDest:rw_typ_tokens_words=$00:000A24
inetCidrRouteDest:o=$00:000A25
inetCidrRouteDest:l=$00:000A26
inetCidrRouteDest:data=$00:000A27
inetCidrRouteDest:flags=$00:000A28
inetCidrRouteDest:bucket=$00:000A29
inetCidrRouteDest:ranges=$00:000A29
inetCidrRouteDest:range=$00:000A2A
inetCidrRouteDest:advance=$00:000A2A
inetCidrRouteDest:netstring=:N129:P:0:000000
inetCidrRouteDestType=$00:000A1E
inetCidrRouteDestType:rw_typ_tokens_words=$00:000A1E
inetCidrRouteDestType:o=$00:000A1F
inetCidrRouteDestType:l=$00:000A20
inetCidrRouteDestType:data=$00:000A21
inetCidrRouteDestType:flags=$00:000A22
inetCidrRouteDestType:bucket=$00:000A23
inetCidrRouteDestType:ranges=$00:000A23
inetCidrRouteDestType:range=$00:000A24
inetCidrRouteDestType:advance=$00:000A24
inetCidrRouteDestType:netstring=:N129:P:0:000000
inetCidrRouteIfIndex=$00:000A3C
inetCidrRouteIfIndex:rw_typ_tokens_words=$00:000A3C
inetCidrRouteIfIndex:o=$00:000A3D
inetCidrRouteIfIndex:l=$00:000A3E
inetCidrRouteIfIndex:data=$00:000A3F
inetCidrRouteIfIndex:flags=$00:000A40
inetCidrRouteIfIndex:bucket=$00:000A41
inetCidrRouteIfIndex:ranges=$00:000A41
inetCidrRouteIfIndex:range=$00:000A42
inetCidrRouteIfIndex:advance=$00:000A42
inetCidrRouteIfIndex:netstring=:N129:P:0:000000
inetCidrRouteNextHop=$00:000A36
inetCidrRouteNextHop:rw_typ_tokens_words=$00:000A36
inetCidrRouteNextHop:o=$00:000A37
inetCidrRouteNextHop:l=$00:000A38
inetCidrRouteNextHop:data=$00:000A39
inetCidrRouteNextHop:flags=$00:000A3A
inetCidrRouteNextHop:bucket=$00:000A3B
inetCidrRouteNextHop:ranges=$00:000A3B
inetCidrRouteNextHop:range=$00:000A3C
inetCidrRouteNextHop:advance=$00:000A3C
inetCidrRouteNextHop:netstring=:N129:P:0:000000
inetCidrRouteNextHopType=$00:000A30
inetCidrRouteNextHopType:rw_typ_tokens_words=$00:000A30
inetCidrRouteNextHopType:o=$00:000A31
inetCidrRouteNextHopType:l=$00:000A32
inetCidrRouteNextHopType:data=$00:000A33
inetCidrRouteNextHopType:flags=$00:000A34
inetCidrRouteNextHopType:bucket=$00:000A35
inetCidrRouteNextHopType:ranges=$00:000A35
inetCidrRouteNextHopType:range=$00:000A36
inetCidrRouteNextHopType:advance=$00:000A36
inetCidrRouteNextHopType:netstring=:N129:P:0:000000
inetCidrRoutePfxLen=$00:000A2A
inetCidrRoutePfxLen:rw_typ_tokens_words=$00:000A2A
inetCidrRoutePfxLen:o=$00:000A2B
inetCidrRoutePfxLen:l=$00:000A2C
inetCidrRoutePfxLen:data=$00:000A2D
inetCidrRoutePfxLen:flags=$00:000A2E
inetCidrRoutePfxLen:bucket=$00:000A2F
inetCidrRoutePfxLen:ranges=$00:000A2F
inetCidrRoutePfxLen:range=$00:000A30
inetCidrRoutePfxLen:advance=$00:000A30
inetCidrRoutePfxLen:netstring=:N129:P:0:000000
inetCidrRouteType=$00:000A42
inetCidrRouteType:rw_typ_tokens_words=$00:000A42
inetCidrRouteType:o=$00:000A43
inetCidrRouteType:l=$00:000A44
inetCidrRouteType:data=$00:000A45
inetCidrRouteType:flags=$00:000A46
inetCidrRouteType:bucket=$00:000A47
inetCidrRouteType:ranges=$00:000A47
inetCidrRouteType:range=$00:000A48
inetCidrRouteType:advance=$00:000A48
inetCidrRouteType:netstring=:N129:P:0:000000
inetcidr_gauge=$01:0004BF
inetcidr_oaddress=$01:0004C9
inetcidr_oaddress:along=$01:0004C9
inetcidr_oaddress:data=$01:0004CA
inetcidr_oaddress:down=$01:0004CA
inetcidr_oaddress:seq=$01:0004CB
inetcidr_oaddress:type=$01:0004CC
inetcidr_oaddress:bytes=$01:0004CD
inetcidr_oaddress:flags=$01:0004CE
inetcidr_oaddress:bucket=$01:0004CF
inetcidr_oaddress:ranges=$01:0004CF
inetcidr_oaddress:range=$01:0004D0
inetcidr_ogauge=$01:0004C2
inetcidr_ogauge:along=$01:0004C2
inetcidr_ogauge:data=$01:0004C3
inetcidr_ogauge:down=$01:0004C3
inetcidr_ogauge:seq=$01:0004C4
inetcidr_ogauge:type=$01:0004C5
inetcidr_ogauge:bytes=$01:0004C6
inetcidr_ogauge:flags=$01:0004C7
inetcidr_ogauge:bucket=$01:0004C8
inetcidr_ogauge:ranges=$01:0004C8
inetcidr_ogauge:range=$01:0004C9
inetcidr_xnet=$01:0004C0
init_pool=$00:000E0A
init_pool:caller_y=00000C,00000F
init_pool:save_simd=000008,00000F
init_pool:initial_pointers=000004,00000F
init_pool:simd_control=000000,00000F
initial_startups+=$00:00014B
int=000014,00000F
integer192+=$00:000171
integer96+=$00:000173
integer_edit=[001b]000000
integer_server=$00:000144
interface!=$00:000F69
interface(1)=$01:00000A
interface(1):id=$01:00000A
interface(1):flags=$01:00000B
interface(1):address_list=$01:00000C
interface(1):type=$01:00000D
interface(1):mtu=$01:00000E
interface(1):state=$01:00000F
interface(1):bitrate=$01:000010
interface(1):physa=$01:000012
interface(1):lastchange=$01:000014
interface(1):inoctets=$01:000016
interface(1):outoctets=$01:000018
interface(1):inpackets=$01:00001A
interface(1):outpackets=$01:00001C
interface(1):inmcast=$01:00001E
interface(1):outmcast=$01:000020
interface(1):indrops=$01:000022
interface(1):outdrops=$01:000024
interface(1):inerrs=$01:000026
interface(1):outerrs=$01:000028
interface(1):inoproto=$01:00002A
interface(1):oqlen=$01:00002C
interface(1):oqremaining=$01:00002D
interface(1):threshold_time=$01:00002E
interface(1):description=$01:00002F
interface(1):description_bytes=$01:000030
interface(1):q2=$01:000031
interface(1):lock_cell_q1=$01:000032
interface(1):lock_cell_q2=$01:000033
interface(1):iq_rxfragments=$01:000034
interface(1):fragment_engine_descriptor=$01:000035
interface(1):iq_buffer=$01:000036
interface(1):iq=$01:000037
interface(1):iq:head=$01:000037
interface(1):iq:tail=$01:000038
interface(1):oq=$01:000039
interface(1):oq:head=$01:000039
interface(1):oq:tail=$01:00003A
interface(1):oq2=$01:00003B
interface(1):oq2:head=$01:00003B
interface(1):oq2:head:bx=$01:00003B
interface(1):oq2:head:offset=$01:00003C
interface(1):oq2:tail=$01:00003D
interface(1):oq2:tail:bx=$01:00003D
interface(1):oq2:tail:offset=$01:00003E
interface(1):initial=$01:00003F
interface(1):rxtx_interface=$01:000040
interface(1):class=$01:000041
interface(1):llhl=$01:000042
interface(1):write_llh=$01:000043
interface(1):arp_rx=$01:000044
interface(1):arp_tx=$01:000045
interface(1):arp_resolve=$01:000046
interface(1):xarp=$01:000047
interface(1):ift1=$01:000048
interface(1):ift1:rx_restart=$01:000048
interface(1):ift1:rx_limit=$01:000049
interface(1):ift1:tx_restart=$01:00004A
interface(1):ift1:tx_limit=$01:00004B
interface(1):ift1:base_rx=$01:00004C
interface(1):ift1:rx_cursor=$01:00004D
interface(1):ift1:base_tx=$01:00004E
interface(1):ift1:tx_cursor=$01:00004F
interface(1):sif=$01:000048
interface(2)=$01:000050
interface(2):id=$01:000050
interface(2):flags=$01:000051
interface(2):address_list=$01:000052
interface(2):type=$01:000053
interface(2):mtu=$01:000054
interface(2):state=$01:000055
interface(2):bitrate=$01:000056
interface(2):physa=$01:000058
interface(2):lastchange=$01:00005A
interface(2):inoctets=$01:00005C
interface(2):outoctets=$01:00005E
interface(2):inpackets=$01:000060
interface(2):outpackets=$01:000062
interface(2):inmcast=$01:000064
interface(2):outmcast=$01:000066
interface(2):indrops=$01:000068
interface(2):outdrops=$01:00006A
interface(2):inerrs=$01:00006C
interface(2):outerrs=$01:00006E
interface(2):inoproto=$01:000070
interface(2):oqlen=$01:000072
interface(2):oqremaining=$01:000073
interface(2):threshold_time=$01:000074
interface(2):description=$01:000075
interface(2):description_bytes=$01:000076
interface(2):q2=$01:000077
interface(2):lock_cell_q1=$01:000078
interface(2):lock_cell_q2=$01:000079
interface(2):iq_rxfragments=$01:00007A
interface(2):fragment_engine_descriptor=$01:00007B
interface(2):iq_buffer=$01:00007C
interface(2):iq=$01:00007D
interface(2):iq:head=$01:00007D
interface(2):iq:tail=$01:00007E
interface(2):oq=$01:00007F
interface(2):oq:head=$01:00007F
interface(2):oq:tail=$01:000080
interface(2):oq2=$01:000081
interface(2):oq2:head=$01:000081
interface(2):oq2:head:bx=$01:000081
interface(2):oq2:head:offset=$01:000082
interface(2):oq2:tail=$01:000083
interface(2):oq2:tail:bx=$01:000083
interface(2):oq2:tail:offset=$01:000084
interface(2):initial=$01:000085
interface(2):rxtx_interface=$01:000086
interface(2):class=$01:000087
interface(2):llhl=$01:000088
interface(2):write_llh=$01:000089
interface(2):arp_rx=$01:00008A
interface(2):arp_tx=$01:00008B
interface(2):arp_resolve=$01:00008C
interface(2):xarp=$01:00008D
interface(2):ift1=$01:00008E
interface(2):ift1:rx_restart=$01:00008E
interface(2):ift1:rx_limit=$01:00008F
interface(2):ift1:tx_restart=$01:000090
interface(2):ift1:tx_limit=$01:000091
interface(2):ift1:base_rx=$01:000092
interface(2):ift1:rx_cursor=$01:000093
interface(2):ift1:base_tx=$01:000094
interface(2):ift1:tx_cursor=$01:000095
interface(2):sif=$01:00008E
interface(3)=$01:000096
interface(3):id=$01:000096
interface(3):flags=$01:000097
interface(3):address_list=$01:000098
interface(3):type=$01:000099
interface(3):mtu=$01:00009A
interface(3):state=$01:00009B
interface(3):bitrate=$01:00009C
interface(3):physa=$01:00009E
interface(3):lastchange=$01:0000A0
interface(3):inoctets=$01:0000A2
interface(3):outoctets=$01:0000A4
interface(3):inpackets=$01:0000A6
interface(3):outpackets=$01:0000A8
interface(3):inmcast=$01:0000AA
interface(3):outmcast=$01:0000AC
interface(3):indrops=$01:0000AE
interface(3):outdrops=$01:0000B0
interface(3):inerrs=$01:0000B2
interface(3):outerrs=$01:0000B4
interface(3):inoproto=$01:0000B6
interface(3):oqlen=$01:0000B8
interface(3):oqremaining=$01:0000B9
interface(3):threshold_time=$01:0000BA
interface(3):description=$01:0000BB
interface(3):description_bytes=$01:0000BC
interface(3):q2=$01:0000BD
interface(3):lock_cell_q1=$01:0000BE
interface(3):lock_cell_q2=$01:0000BF
interface(3):iq_rxfragments=$01:0000C0
interface(3):fragment_engine_descriptor=$01:0000C1
interface(3):iq_buffer=$01:0000C2
interface(3):iq=$01:0000C3
interface(3):iq:head=$01:0000C3
interface(3):iq:tail=$01:0000C4
interface(3):oq=$01:0000C5
interface(3):oq:head=$01:0000C5
interface(3):oq:tail=$01:0000C6
interface(3):oq2=$01:0000C7
interface(3):oq2:head=$01:0000C7
interface(3):oq2:head:bx=$01:0000C7
interface(3):oq2:head:offset=$01:0000C8
interface(3):oq2:tail=$01:0000C9
interface(3):oq2:tail:bx=$01:0000C9
interface(3):oq2:tail:offset=$01:0000CA
interface(3):initial=$01:0000CB
interface(3):rxtx_interface=$01:0000CC
interface(3):class=$01:0000CD
interface(3):llhl=$01:0000CE
interface(3):write_llh=$01:0000CF
interface(3):arp_rx=$01:0000D0
interface(3):arp_tx=$01:0000D1
interface(3):arp_resolve=$01:0000D2
interface(3):xarp=$01:0000D3
interface(3):ift1=$01:0000D4
interface(3):ift1:rx_restart=$01:0000D4
interface(3):ift1:rx_limit=$01:0000D5
interface(3):ift1:tx_restart=$01:0000D6
interface(3):ift1:tx_limit=$01:0000D7
interface(3):ift1:base_rx=$01:0000D8
interface(3):ift1:rx_cursor=$01:0000D9
interface(3):ift1:base_tx=$01:0000DA
interface(3):ift1:tx_cursor=$01:0000DB
interface(3):sif=$01:0000D4
interface(4)=$01:0000DC
interface(4):id=$01:0000DC
interface(4):flags=$01:0000DD
interface(4):address_list=$01:0000DE
interface(4):type=$01:0000DF
interface(4):mtu=$01:0000E0
interface(4):state=$01:0000E1
interface(4):bitrate=$01:0000E2
interface(4):physa=$01:0000E4
interface(4):lastchange=$01:0000E6
interface(4):inoctets=$01:0000E8
interface(4):outoctets=$01:0000EA
interface(4):inpackets=$01:0000EC
interface(4):outpackets=$01:0000EE
interface(4):inmcast=$01:0000F0
interface(4):outmcast=$01:0000F2
interface(4):indrops=$01:0000F4
interface(4):outdrops=$01:0000F6
interface(4):inerrs=$01:0000F8
interface(4):outerrs=$01:0000FA
interface(4):inoproto=$01:0000FC
interface(4):oqlen=$01:0000FE
interface(4):oqremaining=$01:0000FF
interface(4):threshold_time=$01:000100
interface(4):description=$01:000101
interface(4):description_bytes=$01:000102
interface(4):q2=$01:000103
interface(4):lock_cell_q1=$01:000104
interface(4):lock_cell_q2=$01:000105
interface(4):iq_rxfragments=$01:000106
interface(4):fragment_engine_descriptor=$01:000107
interface(4):iq_buffer=$01:000108
interface(4):iq=$01:000109
interface(4):iq:head=$01:000109
interface(4):iq:tail=$01:00010A
interface(4):oq=$01:00010B
interface(4):oq:head=$01:00010B
interface(4):oq:tail=$01:00010C
interface(4):oq2=$01:00010D
interface(4):oq2:head=$01:00010D
interface(4):oq2:head:bx=$01:00010D
interface(4):oq2:head:offset=$01:00010E
interface(4):oq2:tail=$01:00010F
interface(4):oq2:tail:bx=$01:00010F
interface(4):oq2:tail:offset=$01:000110
interface(4):initial=$01:000111
interface(4):rxtx_interface=$01:000112
interface(4):class=$01:000113
interface(4):llhl=$01:000114
interface(4):write_llh=$01:000115
interface(4):arp_rx=$01:000116
interface(4):arp_tx=$01:000117
interface(4):arp_resolve=$01:000118
interface(4):xarp=$01:000119
interface(4):ift1=$01:00011A
interface(4):ift1:rx_restart=$01:00011A
interface(4):ift1:rx_limit=$01:00011B
interface(4):ift1:tx_restart=$01:00011C
interface(4):ift1:tx_limit=$01:00011D
interface(4):ift1:base_rx=$01:00011E
interface(4):ift1:rx_cursor=$01:00011F
interface(4):ift1:base_tx=$01:000120
interface(4):ift1:tx_cursor=$01:000121
interface(4):sif=$01:00011A
interface(5)=$01:000122
interface(5):id=$01:000122
interface(5):flags=$01:000123
interface(5):address_list=$01:000124
interface(5):type=$01:000125
interface(5):mtu=$01:000126
interface(5):state=$01:000127
interface(5):bitrate=$01:000128
interface(5):physa=$01:00012A
interface(5):lastchange=$01:00012C
interface(5):inoctets=$01:00012E
interface(5):outoctets=$01:000130
interface(5):inpackets=$01:000132
interface(5):outpackets=$01:000134
interface(5):inmcast=$01:000136
interface(5):outmcast=$01:000138
interface(5):indrops=$01:00013A
interface(5):outdrops=$01:00013C
interface(5):inerrs=$01:00013E
interface(5):outerrs=$01:000140
interface(5):inoproto=$01:000142
interface(5):oqlen=$01:000144
interface(5):oqremaining=$01:000145
interface(5):threshold_time=$01:000146
interface(5):description=$01:000147
interface(5):description_bytes=$01:000148
interface(5):q2=$01:000149
interface(5):lock_cell_q1=$01:00014A
interface(5):lock_cell_q2=$01:00014B
interface(5):iq_rxfragments=$01:00014C
interface(5):fragment_engine_descriptor=$01:00014D
interface(5):iq_buffer=$01:00014E
interface(5):iq=$01:00014F
interface(5):iq:head=$01:00014F
interface(5):iq:tail=$01:000150
interface(5):oq=$01:000151
interface(5):oq:head=$01:000151
interface(5):oq:tail=$01:000152
interface(5):oq2=$01:000153
interface(5):oq2:head=$01:000153
interface(5):oq2:head:bx=$01:000153
interface(5):oq2:head:offset=$01:000154
interface(5):oq2:tail=$01:000155
interface(5):oq2:tail:bx=$01:000155
interface(5):oq2:tail:offset=$01:000156
interface(5):initial=$01:000157
interface(5):rxtx_interface=$01:000158
interface(5):class=$01:000159
interface(5):llhl=$01:00015A
interface(5):write_llh=$01:00015B
interface(5):arp_rx=$01:00015C
interface(5):arp_tx=$01:00015D
interface(5):arp_resolve=$01:00015E
interface(5):xarp=$01:00015F
interface(5):ift1=$01:000160
interface(5):ift1:rx_restart=$01:000160
interface(5):ift1:rx_limit=$01:000161
interface(5):ift1:tx_restart=$01:000162
interface(5):ift1:tx_limit=$01:000163
interface(5):ift1:base_rx=$01:000164
interface(5):ift1:rx_cursor=$01:000165
interface(5):ift1:base_tx=$01:000166
interface(5):ift1:tx_cursor=$01:000167
interface(5):sif=$01:000160
interface(6)=$01:000168
interface(6):id=$01:000168
interface(6):flags=$01:000169
interface(6):address_list=$01:00016A
interface(6):type=$01:00016B
interface(6):mtu=$01:00016C
interface(6):state=$01:00016D
interface(6):bitrate=$01:00016E
interface(6):physa=$01:000170
interface(6):lastchange=$01:000172
interface(6):inoctets=$01:000174
interface(6):outoctets=$01:000176
interface(6):inpackets=$01:000178
interface(6):outpackets=$01:00017A
interface(6):inmcast=$01:00017C
interface(6):outmcast=$01:00017E
interface(6):indrops=$01:000180
interface(6):outdrops=$01:000182
interface(6):inerrs=$01:000184
interface(6):outerrs=$01:000186
interface(6):inoproto=$01:000188
interface(6):oqlen=$01:00018A
interface(6):oqremaining=$01:00018B
interface(6):threshold_time=$01:00018C
interface(6):description=$01:00018D
interface(6):description_bytes=$01:00018E
interface(6):q2=$01:00018F
interface(6):lock_cell_q1=$01:000190
interface(6):lock_cell_q2=$01:000191
interface(6):iq_rxfragments=$01:000192
interface(6):fragment_engine_descriptor=$01:000193
interface(6):iq_buffer=$01:000194
interface(6):iq=$01:000195
interface(6):iq:head=$01:000195
interface(6):iq:tail=$01:000196
interface(6):oq=$01:000197
interface(6):oq:head=$01:000197
interface(6):oq:tail=$01:000198
interface(6):oq2=$01:000199
interface(6):oq2:head=$01:000199
interface(6):oq2:head:bx=$01:000199
interface(6):oq2:head:offset=$01:00019A
interface(6):oq2:tail=$01:00019B
interface(6):oq2:tail:bx=$01:00019B
interface(6):oq2:tail:offset=$01:00019C
interface(6):initial=$01:00019D
interface(6):rxtx_interface=$01:00019E
interface(6):class=$01:00019F
interface(6):llhl=$01:0001A0
interface(6):write_llh=$01:0001A1
interface(6):arp_rx=$01:0001A2
interface(6):arp_tx=$01:0001A3
interface(6):arp_resolve=$01:0001A4
interface(6):xarp=$01:0001A5
interface(6):ift1=$01:0001A6
interface(6):ift1:rx_restart=$01:0001A6
interface(6):ift1:rx_limit=$01:0001A7
interface(6):ift1:tx_restart=$01:0001A8
interface(6):ift1:tx_limit=$01:0001A9
interface(6):ift1:base_rx=$01:0001AA
interface(6):ift1:rx_cursor=$01:0001AB
interface(6):ift1:base_tx=$01:0001AC
interface(6):ift1:tx_cursor=$01:0001AD
interface(6):sif=$01:0001A6
interface(7)=$01:0001AE
interface(7):id=$01:0001AE
interface(7):flags=$01:0001AF
interface(7):address_list=$01:0001B0
interface(7):type=$01:0001B1
interface(7):mtu=$01:0001B2
interface(7):state=$01:0001B3
interface(7):bitrate=$01:0001B4
interface(7):physa=$01:0001B6
interface(7):lastchange=$01:0001B8
interface(7):inoctets=$01:0001BA
interface(7):outoctets=$01:0001BC
interface(7):inpackets=$01:0001BE
interface(7):outpackets=$01:0001C0
interface(7):inmcast=$01:0001C2
interface(7):outmcast=$01:0001C4
interface(7):indrops=$01:0001C6
interface(7):outdrops=$01:0001C8
interface(7):inerrs=$01:0001CA
interface(7):outerrs=$01:0001CC
interface(7):inoproto=$01:0001CE
interface(7):oqlen=$01:0001D0
interface(7):oqremaining=$01:0001D1
interface(7):threshold_time=$01:0001D2
interface(7):description=$01:0001D3
interface(7):description_bytes=$01:0001D4
interface(7):q2=$01:0001D5
interface(7):lock_cell_q1=$01:0001D6
interface(7):lock_cell_q2=$01:0001D7
interface(7):iq_rxfragments=$01:0001D8
interface(7):fragment_engine_descriptor=$01:0001D9
interface(7):iq_buffer=$01:0001DA
interface(7):iq=$01:0001DB
interface(7):iq:head=$01:0001DB
interface(7):iq:tail=$01:0001DC
interface(7):oq=$01:0001DD
interface(7):oq:head=$01:0001DD
interface(7):oq:tail=$01:0001DE
interface(7):oq2=$01:0001DF
interface(7):oq2:head=$01:0001DF
interface(7):oq2:head:bx=$01:0001DF
interface(7):oq2:head:offset=$01:0001E0
interface(7):oq2:tail=$01:0001E1
interface(7):oq2:tail:bx=$01:0001E1
interface(7):oq2:tail:offset=$01:0001E2
interface(7):initial=$01:0001E3
interface(7):rxtx_interface=$01:0001E4
interface(7):class=$01:0001E5
interface(7):llhl=$01:0001E6
interface(7):write_llh=$01:0001E7
interface(7):arp_rx=$01:0001E8
interface(7):arp_tx=$01:0001E9
interface(7):arp_resolve=$01:0001EA
interface(7):xarp=$01:0001EB
interface(7):ift1=$01:0001EC
interface(7):ift1:rx_restart=$01:0001EC
interface(7):ift1:rx_limit=$01:0001ED
interface(7):ift1:tx_restart=$01:0001EE
interface(7):ift1:tx_limit=$01:0001EF
interface(7):ift1:base_rx=$01:0001F0
interface(7):ift1:rx_cursor=$01:0001F1
interface(7):ift1:base_tx=$01:0001F2
interface(7):ift1:tx_cursor=$01:0001F3
interface(7):sif=$01:0001EC
interface(8)=$01:0001F4
interface(8):id=$01:0001F4
interface(8):flags=$01:0001F5
interface(8):address_list=$01:0001F6
interface(8):type=$01:0001F7
interface(8):mtu=$01:0001F8
interface(8):state=$01:0001F9
interface(8):bitrate=$01:0001FA
interface(8):physa=$01:0001FC
interface(8):lastchange=$01:0001FE
interface(8):inoctets=$01:000200
interface(8):outoctets=$01:000202
interface(8):inpackets=$01:000204
interface(8):outpackets=$01:000206
interface(8):inmcast=$01:000208
interface(8):outmcast=$01:00020A
interface(8):indrops=$01:00020C
interface(8):outdrops=$01:00020E
interface(8):inerrs=$01:000210
interface(8):outerrs=$01:000212
interface(8):inoproto=$01:000214
interface(8):oqlen=$01:000216
interface(8):oqremaining=$01:000217
interface(8):threshold_time=$01:000218
interface(8):description=$01:000219
interface(8):description_bytes=$01:00021A
interface(8):q2=$01:00021B
interface(8):lock_cell_q1=$01:00021C
interface(8):lock_cell_q2=$01:00021D
interface(8):iq_rxfragments=$01:00021E
interface(8):fragment_engine_descriptor=$01:00021F
interface(8):iq_buffer=$01:000220
interface(8):iq=$01:000221
interface(8):iq:head=$01:000221
interface(8):iq:tail=$01:000222
interface(8):oq=$01:000223
interface(8):oq:head=$01:000223
interface(8):oq:tail=$01:000224
interface(8):oq2=$01:000225
interface(8):oq2:head=$01:000225
interface(8):oq2:head:bx=$01:000225
interface(8):oq2:head:offset=$01:000226
interface(8):oq2:tail=$01:000227
interface(8):oq2:tail:bx=$01:000227
interface(8):oq2:tail:offset=$01:000228
interface(8):initial=$01:000229
interface(8):rxtx_interface=$01:00022A
interface(8):class=$01:00022B
interface(8):llhl=$01:00022C
interface(8):write_llh=$01:00022D
interface(8):arp_rx=$01:00022E
interface(8):arp_tx=$01:00022F
interface(8):arp_resolve=$01:000230
interface(8):xarp=$01:000231
interface(8):ift1=$01:000232
interface(8):ift1:rx_restart=$01:000232
interface(8):ift1:rx_limit=$01:000233
interface(8):ift1:tx_restart=$01:000234
interface(8):ift1:tx_limit=$01:000235
interface(8):ift1:base_rx=$01:000236
interface(8):ift1:rx_cursor=$01:000237
interface(8):ift1:base_tx=$01:000238
interface(8):ift1:tx_cursor=$01:000239
interface(8):sif=$01:000232
interface?=$00:000F6D
invoi=00001D,00000F
ioaccesswordB=:N129:P:0:000000
ip$sendx+=$00:00013E
ipAdEntAddr=$00:00076C
ipAdEntAddr:rw_typ_tokens_words=$00:00076C
ipAdEntAddr:o=$00:00076D
ipAdEntAddr:l=$00:00076E
ipAdEntAddr:data=$00:00076F
ipAdEntAddr:flags=$00:000770
ipAdEntAddr:bucket=$00:000771
ipAdEntAddr:ranges=$00:000771
ipAdEntAddr:range=$00:000772
ipAdEntAddr:advance=$00:000772
ipAdEntAddr:netstring=:N129:P:0:000000
ipAdEntIfIndex=$00:000772
ipAdEntIfIndex:rw_typ_tokens_words=$00:000772
ipAdEntIfIndex:o=$00:000773
ipAdEntIfIndex:l=$00:000774
ipAdEntIfIndex:data=$00:000775
ipAdEntIfIndex:flags=$00:000776
ipAdEntIfIndex:bucket=$00:000777
ipAdEntIfIndex:ranges=$00:000777
ipAdEntIfIndex:range=$00:000778
ipAdEntIfIndex:advance=$00:000778
ipAdEntIfIndex:netstring=:N129:P:0:000000
ipAdEntNetMask=$00:000778
ipAdEntNetMask:rw_typ_tokens_words=$00:000778
ipAdEntNetMask:o=$00:000779
ipAdEntNetMask:l=$00:00077A
ipAdEntNetMask:data=$00:00077B
ipAdEntNetMask:flags=$00:00077C
ipAdEntNetMask:bucket=$00:00077D
ipAdEntNetMask:ranges=$00:00077D
ipAdEntNetMask:range=$00:00077E
ipAdEntNetMask:advance=$00:00077E
ipAdEntNetMask:netstring=:N129:P:0:000000
ipDefaultTTL=$00:000700
ipDefaultTTL:rw_typ_tokens_words=$00:000700
ipDefaultTTL:o=$00:000701
ipDefaultTTL:l=$00:000702
ipDefaultTTL:data=$00:000703
ipDefaultTTL:flags=$00:000704
ipDefaultTTL:bucket=$00:000705
ipDefaultTTL:ranges=$00:000705
ipDefaultTTL:range=$00:000706
ipDefaultTTL:advance=$00:000706
ipDefaultTTL:netstring=:N129:P:0:000000
ipDefaultTTL:i=$01:0004FF
ipForwDatagrams=$00:000718
ipForwDatagrams:rw_typ_tokens_words=$00:000718
ipForwDatagrams:o=$00:000719
ipForwDatagrams:l=$00:00071A
ipForwDatagrams:data=$00:00071B
ipForwDatagrams:flags=$00:00071C
ipForwDatagrams:bucket=$00:00071D
ipForwDatagrams:ranges=$00:00071D
ipForwDatagrams:range=$00:00071E
ipForwDatagrams:advance=$00:00071E
ipForwDatagrams:netstring=:N129:P:0:000000
ipForwDatagrams:i=$01:000506
ipForwarding=$00:0006F8
ipForwarding:rw_typ_tokens_words=$00:0006F8
ipForwarding:o=$00:0006F9
ipForwarding:l=$00:0006FA
ipForwarding:data=$00:0006FB
ipForwarding:flags=$00:0006FC
ipForwarding:bucket=$00:0006FD
ipForwarding:ranges=$00:0006FD
ipForwarding:range=$00:0006FE
ipForwarding:advance=$00:000700
ipForwarding:netstring=:N129:P:0:000000
ipForwarding:i=$01:0004FE
ipFragCreates=$00:000766
ipFragCreates:rw_typ_tokens_words=$00:000766
ipFragCreates:o=$00:000767
ipFragCreates:l=$00:000768
ipFragCreates:data=$00:000769
ipFragCreates:flags=$00:00076A
ipFragCreates:bucket=$00:00076B
ipFragCreates:ranges=$00:00076B
ipFragCreates:range=$00:00076C
ipFragCreates:advance=$00:00076C
ipFragCreates:netstring=:N129:P:0:000000
ipFragCreates:i=$01:00051F
ipFragFails=$00:000760
ipFragFails:rw_typ_tokens_words=$00:000760
ipFragFails:o=$00:000761
ipFragFails:l=$00:000762
ipFragFails:data=$00:000763
ipFragFails:flags=$00:000764
ipFragFails:bucket=$00:000765
ipFragFails:ranges=$00:000765
ipFragFails:range=$00:000766
ipFragFails:advance=$00:000766
ipFragFails:netstring=:N129:P:0:000000
ipFragFails:i=$01:00051D
ipFragOKs=$00:00075A
ipFragOKs:rw_typ_tokens_words=$00:00075A
ipFragOKs:o=$00:00075B
ipFragOKs:l=$00:00075C
ipFragOKs:data=$00:00075D
ipFragOKs:flags=$00:00075E
ipFragOKs:bucket=$00:00075F
ipFragOKs:ranges=$00:00075F
ipFragOKs:range=$00:000760
ipFragOKs:advance=$00:000760
ipFragOKs:netstring=:N129:P:0:000000
ipFragOKs:i=$01:00051B
ipInAddrErrors=$00:000712
ipInAddrErrors:rw_typ_tokens_words=$00:000712
ipInAddrErrors:o=$00:000713
ipInAddrErrors:l=$00:000714
ipInAddrErrors:data=$00:000715
ipInAddrErrors:flags=$00:000716
ipInAddrErrors:bucket=$00:000717
ipInAddrErrors:ranges=$00:000717
ipInAddrErrors:range=$00:000718
ipInAddrErrors:advance=$00:000718
ipInAddrErrors:netstring=:N129:P:0:000000
ipInAddrErrors:i=$01:000504
ipInDelivers=$00:00072A
ipInDelivers:rw_typ_tokens_words=$00:00072A
ipInDelivers:o=$00:00072B
ipInDelivers:l=$00:00072C
ipInDelivers:data=$00:00072D
ipInDelivers:flags=$00:00072E
ipInDelivers:bucket=$00:00072F
ipInDelivers:ranges=$00:00072F
ipInDelivers:range=$00:000730
ipInDelivers:advance=$00:000730
ipInDelivers:netstring=:N129:P:0:000000
ipInDelivers:i=$01:00050C
ipInDiscards=$00:000724
ipInDiscards:rw_typ_tokens_words=$00:000724
ipInDiscards:o=$00:000725
ipInDiscards:l=$00:000726
ipInDiscards:data=$00:000727
ipInDiscards:flags=$00:000728
ipInDiscards:bucket=$00:000729
ipInDiscards:ranges=$00:000729
ipInDiscards:range=$00:00072A
ipInDiscards:advance=$00:00072A
ipInDiscards:netstring=:N129:P:0:000000
ipInDiscards:i=$01:00050A
ipInHdrErrors=$00:00070C
ipInHdrErrors:rw_typ_tokens_words=$00:00070C
ipInHdrErrors:o=$00:00070D
ipInHdrErrors:l=$00:00070E
ipInHdrErrors:data=$00:00070F
ipInHdrErrors:flags=$00:000710
ipInHdrErrors:bucket=$00:000711
ipInHdrErrors:ranges=$00:000711
ipInHdrErrors:range=$00:000712
ipInHdrErrors:advance=$00:000712
ipInHdrErrors:netstring=:N129:P:0:000000
ipInHdrErrors:i=$01:000502
ipInReceives=$00:000706
ipInReceives:rw_typ_tokens_words=$00:000706
ipInReceives:o=$00:000707
ipInReceives:l=$00:000708
ipInReceives:data=$00:000709
ipInReceives:flags=$00:00070A
ipInReceives:bucket=$00:00070B
ipInReceives:ranges=$00:00070B
ipInReceives:range=$00:00070C
ipInReceives:advance=$00:00070C
ipInReceives:netstring=:N129:P:0:000000
ipInReceives:i=$01:000500
ipInUnknownProtos=$00:00071E
ipInUnknownProtos:rw_typ_tokens_words=$00:00071E
ipInUnknownProtos:o=$00:00071F
ipInUnknownProtos:l=$00:000720
ipInUnknownProtos:data=$00:000721
ipInUnknownProtos:flags=$00:000722
ipInUnknownProtos:bucket=$00:000723
ipInUnknownProtos:ranges=$00:000723
ipInUnknownProtos:range=$00:000724
ipInUnknownProtos:advance=$00:000724
ipInUnknownProtos:netstring=:N129:P:0:000000
ipInUnknownProtos:i=$01:000508
ipNetToMediaIfIndex=$00:00079C
ipNetToMediaIfIndex:rw_typ_tokens_words=$00:00079C
ipNetToMediaIfIndex:o=$00:00079D
ipNetToMediaIfIndex:l=$00:00079E
ipNetToMediaIfIndex:data=$00:00079F
ipNetToMediaIfIndex:flags=$00:0007A0
ipNetToMediaIfIndex:bucket=$00:0007A1
ipNetToMediaIfIndex:ranges=$00:0007A1
ipNetToMediaIfIndex:range=$00:0007A2
ipNetToMediaIfIndex:advance=$00:0007A2
ipNetToMediaIfIndex:netstring=:N129:P:0:000000
ipNetToMediaPhysAddress=$00:0007A2
ipNetToMediaPhysAddress:rw_typ_tokens_words=$00:0007A2
ipNetToMediaPhysAddress:o=$00:0007A3
ipNetToMediaPhysAddress:l=$00:0007A4
ipNetToMediaPhysAddress:data=$00:0007A5
ipNetToMediaPhysAddress:flags=$00:0007A6
ipNetToMediaPhysAddress:bucket=$00:0007A7
ipNetToMediaPhysAddress:ranges=$00:0007A7
ipNetToMediaPhysAddress:range=$00:0007A8
ipNetToMediaPhysAddress:advance=$00:0007A8
ipNetToMediaPhysAddress:netstring=:N129:P:0:000000
ipOutDiscards=$00:000736
ipOutDiscards:rw_typ_tokens_words=$00:000736
ipOutDiscards:o=$00:000737
ipOutDiscards:l=$00:000738
ipOutDiscards:data=$00:000739
ipOutDiscards:flags=$00:00073A
ipOutDiscards:bucket=$00:00073B
ipOutDiscards:ranges=$00:00073B
ipOutDiscards:range=$00:00073C
ipOutDiscards:advance=$00:00073C
ipOutDiscards:netstring=:N129:P:0:000000
ipOutDiscards:i=$01:000510
ipOutNoRoutes=$00:00073C
ipOutNoRoutes:rw_typ_tokens_words=$00:00073C
ipOutNoRoutes:o=$00:00073D
ipOutNoRoutes:l=$00:00073E
ipOutNoRoutes:data=$00:00073F
ipOutNoRoutes:flags=$00:000740
ipOutNoRoutes:bucket=$00:000741
ipOutNoRoutes:ranges=$00:000741
ipOutNoRoutes:range=$00:000742
ipOutNoRoutes:advance=$00:000742
ipOutNoRoutes:netstring=:N129:P:0:000000
ipOutNoRoutes:i=$01:000512
ipOutRequests=$00:000730
ipOutRequests:rw_typ_tokens_words=$00:000730
ipOutRequests:o=$00:000731
ipOutRequests:l=$00:000732
ipOutRequests:data=$00:000733
ipOutRequests:flags=$00:000734
ipOutRequests:bucket=$00:000735
ipOutRequests:ranges=$00:000735
ipOutRequests:range=$00:000736
ipOutRequests:advance=$00:000736
ipOutRequests:netstring=:N129:P:0:000000
ipOutRequests:i=$01:00050E
ipReasmFails=$00:000754
ipReasmFails:rw_typ_tokens_words=$00:000754
ipReasmFails:o=$00:000755
ipReasmFails:l=$00:000756
ipReasmFails:data=$00:000757
ipReasmFails:flags=$00:000758
ipReasmFails:bucket=$00:000759
ipReasmFails:ranges=$00:000759
ipReasmFails:range=$00:00075A
ipReasmFails:advance=$00:00075A
ipReasmFails:netstring=:N129:P:0:000000
ipReasmFails:i=$01:000519
ipReasmOKs=$00:00074E
ipReasmOKs:rw_typ_tokens_words=$00:00074E
ipReasmOKs:o=$00:00074F
ipReasmOKs:l=$00:000750
ipReasmOKs:data=$00:000751
ipReasmOKs:flags=$00:000752
ipReasmOKs:bucket=$00:000753
ipReasmOKs:ranges=$00:000753
ipReasmOKs:range=$00:000754
ipReasmOKs:advance=$00:000754
ipReasmOKs:netstring=:N129:P:0:000000
ipReasmOKs:i=$01:000517
ipReasmReqds=$00:000748
ipReasmReqds:rw_typ_tokens_words=$00:000748
ipReasmReqds:o=$00:000749
ipReasmReqds:l=$00:00074A
ipReasmReqds:data=$00:00074B
ipReasmReqds:flags=$00:00074C
ipReasmReqds:bucket=$00:00074D
ipReasmReqds:ranges=$00:00074D
ipReasmReqds:range=$00:00074E
ipReasmReqds:advance=$00:00074E
ipReasmReqds:netstring=:N129:P:0:000000
ipReasmReqds:i=$01:000515
ipReasmTimeOut=$00:000742
ipReasmTimeOut:rw_typ_tokens_words=$00:000742
ipReasmTimeOut:o=$00:000743
ipReasmTimeOut:l=$00:000744
ipReasmTimeOut:data=$00:000745
ipReasmTimeOut:flags=$00:000746
ipReasmTimeOut:bucket=$00:000747
ipReasmTimeOut:ranges=$00:000747
ipReasmTimeOut:range=$00:000748
ipReasmTimeOut:advance=$00:000748
ipReasmTimeOut:netstring=:N129:P:0:000000
ipReasmTimeOut:i=$01:000514
ipRouteDest=$00:00077E
ipRouteDest:rw_typ_tokens_words=$00:00077E
ipRouteDest:o=$00:00077F
ipRouteDest:l=$00:000780
ipRouteDest:data=$00:000781
ipRouteDest:flags=$00:000782
ipRouteDest:bucket=$00:000783
ipRouteDest:ranges=$00:000783
ipRouteDest:range=$00:000784
ipRouteDest:advance=$00:000784
ipRouteDest:netstring=:N129:P:0:000000
ipRouteIfIndex=$00:000784
ipRouteIfIndex:rw_typ_tokens_words=$00:000784
ipRouteIfIndex:o=$00:000785
ipRouteIfIndex:l=$00:000786
ipRouteIfIndex:data=$00:000787
ipRouteIfIndex:flags=$00:000788
ipRouteIfIndex:bucket=$00:000789
ipRouteIfIndex:ranges=$00:000789
ipRouteIfIndex:range=$00:00078A
ipRouteIfIndex:advance=$00:00078A
ipRouteIfIndex:netstring=:N129:P:0:000000
ipRouteNetMask=$00:000796
ipRouteNetMask:rw_typ_tokens_words=$00:000796
ipRouteNetMask:o=$00:000797
ipRouteNetMask:l=$00:000798
ipRouteNetMask:data=$00:000799
ipRouteNetMask:flags=$00:00079A
ipRouteNetMask:bucket=$00:00079B
ipRouteNetMask:ranges=$00:00079B
ipRouteNetMask:range=$00:00079C
ipRouteNetMask:advance=$00:00079C
ipRouteNetMask:netstring=:N129:P:0:000000
ipRouteNextHop=$00:00078A
ipRouteNextHop:rw_typ_tokens_words=$00:00078A
ipRouteNextHop:o=$00:00078B
ipRouteNextHop:l=$00:00078C
ipRouteNextHop:data=$00:00078D
ipRouteNextHop:flags=$00:00078E
ipRouteNextHop:bucket=$00:00078F
ipRouteNextHop:ranges=$00:00078F
ipRouteNextHop:range=$00:000790
ipRouteNextHop:advance=$00:000790
ipRouteNextHop:netstring=:N129:P:0:000000
ipRouteType=$00:000790
ipRouteType:rw_typ_tokens_words=$00:000790
ipRouteType:o=$00:000791
ipRouteType:l=$00:000792
ipRouteType:data=$00:000793
ipRouteType:flags=$00:000794
ipRouteType:bucket=$00:000795
ipRouteType:ranges=$00:000795
ipRouteType:range=$00:000796
ipRouteType:advance=$00:000796
ipRouteType:netstring=:N129:P:0:000000
ipRoutingDiscards=$00:0007A8
ipRoutingDiscards:rw_typ_tokens_words=$00:0007A8
ipRoutingDiscards:o=$00:0007A9
ipRoutingDiscards:l=$00:0007AA
ipRoutingDiscards:data=$00:0007AB
ipRoutingDiscards:flags=$00:0007AC
ipRoutingDiscards:bucket=$00:0007AD
ipRoutingDiscards:ranges=$00:0007AD
ipRoutingDiscards:range=$00:0007AE
ipRoutingDiscards:advance=$00:0007AE
ipRoutingDiscards:netstring=:N129:P:0:000000
ipRoutingDiscards:i=$01:000521
ip_agent_address=$00:000266
ip_agent_address_broadcast=$00:000029
ip_agent_address_ifidx=$00:000267
ip_agent_address_maxreasm=$00:00002A
ip_agent_address_netmask=$00:000268
ip_agent_cidr_route_dest=$00:000271
ip_agent_cidr_route_dest_type=$00:000270
ip_agent_cidr_route_ifidx=$00:000275
ip_agent_cidr_route_mask_log=$00:000272
ip_agent_cidr_route_next_hop=$00:000274
ip_agent_cidr_route_next_hop_type=$00:000273
ip_agent_cidr_route_type=$00:000276
ip_agent_route_dest=$00:00026B
ip_agent_route_ifidx=$00:00026C
ip_agent_route_mask=$00:00026F
ip_agent_route_next_hop=$00:00026D
ip_agent_route_type=$00:00026E
ip_buy_datagram=$00:0001E4
ip_buy_datagram_alternate=$00:0001E5
ip_homed_route=$00:000153
ip_mib_i_f=$01:000479
ip_mib_oaddress=$01:00047C
ip_mib_oaddress:along=$01:00047C
ip_mib_oaddress:data=$01:00047D
ip_mib_oaddress:down=$01:00047D
ip_mib_oaddress:seq=$01:00047E
ip_mib_oaddress:type=$01:00047F
ip_mib_oaddress:bytes=$01:000480
ip_mib_oaddress:flags=$01:000481
ip_mib_oaddress:bucket=$01:000482
ip_mib_oaddress:ranges=$01:000482
ip_mib_oaddress:range=$01:000483
ip_mib_oifidx=$01:000483
ip_mib_oifidx:along=$01:000483
ip_mib_oifidx:data=$01:000484
ip_mib_oifidx:down=$01:000484
ip_mib_oifidx:seq=$01:000485
ip_mib_oifidx:type=$01:000486
ip_mib_oifidx:bytes=$01:000487
ip_mib_oifidx:flags=$01:000488
ip_mib_oifidx:bucket=$01:000489
ip_mib_oifidx:ranges=$01:000489
ip_mib_oifidx:range=$01:00048A
ip_mib_xnet=$01:00047A
ip_next_route=$00:000131
ip_no_txbuffer=$00:000203
ip_route=$00:000130
ip_route_advance=$00:00012E
ip_route_x=$00:00013A
ip_send=$00:00013B
ip_send_now=$00:00015F
ip_send_now1=$00:000160
ip_send_x=$00:000163
ip_source_ifidx=$00:000226
ip_source_next=$00:000228
ip_source_no=$00:000230
ip_source_yes=$00:00022F
ipacidrlist=000003,00000F
ipacidrseq=000002,00000F
ipagent_1more=$00:0003F1
ipagent_address=$00:0003AF
ipagent_address_ifidx=$00:0003BE
ipagent_address_netmask=$00:0003CB
ipagent_cidr_address_along=$00:000557
ipagent_cidr_route_dest=$00:00057B
ipagent_cidr_route_dest_notype=$00:00057A
ipagent_cidr_route_dest_type=$00:00056E
ipagent_cidr_route_ifidx=$00:0005B7
ipagent_cidr_route_mask_log=$00:00058A
ipagent_cidr_route_next_hop=$00:0005A5
ipagent_cidr_route_next_hop_type=$00:000597
ipagent_cidr_route_nodest=$00:000589
ipagent_cidr_route_noifidx=$00:0005C4
ipagent_cidr_route_nomask_log=$00:000596
ipagent_cidr_route_nonext_hop=$00:0005B6
ipagent_cidr_route_nonext_hop_type=$00:0005A4
ipagent_cidr_route_notype=$00:0005D3
ipagent_cidr_route_type=$00:0005C5
ipagent_cidr_search_exact=$00:00056A
ipagent_cidr_search_forward=$00:00056C
ipagent_cidr_tabler=$00:000549
ipagent_cidr_tabler_address!=$00:000565
ipagent_cidr_tabler_noaddress=$00:000565
ipagent_cidr_tabler_readdress=$00:000562
ipagent_cidr_write_oid_tokens=$00:000567
ipagent_exact=$00:0003EB
ipagent_find_ge=$00:000407
ipagent_noaddress=$00:0003BD
ipagent_noifidx=$00:0003CA
ipagent_nomask=$00:0003D9
ipagent_readoid2netform=$00:0003F3
ipagent_route_dest=$00:000408
ipagent_route_ifidx=$00:000417
ipagent_route_mask=$00:000425
ipagent_route_next_hop=$00:000434
ipagent_route_nodest=$00:000416
ipagent_route_noifidx=$00:000424
ipagent_route_nomask=$00:000433
ipagent_route_nonext_hop=$00:000442
ipagent_route_notype=$00:000451
ipagent_route_type=$00:000443
ipagent_search_exact=$00:0003E5
ipagent_search_forward=$00:0003EC
ipagent_search_id=$00:0003E6
ipagent_search_nextid=$00:0003ED
ipagent_seek=$00:0003FE
ipagent_seek_nane?=$00:000405
ipagent_seek_next=$00:000401
ipagent_tabler=$00:000391
ipagent_write2oid=$00:0003DC
ipagent_write_oid_tokens=$00:0003DA
ipcidr_tableidx=000006,00000F
ipcidro=000004,00000F
ipcidrroutine=000005,00000F
ipifidxflags=000004,00000F
ipifidxseq=000003,00000F
ipmaskflags=000004,00000F
ipmaskroutine=000005,00000F
ipmaskseq=000003,00000F
ipnetflags=000004,00000F
ipnetroutine=000005,00000F
ipnetseq=000003,00000F
ipq_add_options!=$00:0002B5
ipq_add_options?=$00:0002B7
ipq_construct_datagram_header=$00:0002A4
ipq_write=$00:000295
ipq_write2q=$00:00029E
ipq_write_channel_program=$00:0002BB
ipq_write_sum=$00:0002B8
iprohopflags=000004,00000F
iprohoproutine=000005,00000F
iprohopseq=000003,00000F
iproifidxflags=000004,00000F
iproifidxseq=000003,00000F
ipromaskflags=000004,00000F
ipromaskroutine=000005,00000F
ipromaskseq=000003,00000F
ipromib_i_f=$01:00048A
ipromib_oaddress=$01:00048D
ipromib_oaddress:along=$01:00048D
ipromib_oaddress:data=$01:00048E
ipromib_oaddress:down=$01:00048E
ipromib_oaddress:seq=$01:00048F
ipromib_oaddress:type=$01:000490
ipromib_oaddress:bytes=$01:000491
ipromib_oaddress:flags=$01:000492
ipromib_oaddress:bucket=$01:000493
ipromib_oaddress:ranges=$01:000493
ipromib_oaddress:range=$01:000494
ipromib_oifidx=$01:000494
ipromib_oifidx:along=$01:000494
ipromib_oifidx:data=$01:000495
ipromib_oifidx:down=$01:000495
ipromib_oifidx:seq=$01:000496
ipromib_oifidx:type=$01:000497
ipromib_oifidx:bytes=$01:000498
ipromib_oifidx:flags=$01:000499
ipromib_oifidx:bucket=$01:00049A
ipromib_oifidx:ranges=$01:00049A
ipromib_oifidx:range=$01:00049B
ipromib_xnet=$01:00048B
ipronetflags=000004,00000F
ipronetroutine=000005,00000F
ipronetseq=000003,00000F
iprotypflags=000004,00000F
iprotyproutine=000005,00000F
iprotypseq=000003,00000F
ipsend+=$00:00008B
iptabler_address!=$00:0003AD
iptabler_address_along=$00:00039F
iptabler_noaddress=$00:0003AD
iptabler_readdress=$00:0003AA
iptabroutine=000005,00000F
iptabseq=000002,00000F
ipv4=$00:00011E
ipv44us?=$00:000234
ipv4_4us?+=$00:0000A0
ipv4_address_hit=$00:000214
ipv4_address_test=$00:00020D
ipv4_address_this_host?=$00:000215
ipv4_address_this_if?=$00:00020B
ipv4_count_check=$00:0001CE
ipv4_drop=$00:0001DD
ipv4_forus!=$00:00020A
ipv4_forus?=$00:000204
ipv4_forward=$00:000221
ipv4_high=$00:000F72
ipv4_list_hit=$00:000220
ipv4_nex=$00:00021C
ipv4_next=$00:000210
ipv4_qcheckin(1)=$00:0001A6
ipv4_qcheckin(10)=$00:00019D
ipv4_qcheckin(11)=$00:00019C
ipv4_qcheckin(12)=$00:00019B
ipv4_qcheckin(13)=$00:00019A
ipv4_qcheckin(14)=$00:000199
ipv4_qcheckin(2)=$00:0001A5
ipv4_qcheckin(3)=$00:0001A4
ipv4_qcheckin(4)=$00:0001A3
ipv4_qcheckin(5)=$00:0001A2
ipv4_qcheckin(6)=$00:0001A1
ipv4_qcheckin(7)=$00:0001A0
ipv4_qcheckin(8)=$00:00019F
ipv4_qcheckin(9)=$00:00019E
ipv4_round_stack_word=$00:0001C2
ipv4_rx=$00:000165
ipv4_rxz+=$00:0001E1
ipv4_test_in_list=$00:000216
ipv4_this_host?+=$00:0000A2
ipv4_this_if?+=$00:0000A1
ipv4_uproto_rx=$00:0001D2
ipv4_uprotocol_checksum_addresses=$00:0001CE
ipv4_xforward=$00:000224
ipv4_yesforus=$00:0001B7
ipv4_zforward=$00:000225
ipv4thishost?=$00:00023A
ipv4thisif?=$00:000237
irespite=$00:0006FF
iscan=[0025]000000
iscan48=[0026]000000
iscan48a
iscan72=[0027]000000
iscan72a
iscan_skip=[0024]000000
iscan_skipa
iscana
iserve=$00:0004DC
iserve:integer_serve=$00:0004DC
iserve:iserver_zstart=$00:0004E1
iserve:socketi=$01:00041D
iserve:i_bound=$01:00041E
iserve:portcb_lva=$01:00041F
iserve:portcb=$01:000420
iserve:descriptor=$46:000000,00000E
iserve:descriptor:next=$46:000000,00000E
iserve:descriptor:frame=$46:000001,00000E
iserve:descriptor:i_f=$46:000002,00000E
iserve:descriptor:bytes=$46:000003,00000E
iserve:descriptor:dgram=$46:000004,00000E
iserve:descriptor:uproto=$46:000005,00000E
iserve:descriptor:sobdi=$46:000006,00000E
iserve:descriptor:apdata=$46:000006,00000E
iserve:descriptor:tcbloc=$46:000007,00000E
iserve:descriptor:ifql=$46:000007,00000E
iserve:descriptor:lso=$46:000007,00000E
iserve:descriptor:total_bytes=$46:000007,00000E
iserve:descriptor:readpoint=$46:000007,00000E
iserve:descriptor:next_bdi=$46:000007,00000E
iserve:so=$42:000000,000002
iserve:so:socket_address=$42:000000,000002
iserve:so:remote_address=$42:000002,000002
iserve:so:flags=$42:000004,000002
iserve:so:udp=$42:000005,000002
iserve:so:udp:tsq=$42:000005,000002
iserve:so:udp:socket_inq=$42:000006,000002
iserve:so:udp:socket_inq:head=$42:000006,000002
iserve:so:udp:socket_inq:tail=$42:000007,000002
iserve:so:tcp=$42:000005,000002
iserve:so:tcp:tbase=$42:000005,000002
iserve:so:tcp:tcbs=$42:000006,000002
iserve:so:tcp:rxbu_p=$42:000006,000002
iserve:so:tcp:rxowner=$42:000007,000002
iserve:so:tcp:txbu_p=$42:000007,000002
iserve:i_server1=$00:0004E2
iserve:response_axw=000010,00000F
iserve:operator=00000F,00000F
iserve:left=00000B,00000F
iserve:right=000007,00000F
iserve:xtra=000003,00000F
iserve:signs1=000002,00000F
iserve:signs=000000,00000F
iserve:i_rx1=$00:0004FB
iserve:i_again=$00:000514
iserve:i_add=$00:000522
iserve:i_add_again=$00:000522
iserve:i_add_negative=$00:00052C
iserve:i_add_negative_again=$00:00052C
iserve:i_multiply=$00:000537
iserve:i_multiply_again=$00:000537
iserve:i_divide=$00:00053F
iserve:i_divide_again=$00:00053F
iserve:i_div_dont=$00:000546
iserve:i_nop=$00:000548
iserve:i_edit=$00:000548
iserve:i_ecomplete=$00:000559
iserve:i_release=$00:000562
iserve:i_no_traffic=$00:000566
iserve:i_error=$00:000569
itable_ii=$00:000616
itable_write=$00:00061E
ityp=00001C,00000F
jumboq2
kernel_b1_ii=$00:0005EA
kernel_b1_ii_1=$00:0005E2
large_bank=$00:000204
large_bank_at_summit=$00:0001A2
large_bank_descriptor_sp=$41:003006
large_bank_free=$00:00018C
large_system=$00:000103
lexical_list=000003,00000F
llheader=:N129:P:0:000000
load_image=$00:000139
load_oid?=$00:0001F2
locate_interfaces
lookfor_app=$42:000000,000002
lookfor_app:fs_type=$42:000000,000002
lookfor_app:device=$42:000001,000002
lookfor_app:bank=$42:000001,000002
lookfor_app:extent=$42:000002,000002
lookfor_app:absolute_pointer=$42:000004,000002
lvp=:P1:0:000043
m48_24
m48_48
mabanks=$00:0000B7
major_minor=:N129:P:0:000000
management_pages_based=$00:0000F9
management_words=$00:0000AB
masked_test_jump=:N131:P:0:000000
maxmabanks=$00:0000BD
measure=$00:0000E4
memory_configured=$00:000114
mib+=$03:0004CD
mib2tick=$00:000245
mib2tick_deliver=$00:000245
mib2ticko=$01:00042D
mib2ticko:along=$01:00042D
mib2ticko:data=$01:00042E
mib2ticko:down=$01:00042E
mib2ticko:seq=$01:00042F
mib2ticko:type=$01:000430
mib2ticko:bytes=$01:000431
mib2ticko:flags=$01:000432
mib2ticko:bucket=$01:000433
mib2ticko:ranges=$01:000433
mib2ticko:range=$01:000434
mib2ticks+=$00:000245
mib_check_double_good=$00:000243
mib_check_good=$00:000244
mib_checksigned_l=$00:000238
mib_checksigned_l!=$00:00023A
mib_checksigned_l?=$00:000241
mib_checksigned_lnext=$00:000240
mib_checksigned_s=$00:000223
mib_checksigned_s!=$00:000224
mib_checksigned_s?=$00:00022B
mib_checksigned_snext=$00:00022A
mib_checkunsigned_l=$00:00022D
mib_checkunsigned_l!=$00:00022F
mib_checkunsigned_l?=$00:000236
mib_checkunsigned_lnext=$00:000235
mib_checkunsigned_s=$00:000219
mib_checkunsigned_s!=$00:00021A
mib_checkunsigned_s?=$00:000221
mib_checkunsigned_snext=$00:000220
mib_checkwlen=$00:0001BC
mib_decode=$00:00020B
mib_decode_simple=$00:000216
mib_decoded=$00:000215
mib_downpathw=$00:000100
mib_firstinroww=$00:000127
mib_floor=$01:000425
mib_get+=$00:000240
mib_getnext+=$00:000241
mib_initial=$00:0001D6
mib_initial_next=$00:0001D7
mib_initial_x=$00:0001DE
mib_line+=$00:000244
mib_long_signed=$00:0001A3
mib_modify=$00:00016B
mib_nowrite=$00:0001CF
mib_read=$00:000040
mib_right_awayw=$00:000116
mib_right_onw=$00:000113
mib_rightwardw=$00:000104
mib_root=$01:000426
mib_root:along=$01:000426
mib_root:data=$01:000427
mib_root:down=$01:000427
mib_root:seq=$01:000428
mib_root:type=$01:000429
mib_root:bytes=$01:00042A
mib_root:flags=$01:00042B
mib_root:bucket=$01:00042C
mib_root:ranges=$01:00042C
mib_root:range=$01:00042D
mib_rr!=$00:000048
mib_rr?=$00:000059
mib_rr_badvalue=$00:000063
mib_rr_function=$00:000069
mib_rr_nosuchname=$00:000066
mib_rr_seq?=$00:000050
mib_rr_token_pass=$00:000058
mib_rr_x=$00:000071
mib_set+=$00:000242
mib_setinroww=$00:00012B
mib_single_signed=$00:0001B1
mib_space=$00:000211
mib_start+=$00:000243
mib_store=$00:0001D1
mib_store1=$00:0001A8
mib_store_l=$00:0001B9
mib_store_long_range!=$00:000154
mib_store_long_range?=$00:000158
mib_store_new=$00:000168
mib_store_new_x=$00:000160
mib_store_new_x1=$00:000166
mib_store_range!=$00:00015A
mib_store_range?=$00:00015E
mib_store_s=$00:0001B6
mib_storeb=$00:0001D2
mib_uneta=$01:000444
mib_uneto=$01:000436
mib_uneto:along=$01:000436
mib_uneto:data=$01:000437
mib_uneto:down=$01:000437
mib_uneto:seq=$01:000438
mib_uneto:type=$01:000439
mib_uneto:bytes=$01:00043A
mib_uneto:flags=$01:00043B
mib_uneto:bucket=$01:00043C
mib_uneto:ranges=$01:00043C
mib_uneto:range=$01:00043D
mib_unpack=$00:000204
mib_uporto=$01:00043D
mib_uporto:along=$01:00043D
mib_uporto:data=$01:00043E
mib_uporto:down=$01:00043E
mib_uporto:seq=$01:00043F
mib_uporto:type=$01:000440
mib_uporto:bytes=$01:000441
mib_uporto:flags=$01:000442
mib_uporto:bucket=$01:000443
mib_uporto:ranges=$01:000443
mib_uporto:range=$01:000444
mib_walk=$00:000072
mib_warray!=$00:0001C2
mib_warray?=$00:0001C6
mib_wbadvalue=$00:0001CC
mib_wgenerr=$00:0001CA
mib_wline=$00:0001DF
mib_wlocate!=$00:0000EF
mib_wlocate?=$00:00012B
mib_wnumber=$00:00018D
mib_wreadonly=$00:0001CE
mib_write=$00:0000E3
mib_writex=$00:0001D3
mib_wtoobig=$00:0001C8
mib_ww!=$00:00007F
mib_ww?=$00:0000A3
mib_ww_along!=$00:0000C7
mib_ww_along?=$00:0000BE
mib_ww_badvalue=$00:0000CC
mib_ww_down=$00:000089
mib_ww_function=$00:0000B5
mib_ww_nosuchname=$00:0000C9
mib_ww_peer=$00:00009D
mib_ww_ruano?=$00:0000A6
mib_ww_seek_peer=$00:000092
mib_ww_slingback!=$00:0000D7
mib_ww_slingback?=$00:0000DD
mib_ww_slungback=$00:0000DB
mib_ww_up=$00:0000C0
mib_ww_x=$00:0000E0
mib_www=$00:0000CF
mibw_first=000001,00000F
mibw_floorb4=000003,00000F
mibw_parent=000002,00000F
mibw_prior=000000,00000F
minimald
mo=$42:000000,000002
mo:along=$42:000000,000002
mo:data=$42:000001,000002
mo:down=$42:000001,000002
mo:seq=$42:000002,000002
mo:type=$42:000003,000002
mo:bytes=$42:000004,000002
mo:flags=$42:000005,000002
mo:bucket=$42:000006,000002
mo:ranges=$42:000006,000002
mo:range=$42:000007,000002
mobjet=:N129:P:0:000000
mpool=:P1:0:000045
mvo=:N129:P:(0)0:000000
mvoi=:N129:P:0:000000
named_vector=$00:0005DA
net2ifidx_deliver=$00:0005DE
net2ifidx_x=$00:0005E6
net2ifindex_walk=$00:0005DB
net2physa_deliver=$00:0005F8
net2physa_tree=$00:0005F5
net2physa_walk=$00:0005EF
net2physa_x=$00:000602
net2sym_ii=$00:00063B
net_addres2net_address=$00:000604
net_address(1)=$01:000330
net_address(1):next=$01:000330
net_address(1):lexical=$01:000331
net_address(1):i_f=$01:000332
net_address(1):net=$01:000333
net_address(1):mask=$01:000335
net_address(1):broadcast=$01:000337
net_address(10)=$01:000381
net_address(10):next=$01:000381
net_address(10):lexical=$01:000382
net_address(10):i_f=$01:000383
net_address(10):net=$01:000384
net_address(10):mask=$01:000386
net_address(10):broadcast=$01:000388
net_address(11)=$01:00038A
net_address(11):next=$01:00038A
net_address(11):lexical=$01:00038B
net_address(11):i_f=$01:00038C
net_address(11):net=$01:00038D
net_address(11):mask=$01:00038F
net_address(11):broadcast=$01:000391
net_address(12)=$01:000393
net_address(12):next=$01:000393
net_address(12):lexical=$01:000394
net_address(12):i_f=$01:000395
net_address(12):net=$01:000396
net_address(12):mask=$01:000398
net_address(12):broadcast=$01:00039A
net_address(13)=$01:00039C
net_address(13):next=$01:00039C
net_address(13):lexical=$01:00039D
net_address(13):i_f=$01:00039E
net_address(13):net=$01:00039F
net_address(13):mask=$01:0003A1
net_address(13):broadcast=$01:0003A3
net_address(14)=$01:0003A5
net_address(14):next=$01:0003A5
net_address(14):lexical=$01:0003A6
net_address(14):i_f=$01:0003A7
net_address(14):net=$01:0003A8
net_address(14):mask=$01:0003AA
net_address(14):broadcast=$01:0003AC
net_address(15)=$01:0003AE
net_address(15):next=$01:0003AE
net_address(15):lexical=$01:0003AF
net_address(15):i_f=$01:0003B0
net_address(15):net=$01:0003B1
net_address(15):mask=$01:0003B3
net_address(15):broadcast=$01:0003B5
net_address(16)=$01:0003B7
net_address(16):next=$01:0003B7
net_address(16):lexical=$01:0003B8
net_address(16):i_f=$01:0003B9
net_address(16):net=$01:0003BA
net_address(16):mask=$01:0003BC
net_address(16):broadcast=$01:0003BE
net_address(17)=$01:0003C0
net_address(17):next=$01:0003C0
net_address(17):lexical=$01:0003C1
net_address(17):i_f=$01:0003C2
net_address(17):net=$01:0003C3
net_address(17):mask=$01:0003C5
net_address(17):broadcast=$01:0003C7
net_address(18)=$01:0003C9
net_address(18):next=$01:0003C9
net_address(18):lexical=$01:0003CA
net_address(18):i_f=$01:0003CB
net_address(18):net=$01:0003CC
net_address(18):mask=$01:0003CE
net_address(18):broadcast=$01:0003D0
net_address(19)=$01:0003D2
net_address(19):next=$01:0003D2
net_address(19):lexical=$01:0003D3
net_address(19):i_f=$01:0003D4
net_address(19):net=$01:0003D5
net_address(19):mask=$01:0003D7
net_address(19):broadcast=$01:0003D9
net_address(2)=$01:000339
net_address(2):next=$01:000339
net_address(2):lexical=$01:00033A
net_address(2):i_f=$01:00033B
net_address(2):net=$01:00033C
net_address(2):mask=$01:00033E
net_address(2):broadcast=$01:000340
net_address(20)=$01:0003DB
net_address(20):next=$01:0003DB
net_address(20):lexical=$01:0003DC
net_address(20):i_f=$01:0003DD
net_address(20):net=$01:0003DE
net_address(20):mask=$01:0003E0
net_address(20):broadcast=$01:0003E2
net_address(21)=$01:0003E4
net_address(21):next=$01:0003E4
net_address(21):lexical=$01:0003E5
net_address(21):i_f=$01:0003E6
net_address(21):net=$01:0003E7
net_address(21):mask=$01:0003E9
net_address(21):broadcast=$01:0003EB
net_address(22)=$01:0003ED
net_address(22):next=$01:0003ED
net_address(22):lexical=$01:0003EE
net_address(22):i_f=$01:0003EF
net_address(22):net=$01:0003F0
net_address(22):mask=$01:0003F2
net_address(22):broadcast=$01:0003F4
net_address(23)=$01:0003F6
net_address(23):next=$01:0003F6
net_address(23):lexical=$01:0003F7
net_address(23):i_f=$01:0003F8
net_address(23):net=$01:0003F9
net_address(23):mask=$01:0003FB
net_address(23):broadcast=$01:0003FD
net_address(24)=$01:0003FF
net_address(24):next=$01:0003FF
net_address(24):lexical=$01:000400
net_address(24):i_f=$01:000401
net_address(24):net=$01:000402
net_address(24):mask=$01:000404
net_address(24):broadcast=$01:000406
net_address(3)=$01:000342
net_address(3):next=$01:000342
net_address(3):lexical=$01:000343
net_address(3):i_f=$01:000344
net_address(3):net=$01:000345
net_address(3):mask=$01:000347
net_address(3):broadcast=$01:000349
net_address(4)=$01:00034B
net_address(4):next=$01:00034B
net_address(4):lexical=$01:00034C
net_address(4):i_f=$01:00034D
net_address(4):net=$01:00034E
net_address(4):mask=$01:000350
net_address(4):broadcast=$01:000352
net_address(5)=$01:000354
net_address(5):next=$01:000354
net_address(5):lexical=$01:000355
net_address(5):i_f=$01:000356
net_address(5):net=$01:000357
net_address(5):mask=$01:000359
net_address(5):broadcast=$01:00035B
net_address(6)=$01:00035D
net_address(6):next=$01:00035D
net_address(6):lexical=$01:00035E
net_address(6):i_f=$01:00035F
net_address(6):net=$01:000360
net_address(6):mask=$01:000362
net_address(6):broadcast=$01:000364
net_address(7)=$01:000366
net_address(7):next=$01:000366
net_address(7):lexical=$01:000367
net_address(7):i_f=$01:000368
net_address(7):net=$01:000369
net_address(7):mask=$01:00036B
net_address(7):broadcast=$01:00036D
net_address(8)=$01:00036F
net_address(8):next=$01:00036F
net_address(8):lexical=$01:000370
net_address(8):i_f=$01:000371
net_address(8):net=$01:000372
net_address(8):mask=$01:000374
net_address(8):broadcast=$01:000376
net_address(9)=$01:000378
net_address(9):next=$01:000378
net_address(9):lexical=$01:000379
net_address(9):i_f=$01:00037A
net_address(9):net=$01:00037B
net_address(9):mask=$01:00037D
net_address(9):broadcast=$01:00037F
net_address2ifidx=$00:0005D4
net_address2physa=$00:0005E8
net_afree+=$01:00032F
net_alexical+=$01:00032E
net_alock+=$01:00032D
net_buffer_acquired=$00:00011D
net_buffer_bank=$00:0000FA
net_buffer_banks=$00:0000ED
net_buffer_base_banks=$00:0000F8
net_buffer_base_pages=$00:0000E4
net_buffer_page=$00:0000E6
net_buffer_pages=$00:0000DC
net_buffer_request=$00:000115
net_buffer_requestB=$00:000112
net_buffer_requestP=$00:000114
net_buffer_request_pages=$00:0000E1
net_buffers=$00:0000CD
net_free=$00:0000C9
net_free_txb=$00:0000CB
net_request_allowable=$00:0000D7
netframe=:N129:P:0:000000
netpool_initial=$00:000100
netv4=:N129:P:0:000000
network=$00:000061
network_socket=$00:00006B
networkframe=$43:000000,000003
networkframe:flag=$43:000000,000003
networkframe:frame_length=$43:000001,000003
networkframe:ll_hl=$43:000002,000003
networkframe:interface=$43:000003,000003
networkframe:protocol=$43:000004,000003
networkframe:frame=$43:000005,000003
networks=$00:000080
networks_start=$00:000040
new_dayclock=$41:003000
new_handle=$00:000546
new_large_bank=$00:000216
new_tdescriptor=$00:00047F
next=$41:003005
next_page_descriptor=$41:0030F0
next_stem=$00:0000C4
next_tdescriptor_sp=$41:003049
nextpx=000002,00000F
nframe=$42:000000,000002
nframe:llh=$42:000000,000002
nframe:llh:loopback=$42:000000,000002
nframe:llh:loopback:af=$42:000000,000002
nframe:llh:ethernet=$42:000000,000002
nframe:llh:ethernet:to=$42:000000,000002
nframe:llh:ethernet:from=$42:000003,000002
nframe:llh:ethernet:protocol=$42:000006,000002
nframe:llh:generic=$42:000000,000002
nframe:llh:generic:address=$42:000000,000002
nframe:llh:generic:protocol=$42:000006,000002
nframe:frame_axw(1)=$42:000007,000002
nframe:frame_axw(1):bytes=$42:000007,000002
nframe:frame_axw(1):word_pointer=$42:000008,000002
nframe:frame_axw(2)=$42:000009,000002
nframe:frame_axw(2):bytes=$42:000009,000002
nframe:frame_axw(2):word_pointer=$42:00000A,000002
nframe:frame_axw(3)=$42:00000B,000002
nframe:frame_axw(3):bytes=$42:00000B,000002
nframe:frame_axw(3):word_pointer=$42:00000C,000002
nframe:stack_index=$42:00000D,000002
nframe:next_hop=$42:00000E,000002
no_handle=$00:000554
no_new_task=$00:000470
no_new_task_descriptor=$00:00046E
no_new_thread=$00:0004F3
no_new_thread_descriptor=$00:0004F1
no_path2remote=$00:000DFF
no_xflag=$00:000320
noblock_udp=$00:000BAD
normal_s=$00:0003EF
normal_s:to=000003,00000F
normal_s:from=000004,00000F
normal_s:chars=000005,00000F
normal_s:offset=000006,00000F
normal_s:clear_end=$00:0003F8
normal_s:align1=$00:0003F9
normal_string+=$00:00014C
not_a_handle=$00:00056A
not_highest_bank=$00:00017E
not_on_list=$00:0001E2
nothing_banked=$00:000056
nothing_gained=$00:00004D
nuflags=000004,00000F
nuroutine=000005,00000F
nuseq=000003,00000F
obytes=00000A,00000F
oclass=000009,00000F
octopop=:N129:P:0:000000
octopush=:N129:P:0:000000
odata=00000B,00000F
odynamic=000004,00000F
oflags=000008,00000F
oid=:N129:P:0:000000
oid_loaded=$00:0001F5
olist=000007,00000F
om=$43:000000,000003
om:words=$43:000000,000003
om:o=$43:000001,000003
om:l=$43:000002,000003
om:data=$43:000003,000003
om:flags=$43:000004,000003
om:bucket=$43:000005,000003
om:ranges=$43:000005,000003
om:range=$43:000006,000003
one_time_save_ii=$00:0006ED
online_norun=$00:000335
online_run=$00:000336
online_search_app=$00:000317
online_xqt+=$00:000149
ooid=:N129:P:0:000000
orange=00000D,00000F
orules=00000C,00000F
otext=[0028]000000
out_of_range=$00:0001BA
pages_read=$00:000100
part(1)=000006
part(2)=000000
part(3)=$46:0000A0
ping=$42:000000,000002
ping:h=$42:000000,000002
ping:h:type_code=$42:000000,000002
ping:h:checksum=$42:000001,000002
ping:id=$42:000002,000002
ping:sequence=$42:000003,000002
ping:data=$42:000004,000002
platform_relay=000064
platform_relay2=000065
pool=$42:000000,000002
pool:lock_cell=$42:000000,000002
pool:next=$42:000001,000002
pool:free(1)=$42:000002,000002
pool:free(2)=$42:000003,000002
pool:free(3)=$42:000004,000002
pool:free(4)=$42:000005,000002
pool:free(5)=$42:000006,000002
pool:free(6)=$42:000007,000002
pool:free(7)=$42:000008,000002
pool:free(8)=$42:000009,000002
pool:free(9)=$42:00000A,000002
pool:free(10)=$42:00000B,000002
pool:free(11)=$42:00000C,000002
pool:free(12)=$42:00000D,000002
pool:free(13)=$42:00000E,000002
pool:free(14)=$42:00000F,000002
pool:free(15)=$42:000010,000002
pool:free(16)=$42:000011,000002
pool:free(17)=$42:000012,000002
pool:free(18)=$42:000013,000002
pool:free(19)=$42:000014,000002
pool:free(20)=$42:000015,000002
pool:free(21)=$42:000016,000002
pool:free(22)=$42:000017,000002
pool:free(23)=$42:000018,000002
pool:free(24)=$42:000019,000002
pool:free(25)=$42:00001A,000002
pool:free(26)=$42:00001B,000002
pool:free(27)=$42:00001C,000002
pool:free(28)=$42:00001D,000002
pool:free(29)=$42:00001E,000002
pool:free(30)=$42:00001F,000002
pool:free(31)=$42:000020,000002
pool:free(32)=$42:000021,000002
pool:free(33)=$42:000022,000002
pool:free(34)=$42:000023,000002
pool:free(35)=$42:000024,000002
pool:free(36)=$42:000025,000002
pool:free(37)=$42:000026,000002
pool:free(38)=$42:000027,000002
pool:free(39)=$42:000028,000002
pool:free(40)=$42:000029,000002
pool:free(41)=$42:00002A,000002
pool:free(42)=$42:00002B,000002
pool:free(43)=$42:00002C,000002
pool:free(44)=$42:00002D,000002
pool:free(45)=$42:00002E,000002
pool:free(46)=$42:00002F,000002
pool:free(47)=$42:000030,000002
pool:free(48)=$42:000031,000002
pool:free(49)=$42:000032,000002
pool:free(50)=$42:000033,000002
pool:free(51)=$42:000034,000002
pool:free(52)=$42:000035,000002
pool:free(53)=$42:000036,000002
pool:free(54)=$42:000037,000002
pool:free(55)=$42:000038,000002
pool:free(56)=$42:000039,000002
pool:free(57)=$42:00003A,000002
pool:free(58)=$42:00003B,000002
pool:free(59)=$42:00003C,000002
pool:free(60)=$42:00003D,000002
pool:free(61)=$42:00003E,000002
pool:free(62)=$42:00003F,000002
pool:free(63)=$42:000040,000002
pool:free(64)=$42:000041,000002
pool:free(65)=$42:000042,000002
pool:free(66)=$42:000043,000002
pool:free(67)=$42:000044,000002
pool:free(68)=$42:000045,000002
pool:free(69)=$42:000046,000002
pool:free(70)=$42:000047,000002
pool:free(71)=$42:000048,000002
pool:free(72)=$42:000049,000002
pool:free(73)=$42:00004A,000002
pool:free(74)=$42:00004B,000002
pool:free(75)=$42:00004C,000002
pool:free(76)=$42:00004D,000002
pool:free(77)=$42:00004E,000002
pool:free(78)=$42:00004F,000002
pool:free(79)=$42:000050,000002
pool:free(80)=$42:000051,000002
pool:free(81)=$42:000052,000002
pool:free(82)=$42:000053,000002
pool:free(83)=$42:000054,000002
pool:free(84)=$42:000055,000002
pool:free(85)=$42:000056,000002
pool:free(86)=$42:000057,000002
pool:free(87)=$42:000058,000002
pool:free(88)=$42:000059,000002
pool:free(89)=$42:00005A,000002
pool:free(90)=$42:00005B,000002
pool:free(91)=$42:00005C,000002
pool:free(92)=$42:00005D,000002
pool:free(93)=$42:00005E,000002
pool:free(94)=$42:00005F,000002
pool:free(95)=$42:000060,000002
pool:free(96)=$42:000061,000002
pool:free(97)=$42:000062,000002
pool:free(98)=$42:000063,000002
pool:free(99)=$42:000064,000002
pool:free(100)=$42:000065,000002
pool:free(101)=$42:000066,000002
pool:free(102)=$42:000067,000002
pool:free(103)=$42:000068,000002
pool:free(104)=$42:000069,000002
pool:free(105)=$42:00006A,000002
pool:free(106)=$42:00006B,000002
pool:free(107)=$42:00006C,000002
pool:free(108)=$42:00006D,000002
pool:free(109)=$42:00006E,000002
pool:free(110)=$42:00006F,000002
pool:free(111)=$42:000070,000002
pool:free(112)=$42:000071,000002
pool:free(113)=$42:000072,000002
pool:free(114)=$42:000073,000002
pool:free(115)=$42:000074,000002
pool:free(116)=$42:000075,000002
pool:free(117)=$42:000076,000002
pool:free(118)=$42:000077,000002
pool:free(119)=$42:000078,000002
pool:free(120)=$42:000079,000002
pool:free(121)=$42:00007A,000002
pool:free(122)=$42:00007B,000002
pool:free(123)=$42:00007C,000002
pool:free(124)=$42:00007D,000002
pool:free(125)=$42:00007E,000002
pool:free(126)=$42:00007F,000002
pool:free(127)=$42:000080,000002
pool:free(128)=$42:000081,000002
pool:free(129)=$42:000082,000002
pool:free(130)=$42:000083,000002
pool:free(131)=$42:000084,000002
pool:free(132)=$42:000085,000002
pool:free(133)=$42:000086,000002
pool:free(134)=$42:000087,000002
pool:free(135)=$42:000088,000002
pool:free(136)=$42:000089,000002
pool:free(137)=$42:00008A,000002
pool:free(138)=$42:00008B,000002
pool:free(139)=$42:00008C,000002
pool:free(140)=$42:00008D,000002
pool:free(141)=$42:00008E,000002
pool:free(142)=$42:00008F,000002
pool:free(143)=$42:000090,000002
pool:free(144)=$42:000091,000002
pool:free(145)=$42:000092,000002
pool:free(146)=$42:000093,000002
pool:free(147)=$42:000094,000002
pool:free(148)=$42:000095,000002
pool:free(149)=$42:000096,000002
pool:free(150)=$42:000097,000002
pool:free(151)=$42:000098,000002
pool:free(152)=$42:000099,000002
pool:free(153)=$42:00009A,000002
pool:free(154)=$42:00009B,000002
pool:free(155)=$42:00009C,000002
pool:free(156)=$42:00009D,000002
pool:free(157)=$42:00009E,000002
pool:free(158)=$42:00009F,000002
pool:free(159)=$42:0000A0,000002
pool:free(160)=$42:0000A1,000002
pool:free(161)=$42:0000A2,000002
pool:free(162)=$42:0000A3,000002
pool:free(163)=$42:0000A4,000002
pool:free(164)=$42:0000A5,000002
pool:free(165)=$42:0000A6,000002
pool:free(166)=$42:0000A7,000002
pool:free(167)=$42:0000A8,000002
pool:free(168)=$42:0000A9,000002
pool:free(169)=$42:0000AA,000002
pool:free(170)=$42:0000AB,000002
pool:free(171)=$42:0000AC,000002
pool:free(172)=$42:0000AD,000002
pool:free(173)=$42:0000AE,000002
pool:free(174)=$42:0000AF,000002
pool:free(175)=$42:0000B0,000002
pool:free(176)=$42:0000B1,000002
pool:free(177)=$42:0000B2,000002
pool:free(178)=$42:0000B3,000002
pool:free(179)=$42:0000B4,000002
pool:free(180)=$42:0000B5,000002
pool:free(181)=$42:0000B6,000002
pool:free(182)=$42:0000B7,000002
pool:free(183)=$42:0000B8,000002
pool:free(184)=$42:0000B9,000002
pool:free(185)=$42:0000BA,000002
pool:free(186)=$42:0000BB,000002
pool:free(187)=$42:0000BC,000002
pool:free(188)=$42:0000BD,000002
pool:free(189)=$42:0000BE,000002
pool:free(190)=$42:0000BF,000002
pool:free(191)=$42:0000C0,000002
pool:free(192)=$42:0000C1,000002
pool:free(193)=$42:0000C2,000002
pool:free(194)=$42:0000C3,000002
pool:free(195)=$42:0000C4,000002
pool:free(196)=$42:0000C5,000002
pool:free(197)=$42:0000C6,000002
pool:free(198)=$42:0000C7,000002
pool:free(199)=$42:0000C8,000002
pool:free(200)=$42:0000C9,000002
pool:free(201)=$42:0000CA,000002
pool:free(202)=$42:0000CB,000002
pool:free(203)=$42:0000CC,000002
pool:free(204)=$42:0000CD,000002
pool:free(205)=$42:0000CE,000002
pool:free(206)=$42:0000CF,000002
pool:free(207)=$42:0000D0,000002
pool:free(208)=$42:0000D1,000002
pool:free(209)=$42:0000D2,000002
pool:free(210)=$42:0000D3,000002
pool:free(211)=$42:0000D4,000002
pool:free(212)=$42:0000D5,000002
pool:free(213)=$42:0000D6,000002
pool:free(214)=$42:0000D7,000002
pool:free(215)=$42:0000D8,000002
pool:free(216)=$42:0000D9,000002
pool:free(217)=$42:0000DA,000002
pool:free(218)=$42:0000DB,000002
pool:free(219)=$42:0000DC,000002
pool:free(220)=$42:0000DD,000002
pool:free(221)=$42:0000DE,000002
pool:free(222)=$42:0000DF,000002
pool:free(223)=$42:0000E0,000002
pool:free(224)=$42:0000E1,000002
pool:free(225)=$42:0000E2,000002
pool:free(226)=$42:0000E3,000002
pool:free(227)=$42:0000E4,000002
pool:free(228)=$42:0000E5,000002
pool:free(229)=$42:0000E6,000002
pool:free(230)=$42:0000E7,000002
pool:free(231)=$42:0000E8,000002
pool:free(232)=$42:0000E9,000002
pool:free(233)=$42:0000EA,000002
pool:free(234)=$42:0000EB,000002
pool:free(235)=$42:0000EC,000002
pool:free(236)=$42:0000ED,000002
pool:free(237)=$42:0000EE,000002
pool:free(238)=$42:0000EF,000002
pool:free(239)=$42:0000F0,000002
pool:free(240)=$42:0000F1,000002
pool:free(241)=$42:0000F2,000002
pool:free(242)=$42:0000F3,000002
pool:free(243)=$42:0000F4,000002
pool:free(244)=$42:0000F5,000002
pool:free(245)=$42:0000F6,000002
pool:free(246)=$42:0000F7,000002
pool:free(247)=$42:0000F8,000002
pool:free(248)=$42:0000F9,000002
pool:free(249)=$42:0000FA,000002
pool:free(250)=$42:0000FB,000002
pool:free(251)=$42:0000FC,000002
pool:free(252)=$42:0000FD,000002
pool:free(253)=$42:0000FE,000002
pool:free(254)=$42:0000FF,000002
pool:free(255)=$42:000100,000002
pool:free(256)=$42:000101,000002
pool:free(257)=$42:000102,000002
pool:free(258)=$42:000103,000002
position?=$00:00019B
preport=$00:000F4D
preport:lookaside=$47:000000,00000F
preport:return=$47:000002,00000F
preport:dgram=$47:000003,00000F
preport:dgram:vers_ihl_tos=$47:000003,00000F
preport:dgram:bytes=$47:000004,00000F
preport:dgram:id=$47:000005,00000F
preport:dgram:flags_fragment=$47:000006,00000F
preport:dgram:ttl_protocol=$47:000007,00000F
preport:dgram:checksum=$47:000008,00000F
preport:dgram:ipsource=$47:000009,00000F
preport:dgram:ipdest=$47:00000B,00000F
preport:caller_ab=000000,00000F
preport:unigram_or_1st_part=$00:000F54
preport:get_udp_socket=$00:000F5C
preport:store_port_pointer=$00:000F5D
preport:no_fragment_encountered=$00:000F63
preport:no_pointer_needed=$00:000F63
printf=:N129:P:0:000000
priority_out_of_range=$00:000470
proto_apdata=000000,00000F
protocol_socket=$00:000A14
push_normalise=:N129:P:0:000000
q2=$00:000E96
q2first?=$00:000E90
q2if_unit_datagram=$00:0000A3
q2ifoq=00007D
q2ifoq1=$00:00009A
q2ifoq_low=$00:000098
q2ifree=$00:000088
q2ifreel=$00:000087
q2ifreex=$00:0000A4
q2z=$00:000E9C
qpriority=$00:0002E3
qstart
queue=$43:000000,000003
queue:head=$43:000000,000003
queue:tail=$43:000001,000003
ram_start=000000,00000F
rasm_time
rasmgram
rbuffer=$00:000D0B
rbuffer1=$00:000D46
rbuffer2!=$00:000D3E
rbuffer2?=$00:000D42
rbuffer32!=$00:000D0F
rbuffer32?=$00:000D38
rbufferq=:P1:0:000078
rcaller_8_11=000000,00000F
read_handle_ii=$00:000575
read_socket_ii=$00:0005A7
read_xvector_ii=$00:0005B6
readq=$00:000EA1
readqz=$00:000EA5
rebound75=$00:0000DD
receive_socket_protocol_wrong=$00:000BC8
receive_socket_state?=$00:000BBF
receive_socket_x=$00:000BC9
recv+=$00:000089
release_udgram+=$00:000087
remove_thread=$00:000233
remove_threadx=$00:00023E
replicate_abt=$00:000486
requeue=$00:0002EB
resolve_socket=$00:000B69
restart=$00:000067
restart_ei=$00:0006E9
restart_go=$00:0002A2
restricted=$00:00030C
retrieve_netb=:P1:0:000040
retrieve_thread=$00:000238
rflags=000004,00000F
rlist=000003,00000F
rnolastbytes=$00:000460
rnowordpair=$00:000457
ro=$42:000000,000002
ro:next=$42:000000,000002
ro:lexical=$42:000001,000002
ro:i_f=$42:000002,000002
ro:net=$42:000003,000002
ro:mask=$42:000005,000002
ro:next_hop=$42:000007,000002
ro:mask_log=$42:000009,000002
roifidxroutine=000005,00000F
route=:N129:P:0:000000
route_(1)=$01:00023D
route_(1):next=$01:00023D
route_(1):lexical=$01:00023E
route_(1):i_f=$01:00023F
route_(1):net=$01:000240
route_(1):mask=$01:000242
route_(1):next_hop=$01:000244
route_(1):mask_log=$01:000246
route_(10)=$01:000297
route_(10):next=$01:000297
route_(10):lexical=$01:000298
route_(10):i_f=$01:000299
route_(10):net=$01:00029A
route_(10):mask=$01:00029C
route_(10):next_hop=$01:00029E
route_(10):mask_log=$01:0002A0
route_(11)=$01:0002A1
route_(11):next=$01:0002A1
route_(11):lexical=$01:0002A2
route_(11):i_f=$01:0002A3
route_(11):net=$01:0002A4
route_(11):mask=$01:0002A6
route_(11):next_hop=$01:0002A8
route_(11):mask_log=$01:0002AA
route_(12)=$01:0002AB
route_(12):next=$01:0002AB
route_(12):lexical=$01:0002AC
route_(12):i_f=$01:0002AD
route_(12):net=$01:0002AE
route_(12):mask=$01:0002B0
route_(12):next_hop=$01:0002B2
route_(12):mask_log=$01:0002B4
route_(13)=$01:0002B5
route_(13):next=$01:0002B5
route_(13):lexical=$01:0002B6
route_(13):i_f=$01:0002B7
route_(13):net=$01:0002B8
route_(13):mask=$01:0002BA
route_(13):next_hop=$01:0002BC
route_(13):mask_log=$01:0002BE
route_(14)=$01:0002BF
route_(14):next=$01:0002BF
route_(14):lexical=$01:0002C0
route_(14):i_f=$01:0002C1
route_(14):net=$01:0002C2
route_(14):mask=$01:0002C4
route_(14):next_hop=$01:0002C6
route_(14):mask_log=$01:0002C8
route_(15)=$01:0002C9
route_(15):next=$01:0002C9
route_(15):lexical=$01:0002CA
route_(15):i_f=$01:0002CB
route_(15):net=$01:0002CC
route_(15):mask=$01:0002CE
route_(15):next_hop=$01:0002D0
route_(15):mask_log=$01:0002D2
route_(16)=$01:0002D3
route_(16):next=$01:0002D3
route_(16):lexical=$01:0002D4
route_(16):i_f=$01:0002D5
route_(16):net=$01:0002D6
route_(16):mask=$01:0002D8
route_(16):next_hop=$01:0002DA
route_(16):mask_log=$01:0002DC
route_(17)=$01:0002DD
route_(17):next=$01:0002DD
route_(17):lexical=$01:0002DE
route_(17):i_f=$01:0002DF
route_(17):net=$01:0002E0
route_(17):mask=$01:0002E2
route_(17):next_hop=$01:0002E4
route_(17):mask_log=$01:0002E6
route_(18)=$01:0002E7
route_(18):next=$01:0002E7
route_(18):lexical=$01:0002E8
route_(18):i_f=$01:0002E9
route_(18):net=$01:0002EA
route_(18):mask=$01:0002EC
route_(18):next_hop=$01:0002EE
route_(18):mask_log=$01:0002F0
route_(19)=$01:0002F1
route_(19):next=$01:0002F1
route_(19):lexical=$01:0002F2
route_(19):i_f=$01:0002F3
route_(19):net=$01:0002F4
route_(19):mask=$01:0002F6
route_(19):next_hop=$01:0002F8
route_(19):mask_log=$01:0002FA
route_(2)=$01:000247
route_(2):next=$01:000247
route_(2):lexical=$01:000248
route_(2):i_f=$01:000249
route_(2):net=$01:00024A
route_(2):mask=$01:00024C
route_(2):next_hop=$01:00024E
route_(2):mask_log=$01:000250
route_(20)=$01:0002FB
route_(20):next=$01:0002FB
route_(20):lexical=$01:0002FC
route_(20):i_f=$01:0002FD
route_(20):net=$01:0002FE
route_(20):mask=$01:000300
route_(20):next_hop=$01:000302
route_(20):mask_log=$01:000304
route_(21)=$01:000305
route_(21):next=$01:000305
route_(21):lexical=$01:000306
route_(21):i_f=$01:000307
route_(21):net=$01:000308
route_(21):mask=$01:00030A
route_(21):next_hop=$01:00030C
route_(21):mask_log=$01:00030E
route_(22)=$01:00030F
route_(22):next=$01:00030F
route_(22):lexical=$01:000310
route_(22):i_f=$01:000311
route_(22):net=$01:000312
route_(22):mask=$01:000314
route_(22):next_hop=$01:000316
route_(22):mask_log=$01:000318
route_(23)=$01:000319
route_(23):next=$01:000319
route_(23):lexical=$01:00031A
route_(23):i_f=$01:00031B
route_(23):net=$01:00031C
route_(23):mask=$01:00031E
route_(23):next_hop=$01:000320
route_(23):mask_log=$01:000322
route_(24)=$01:000323
route_(24):next=$01:000323
route_(24):lexical=$01:000324
route_(24):i_f=$01:000325
route_(24):net=$01:000326
route_(24):mask=$01:000328
route_(24):next_hop=$01:00032A
route_(24):mask_log=$01:00032C
route_(3)=$01:000251
route_(3):next=$01:000251
route_(3):lexical=$01:000252
route_(3):i_f=$01:000253
route_(3):net=$01:000254
route_(3):mask=$01:000256
route_(3):next_hop=$01:000258
route_(3):mask_log=$01:00025A
route_(4)=$01:00025B
route_(4):next=$01:00025B
route_(4):lexical=$01:00025C
route_(4):i_f=$01:00025D
route_(4):net=$01:00025E
route_(4):mask=$01:000260
route_(4):next_hop=$01:000262
route_(4):mask_log=$01:000264
route_(5)=$01:000265
route_(5):next=$01:000265
route_(5):lexical=$01:000266
route_(5):i_f=$01:000267
route_(5):net=$01:000268
route_(5):mask=$01:00026A
route_(5):next_hop=$01:00026C
route_(5):mask_log=$01:00026E
route_(6)=$01:00026F
route_(6):next=$01:00026F
route_(6):lexical=$01:000270
route_(6):i_f=$01:000271
route_(6):net=$01:000272
route_(6):mask=$01:000274
route_(6):next_hop=$01:000276
route_(6):mask_log=$01:000278
route_(7)=$01:000279
route_(7):next=$01:000279
route_(7):lexical=$01:00027A
route_(7):i_f=$01:00027B
route_(7):net=$01:00027C
route_(7):mask=$01:00027E
route_(7):next_hop=$01:000280
route_(7):mask_log=$01:000282
route_(8)=$01:000283
route_(8):next=$01:000283
route_(8):lexical=$01:000284
route_(8):i_f=$01:000285
route_(8):net=$01:000286
route_(8):mask=$01:000288
route_(8):next_hop=$01:00028A
route_(8):mask_log=$01:00028C
route_(9)=$01:00028D
route_(9):next=$01:00028D
route_(9):lexical=$01:00028E
route_(9):i_f=$01:00028F
route_(9):net=$01:000290
route_(9):mask=$01:000292
route_(9):next_hop=$01:000294
route_(9):mask_log=$01:000296
route_config_frame=:N129:P:0:000000
route_free+=$01:00023B
route_lexical+=$01:00023C
route_list+=$01:00023A
route_outward_interface=$00:000DFB
rstream_registers=000004,00000F
rstream_scan_net=[0029]000000
rstream_scana
rstream_start_net
rstream_starta
run_device_nothread=$00:0000F4
run_device_thread=$00:0000E1
run_device_wrongcore=$00:0000F4
run_start+=$00:00014A
rx2!=$00:00048C
rx2?=$00:000490
rx64!=$00:00046E
rx64?=$00:000480
rx8!=$00:000483
rx8?=$00:000487
rx_nocheck=$00:000469
rx_payload=$00:000419
rx_state_examine=$00:000D7F
rxbuf=00000C,00000F
rxbytes=00000D,00000F
rxcheck64!=$00:000420
rxcheck64?=$00:000445
rxcheck8!=$00:000448
rxcheck8?=$00:00044E
rxflags=00000E,00000F
rxnocheckZ=$00:000495
s=$42:000000,000005
s:socket_address=$42:000000,000005
s:remote_address=$42:000002,000005
s:flags=$42:000004,000005
s:udp=$42:000005,000005
s:udp:tsq=$42:000005,000005
s:udp:socket_inq=$42:000006,000005
s:udp:socket_inq:head=$42:000006,000005
s:udp:socket_inq:tail=$42:000007,000005
s:tcp=$42:000005,000005
s:tcp:tbase=$42:000005,000005
s:tcp:tcbs=$42:000006,000005
s:tcp:rxbu_p=$42:000006,000005
s:tcp:rxowner=$42:000007,000005
s:tcp:txbu_p=$42:000007,000005
safety=000018,00000F
save_BYTES=00000D,00000F
save_RDATACD=00000A,00000F
save_chain_pointer=000000,00000F
save_q=00000C,00000F
sbind=$43:000000,000003
sbind:socket_address=$43:000000,000003
sbind:remote_address=$43:000002,000003
sbind:flags=$43:000004,000003
sbind:udp=$43:000005,000003
sbind:udp:tsq=$43:000005,000003
sbind:udp:socket_inq=$43:000006,000003
sbind:udp:socket_inq:head=$43:000006,000003
sbind:udp:socket_inq:tail=$43:000007,000003
sbind:tcp=$43:000005,000003
sbind:tcp:tbase=$43:000005,000003
sbind:tcp:tcbs=$43:000006,000003
sbind:tcp:rxbu_p=$43:000006,000003
sbind:tcp:rxowner=$43:000007,000003
sbind:tcp:txbu_p=$43:000007,000003
scanf=:N129:P:0:000000
scanhex
sdepth=000000,00000F
seal32vectors=$00:000458
search_name_words=000006,00000F
search_onlinexqt=$00:00030F
search_run_namep=000007,00000F
search_unbalanced=$00:000335
seg$load
segment=:N129:P:0:000000
sell1=$00:000E49
sell1_chain_equal?=$00:000E6F
sell1_chain_walk=$00:000E6B
sell1_final=$00:000E77
sell1_list=$00:000E79
sell1_list?=$00:000E80
sell1_log=$00:000E79
sell1_more=$00:000E5C
sell1_more?=$00:000E5F
sell1_u=$00:000E8E
sell1_z=$00:000E8B
send+=$00:00008A
send1byte=$00:000D06
send2bytes!=$00:000CFD
send2bytes?=$00:000D01
send32bytes!=$00:000CC2
send32bytes?=$00:000CF7
sendbytepair=:P1:0:000077
sense_data+=$00:000090
sense_socket_protocol_wrong=$00:000B8D
sense_socket_x=$00:000B8E
serx=000003,00000F
set_b1=$00:000395
sflags=000019,00000F
sine192+=$00:000174
sine96+=$00:000178
slevel=000001,00000F
slist=000018,00000F
smp_activate=$00:00011D
smp_ii=$00:0006F0
smp_pend=$00:00013A
smp_pendu=$00:00013E
snmpEnableAuthenTraps=$00:000A18
snmpEnableAuthenTraps:rw_typ_tokens_words=$00:000A18
snmpEnableAuthenTraps:o=$00:000A19
snmpEnableAuthenTraps:l=$00:000A1A
snmpEnableAuthenTraps:data=$00:000A1B
snmpEnableAuthenTraps:flags=$00:000A1C
snmpEnableAuthenTraps:bucket=$00:000A1D
snmpEnableAuthenTraps:ranges=$00:000A1D
snmpEnableAuthenTraps:range=$00:000A1E
snmpEnableAuthenTraps:advance=$00:000A1E
snmpEnableAuthenTraps:netstring=:N129:P:0:000000
snmpEnableAuthenTraps:i=$01:0005D6
snmpInASNParseErrors=$00:000994
snmpInASNParseErrors:rw_typ_tokens_words=$00:000994
snmpInASNParseErrors:o=$00:000995
snmpInASNParseErrors:l=$00:000996
snmpInASNParseErrors:data=$00:000997
snmpInASNParseErrors:flags=$00:000998
snmpInASNParseErrors:bucket=$00:000999
snmpInASNParseErrors:ranges=$00:000999
snmpInASNParseErrors:range=$00:00099A
snmpInASNParseErrors:advance=$00:00099A
snmpInASNParseErrors:netstring=:N129:P:0:000000
snmpInASNParseErrors:i=$01:0005AA
snmpInBadCommunityNames=$00:000988
snmpInBadCommunityNames:rw_typ_tokens_words=$00:000988
snmpInBadCommunityNames:o=$00:000989
snmpInBadCommunityNames:l=$00:00098A
snmpInBadCommunityNames:data=$00:00098B
snmpInBadCommunityNames:flags=$00:00098C
snmpInBadCommunityNames:bucket=$00:00098D
snmpInBadCommunityNames:ranges=$00:00098D
snmpInBadCommunityNames:range=$00:00098E
snmpInBadCommunityNames:advance=$00:00098E
snmpInBadCommunityNames:netstring=:N129:P:0:000000
snmpInBadCommunityNames:i=$01:0005A6
snmpInBadCommunityUses=$00:00098E
snmpInBadCommunityUses:rw_typ_tokens_words=$00:00098E
snmpInBadCommunityUses:o=$00:00098F
snmpInBadCommunityUses:l=$00:000990
snmpInBadCommunityUses:data=$00:000991
snmpInBadCommunityUses:flags=$00:000992
snmpInBadCommunityUses:bucket=$00:000993
snmpInBadCommunityUses:ranges=$00:000993
snmpInBadCommunityUses:range=$00:000994
snmpInBadCommunityUses:advance=$00:000994
snmpInBadCommunityUses:netstring=:N129:P:0:000000
snmpInBadCommunityUses:i=$01:0005A8
snmpInBadValues=$00:0009A6
snmpInBadValues:rw_typ_tokens_words=$00:0009A6
snmpInBadValues:o=$00:0009A7
snmpInBadValues:l=$00:0009A8
snmpInBadValues:data=$00:0009A9
snmpInBadValues:flags=$00:0009AA
snmpInBadValues:bucket=$00:0009AB
snmpInBadValues:ranges=$00:0009AB
snmpInBadValues:range=$00:0009AC
snmpInBadValues:advance=$00:0009AC
snmpInBadValues:netstring=:N129:P:0:000000
snmpInBadValues:i=$01:0005B0
snmpInBadVersions=$00:000982
snmpInBadVersions:rw_typ_tokens_words=$00:000982
snmpInBadVersions:o=$00:000983
snmpInBadVersions:l=$00:000984
snmpInBadVersions:data=$00:000985
snmpInBadVersions:flags=$00:000986
snmpInBadVersions:bucket=$00:000987
snmpInBadVersions:ranges=$00:000987
snmpInBadVersions:range=$00:000988
snmpInBadVersions:advance=$00:000988
snmpInBadVersions:netstring=:N129:P:0:000000
snmpInBadVersions:i=$01:0005A4
snmpInGenErrs=$00:0009B2
snmpInGenErrs:rw_typ_tokens_words=$00:0009B2
snmpInGenErrs:o=$00:0009B3
snmpInGenErrs:l=$00:0009B4
snmpInGenErrs:data=$00:0009B5
snmpInGenErrs:flags=$00:0009B6
snmpInGenErrs:bucket=$00:0009B7
snmpInGenErrs:ranges=$00:0009B7
snmpInGenErrs:range=$00:0009B8
snmpInGenErrs:advance=$00:0009B8
snmpInGenErrs:netstring=:N129:P:0:000000
snmpInGenErrs:i=$01:0005B4
snmpInGetNexts=$00:0009CA
snmpInGetNexts:rw_typ_tokens_words=$00:0009CA
snmpInGetNexts:o=$00:0009CB
snmpInGetNexts:l=$00:0009CC
snmpInGetNexts:data=$00:0009CD
snmpInGetNexts:flags=$00:0009CE
snmpInGetNexts:bucket=$00:0009CF
snmpInGetNexts:ranges=$00:0009CF
snmpInGetNexts:range=$00:0009D0
snmpInGetNexts:advance=$00:0009D0
snmpInGetNexts:netstring=:N129:P:0:000000
snmpInGetNexts:i=$01:0005BC
snmpInGetRequests=$00:0009C4
snmpInGetRequests:rw_typ_tokens_words=$00:0009C4
snmpInGetRequests:o=$00:0009C5
snmpInGetRequests:l=$00:0009C6
snmpInGetRequests:data=$00:0009C7
snmpInGetRequests:flags=$00:0009C8
snmpInGetRequests:bucket=$00:0009C9
snmpInGetRequests:ranges=$00:0009C9
snmpInGetRequests:range=$00:0009CA
snmpInGetRequests:advance=$00:0009CA
snmpInGetRequests:netstring=:N129:P:0:000000
snmpInGetRequests:i=$01:0005BA
snmpInGetResponses=$00:0009D6
snmpInGetResponses:rw_typ_tokens_words=$00:0009D6
snmpInGetResponses:o=$00:0009D7
snmpInGetResponses:l=$00:0009D8
snmpInGetResponses:data=$00:0009D9
snmpInGetResponses:flags=$00:0009DA
snmpInGetResponses:bucket=$00:0009DB
snmpInGetResponses:ranges=$00:0009DB
snmpInGetResponses:range=$00:0009DC
snmpInGetResponses:advance=$00:0009DC
snmpInGetResponses:netstring=:N129:P:0:000000
snmpInGetResponses:i=$01:0005C0
snmpInNoSuchNames=$00:0009A0
snmpInNoSuchNames:rw_typ_tokens_words=$00:0009A0
snmpInNoSuchNames:o=$00:0009A1
snmpInNoSuchNames:l=$00:0009A2
snmpInNoSuchNames:data=$00:0009A3
snmpInNoSuchNames:flags=$00:0009A4
snmpInNoSuchNames:bucket=$00:0009A5
snmpInNoSuchNames:ranges=$00:0009A5
snmpInNoSuchNames:range=$00:0009A6
snmpInNoSuchNames:advance=$00:0009A6
snmpInNoSuchNames:netstring=:N129:P:0:000000
snmpInNoSuchNames:i=$01:0005AE
snmpInPkts=$00:000976
snmpInPkts:rw_typ_tokens_words=$00:000976
snmpInPkts:o=$00:000977
snmpInPkts:l=$00:000978
snmpInPkts:data=$00:000979
snmpInPkts:flags=$00:00097A
snmpInPkts:bucket=$00:00097B
snmpInPkts:ranges=$00:00097B
snmpInPkts:range=$00:00097C
snmpInPkts:advance=$00:00097C
snmpInPkts:netstring=:N129:P:0:000000
snmpInPkts:i=$01:0005A0
snmpInReadOnlys=$00:0009AC
snmpInReadOnlys:rw_typ_tokens_words=$00:0009AC
snmpInReadOnlys:o=$00:0009AD
snmpInReadOnlys:l=$00:0009AE
snmpInReadOnlys:data=$00:0009AF
snmpInReadOnlys:flags=$00:0009B0
snmpInReadOnlys:bucket=$00:0009B1
snmpInReadOnlys:ranges=$00:0009B1
snmpInReadOnlys:range=$00:0009B2
snmpInReadOnlys:advance=$00:0009B2
snmpInReadOnlys:netstring=:N129:P:0:000000
snmpInReadOnlys:i=$01:0005B2
snmpInSetRequests=$00:0009D0
snmpInSetRequests:rw_typ_tokens_words=$00:0009D0
snmpInSetRequests:o=$00:0009D1
snmpInSetRequests:l=$00:0009D2
snmpInSetRequests:data=$00:0009D3
snmpInSetRequests:flags=$00:0009D4
snmpInSetRequests:bucket=$00:0009D5
snmpInSetRequests:ranges=$00:0009D5
snmpInSetRequests:range=$00:0009D6
snmpInSetRequests:advance=$00:0009D6
snmpInSetRequests:netstring=:N129:P:0:000000
snmpInSetRequests:i=$01:0005BE
snmpInTooBigs=$00:00099A
snmpInTooBigs:rw_typ_tokens_words=$00:00099A
snmpInTooBigs:o=$00:00099B
snmpInTooBigs:l=$00:00099C
snmpInTooBigs:data=$00:00099D
snmpInTooBigs:flags=$00:00099E
snmpInTooBigs:bucket=$00:00099F
snmpInTooBigs:ranges=$00:00099F
snmpInTooBigs:range=$00:0009A0
snmpInTooBigs:advance=$00:0009A0
snmpInTooBigs:netstring=:N129:P:0:000000
snmpInTooBigs:i=$01:0005AC
snmpInTotalReqVars=$00:0009B8
snmpInTotalReqVars:rw_typ_tokens_words=$00:0009B8
snmpInTotalReqVars:o=$00:0009B9
snmpInTotalReqVars:l=$00:0009BA
snmpInTotalReqVars:data=$00:0009BB
snmpInTotalReqVars:flags=$00:0009BC
snmpInTotalReqVars:bucket=$00:0009BD
snmpInTotalReqVars:ranges=$00:0009BD
snmpInTotalReqVars:range=$00:0009BE
snmpInTotalReqVars:advance=$00:0009BE
snmpInTotalReqVars:netstring=:N129:P:0:000000
snmpInTotalReqVars:i=$01:0005B6
snmpInTotalSetVars=$00:0009BE
snmpInTotalSetVars:rw_typ_tokens_words=$00:0009BE
snmpInTotalSetVars:o=$00:0009BF
snmpInTotalSetVars:l=$00:0009C0
snmpInTotalSetVars:data=$00:0009C1
snmpInTotalSetVars:flags=$00:0009C2
snmpInTotalSetVars:bucket=$00:0009C3
snmpInTotalSetVars:ranges=$00:0009C3
snmpInTotalSetVars:range=$00:0009C4
snmpInTotalSetVars:advance=$00:0009C4
snmpInTotalSetVars:netstring=:N129:P:0:000000
snmpInTotalSetVars:i=$01:0005B8
snmpInTraps=$00:0009DC
snmpInTraps:rw_typ_tokens_words=$00:0009DC
snmpInTraps:o=$00:0009DD
snmpInTraps:l=$00:0009DE
snmpInTraps:data=$00:0009DF
snmpInTraps:flags=$00:0009E0
snmpInTraps:bucket=$00:0009E1
snmpInTraps:ranges=$00:0009E1
snmpInTraps:range=$00:0009E2
snmpInTraps:advance=$00:0009E2
snmpInTraps:netstring=:N129:P:0:000000
snmpInTraps:i=$01:0005C2
snmpOutBadValues=$00:0009EE
snmpOutBadValues:rw_typ_tokens_words=$00:0009EE
snmpOutBadValues:o=$00:0009EF
snmpOutBadValues:l=$00:0009F0
snmpOutBadValues:data=$00:0009F1
snmpOutBadValues:flags=$00:0009F2
snmpOutBadValues:bucket=$00:0009F3
snmpOutBadValues:ranges=$00:0009F3
snmpOutBadValues:range=$00:0009F4
snmpOutBadValues:advance=$00:0009F4
snmpOutBadValues:netstring=:N129:P:0:000000
snmpOutBadValues:i=$01:0005C8
snmpOutGenErrs=$00:0009F4
snmpOutGenErrs:rw_typ_tokens_words=$00:0009F4
snmpOutGenErrs:o=$00:0009F5
snmpOutGenErrs:l=$00:0009F6
snmpOutGenErrs:data=$00:0009F7
snmpOutGenErrs:flags=$00:0009F8
snmpOutGenErrs:bucket=$00:0009F9
snmpOutGenErrs:ranges=$00:0009F9
snmpOutGenErrs:range=$00:0009FA
snmpOutGenErrs:advance=$00:0009FA
snmpOutGenErrs:netstring=:N129:P:0:000000
snmpOutGenErrs:i=$01:0005CA
snmpOutGetNexts=$00:000A00
snmpOutGetNexts:rw_typ_tokens_words=$00:000A00
snmpOutGetNexts:o=$00:000A01
snmpOutGetNexts:l=$00:000A02
snmpOutGetNexts:data=$00:000A03
snmpOutGetNexts:flags=$00:000A04
snmpOutGetNexts:bucket=$00:000A05
snmpOutGetNexts:ranges=$00:000A05
snmpOutGetNexts:range=$00:000A06
snmpOutGetNexts:advance=$00:000A06
snmpOutGetNexts:netstring=:N129:P:0:000000
snmpOutGetNexts:i=$01:0005CE
snmpOutGetRequests=$00:0009FA
snmpOutGetRequests:rw_typ_tokens_words=$00:0009FA
snmpOutGetRequests:o=$00:0009FB
snmpOutGetRequests:l=$00:0009FC
snmpOutGetRequests:data=$00:0009FD
snmpOutGetRequests:flags=$00:0009FE
snmpOutGetRequests:bucket=$00:0009FF
snmpOutGetRequests:ranges=$00:0009FF
snmpOutGetRequests:range=$00:000A00
snmpOutGetRequests:advance=$00:000A00
snmpOutGetRequests:netstring=:N129:P:0:000000
snmpOutGetRequests:i=$01:0005CC
snmpOutGetResponses=$00:000A0C
snmpOutGetResponses:rw_typ_tokens_words=$00:000A0C
snmpOutGetResponses:o=$00:000A0D
snmpOutGetResponses:l=$00:000A0E
snmpOutGetResponses:data=$00:000A0F
snmpOutGetResponses:flags=$00:000A10
snmpOutGetResponses:bucket=$00:000A11
snmpOutGetResponses:ranges=$00:000A11
snmpOutGetResponses:range=$00:000A12
snmpOutGetResponses:advance=$00:000A12
snmpOutGetResponses:netstring=:N129:P:0:000000
snmpOutGetResponses:i=$01:0005D2
snmpOutNoSuchNames=$00:0009E8
snmpOutNoSuchNames:rw_typ_tokens_words=$00:0009E8
snmpOutNoSuchNames:o=$00:0009E9
snmpOutNoSuchNames:l=$00:0009EA
snmpOutNoSuchNames:data=$00:0009EB
snmpOutNoSuchNames:flags=$00:0009EC
snmpOutNoSuchNames:bucket=$00:0009ED
snmpOutNoSuchNames:ranges=$00:0009ED
snmpOutNoSuchNames:range=$00:0009EE
snmpOutNoSuchNames:advance=$00:0009EE
snmpOutNoSuchNames:netstring=:N129:P:0:000000
snmpOutNoSuchNames:i=$01:0005C6
snmpOutPkts=$00:00097C
snmpOutPkts:rw_typ_tokens_words=$00:00097C
snmpOutPkts:o=$00:00097D
snmpOutPkts:l=$00:00097E
snmpOutPkts:data=$00:00097F
snmpOutPkts:flags=$00:000980
snmpOutPkts:bucket=$00:000981
snmpOutPkts:ranges=$00:000981
snmpOutPkts:range=$00:000982
snmpOutPkts:advance=$00:000982
snmpOutPkts:netstring=:N129:P:0:000000
snmpOutPkts:i=$01:0005A2
snmpOutSetRequests=$00:000A06
snmpOutSetRequests:rw_typ_tokens_words=$00:000A06
snmpOutSetRequests:o=$00:000A07
snmpOutSetRequests:l=$00:000A08
snmpOutSetRequests:data=$00:000A09
snmpOutSetRequests:flags=$00:000A0A
snmpOutSetRequests:bucket=$00:000A0B
snmpOutSetRequests:ranges=$00:000A0B
snmpOutSetRequests:range=$00:000A0C
snmpOutSetRequests:advance=$00:000A0C
snmpOutSetRequests:netstring=:N129:P:0:000000
snmpOutSetRequests:i=$01:0005D0
snmpOutTooBigs=$00:0009E2
snmpOutTooBigs:rw_typ_tokens_words=$00:0009E2
snmpOutTooBigs:o=$00:0009E3
snmpOutTooBigs:l=$00:0009E4
snmpOutTooBigs:data=$00:0009E5
snmpOutTooBigs:flags=$00:0009E6
snmpOutTooBigs:bucket=$00:0009E7
snmpOutTooBigs:ranges=$00:0009E7
snmpOutTooBigs:range=$00:0009E8
snmpOutTooBigs:advance=$00:0009E8
snmpOutTooBigs:netstring=:N129:P:0:000000
snmpOutTooBigs:i=$01:0005C4
snmpOutTraps=$00:000A12
snmpOutTraps:rw_typ_tokens_words=$00:000A12
snmpOutTraps:o=$00:000A13
snmpOutTraps:l=$00:000A14
snmpOutTraps:data=$00:000A15
snmpOutTraps:flags=$00:000A16
snmpOutTraps:bucket=$00:000A17
snmpOutTraps:ranges=$00:000A17
snmpOutTraps:range=$00:000A18
snmpOutTraps:advance=$00:000A18
snmpOutTraps:netstring=:N129:P:0:000000
snmpOutTraps:i=$01:0005D4
snmp_agent+=$00:000146
snmp_agent_launch=$00:000A82
snmp_rseq=000008,00000F
snmp_tferq=$03:00022F
socket=:N129:P:0:000000
socket_call_udp_txaw=$00:000BF9
socket_out_of_range=$00:0005AC
socket_protocol_wrong=$00:000B7F
socket_receive=$00:000B9D
socket_receive_tcp?=$00:000BB4
socket_rx_established=$00:000BC6
socket_rx_readable=$00:000BC6
socket_send=$00:000BCE
socket_sense=$00:000B81
socket_sense_tcp?=$00:000B89
socket_tcp?=$00:000B77
socket_transmit_tcp?=$00:000C00
socket_udp_fail5=$00:000BFE
socket_unresolved=$00:000B80
softwareLoopback=000018
sorx=00000B,00000F
sotx=00000B,00000F
spawn=$00:00036E
spawn_ii=$00:00006D
spawn_z=$00:000084
spiral=$00:000173
spiral_again=$00:00016A
sprintf=:N129:P:0:000000
square192+=$00:00017C
square_root192+=$00:00017D
srequest=$00:000073
sscanf=:N129:P:0:000000
start=$00:00008A
startpx=000001,00000F
startup_osocket_encoding=$01:00041B
startups=$00:000339
startups:USTDOUT=000012
startups:initial=$00:000339
startups:startupz=$00:00033E
startups:read_startups=$00:00033F
startups:socko=000001,00000F
startups:config_retry=000000,00000F
startups:config?=$00:000353
startups:local_address=$00:000361
startups:no_stdout=$00:00036B
startups:run=$00:00036E
startups:script_path=000007,00000F
startups:file_position=000002,00000F
startups:siobloc=000001,00000F
startups:zdepth=000000,00000F
startups:no_run=$00:000389
startups:runfile_scan=$00:00038C
startups:depth=00000A,00000F
startups:share_iobloc=00000B,00000F
startups:fposition=00000C,00000F
startups:save_fspp=000000,00000F
startups:search_name=$46:000000,00000E
startups:text=$46:000050,00000E
startups:read_script=$00:00039B
startups:text_command=$00:0003C1
startups:runfile_breakpoint=$00:0003CA
startups:action_command=$00:0003D1
startups:share_ioblocp=000003,00000F
startups:textw=000004,00000F
startups:searchp=000005,00000F
startups:textp=000006,00000F
startups:new_process=000000,00000F
startups:action_running?=$00:0003E8
startups:action_concluded=$00:0003EC
startups:action_skip=$00:0003EC
stderr=000002,,000005
stdin=000000,,000005
stdout=000001,,000005
stem(1)=$41:003050
stem(2)=$41:003054
stem(3)=$41:003058
stem(4)=$41:00305C
stem(5)=$41:003060
stem(6)=$41:003064
stem(7)=$41:003068
stem(8)=$41:00306C
stem_link=$00:0000BF
storage_block_idxa_ii=$00:00066D
storage_block_idxb_ii=$00:000674
store_upacket=$00:0003B8
strail=$00:0002B7
stril=$00:0002AE
strilw+=$00:0002B1
subagent+=$00:000147
subagent?+=$00:000148
subagent_cancel=$00:000D64
subagent_insert=$00:000D4D
subagent_ithread=$03:000423
subagent_lookup=$00:000D51
subagent_point=$00:000D67
subagent_running!=$00:000D66
subagent_running?=$00:000D56
switch_fp_guard_ii=$00:0005FD
switch_lock_cell=$41:003047
switch_select=$00:00030F
symbol_scan=[0019]000000
sysContact=$00:00064A
sysContact:rw_typ_tokens_words=$00:00064A
sysContact:o=$00:00064B
sysContact:l=$00:00064C
sysContact:data=$00:00064D
sysContact:flags=$00:00064E
sysContact:bucket=$00:00064F
sysContact:ranges=$00:00064F
sysContact:advance=$00:000650
sysContact:netstring=:N129:P:0:000000
sysContact:s=$01:0004F1
sysDescr=$00:000638
sysDescr:rw_typ_tokens_words=$00:000638
sysDescr:o=$00:000639
sysDescr:l=$00:00063A
sysDescr:data=$00:00063B
sysDescr:flags=$00:00063C
sysDescr:bucket=$00:00063D
sysDescr:ranges=$00:00063D
sysDescr:advance=$00:00063E
sysDescr:netstring=:N129:P:0:000000
sysDescr:s=$01:0004E8
sysLocation=$00:000656
sysLocation:rw_typ_tokens_words=$00:000656
sysLocation:o=$00:000657
sysLocation:l=$00:000658
sysLocation:data=$00:000659
sysLocation:flags=$00:00065A
sysLocation:bucket=$00:00065B
sysLocation:ranges=$00:00065B
sysLocation:advance=$00:00065C
sysLocation:netstring=:N129:P:0:000000
sysLocation:s=$01:0004F9
sysName=$00:000650
sysName:rw_typ_tokens_words=$00:000650
sysName:o=$00:000651
sysName:l=$00:000652
sysName:data=$00:000653
sysName:flags=$00:000654
sysName:bucket=$00:000655
sysName:ranges=$00:000655
sysName:advance=$00:000656
sysName:netstring=:N129:P:0:000000
sysName:s=$01:0004F7
sysObjectID=$00:00063E
sysObjectID:rw_typ_tokens_words=$00:00063E
sysObjectID:o=$00:00063F
sysObjectID:l=$00:000640
sysObjectID:data=$00:000641
sysObjectID:flags=$00:000642
sysObjectID:bucket=$00:000643
sysObjectID:ranges=$00:000643
sysObjectID:advance=$00:000644
sysObjectID:netstring=:N129:P:0:000000
sysObjectID:oo=$01:0004F0
sysServices=$00:00065C
sysServices:rw_typ_tokens_words=$00:00065C
sysServices:o=$00:00065D
sysServices:l=$00:00065E
sysServices:data=$00:00065F
sysServices:flags=$00:000660
sysServices:bucket=$00:000661
sysServices:ranges=$00:000661
sysServices:range=$00:000662
sysServices:advance=$00:000662
sysServices:netstring=:N129:P:0:000000
sysServices:i=$01:0004FC
sysUpTime=$00:000644
sysUpTime:rw_typ_tokens_words=$00:000644
sysUpTime:o=$00:000645
sysUpTime:l=$00:000646
sysUpTime:data=$00:000647
sysUpTime:flags=$00:000648
sysUpTime:bucket=$00:000649
sysUpTime:ranges=$00:000649
sysUpTime:range=$00:00064A
sysUpTime:advance=$00:00064A
sysUpTime:netstring=:N129:P:0:000000
sys_info=$00:000E98
sysinfo+=$00:00015E
sysmem_free=$00:000061
t_ibuffer=$00:000274
table_id=000006,00000F
taflags=000004,00000F
tag_ii=$00:0006C7
tag_ii_user_refp=$00:0006D1
tag_iiw=$00:0006CF
tag_iiz=$00:0006D6
take_any=$00:0001F5
take_any_bank=$00:0001F4
take_bank=$00:0001FA
takt=$03:000002
tanflags=000004,00000F
tangent192+=$00:000176
tangent96+=$00:00017A
tanrflags=000004,00000F
tanroutine=000005,00000F
tanrroutine=000005,00000F
tanrseq=000003,00000F
tanseq=000003,00000F
tapflags=000004,00000F
taprflags=000004,00000F
taproutine=000005,00000F
taprroutine=000005,00000F
taprseq=000003,00000F
tapseq=000003,00000F
taroutine=000005,00000F
taseq=000003,00000F
tbank=:N129:P:0:000000
tco_total_i=$01:0004BD
tco_total_o=$01:0004B6
tco_total_o:along=$01:0004B6
tco_total_o:data=$01:0004B7
tco_total_o:down=$01:0004B7
tco_total_o:seq=$01:0004B8
tco_total_o:type=$01:0004B9
tco_total_o:bytes=$01:0004BA
tco_total_o:flags=$01:0004BB
tco_total_o:bucket=$01:0004BC
tco_total_o:ranges=$01:0004BC
tco_total_o:range=$01:0004BD
tconnection_p=000000,00000F
tcp4_closed?=$00:000539
tcp4_construct_connections_bank=$00:0005C2
tcp4_construct_x=$00:0005DA
tcp4_established!=$00:000516
tcp4_flags_weighed=$00:000569
tcp4_free_block=$00:00053F
tcp4_free_no_mib_line=$00:00054A
tcp4_globaltime!=$00:000530
tcp4_globaltime?=$00:000532
tcp4_high_volume=$00:0004F5
tcp4_list_processed=$00:000555
tcp4_locate_next_connection=$00:00054C
tcp4_located_next_connection=$00:00054E
tcp4_mark_time=$00:000536
tcp4_most_states=$00:000524
tcp4_net_free_txdatagram=$00:0008D1
tcp4_net_free_txdatagram_no_action=$00:0008D7
tcp4_new_traffic?=$00:00051E
tcp4_outstanding=$00:000558
tcp4_outstanding_later=$00:000579
tcp4_outstanding_next=$00:00055B
tcp4_outstanding_release=$00:000575
tcp4_process_list=$00:00050D
tcp4_reset_dq=$00:0008CB
tcp4_reset_dq_lx=$00:0008CA
tcp4_reset_dqx=$00:0008D0
tcp4_retransmit1=$00:00057E
tcp4_retransmit_next=$00:000581
tcp4_retransmit_rewind=$00:00058B
tcp4_retransmitted=$00:0005A0
tcp4_routine=$00:0004F5
tcp4_rxaction=$00:0008D8
tcp4_rxaction:connection=000006,00000F
tcp4_rxaction:ACK_AWAITED=000005,00000F
tcp4_rxaction:state=000004,00000F
tcp4_rxaction:received_seq=000002,00000F
tcp4_rxaction:remote_ack=000000,00000F
tcp4_rxaction:tcp_reset_dq_lx=$00:0008E7
tcp4_rxaction:tcp_accept_fail2=$00:0008E9
tcp4_rxaction:tcp4_accept=$00:0008EB
tcp4_rxaction:tcp_connection_located=$00:0008EF
tcp4_rxaction:tcp_synsent?=$00:000902
tcp4_rxaction:tcp_syn_ack_correct=$00:000908
tcp4_rxaction:tcp_no2ndsyn=$00:000908
tcp4_rxaction:tcp_compare_forward=$00:000917
tcp4_rxaction:tc_no_problem_p=$00:000920
tcp4_rxaction:jlist=:N129:P:0:000000
tcp4_rxaction:stepfor=$00:000929
tcp4_rxaction:tcp_established=$00:000939
tcp4_rxaction:tcp_closewait=$00:000939
tcp4_rxaction:tcp_tx_segments_acked?=$00:000939
tcp4_rxaction:tcp_rx_in_range?=$00:00093F
tcp4_rxaction:local_ack=000000,00000F
tcp4_rxaction:tcp_place_in_stream=$00:000943
tcp4_rxaction:tcp_rx_exact_sequence=$00:000958
tcp4_rxaction:tcp_lastack=$00:000966
tcp4_rxaction:tcp_lastack2closed=$00:00096C
tcp4_rxaction:tcp_rx_payload?=$00:00096F
tcp4_rxaction:tcp_rx_payload=$00:000972
tcp4_rxaction:tcp_rx_rechain=$00:000982
tcp4_rxaction:tcp_ack_point=$00:000996
tcp4_rxaction:tcp_rx_above_ack=$00:00099A
tcp4_rxaction:ELIMINATE_PREVIOUS_RESEND=000000
tcp4_rxaction:tcp_rx_already_acked=$00:0009A7
tcp4_rxaction:tcp_rx_above_range=$00:0009AE
tcp4_rxaction:tcp_rx_ack_nopayload=$00:0009AE
tcp4_rxaction:tcp_finwait1=$00:0009AF
tcp4_rxaction:tcp_closing=$00:0009B8
tcp4_rxaction:tcp_finwait1_acked?=$00:0009BB
tcp4_rxaction:tcp_finwait1tofinwait2=$00:0009BE
tcp4_rxaction:tcp_close2timewait=$00:0009C1
tcp4_rxaction:tcp_finwait2=$00:0009C5
tcp4_rxaction:tcp_timewait=$00:0009CD
tcp4_rxaction:tcp_synreceived=$00:0009D3
tcp4_rxaction:tcp_syn_ack_acked=$00:0009D6
tcp4_rxaction:tcp_ripdown_reset=$00:0009DB
tcp4_rxaction:tcp_ripdown_silently=$00:0009E5
tcp4_rxaction:tcp_deletetcb=$00:0009EE
tcp4_rxaction:tcp_closed=$00:0009F0
tcp4_rxaction:tcp_synsent=$00:0009F1
tcp4_rxaction:tcp_synsent1=$00:0009F4
tcp4_rxaction:tcp_clear_syn=$00:000A00
tcp4_rxaction:tcp_ack=$00:000A01
tcp4_rxaction:tcp_listen=$00:000A02
tcp4_rxaction:tcp_stepover_response=$00:000A02
tcp4_rxaction:tcp4xreact=$00:000A05
tcp4_rxaction:tcp_rack=$00:000A09
tcp4_service=$00:0004F6
tcp4_service_connection_list=$00:000509
tcp4_service_next_connection=$00:00050F
tcp4_state?=$00:000539
tcp4_synreceived?=$00:000521
tcp4_synsent?=$00:00052C
tcp4_zhash_chain=$00:0005CC
tcp4x=$00:000508
tcpActiveOpens=$00:000862
tcpActiveOpens:rw_typ_tokens_words=$00:000862
tcpActiveOpens:o=$00:000863
tcpActiveOpens:l=$00:000864
tcpActiveOpens:data=$00:000865
tcpActiveOpens:flags=$00:000866
tcpActiveOpens:bucket=$00:000867
tcpActiveOpens:ranges=$00:000867
tcpActiveOpens:range=$00:000868
tcpActiveOpens:advance=$00:000868
tcpActiveOpens:netstring=:N129:P:0:000000
tcpActiveOpens:i=$01:00055C
tcpAddRelinquish=$00:0008C2
tcpAddRelinquish:rw_typ_tokens_words=$00:0008C2
tcpAddRelinquish:o=$00:0008C3
tcpAddRelinquish:l=$00:0008C4
tcpAddRelinquish:data=$00:0008C5
tcpAddRelinquish:flags=$00:0008C6
tcpAddRelinquish:bucket=$00:0008C7
tcpAddRelinquish:ranges=$00:0008C7
tcpAddRelinquish:range=$00:0008C8
tcpAddRelinquish:advance=$00:0008C8
tcpAddRelinquish:netstring=:N129:P:0:000000
tcpAddRelinquish:i=$01:000570
tcpAddWait=$00:0008BC
tcpAddWait:rw_typ_tokens_words=$00:0008BC
tcpAddWait:o=$00:0008BD
tcpAddWait:l=$00:0008BE
tcpAddWait:data=$00:0008BF
tcpAddWait:flags=$00:0008C0
tcpAddWait:bucket=$00:0008C1
tcpAddWait:ranges=$00:0008C1
tcpAddWait:range=$00:0008C2
tcpAddWait:advance=$00:0008C2
tcpAddWait:netstring=:N129:P:0:000000
tcpAddWait:i=$01:00056E
tcpAttemptFails=$00:00086E
tcpAttemptFails:rw_typ_tokens_words=$00:00086E
tcpAttemptFails:o=$00:00086F
tcpAttemptFails:l=$00:000870
tcpAttemptFails:data=$00:000871
tcpAttemptFails:flags=$00:000872
tcpAttemptFails:bucket=$00:000873
tcpAttemptFails:ranges=$00:000873
tcpAttemptFails:range=$00:000874
tcpAttemptFails:advance=$00:000874
tcpAttemptFails:netstring=:N129:P:0:000000
tcpAttemptFails:i=$01:000560
tcpConnLocalAddress=$00:000898
tcpConnLocalAddress:rw_typ_tokens_words=$00:000898
tcpConnLocalAddress:o=$00:000899
tcpConnLocalAddress:l=$00:00089A
tcpConnLocalAddress:data=$00:00089B
tcpConnLocalAddress:flags=$00:00089C
tcpConnLocalAddress:bucket=$00:00089D
tcpConnLocalAddress:ranges=$00:00089D
tcpConnLocalAddress:range=$00:00089E
tcpConnLocalAddress:advance=$00:00089E
tcpConnLocalAddress:netstring=:N129:P:0:000000
tcpConnLocalPort=$00:00089E
tcpConnLocalPort:rw_typ_tokens_words=$00:00089E
tcpConnLocalPort:o=$00:00089F
tcpConnLocalPort:l=$00:0008A0
tcpConnLocalPort:data=$00:0008A1
tcpConnLocalPort:flags=$00:0008A2
tcpConnLocalPort:bucket=$00:0008A3
tcpConnLocalPort:ranges=$00:0008A3
tcpConnLocalPort:range=$00:0008A4
tcpConnLocalPort:advance=$00:0008A4
tcpConnLocalPort:netstring=:N129:P:0:000000
tcpConnRemAddress=$00:0008A4
tcpConnRemAddress:rw_typ_tokens_words=$00:0008A4
tcpConnRemAddress:o=$00:0008A5
tcpConnRemAddress:l=$00:0008A6
tcpConnRemAddress:data=$00:0008A7
tcpConnRemAddress:flags=$00:0008A8
tcpConnRemAddress:bucket=$00:0008A9
tcpConnRemAddress:ranges=$00:0008A9
tcpConnRemAddress:range=$00:0008AA
tcpConnRemAddress:advance=$00:0008AA
tcpConnRemAddress:netstring=:N129:P:0:000000
tcpConnRemPort=$00:0008AA
tcpConnRemPort:rw_typ_tokens_words=$00:0008AA
tcpConnRemPort:o=$00:0008AB
tcpConnRemPort:l=$00:0008AC
tcpConnRemPort:data=$00:0008AD
tcpConnRemPort:flags=$00:0008AE
tcpConnRemPort:bucket=$00:0008AF
tcpConnRemPort:ranges=$00:0008AF
tcpConnRemPort:range=$00:0008B0
tcpConnRemPort:advance=$00:0008B0
tcpConnRemPort:netstring=:N129:P:0:000000
tcpConnState=$00:000892
tcpConnState:rw_typ_tokens_words=$00:000892
tcpConnState:o=$00:000893
tcpConnState:l=$00:000894
tcpConnState:data=$00:000895
tcpConnState:flags=$00:000896
tcpConnState:bucket=$00:000897
tcpConnState:ranges=$00:000897
tcpConnState:range=$00:000898
tcpConnState:advance=$00:000898
tcpConnState:netstring=:N129:P:0:000000
tcpCurrEstab=$00:00087A
tcpCurrEstab:rw_typ_tokens_words=$00:00087A
tcpCurrEstab:o=$00:00087B
tcpCurrEstab:l=$00:00087C
tcpCurrEstab:data=$00:00087D
tcpCurrEstab:flags=$00:00087E
tcpCurrEstab:bucket=$00:00087F
tcpCurrEstab:ranges=$00:00087F
tcpCurrEstab:range=$00:000880
tcpCurrEstab:advance=$00:000880
tcpCurrEstab:netstring=:N129:P:0:000000
tcpDupDrops=$00:0008CE
tcpDupDrops:rw_typ_tokens_words=$00:0008CE
tcpDupDrops:o=$00:0008CF
tcpDupDrops:l=$00:0008D0
tcpDupDrops:data=$00:0008D1
tcpDupDrops:flags=$00:0008D2
tcpDupDrops:bucket=$00:0008D3
tcpDupDrops:ranges=$00:0008D3
tcpDupDrops:range=$00:0008D4
tcpDupDrops:advance=$00:0008D4
tcpDupDrops:netstring=:N129:P:0:000000
tcpDupDrops:i=$01:000574
tcpEstabResets=$00:000874
tcpEstabResets:rw_typ_tokens_words=$00:000874
tcpEstabResets:o=$00:000875
tcpEstabResets:l=$00:000876
tcpEstabResets:data=$00:000877
tcpEstabResets:flags=$00:000878
tcpEstabResets:bucket=$00:000879
tcpEstabResets:ranges=$00:000879
tcpEstabResets:range=$00:00087A
tcpEstabResets:advance=$00:00087A
tcpEstabResets:netstring=:N129:P:0:000000
tcpEstabResets:i=$01:000562
tcpInDrops=$00:0008C8
tcpInDrops:rw_typ_tokens_words=$00:0008C8
tcpInDrops:o=$00:0008C9
tcpInDrops:l=$00:0008CA
tcpInDrops:data=$00:0008CB
tcpInDrops:flags=$00:0008CC
tcpInDrops:bucket=$00:0008CD
tcpInDrops:ranges=$00:0008CD
tcpInDrops:range=$00:0008CE
tcpInDrops:advance=$00:0008CE
tcpInDrops:netstring=:N129:P:0:000000
tcpInDrops:i=$01:000572
tcpInErrs=$00:0008B0
tcpInErrs:rw_typ_tokens_words=$00:0008B0
tcpInErrs:o=$00:0008B1
tcpInErrs:l=$00:0008B2
tcpInErrs:data=$00:0008B3
tcpInErrs:flags=$00:0008B4
tcpInErrs:bucket=$00:0008B5
tcpInErrs:ranges=$00:0008B5
tcpInErrs:range=$00:0008B6
tcpInErrs:advance=$00:0008B6
tcpInErrs:netstring=:N129:P:0:000000
tcpInErrs:i=$01:00056A
tcpInSegs=$00:000880
tcpInSegs:rw_typ_tokens_words=$00:000880
tcpInSegs:o=$00:000881
tcpInSegs:l=$00:000882
tcpInSegs:data=$00:000883
tcpInSegs:flags=$00:000884
tcpInSegs:bucket=$00:000885
tcpInSegs:ranges=$00:000885
tcpInSegs:range=$00:000886
tcpInSegs:advance=$00:000886
tcpInSegs:netstring=:N129:P:0:000000
tcpInSegs:i=$01:000564
tcpMaxConn=$00:00085C
tcpMaxConn:rw_typ_tokens_words=$00:00085C
tcpMaxConn:o=$00:00085D
tcpMaxConn:l=$00:00085E
tcpMaxConn:data=$00:00085F
tcpMaxConn:flags=$00:000860
tcpMaxConn:bucket=$00:000861
tcpMaxConn:ranges=$00:000861
tcpMaxConn:range=$00:000862
tcpMaxConn:advance=$00:000862
tcpMaxConn:netstring=:N129:P:0:000000
tcpMaxConn:i=$01:00055A
tcpOutAckDrops=$00:0008D4
tcpOutAckDrops:rw_typ_tokens_words=$00:0008D4
tcpOutAckDrops:o=$00:0008D5
tcpOutAckDrops:l=$00:0008D6
tcpOutAckDrops:data=$00:0008D7
tcpOutAckDrops:flags=$00:0008D8
tcpOutAckDrops:bucket=$00:0008D9
tcpOutAckDrops:ranges=$00:0008D9
tcpOutAckDrops:range=$00:0008DA
tcpOutAckDrops:advance=$00:0008DA
tcpOutAckDrops:netstring=:N129:P:0:000000
tcpOutAckDrops:i=$01:000576
tcpOutRsts=$00:0008B6
tcpOutRsts:rw_typ_tokens_words=$00:0008B6
tcpOutRsts:o=$00:0008B7
tcpOutRsts:l=$00:0008B8
tcpOutRsts:data=$00:0008B9
tcpOutRsts:flags=$00:0008BA
tcpOutRsts:bucket=$00:0008BB
tcpOutRsts:ranges=$00:0008BB
tcpOutRsts:range=$00:0008BC
tcpOutRsts:advance=$00:0008BC
tcpOutRsts:netstring=:N129:P:0:000000
tcpOutRsts:i=$01:00056C
tcpOutSegs=$00:000886
tcpOutSegs:rw_typ_tokens_words=$00:000886
tcpOutSegs:o=$00:000887
tcpOutSegs:l=$00:000888
tcpOutSegs:data=$00:000889
tcpOutSegs:flags=$00:00088A
tcpOutSegs:bucket=$00:00088B
tcpOutSegs:ranges=$00:00088B
tcpOutSegs:range=$00:00088C
tcpOutSegs:advance=$00:00088C
tcpOutSegs:netstring=:N129:P:0:000000
tcpOutSegs:i=$01:000566
tcpPassiveOpens=$00:000868
tcpPassiveOpens:rw_typ_tokens_words=$00:000868
tcpPassiveOpens:o=$00:000869
tcpPassiveOpens:l=$00:00086A
tcpPassiveOpens:data=$00:00086B
tcpPassiveOpens:flags=$00:00086C
tcpPassiveOpens:bucket=$00:00086D
tcpPassiveOpens:ranges=$00:00086D
tcpPassiveOpens:range=$00:00086E
tcpPassiveOpens:advance=$00:00086E
tcpPassiveOpens:netstring=:N129:P:0:000000
tcpPassiveOpens:i=$01:00055E
tcpRetransSegs=$00:00088C
tcpRetransSegs:rw_typ_tokens_words=$00:00088C
tcpRetransSegs:o=$00:00088D
tcpRetransSegs:l=$00:00088E
tcpRetransSegs:data=$00:00088F
tcpRetransSegs:flags=$00:000890
tcpRetransSegs:bucket=$00:000891
tcpRetransSegs:ranges=$00:000891
tcpRetransSegs:range=$00:000892
tcpRetransSegs:advance=$00:000892
tcpRetransSegs:netstring=:N129:P:0:000000
tcpRetransSegs:i=$01:000568
tcpRtoAlgorithm=$00:00084A
tcpRtoAlgorithm:rw_typ_tokens_words=$00:00084A
tcpRtoAlgorithm:o=$00:00084B
tcpRtoAlgorithm:l=$00:00084C
tcpRtoAlgorithm:data=$00:00084D
tcpRtoAlgorithm:flags=$00:00084E
tcpRtoAlgorithm:bucket=$00:00084F
tcpRtoAlgorithm:ranges=$00:00084F
tcpRtoAlgorithm:range=$00:000850
tcpRtoAlgorithm:advance=$00:000850
tcpRtoAlgorithm:netstring=:N129:P:0:000000
tcpRtoAlgorithm:i=$01:000557
tcpRtoMax=$00:000856
tcpRtoMax:rw_typ_tokens_words=$00:000856
tcpRtoMax:o=$00:000857
tcpRtoMax:l=$00:000858
tcpRtoMax:data=$00:000859
tcpRtoMax:flags=$00:00085A
tcpRtoMax:bucket=$00:00085B
tcpRtoMax:ranges=$00:00085B
tcpRtoMax:range=$00:00085C
tcpRtoMax:advance=$00:00085C
tcpRtoMax:netstring=:N129:P:0:000000
tcpRtoMax:i=$01:000559
tcpRtoMin=$00:000850
tcpRtoMin:rw_typ_tokens_words=$00:000850
tcpRtoMin:o=$00:000851
tcpRtoMin:l=$00:000852
tcpRtoMin:data=$00:000853
tcpRtoMin:flags=$00:000854
tcpRtoMin:bucket=$00:000855
tcpRtoMin:ranges=$00:000855
tcpRtoMin:range=$00:000856
tcpRtoMin:advance=$00:000856
tcpRtoMin:netstring=:N129:P:0:000000
tcpRtoMin:i=$01:000558
tcp_2nd_list=$01:00040F
tcp_accept+=$00:00008D
tcp_accept_fail=$00:0005F5
tcp_ack_dropped=$00:000771
tcp_ack_fin=$00:00008E
tcp_ackq_started=$00:00076C
tcp_add=$00:000C11
tcp_add:__x=$00:000C17
tcp_add:tcpa=$00:000C1A
tcp_add:caller_fp=000005,00000F
tcp_add:socket_call_flags=000004,00000F
tcp_add:mss=000003,00000F
tcp_add:lookaside=000002,00000F
tcp_add:outstanding=000001,00000F
tcp_add:requested=000000,00000F
tcp_add:add=$00:000C28
tcp_add:transfer=$00:000C3B
tcp_add:add_words=$00:000C4B
tcp_add:push?=$00:000C4E
tcp_add:release=$00:000C54
tcp_add:no_output=$00:000C5B
tcp_add:add_x=$00:000C5C
tcp_add:add_z=$00:000C61
tcp_add:wherefore?=$00:000C62
tcp_add:weh=$00:000C69
tcp_add:segment_transmit=$00:000C6A
tcp_add:insert_byte=$00:000C85
tcp_add:buffer=$00:000C8D
tcp_add:new_segment=$00:000C94
tcp_add:request=$00:000C96
tcp_add:new_segment_request=$00:000C9B
tcp_add:LIMITQ=000000
tcp_add:request_maximum_segment_buffer=$00:000CA5
tcp_add:no_segment=$00:000CB2
tcp_add:segment=$00:000CB9
tcp_add:drop_request_closed=$00:000CBB
tcp_add:drop_request_zero=$00:000CBD
tcp_add_anomaly=$00:000652
tcp_add_connection=$00:000604
tcp_add_incoming_defaults=$00:00063A
tcp_add_timer1=$00:0008C6
tcp_addx+=$00:0000B2
tcp_agent_add=$00:00025E
tcp_agent_add_new=$00:000457
tcp_agent_established=$00:000265
tcp_agent_free=$00:00025F
tcp_agent_neta=$00:000261
tcp_agent_port=$00:000262
tcp_agent_remote_neta=$00:000263
tcp_agent_remote_port=$00:000264
tcp_agent_state=$00:000260
tcp_auto_accept=$00:0005DB
tcp_award_window=$00:000723
tcp_check_connection=$00:000672
tcp_compare_local=$00:00067B
tcp_compare_remote=$00:000681
tcp_connection=:N129:P:0:000000
tcp_connection_made=$00:000613
tcp_deflect_frame_safe=$00:0006FA
tcp_e0_accept=$00:000601
tcp_e1_accept=$00:000602
tcp_e2_accept=$00:000602
tcp_escape=$00:0006BC
tcp_escape_error=$00:0006BB
tcp_event1_acknowledged?=$00:0008B9
tcp_free=$00:0008B3
tcp_free_block_found=$00:000611
tcp_free_rxtx=$00:0005A3
tcp_free_tx=$00:0008B6
tcp_freerxq=$00:0005B2
tcp_freerxq:qtuple=000000,00000F
tcp_freerxq:sample=$00:0005B3
tcp_freerxq:clear=$00:0005B8
tcp_freetxq=$00:0005BA
tcp_freetxq:qtuple=000000,00000F
tcp_freetxq:sample=$00:0005BB
tcp_freetxq:clear=$00:0005C0
tcp_hash_connect=$00:000880
tcp_hash_connection+=$00:0000AF
tcp_hash_fold=:N129:P:0:000000
tcp_hash_localsocket+=$00:0000AE
tcp_hashlocal=$00:000882
tcp_hashremote=$00:00088B
tcp_hv_accept=$00:0005EE
tcp_iquick=$00:0006A6
tcp_keep_mss=$00:000635
tcp_locate_connection=$00:000660
tcp_log_reset=$00:000657
tcp_log_rx_error=$00:0006AF
tcp_lsegment_noport=$01:00040E
tcp_message_segment_i=$00:00070B
tcp_mib=$03:0024CD
tcp_mib_chain=$01:00049B
tcp_mib_free=$01:00049C
tcp_mib_high=$01:00049D
tcp_mib_oneta=$01:0004A5
tcp_mib_oneta:along=$01:0004A5
tcp_mib_oneta:data=$01:0004A6
tcp_mib_oneta:down=$01:0004A6
tcp_mib_oneta:seq=$01:0004A7
tcp_mib_oneta:type=$01:0004A8
tcp_mib_oneta:bytes=$01:0004A9
tcp_mib_oneta:flags=$01:0004AA
tcp_mib_oneta:bucket=$01:0004AB
tcp_mib_oneta:ranges=$01:0004AB
tcp_mib_oneta:range=$01:0004AC
tcp_mib_oport=$01:0004AC
tcp_mib_oport:along=$01:0004AC
tcp_mib_oport:data=$01:0004AD
tcp_mib_oport:down=$01:0004AD
tcp_mib_oport:seq=$01:0004AE
tcp_mib_oport:type=$01:0004AF
tcp_mib_oport:bytes=$01:0004B0
tcp_mib_oport:flags=$01:0004B1
tcp_mib_oport:bucket=$01:0004B2
tcp_mib_oport:ranges=$01:0004B2
tcp_mib_oport:range=$01:0004B3
tcp_mib_ostat=$01:00049E
tcp_mib_ostat:along=$01:00049E
tcp_mib_ostat:data=$01:00049F
tcp_mib_ostat:down=$01:00049F
tcp_mib_ostat:seq=$01:0004A0
tcp_mib_ostat:type=$01:0004A1
tcp_mib_ostat:bytes=$01:0004A2
tcp_mib_ostat:flags=$01:0004A3
tcp_mib_ostat:bucket=$01:0004A4
tcp_mib_ostat:ranges=$01:0004A4
tcp_mib_ostat:range=$01:0004A5
tcp_mib_xnet=$01:0004B4
tcp_mib_xstate=$01:0004B3
tcp_no_2nd_list=$00:000508
tcp_no_new_connection=$00:000627
tcp_nobuffer=$00:000844
tcp_noresetbuffer=$00:0007B9
tcp_options_complete=$00:000653
tcp_qthru=$00:0006A9
tcp_rbuffer=$00:000D4A
tcp_rbuffer_complete=$00:000D86
tcp_rbuffer_free=$00:000D6A
tcp_rbuffer_next=$00:000D4C
tcp_rbuffer_x=$00:000D74
tcp_rbuffer_y=$00:000D95
tcp_rbuffer_z=$00:000D93
tcp_read=$00:000D8C
tcp_read_disaster=$00:000D71
tcp_read_rxq=$00:000853
tcp_read_txq=$00:000867
tcp_read_words=$00:000D67
tcp_readtransfer=$00:000D58
tcp_reject=$00:000788
tcp_release_rxline+=$00:0000AD
tcp_reset=$00:0007BA
tcp_reset_deflect=$00:0006E9
tcp_respond_fin_ack=$00:000707
tcp_respond_syn_ack=$00:000702
tcp_restart_timer1=$00:0008C5
tcp_restart_timer2=$00:0008BD
tcp_ripdown=$00:00065C
tcp_rsegment=$00:000871
tcp_rx+=$00:0000B0
tcp_rx_error=$00:0006B9
tcp_rx_far=$00:000A0E
tcp_rx_ready+=$00:000086
tcp_rxbu_error=$00:0006B4
tcp_rxq=$00:000688
tcp_rxqexact=$00:000691
tcp_rxqlong=$00:0006C0
tcp_scan_mss=$00:000630
tcp_scan_next_option=$00:00062A
tcp_scan_next_option?=$00:000638
tcp_scan_option2=$00:000637
tcp_scan_options=$00:000628
tcp_seek=$00:000676
tcp_send_ack=$00:0007BF
tcp_send_i=$00:00070A
tcp_send_on_window=$00:000737
tcp_send_on_window_next=$00:000743
tcp_send_option!=$00:00082C
tcp_send_option?=$00:000832
tcp_send_options=$00:000828
tcp_send_syn=$00:0006FD
tcp_sendq=$00:0007C2
tcp_sendq2=$00:0007C3
tcp_sent_all=$00:00076E
tcp_sent_possible=$00:00076E
tcp_service_2nd_list=$00:0004FE
tcp_socket=$00:0008AD
tcp_socketx=$00:0008B2
tcp_start_timewait=$00:0008C3
tcp_startbuffer=$00:0007D7
tcp_startbuffer:addresses=00000D,00000F
tcp_startbuffer:option_string=000005,00000F
tcp_startbuffer:save_rkxy=000001,00000F
tcp_startbuffer:axw_p=000000,00000F
tcp_startbuffer:tcp_sendno_options=$00:000812
tcp_startbuffer:txp_nostart=$00:000822
tcp_states_beat=$01:000410
tcp_states_step=$00:0004ED
tcp_store_timer1=$00:0008C8
tcp_store_window=$00:000733
tcp_supercount=$01:000412
tcp_superpages=$01:000411
tcp_tbloc_found=$00:000686
tcp_textline_not_there=$00:00087E
tcp_textline_release=$00:00087A
tcp_traffic?=$00:000B97
tcp_traffic_x=$00:000B9C
tcp_tx+=$00:0000B1
tcp_txbuffer=$00:00083A
tcp_txbuffer_initial=$00:00083E
tcp_txbuffer_optional=$00:00083B
tcp_txbufferx=$00:000835
tcp_write_hvsocket_rxq=$00:000851
tcp_write_rxq=$00:000845
tcp_write_txq=$00:00085D
tcp_xaccept=$00:0005FA
tcp_xclose=$00:00089D
tcp_xclosewait=$00:0008A5
tcp_xdisco=$00:000897
tcp_xfin_upsequence=$00:0008A9
tcp_xfinwait1=$00:0008A0
tcp_xmit=$00:000776
tcp_xsegment=$00:000879
tcp_zsegment=$00:000875
tcpagent_add=$00:000452
tcpagent_add_assigned=$00:00045D
tcpagent_add_nop=$00:000469
tcpagent_add_x=$00:00046E
tcpagent_compress_address=$00:00051F
tcpagent_compress_tokens=$00:000517
tcpagent_established=$00:000529
tcpagent_established:accumulate=$00:000533
tcpagent_established:nextp=$00:000537
tcpagent_established:nextc=$00:000539
tcpagent_established:upcount=$00:00053F
tcpagent_established:next=$00:000542
tcpagent_established:along=$00:000544
tcpagent_find=$00:0004E0
tcpagent_free=$00:00046F
tcpagent_free_nop=$00:00047D
tcpagent_free_search=$00:000472
tcpagent_neta=$00:0004A9
tcpagent_neta_remote=$00:0004C0
tcpagent_noneta=$00:0004B3
tcpagent_noneta_remote=$00:0004CA
tcpagent_noport=$00:0004BF
tcpagent_noport_remote=$00:0004D6
tcpagent_nostate=$00:000491
tcpagent_port=$00:0004B4
tcpagent_port_remote=$00:0004CB
tcpagent_runout=$00:0004DD
tcpagent_search=$00:000507
tcpagent_search_as_high=$00:0004F3
tcpagent_search_exact=$00:0004D7
tcpagent_search_forward=$00:0004E3
tcpagent_search_higher=$00:0004FA
tcpagent_search_next=$00:000508
tcpagent_search_on=$00:0004EA
tcpagent_state=$00:000480
tcpagent_state!=$00:00048E
tcpagent_state_along=$00:000489
tcpagent_test_local=$00:00050D
tcpagent_test_remote=$00:000513
tcpagent_write_address=$00:00049D
tcpagent_write_oid_tokens=$00:000492
tcpagent_zerof=$00:0004EE
tcpr+=$00:0000AB
tcpz+=$00:0000AC
tdescriptor=$00:000474
tdescriptor_free=$00:00024D
tdescriptor_freex=$00:00025B
tdescriptor_high_index=$41:00304A
tdescriptor_sp_plus=$00:000259
telnet=$00:000140
telnet_align_trunk=$00:000214
telnet_atest=$00:0002CA
telnet_command=$00:000166
telnet_configuration=$00:00026E
telnet_configure=$00:000262
telnet_console=$00:000163
telnet_count=$00:000298
telnet_counted_name=$00:00029E
telnet_display_quartets=$00:00027A
telnet_echo=$00:0001D8
telnet_free_tcp_port=$00:000222
telnet_help=$00:0001A8
telnet_i=$00:000126
telnet_ilist=$00:000236
telnet_insert=$00:00026B
telnet_istring=$03:00004F
telnet_library_speedtest=$00:0001BC
telnet_memory=$00:0001DD
telnet_mirror_trunk=$00:000218
telnet_name_display=$00:00028F
telnet_name_words=$03:000088
telnet_name_z=$00:000296
telnet_norun=$00:00020A
telnet_pop2hex=:P1:0:0000B9
telnet_print_dayclock=$00:0001B2
telnet_prompt=$00:0001AB
telnet_quicktimeout=$00:0001D4
telnet_repeats=$03:000085
telnet_respond=$00:000263
telnet_run=$00:0001E9
telnet_run_binary=$00:0001F7
telnet_run_name=$03:00004F
telnet_run_report=$00:00020C
telnet_smp=$00:00021C
telnet_start=$00:00012C
telnet_start_time=$03:000086
telnet_state?=$00:000155
telnet_stream16_respond=$00:000266
telnet_test_repeat=$00:0001C0
telnet_text_command=$00:00016F
telnet_thread1=$00:000274
telnet_thread_display=$00:0002A6
telnet_thread_name=$00:000280
telnet_thread_name_clear=$00:00028C
telnet_thread_not_active=$00:00025F
telnet_thread_term=$00:000230
telnet_threadlist=$00:000271
telnet_threads=$00:0001A1
telnet_threadx=$00:000278
telnet_tpaside=$03:00000A
telnet_traffic?=$00:00015A
telnet_tstate?=$00:00013B
telnet_ufirst=$00:000259
telnet_uireqs=$00:00023C
telnet_uireqx=$00:00025B
telnet_uirnext=$00:00023F
telnet_ulast?=$00:000255
telnet_walk=$00:000143
telnet_walk_on=$00:000142
telnet_x=$00:000160
telnet_z=$00:000162
telnet_zero_timer1=$00:0001AE
telnet_zout=$00:000232
telnet_zstart=$00:00012B
teraframe=$00:00070B
teraframe:device_k=$43:000000,000003
teraframe:device_k:ts_cell=$43:000000,000003
teraframe:device_k:index=$43:000001,000003
teraframe:canister=$43:000000,000003
teraframe:canister:next=$43:000000,000003
teraframe:canister:free(1)=$43:000001,000003
teraframe:cluster=$42:000000,000002
teraframe:cluster:next=$42:000000,000002
teraframe:cluster:bank=$42:000001,000002
teraframe:array_device_claim_ii=$00:00070B
teraframe:array_device_claim=$00:00070F
teraframe:device_index=000000,00000F
teraframe:claim?=$00:000716
teraframe:zchain=$00:000727
teraframe:index_constructed=$00:000730
teraframe:claim_new=$00:00073E
teraframe:return_buffer=$00:000749
teraframe:key_free=$00:000755
teraframe:claim_next=$00:000757
teraframe:deliver=$00:000764
teraframe:teraframes_initial=$00:000769
teraframe:teraframe_reset=$00:00076D
teraframe:chain_relink=$00:000772
teraframe:chain_chase=$00:000778
teraframe:array_device_free=$00:000782
teraframe:array_cluster_free=$00:000785
teraframe:indication=000003,00000F
teraframe:bank_index=000002,00000F
teraframe:tuple_p=000001,00000F
teraframe:caller_x=000000,00000F
teraframe:indicated=$00:0007A3
teraframe:array_heap_compress=$00:0007A6
teraframe:array_into_list=$00:0007AE
teraframe:found_list_position=$00:0007B1
teraframe:find_in_freelist=$00:0007B4
teraframe:freelist_search=$00:0007BA
teraframe:list_descriptor_high=$00:0007BE
teraframe:array_device_release=$00:0007C2
teraframe:array_cluster_leave=$00:0007C4
teraframe:free_teraframes=$00:0007C8
teraframe:free_next_chain=$00:0007C9
teraframe:free_owner_chain=$00:0007CF
teraframe:free_owner_chain_out=$00:0007DC
teraframe:owner_chain_walk=$00:0007DE
teraframe:owner_chain_walk_on=$00:0007E1
teraframe:owner_chain_walk_thru=$00:0007E9
test_if=$00:000076
textoa
tflags=000004,00000F
thandle=$03:000006
this_if=$42:000000,000002
this_if:id=$42:000000,000002
this_if:flags=$42:000001,000002
this_if:address_list=$42:000002,000002
this_if:type=$42:000003,000002
this_if:mtu=$42:000004,000002
this_if:state=$42:000005,000002
this_if:bitrate=$42:000006,000002
this_if:physa=$42:000008,000002
this_if:lastchange=$42:00000A,000002
this_if:inoctets=$42:00000C,000002
this_if:outoctets=$42:00000E,000002
this_if:inpackets=$42:000010,000002
this_if:outpackets=$42:000012,000002
this_if:inmcast=$42:000014,000002
this_if:outmcast=$42:000016,000002
this_if:indrops=$42:000018,000002
this_if:outdrops=$42:00001A,000002
this_if:inerrs=$42:00001C,000002
this_if:outerrs=$42:00001E,000002
this_if:inoproto=$42:000020,000002
this_if:oqlen=$42:000022,000002
this_if:oqremaining=$42:000023,000002
this_if:threshold_time=$42:000024,000002
this_if:description=$42:000025,000002
this_if:description_bytes=$42:000026,000002
this_if:q2=$42:000027,000002
this_if:lock_cell_q1=$42:000028,000002
this_if:lock_cell_q2=$42:000029,000002
this_if:iq_rxfragments=$42:00002A,000002
this_if:fragment_engine_descriptor=$42:00002B,000002
this_if:iq_buffer=$42:00002C,000002
this_if:iq=$42:00002D,000002
this_if:iq:head=$42:00002D,000002
this_if:iq:tail=$42:00002E,000002
this_if:oq=$42:00002F,000002
this_if:oq:head=$42:00002F,000002
this_if:oq:tail=$42:000030,000002
this_if:oq2=$42:000031,000002
this_if:oq2:head=$42:000031,000002
this_if:oq2:head:bx=$42:000031,000002
this_if:oq2:head:offset=$42:000032,000002
this_if:oq2:tail=$42:000033,000002
this_if:oq2:tail:bx=$42:000033,000002
this_if:oq2:tail:offset=$42:000034,000002
this_if:initial=$42:000035,000002
this_if:rxtx_interface=$42:000036,000002
this_if:class=$42:000037,000002
this_if:llhl=$42:000038,000002
this_if:write_llh=$42:000039,000002
this_if:arp_rx=$42:00003A,000002
this_if:arp_tx=$42:00003B,000002
this_if:arp_resolve=$42:00003C,000002
this_if:xarp=$42:00003D,000002
this_if:ift1=$42:00003E,000002
this_if:ift1:rx_restart=$42:00003E,000002
this_if:ift1:rx_limit=$42:00003F,000002
this_if:ift1:tx_restart=$42:000040,000002
this_if:ift1:tx_limit=$42:000041,000002
this_if:ift1:base_rx=$42:000042,000002
this_if:ift1:rx_cursor=$42:000043,000002
this_if:ift1:base_tx=$42:000044,000002
this_if:ift1:tx_cursor=$42:000045,000002
this_if:sif=$42:00003E,000002
thread=$00:0004A9
thread_actual?=$00:00064E
thread_current?=$00:00065D
thread_final=$00:0004F4
thread_halt=$00:00012E
thread_not_actual=$00:00065C
thread_state_ii=$00:000664
thread_state_stopped=$00:00066A
thread_stopped=$00:000663
threads_down=$00:000241
threads_lock_cell=$41:003004
threads_next_down=$00:000243
threads_threshold=$00:000657
threadx_down=$00:00024C
ticko=$01:000434
timer_check=$00:000537
timer_chex=$00:00053D
tlist=$43:000000,000003
tlist:link=$43:000000,000003
tlist:free=$43:000001,000003
tlist:top=$43:000002,000003
tlist:climit=$43:000003,000003
tlist:rxbu_p=$43:000003,000003
tlist:txbu_p=$43:000004,000003
tlist:txchain=$43:000005,000003
tlist:flags=$43:000006,000003
tlist:rxowner=$43:000007,000003
tlist:chain(1)=$43:000008,000003
tlist:chain(2)=$43:000009,000003
tlist:chain(3)=$43:00000A,000003
tlist:chain(4)=$43:00000B,000003
tlist:chain(5)=$43:00000C,000003
tlist:chain(6)=$43:00000D,000003
tlist:chain(7)=$43:00000E,000003
tlist:chain(8)=$43:00000F,000003
tlist:chain(9)=$43:000010,000003
tlist:chain(10)=$43:000011,000003
tlist:chain(11)=$43:000012,000003
tlist:chain(12)=$43:000013,000003
tlist:chain(13)=$43:000014,000003
tlist:chain(14)=$43:000015,000003
tlist:chain(15)=$43:000016,000003
tlist:chain(16)=$43:000017,000003
tlist:chain(17)=$43:000018,000003
tlist:chain(18)=$43:000019,000003
tlist:chain(19)=$43:00001A,000003
tlist:chain(20)=$43:00001B,000003
tlist:chain(21)=$43:00001C,000003
tlist:chain(22)=$43:00001D,000003
tlist:chain(23)=$43:00001E,000003
tlist:chain(24)=$43:00001F,000003
tlist:chain(25)=$43:000020,000003
tlist:chain(26)=$43:000021,000003
tlist:chain(27)=$43:000022,000003
tlist:chain(28)=$43:000023,000003
tlist:chain(29)=$43:000024,000003
tlist:chain(30)=$43:000025,000003
tlist:chain(31)=$43:000026,000003
tlist:chain(32)=$43:000027,000003
tlist:connection_block(1)=$43:000028,000003
tlist:connection_block(1):next=$43:000028,000003
tlist:connection_block(1):automatic_fin=$43:000029,000003
tlist:connection_block(1):state=$43:000029,000003
tlist:connection_block(1):mss=$43:00002A,000003
tlist:connection_block(1):tsq=$43:00002B,000003
tlist:connection_block(1):timer(1)=$43:00002C,000003
tlist:connection_block(1):timer(2)=$43:00002D,000003
tlist:connection_block(1):socket_address=$43:00002E,000003
tlist:connection_block(1):remote_address=$43:000030,000003
tlist:connection_block(1):remote_ack_window=$43:000032,000003
tlist:connection_block(1):sequence_ackx=$43:000034,000003
tlist:connection_block(1):ack_window=$43:000036,000003
tlist:connection_block(1):receiveq=$43:000038,000003
tlist:connection_block(1):receiveq:head=$43:000038,000003
tlist:connection_block(1):receiveq:tail=$43:000039,000003
tlist:connection_block(1):deferq=$43:00003A,000003
tlist:connection_block(1):deferq:head=$43:00003A,000003
tlist:connection_block(1):deferq:tail=$43:00003B,000003
tlist:connection_block(1):q4window=$43:00003C,000003
tlist:connection_block(1):q4window:head=$43:00003C,000003
tlist:connection_block(1):q4window:tail=$43:00003D,000003
tlist:connection_block(1):q4ack=$43:00003E,000003
tlist:connection_block(1):q4ack:head=$43:00003E,000003
tlist:connection_block(1):q4ack:tail=$43:00003F,000003
tlist:connection_block(2)=$43:000040,000003
tlist:connection_block(2):next=$43:000040,000003
tlist:connection_block(2):automatic_fin=$43:000041,000003
tlist:connection_block(2):state=$43:000041,000003
tlist:connection_block(2):mss=$43:000042,000003
tlist:connection_block(2):tsq=$43:000043,000003
tlist:connection_block(2):timer(1)=$43:000044,000003
tlist:connection_block(2):timer(2)=$43:000045,000003
tlist:connection_block(2):socket_address=$43:000046,000003
tlist:connection_block(2):remote_address=$43:000048,000003
tlist:connection_block(2):remote_ack_window=$43:00004A,000003
tlist:connection_block(2):sequence_ackx=$43:00004C,000003
tlist:connection_block(2):ack_window=$43:00004E,000003
tlist:connection_block(2):receiveq=$43:000050,000003
tlist:connection_block(2):receiveq:head=$43:000050,000003
tlist:connection_block(2):receiveq:tail=$43:000051,000003
tlist:connection_block(2):deferq=$43:000052,000003
tlist:connection_block(2):deferq:head=$43:000052,000003
tlist:connection_block(2):deferq:tail=$43:000053,000003
tlist:connection_block(2):q4window=$43:000054,000003
tlist:connection_block(2):q4window:head=$43:000054,000003
tlist:connection_block(2):q4window:tail=$43:000055,000003
tlist:connection_block(2):q4ack=$43:000056,000003
tlist:connection_block(2):q4ack:head=$43:000056,000003
tlist:connection_block(2):q4ack:tail=$43:000057,000003
tlsoc_va=$03:000008
tn_add=$00:0002EA
tn_div=$00:0002F6
tn_edit=$00:0002F9
tn_editline=$03:000037
tn_help=$03:00000B
tn_help_bytes=000084
tn_left=000006,00000F
tn_mul=$00:0002F2
tn_negadd=$00:0002EE
tn_operate=$00:0002DE
tn_operation=000000,00000F
tn_ostringp=000010,00000F
tn_right=000002,00000F
tn_tight_repeat=000001,00000F
tnet_callstring
tnetbound=$03:000007
tnext=000006,00000F
token_net=[002a]000000
tokena
tq_align(1)=$41:00304B
tq_align(2)=$41:00304C
tq_align(3)=$41:00304D
tq_align(4)=$41:00304E
tq_align(5)=$41:00304F
tra_remote_ack=000006,00000F
transfer=$42:000000,000002
transfer:sourcep=$42:000000,000002
transfer:destp=$42:000001,000002
transfer:seq=$42:000002,000002
transfer:ack=$42:000004,000002
transfer:hl_code=$42:000006,000002
transfer:window=$42:000007,000002
transfer:checksum=$42:000008,000002
transfer:urgent=$42:000009,000002
transfer:mss_option=$42:00000A,000002
transfer_fp=000002,00000F
transmission=$46:000000,000002
transmission:next=$46:000000,000002
transmission:automatic_fin=$46:000001,000002
transmission:state=$46:000001,000002
transmission:mss=$46:000002,000002
transmission:tsq=$46:000003,000002
transmission:timer(1)=$46:000004,000002
transmission:timer(2)=$46:000005,000002
transmission:socket_address=$46:000006,000002
transmission:remote_address=$46:000008,000002
transmission:remote_ack_window=$46:00000A,000002
transmission:sequence_ackx=$46:00000C,000002
transmission:ack_window=$46:00000E,000002
transmission:receiveq=$46:000010,000002
transmission:receiveq:head=$46:000010,000002
transmission:receiveq:tail=$46:000011,000002
transmission:deferq=$46:000012,000002
transmission:deferq:head=$46:000012,000002
transmission:deferq:tail=$46:000013,000002
transmission:q4window=$46:000014,000002
transmission:q4window:head=$46:000014,000002
transmission:q4window:tail=$46:000015,000002
transmission:q4ack=$46:000016,000002
transmission:q4ack:head=$46:000016,000002
transmission:q4ack:tail=$46:000017,000002
transmission_p=000003,00000F
transmit_socket_protocol_wrong=$00:000C0A
transmit_socket_status=$00:000BFD
transmit_socket_x=$00:000C0B
transmit_socket_y=$00:000BFA
trig192=$00:0007D3
trig192:RECIPROCAL_READY=000001
trig192:_RADIAN_FACTOR=3FFFFB8EFA351294E9C8AE0EC5F66E9485C4D900B8
trig192:_PASSES=000012
trig192:sine=$00:0007D3
trig192:sine:angle=000007,00000F
trig192:sine:u_rkxy=000000,00000F
trig192:cosine=$00:0007DA
trig192:cosine:angle=000007,00000F
trig192:cosine:u_rkxy=000000,00000F
trig192:tangent=$00:0007EB
trig192:tangent:angle=00000F,00000F
trig192:tangent:cosine=000004,00000F
trig192:tangent:u_rkxy=000000,00000F
trig192:cotangent=$00:000802
trig192:cotangent:angle=00000F,00000F
trig192:cotangent:sine=000004,00000F
trig192:cotangent:u_rkxy=000000,00000F
trig192:_sine=$00:000819
trig192:anglep=000012,00000F
trig192:power=000008,00000F
trig192:square=000000,00000F
trig192:_NEXT_FACTORIAL=:P1:0:0000C2
trig192:_NEXT_POWER=:P1:0:0000C3
trig192:_poly=$00:000840
trig192:_nomial=$00:00085D
trig192:_radian_factor=$00:000876
trig192:trim=$00:00087E
trig192:trimmed=$00:00088C
trig192:eliminate_microdust=$00:00088E
trig192:eliminate_normalised=$00:000892
trig192:eliminated=$00:00089C
trig192:encircle=$00:00089E
trig192:degreep=00000A,00000F
trig192:downward=000000,00000F
trig192:magnitude_obtained=$00:0008A5
trig192:encircled=$00:0008B2
trig192:q360=$00:0008B5
trig192:reciprocal_factorials=$00:0008BF
trig96=$00:0009E7
trig96:_RADIAN_FACTOR=3FFFFB8EFA351294E9C8AE0F
trig96:_PASSES=00000B
trig96:sine=$00:0009E7
trig96:sine:angle=00000B,00000F
trig96:sine:u_8=000004,00000F
trig96:sine:u_rkxy=000000,00000F
trig96:cosine=$00:0009F0
trig96:cosine:angle=00000B,00000F
trig96:cosine:u_8=000004,00000F
trig96:cosine:u_rkxy=000000,00000F
trig96:tangent=$00:0009FC
trig96:tangent:angle=00000F,00000F
trig96:tangent:cosine=000008,00000F
trig96:tangent:u_8=000004,00000F
trig96:tangent:u_rkxy=000000,00000F
trig96:cotangent=$00:000A0D
trig96:cotangent:angle=00000F,00000F
trig96:cotangent:sine=000008,00000F
trig96:cotangent:u_8=000004,00000F
trig96:cotangent:u_rkxy=000000,00000F
trig96:_sine=$00:000A1E
trig96:anglep=000012,00000F
trig96:power=00000C,00000F
trig96:square=000008,00000F
trig96:factorial=000004,00000F
trig96:factor=000000,00000F
trig96:_NEXT_FACTORIAL=:P1:0:0000C4
trig96:_NEXT_POWER=:P1:0:0000C5
trig96:_poly=$00:000A30
trig96:_nomial=$00:000A4A
trig96:trim=$00:000A56
trig96:trimmed=$00:000A62
trig96:eliminate_microdust=$00:000A64
trig96:eliminate_normalised=$00:000A68
trig96:eliminated=$00:000A70
trig96:encircle=$00:000A72
trig96:degreep=000002,00000F
trig96:magnitude_found=$00:000A77
trig96:encircled=$00:000A81
tripl2float
troutine=000005,00000F
tseq=000003,00000F
twait_ii=$00:00052E
tx_nocheck=$00:000469
tx_payload=$00:000419
txbloc_p=000001,00000F
txbuf=00000C,00000F
txbytes=00000D,00000F
txflags=00000E,00000F
txq_p=000000,00000F
txsum1?=$00:0004BF
txsum4!=$00:0004B7
txsum4?=$00:0004B9
txsum64!=$00:0004A0
txsum64?=$00:0004B4
txsumx=$00:0004C3
txsumz=$00:0004C4
udgram=:N129:P:0:000000
udgram_acw_send_nocheck+=$00:0000B3
udgram_rbloc=$00:000DA2
udgram_rbuffer=$00:000D9D
udgram_rbuffer_x=$00:000DA7
udgram_read=$00:000DB1
udgram_readx=$00:000DC0
udgram_write=$00:000DC3
udp4=$00:00034F
udp4_x=$00:000362
udpInDatagrams=$00:0008DA
udpInDatagrams:rw_typ_tokens_words=$00:0008DA
udpInDatagrams:o=$00:0008DB
udpInDatagrams:l=$00:0008DC
udpInDatagrams:data=$00:0008DD
udpInDatagrams:flags=$00:0008DE
udpInDatagrams:bucket=$00:0008DF
udpInDatagrams:ranges=$00:0008DF
udpInDatagrams:range=$00:0008E0
udpInDatagrams:advance=$00:0008E0
udpInDatagrams:netstring=:N129:P:0:000000
udpInDatagrams:i=$01:000578
udpInErrors=$00:0008E6
udpInErrors:rw_typ_tokens_words=$00:0008E6
udpInErrors:o=$00:0008E7
udpInErrors:l=$00:0008E8
udpInErrors:data=$00:0008E9
udpInErrors:flags=$00:0008EA
udpInErrors:bucket=$00:0008EB
udpInErrors:ranges=$00:0008EB
udpInErrors:range=$00:0008EC
udpInErrors:advance=$00:0008EC
udpInErrors:netstring=:N129:P:0:000000
udpInErrors:i=$01:00057B
udpLocalAddress=$00:0008F2
udpLocalAddress:rw_typ_tokens_words=$00:0008F2
udpLocalAddress:o=$00:0008F3
udpLocalAddress:l=$00:0008F4
udpLocalAddress:data=$00:0008F5
udpLocalAddress:flags=$00:0008F6
udpLocalAddress:bucket=$00:0008F7
udpLocalAddress:ranges=$00:0008F7
udpLocalAddress:range=$00:0008F8
udpLocalAddress:advance=$00:0008F8
udpLocalAddress:netstring=:N129:P:0:000000
udpLocalPort=$00:0008F8
udpLocalPort:rw_typ_tokens_words=$00:0008F8
udpLocalPort:o=$00:0008F9
udpLocalPort:l=$00:0008FA
udpLocalPort:data=$00:0008FB
udpLocalPort:flags=$00:0008FC
udpLocalPort:bucket=$00:0008FD
udpLocalPort:ranges=$00:0008FD
udpLocalPort:range=$00:0008FE
udpLocalPort:advance=$00:0008FE
udpLocalPort:netstring=:N129:P:0:000000
udpNoPorts=$00:0008E0
udpNoPorts:rw_typ_tokens_words=$00:0008E0
udpNoPorts:o=$00:0008E1
udpNoPorts:l=$00:0008E2
udpNoPorts:data=$00:0008E3
udpNoPorts:flags=$00:0008E4
udpNoPorts:bucket=$00:0008E5
udpNoPorts:ranges=$00:0008E5
udpNoPorts:range=$00:0008E6
udpNoPorts:advance=$00:0008E6
udpNoPorts:netstring=:N129:P:0:000000
udpNoPorts:i=$01:00057A
udpOutDatagrams=$00:0008EC
udpOutDatagrams:rw_typ_tokens_words=$00:0008EC
udpOutDatagrams:o=$00:0008ED
udpOutDatagrams:l=$00:0008EE
udpOutDatagrams:data=$00:0008EF
udpOutDatagrams:flags=$00:0008F0
udpOutDatagrams:bucket=$00:0008F1
udpOutDatagrams:ranges=$00:0008F1
udpOutDatagrams:range=$00:0008F2
udpOutDatagrams:advance=$00:0008F2
udpOutDatagrams:netstring=:N129:P:0:000000
udpOutDatagrams:i=$01:00057D
udp_acw_send+=$00:0000B7
udp_agent1+=$00:000246
udp_agent2+=$00:000247
udp_auto_connect=$00:000DA8
udp_buy_txaw=$00:0003D2
udp_buy_txaw_optional=$00:0003D3
udp_check_payload_tx=$00:0004C9
udp_drop_dgram=$00:0004E3
udp_exact=$00:000377
udp_ip_send=$00:000403
udp_iquick=$00:000392
udp_ldgram_noport=$01:00040D
udp_next=$00:000350
udp_noqdata=$00:0004D8
udp_noresponseb=$00:000418
udp_nosocket_rxgrams=$01:00040C
udp_nosource=$00:000408
udp_qup=$00:0003CA
udp_rbuffer_y=$00:000D95
udp_read_rxq=$00:0004D9
udp_response_buffer=$00:00040A
udp_rtxbuffer+=$00:0000B4
udp_rx_payload=$00:000465
udp_rxq=$00:000363
udp_rxqlong=$00:00039F
udp_rxqthru=$00:000395
udp_send+=$00:0000B5
udp_socket=$00:0004E6
udp_socket?=$00:000380
udp_socket_closed=$00:00035F
udp_socketx=$00:0004EC
udp_store=$00:0003CC
udp_traffic?=$00:000B91
udp_traffic_x=$00:000B96
udp_tx_payload=$00:000465
udp_txaw=$00:0003E0
udp_txaw_nocheck=$00:0003F9
udp_txbuffer+=$00:0000B6
udp_txbx=$00:0003DF
udp_uportbound?=$00:0003A3
udp_wait?=$00:000BA8
udp_write_rxq=$00:0004CD
udpagent_direct=$00:000265
udpagent_eosearch=$00:00029A
udpagent_locate=$00:00027D
udpagent_net=$00:00024D
udpagent_netagain=$00:000255
udpagent_netresult=$00:00025B
udpagent_next_bank=$00:000295
udpagent_next_port=$00:000290
udpagent_nodirect=$00:000271
udpagent_nofind=$00:000298
udpagent_nohit=$00:00025D
udpagent_nohitp=$00:000264
udpagent_port=$00:00025E
udpagent_search_equal=$00:00027C
udpagent_search_forward=$00:000274
udpagent_search_on=$00:000289
udpagent_start_search=$00:000285
udpagent_start_tree=$00:000283
udpq+=$01:00040A
udpq:head=$01:00040A
udpq:tail=$01:00040B
uflags=000004,00000F
unbase_deviceb_ii=$00:0006AF
unbase_socketb_ii=$00:0006B2
unbase_standard_netbuf_ii=$00:0006B5
unbind=$00:0000A1
unconditionally=$00:000314
uq_head=$41:0030EE
uq_tail=$41:0030EF
uroutine=000005,00000F
useq=000003,00000F
usocket=$00:00059F
usocket_c_ii=$00:000587
usocket_ii=$00:000591
usocket_nane=$00:0005A4
usocket_no_protocol=$00:00059C
uugram=$47:000000,00000F
uugram:sourcep=$47:000000,00000F
uugram:destp=$47:000001,00000F
uugram:udgraml=$47:000002,00000F
uugram:checksum=$47:000003,00000F
v64=:N129:P:0:000000
w2buffer=$00:000CBE
w2buffer_nocheck=$00:000DC6
w2nocheck32!=$00:000DCA
w2nocheck32?=$00:000DEB
w2nocheckbyte=$00:000DFA
w2nocheckpair!=$00:000DF1
w2nocheckpair?=$00:000DF4
wcaller_8_11=000000,00000F
wpair_nocheck=:P1:0:000079
wphysa=:N129:P:0:000000
write_avector_ii=$00:0005BC
write_ifq
write_ifqlist
write_ifqlist_head
write_trail=$00:000276
write_xint_table=$00:0000A9
write_xint_wcursor=$00:0000BA
write_xint_wrap=$00:0000B9
write_xvector_ii=$00:0005C6
wrong_pool=$00:000E8F
wstream_registers=000004,00000F
wstream_start_net
wstream_starta
x48d48=$00:000DE9
x48d48:divisor=000003,00000F
x48m24=$00:000D92
x48m24:multiplier=000003,00000F
x48m48=$00:000DA0
x48m48:multiplier=000003,00000F
x72_aU+=$00:000153
x72_anU+=$00:000154
x72_andU+=$00:00014E
x72_d48_48+=$00:00015B
x72_d72_24+=$00:00015A
x72_d72_48+=$00:00015C
x72_d72_72+=$00:00015D
x72_m48_24+=$00:000155
x72_m48_48+=$00:000157
x72_m72_24+=$00:000156
x72_m72_48+=$00:000158
x72_m72_72+=$00:000159
x72_orU+=$00:00014D
x72_sa+=$00:000151
x72_sl+=$00:000152
x72_xorU+=$00:00014F
x72_xtend+=$00:000150
x72andu=$00:000E80
x72andu:uwords=000006,00000F
x72andu:signs_length=000008,00000F
x72andu:ab=000001,00000F
x72andu:caller_x=000000,00000F
x72anu=$00:000D83
x72anu:subtrahend2w=000008,00000F
x72anu:signs_length=00000A,00000F
x72anu:carry=000003,00000F
x72anu:i47_0=000001,00000F
x72anu:caller_x=000000,00000F
x72au=$00:000D76
x72au:addend2w=000008,00000F
x72au:signs_length=00000A,00000F
x72au:carry=000003,00000F
x72au:i47_0=000001,00000F
x72au:caller_x=000000,00000F
x72d24=$00:000DD8
x72d24:divisor=000007,00000F
x72d24:remainderp=000008,00000F
x72d24:quotient=000002,00000F
x72d24:quotientu=000000,00000F
x72d48=$00:000DEF
x72d48:divisor48=000014,00000F
x72d48:divisor=00000D,00000F
x72d48:caller8_11=000009,00000F
x72d48:dividend=000007,00000F
x72d48:dividendu=000005,00000F
x72d48:caller_rkxy=000001,00000F
x72d48:save_fpguard=000000,00000F
x72d72=$00:000E08
x72d72:divisorp=000012,00000F
x72d72:divisor=00000B,00000F
x72d72:caller_891011=000007,00000F
x72d72:dividend=000005,00000F
x72d72:dividendu=000003,00000F
x72d72:caller_rkxy=000001,00000F
x72d72:save_fpguard=000000,00000F
x72m24=$00:000D98
x72m24:multiplier=000003,00000F
x72m48=$00:000DA6
x72m48:multiplier_i48=000014,00000F
x72m48:multiplier=00000D,00000F
x72m48:caller891011=000009,00000F
x72m48:multiplicand=000007,00000F
x72m48:multiplicand_u=000005,00000F
x72m48:caller_rkxy=000001,00000F
x72m48:mguard=000000,00000F
x72m72=$00:000DBF
x72m72:multiplierp=000014,00000F
x72m72:multiplier=00000D,00000F
x72m72:caller_891011=000009,00000F
x72m72:multiplicand=000007,00000F
x72m72:multiplicand_u=000005,00000F
x72m72:muser_rkxy=000001,00000F
x72m72:mguard=000000,00000F
x72oru=$00:000E74
x72oru:uwords=000006,00000F
x72oru:signs_length=000008,00000F
x72oru:ab=000001,00000F
x72oru:caller_x=000000,00000F
x72sa=$00:000E49
x72sa:countR=000007,00000F
x72sa:caller_89=000002,00000F
x72sa:caller_xy=000000,00000F
x72sa:sa_again=$00:000E50
x72sa:sa_round=$00:000E5D
x72sa:sa_return=$00:000E61
x72sa:sa_pushdown_store=$00:000E66
x72sl=$00:000E21
x72sl:countL=000007,00000F
x72sl:usr89=000002,00000F
x72sl:usrxy=000000,00000F
x72sl:sl_again=$00:000E26
x72sl:sl_round=$00:000E32
x72sl:sl_return=$00:000E36
x72sl:sl_pullup_store=$00:000E3B
x72xoru=$00:000E8C
x72xoru:uwords=000006,00000F
x72xoru:signs_length=000008,00000F
x72xoru:ab=000001,00000F
x72xoru:caller_x=000000,00000F
x72xtend=$00:000D70
xaccept+=$00:0000A8
xarp=$00:000F66
xbase(32)=$00:0004F5
xbase(33)=$00:0004FC
xbase(34)=$00:000503
xbase(35)=$00:00050A
xdisco+=$00:0000A9
xdr_inopaque24
xdr_outopaque24
xint_bind_ii=$00:000608
xint_free=$00:000633
xint_free_in=$00:000639
xint_free_out=$00:000638
xint_out=$00:000615
xitable=$45:000000,000005
xitable:lock_cell=$45:000000,000005
xitable:rcursor=$45:000001,000005
xitable:wcursor=$45:000002,000005
xitable:limit=$45:000003,000005
xitable:xint=$45:000004,000005
xmitted=000001,00000F
xrelay_reset
xtcp4=$00:0004F1
xvector_in_range=$00:0005AE
xvector_low_threshold=$00:0005B2
xvector_outwith_range=$00:0005B1
xy=000000,00000F
yield=$00:0002AB
zdevice=$00:0000D9
zeta_ii=$00:000627
zeta_ii_no_op=$00:000630
zeta_ii_user_refp=$00:000630
../mib/loadp2.msm=4<000008
../mib/loadplan.msm=3<000007
../mib/../arp.ext/arp_enet.def=4<000008
../mib/at_lib.msm=3<000007
../mib/atagent.msm=3<000007
../mib/idragent.msm=3<000007
../mib/tcpagen2.msm=3<000007
../mib/tcpagent.msm=3<000007
../mib/roagent.msm=3<000007
../mib/ipagent.msm=3<000007
../mib/ifagent.msm=3<000007
../mib/udpagent.msm=3<000007
../mib/mib2tick.msm=3<000007
../mib/mib-II.msm=3<000007
../netapps2/sysinfo.msm=3<000007
../netapps2/../lib/x72_48if.msm=3<000007
../netapps2/subagent.msm=3<000007
../mib/sequo.msm=3<000007
../mib/ber.msm=3<000007
../mib/snmpv1.msm=3<000007
../apps.lib/trig96.msm=3<000007
../apps.lib/rfactori.msm=4<000008
../apps.lib/trig192.msm=3<000007
../apps.lib/aplib96.msm=3<000007
../apps.lib/aplib192.msm=3<000007
../fponline/fponline.msm=3<000007
..//lib/aquiform.def=4<000008
../netapps2/iserver1.msm=3<000007
../netapps2/http.msm=3<000007
../netapps2/normal_s.msm=3<000007
../netapps2/startups.msm=3<000007
../netapps2/search_x.msm=3<000007
../netapps2/telnet.msm=3<000007
../netapps2/fp_react.msm=3<000007
../netapps2/fpser192.msm=3<000007
../netapps2/fpserver.msm=3<000007
../netapps2/a_protos.msm=3<000007
../netapps2/athreads.msm=3<000007
../netapps2/../stream/stream.def=3<000007
../netapps2/../def.app/iframes.def=3<000007
../netapps2/../fponline/fponline.def=3<000007
../netapps2/../array.app/array.def=3<000007
../netapps2/../lib/octopop.def=3<000007
../netapps2/../lib/ascii.def=3<000007
../netapps2/../lib/144.def=3<000007
../netapps2/../lib/i72.def=3<000007
../netapps2/../lib/alib.def=3<000007
../netapps2/../lib/register.def=3<000007
../netapps2/ap_bank.msm=2<000006
../t77.4/multiarp.msm=2<000006
../t77.4/preport.msm=2<000006
../t77.4/icapsule.msm=2<000006
../t77.4/tcp_lib.msm=2<000006
../t77.4/bind.msm=2<000006
../t77.4/dq.msm=2<000006
../t77.4/route_if.msm=2<000006
../t77.4/tcp_add.msm=3<000007
../t77.4/rwsocket.msm=2<000006
../t77.4/connect.msm=2<000006
../t77.4/socket.msm=2<000006
../t77.4/tcp4ruti.msm=3<000007
../t77.4/tcp.msm=2<000006
../t77.4/anomaly.msm=2<000006
../t77.4/udp.msm=2<000006
../t77.4/icmp.msm=2<000006
../t77.4/ip_q2.msm=2<000006
../t77.4/overhaul.msm=2<000006
../t77.4/netaddr.msm=3<000007
../t77.4/routes.msm=3<000007
../t77.4/k.def=3<000007
../t77.4/ipv4.msm=2<000006
../t77.4/net_buff.msm=2<000006
../t77.4/net_bank.msm=2<000006
../t77.4/i_f.msm=2<000006
../t77.4/a_protos.def=3<000007
../t77.4/networks.msm=2<000006
../t77.4/../fs/response.def=2<000006
../t77.4/../drivers/routecfg.def=2<000006
../t77.4/../drivers/ifconfig.def=2<000006
../t77.4/../mib/ber.def=2<000006
../t77.4/../mib/template.def=2<000006
../t77.4/../mib/mib-II.def=2<000006
../t77.4/pointers.def=2<000006
../t77.4/lockfree.def=2<000006
../t77.4/window.def=2<000006
../t77.4/tcp.def=2<000006
../t77.4/udp.def=2<000006
../t77.4/socket.def=2<000006
../t77.4/icmp.def=2<000006
../t77.4/route.def=2<000006
../t77.4/ipv4.def=2<000006
../t77.4/ip.def=2<000006
../t77.4/arp.def=2<000006
../t77.4/net_bank.def=2<000006
../t77.4/net_buff.def=2<000006
../t77.4/i_f.def=2<000006
../t77.4/networks.def=2<000006
../t77.4/ll.def=2<000006
../t77.4/dq.def=2<000006
../t77.4/t77.msm=1<000005
../teraframe/dframe.msm=1<000005
../teraframe/device1a.msm=1<000005
timer.msm=1<000005
events.msm=1<000005
xiobase.msm=1<000005
threadp.msm=1<000005
measure.msm=1<000005
memory.msm=1<000005
../timer/timer.msm=1<000005
../teraframe/device_a.def=1<000005
../language/stack.def=1<000005
../fs/ustream.def=1<000005
../fs/fs24.def=1<000005
../fs/fs.def=1<000005
../timer/timer.def=1<000005
../def.sys/events.def=1<000005
../def.sys/banks.def=1<000005
../def.sys/base.def=1<000005
../def.sys/io.def=1<000005
../def.sys/tcb.def=1<000005
../def/ringfest.def=1<000005
../def/vector.def=1<000005
../def/ii.def=1<000005
../def/rta.def=1<000005
image.msm=0<000003
:$(00):009000:009C7A :$(01):000000:0005F4 :$(02):002000:003000 :$(03):000000:0026B8 :$(41):003000:0030F2 :$(42):000000:000008 :$(43):000000:000006 :$(45):000000:000400 :$(47):000000:00000D 
image.msm: object code 127847 bytes: 0 errors: 86 undefined labels
MASMX 7r3A Build 12
3/minimal.msm
system.txo:$(0) 3194 words decimal from hexadecimal 009000 to 009C7A
system.txo:$(1) 1524 words decimal from hexadecimal 001000 to 0015F4
system.txo:$(2) 4096 words decimal from hexadecimal 002000 to 003000
system.txo:$(3) 9912 words decimal from hexadecimal 003000 to 0056B8
system.txo:$(65) 242 words decimal from hexadecimal 003000 to 0030F2
../drivers/drivers.txo:$(0) 2210 words decimal from hexadecimal 004000 to 0048A2
../drivers/drivers.txo:$(1) 64 words decimal from hexadecimal 0015F4 to 001634
../drivers/drivers.txo:$(2) 4096 words decimal from hexadecimal 002000 to 003000
../lib/xdr_lib8.txo:$(0) 3223 words decimal from hexadecimal 008000 to 008C97
../fs/fs.txo:$(0) 2818 words decimal from hexadecimal 007000 to 007B02
../fs/fs.txo:$(1) 68 words decimal from hexadecimal 001634 to 001678
../fs/fs.txo:$(2) 4096 words decimal from hexadecimal 002000 to 003000
*EOF*
  :                            1 .       
  :                            2 .    Copyright Tim Cox, 2012
  :                            3 .    TimMilesCox@gmx.ch
  :                            4 .
  :                            5 .    This file is instruction code for the freeware processor architecture
  :                            6 .
  :                            7 .                RTA1
  :                            8 .
  :                            9 .    RTA1 is a free processor architecture specification.
  :                            10 .
  :                            11 .    The executable emulation of RTA1 is free software.
  :                            12 .
  :                            13 .    This instruction code for the target RTA1 architecture is free software
  :                            14 .
  :                            15 .    Software programs delivered with this software to connect the
  :                            16 .    emulated RTA1 with real network interfaces in the emulator host
  :                            17 .    are free software
  :                            18 .
  :                            19 .    Scripts and programs delivered with this software for running
  :                            20 .    on other computers and interacting with the RTA1 are free software
  :                            21 .
  :                            22 .    Scripts and utility programs for constructing RTA1 target
  :                            23 .    executable software are free software      
  :                            24 .
  :                            25 .    You can redistribute it and/or modify RTA1
  :                            26 .    under the terms of the GNU General Public License as published by
  :                            27 .    the Free Software Foundation, either version 3 of the License, or
  :                            28 .    (at your option) any later version.
  :                            29 .
  :                            30 .    RTA1 is distributed in the hope that it will be useful,
  :                            31 .    but WITHOUT ANY WARRANTY; without even the implied warranty of
  :                            32 .    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  :                            33 .    GNU General Public License for more details.
  :                            34 .
  :                            35 .    You should have received a copy of the GNU General Public License
  :                            36 .    along with RTA1.  If not, see <http://www.gnu.org/licenses/>.
  :                            37 .
  :                            38 .
  :                            39 
  :                            40: 	$include		../def/map1.def
  :                            41: 	$include		../def.sys/banks.def	
  :                            42 
  :                            43 
  :                            44 $(1:01000)
  :                            45 $(3:03000)
  :                            46 
  :                            47: 	$include, $binary	system
  :                            48: 	$include, $binary	../drivers/drivers
  :                            49 
  :                            50: 	$include, $binary	../lib/xdr_lib8
  :                            51: 	$include, $binary	../fs/fs
  :                            52 
  :                            53 
  :                            54 SUMMIT$3*	$equ	$zenith(3)
  :                            55 	$store			absolute
*EOF*
$map=:N129:P:0:000000
MICRO_IMAGE=000001
IPV4_BANK=002000
IPV4_B1_INITIAL_BANK=003000
A_PROTOS_B3_INITIAL_BANK=003800
DRIVERS_BANK1=004000
A_PROTOS_BANK1=005000
LIBRARY_XDR=006000
FS24_BANK=007000
ASCII_LIB1=008000
A_PROTOS_BANK2=009000
NET_XBANK=00A000
DRIVERS_BANK2=00C000
APP1_BANK=00E000
CORE_FS1_BANK=00F000
APPLICATION_BASE=00A000
$SMP+=00007E
$ZETA+=00007C
$if0p+=$01:001000
$if2p+=$01:001002
$ifzp+=$01:001009
$sockif+=000A1B
A$IDX+=000073
B$IDX+=000074
CACHE_NETB$+=00006C
DFRAME$+=000064
DFRAME$FREE+=000065
ENERGY$+=00007D
FILE$HANDLE+=00007B
FO$FRAME+=000079
FO$HEAP+=00007A
FREE_DEVB$+=00006E
FREE_NETB$+=000070
FREE_SOCKB$+=00006F
IFNUMBER_I+=$01:0014FD
INTERFACES_HIGH_INDEX+=$01:0011F4
IPINDISCARDS_I+=$01:00150A
IPREASMFAILS_I+=$01:001519
IP_NEXT_DGRAM_ID+=$01:00150E
NET2SYM$+=000071
ON_NETB$+=00006D
TERAFRAME$+=000077
THREAD$STATE+=000072
USOCKET$+=000078
__accept+=00008F
__bind+=000082
__connect+=000083
__disconnect_free_tcp+=000095
__free_tcp_port+=000094
__net_disengage+=000091
__port_disengage+=000092
__port_disengage_udp+=000093
__route+=000088
__socket+=000081
__tcp_connect+=00008C
__tcp_socket+=000096
ack_request+=000097
agent2+=000146
app_protos+=000160
app_threads+=00015F
bind+=000085
connect+=000084
cosine192+=000175
cosine96+=000179
cotangent192+=000177
cotangent96+=00017B
cube192+=00017E
cube_root192+=00017F
far_initpool+=000099
far_q2+=00009D
far_readq+=00009C
fraction192+=000170
fraction96+=000172
frame_to_protocol+=000098
if_buy1+=00009B
if_q2ifree+=00009E
if_rx_nocheck+=00009F
if_sell1+=00009A
if_tx_nocheck+=00009F
initial_startups+=00014B
integer192+=000171
integer96+=000173
ip$sendx+=00013E
ipsend+=00008B
ipv4_4us?+=0000A0
ipv4_rxz+=0001E1
ipv4_this_host?+=0000A2
ipv4_this_if?+=0000A1
mib+=$03:0034CD
mib2ticks+=000245
mib_get+=000240
mib_getnext+=000241
mib_line+=000244
mib_set+=000242
mib_start+=000243
net_afree+=$01:00132F
net_alexical+=$01:00132E
net_alock+=$01:00132D
normal_string+=00014C
online_xqt+=000149
recv+=000089
release_udgram+=000087
route_free+=$01:00123B
route_lexical+=$01:00123C
route_list+=$01:00123A
run_start+=00014A
send+=00008A
sense_data+=000090
sine192+=000174
sine96+=000178
snmp_agent+=000146
square192+=00017C
square_root192+=00017D
strilw+=0002B1
subagent+=000147
subagent?+=000148
sysinfo+=00015E
tangent192+=000176
tangent96+=00017A
tcp_accept+=00008D
tcp_addx+=0000B2
tcp_hash_connection+=0000AF
tcp_hash_localsocket+=0000AE
tcp_release_rxline+=0000AD
tcp_rx+=0000B0
tcp_rx_ready+=000086
tcp_tx+=0000B1
tcpr+=0000AB
tcpz+=0000AC
udgram_acw_send_nocheck+=0000B3
udp_acw_send+=0000B7
udp_agent1+=000246
udp_agent2+=000247
udp_rtxbuffer+=0000B4
udp_send+=0000B5
udp_txbuffer+=0000B6
udpq+=$01:00140A
x72_aU+=000153
x72_anU+=000154
x72_andU+=00014E
x72_d48_48+=00015B
x72_d72_24+=00015A
x72_d72_48+=00015C
x72_d72_72+=00015D
x72_m48_24+=000155
x72_m48_48+=000157
x72_m72_24+=000156
x72_m72_48+=000158
x72_m72_72+=000159
x72_orU+=00014D
x72_sa+=000151
x72_sl+=000152
x72_xorU+=00014F
x72_xtend+=000150
xaccept+=0000A8
xdisco+=0000A9
$initial_ift1+=000102
$light_flight+=000103
$rxtx_ift1+=000101
$rxtx_lo+=000100
BROADCAST_AND_MAXREASM
ENET_HASH_LIST+=$01:0015F6
ENET_POINTER_ARRAY+=$01:001628
SUMMIT$3+=0056B8
__ifconfig+=000108
__ift2_align+=000113
__ift2_mirror+=000114
__initial_ift2+=000111
__route_config+=00010E
__rxtx_ift2+=000112
__sprintf+=0001D9
d48_48+=0001A2
date_timef3+=000224
display_quartets+=000221
fedit192a+=000210
fedita+=00020E
feditia+=00020F
fgets_datafile+=0001E5
fileshare_assign+=0001E9
fileshare_space_open+=0001E7
float2i72+=00019E
forward_callstring+=000229
fp192_add+=00018E
fp192_add_negative+=00018F
fp192_divide+=000193
fp192_load+=00018C
fp192_load_negative+=00018D
fp192_mfa+=000191
fp192_multiply+=000192
fs24_open+=0001C7
fs_dsearch+=0001C3
fs_find+=0001C2
fs_xbase+=0001C4
fscan192a+=000208
fscana+=000206
fspath+=0001C5
fsymbola+=000207
hvsocket_storage+=000130
hvsocket_write_rxq+=000138
i48_2float+=00019F
i72_divide+=000195
i72_multiply+=000194
id72_72+=0001A5
iedit48a+=000215
iedit48as+=000216
iedit48ua+=000214
iedit72a+=000218
iedit72as+=000219
iedit72ua+=000217
iedita+=000212
ieditas+=000213
ieditua+=000211
im72_72+=0001A4
iscan48a+=00020B
iscan72a+=00020C
iscan_skipa+=000209
iscana+=00020A
jumboq2+=00011C
locate_interfaces+=00011A
m48_24+=0001A0
m48_48+=0001A1
minimald
qstart+=0001D1
rasm_time+=00011E
rasmgram+=00011B
rstream_scana+=000204
rstream_start_net+=000200
rstream_starta+=000202
scanhex+=00021B
seg$load+=0001CD
textoa+=00021A
tnet_callstring+=00013A
tokena+=00020D
tripl2float+=0001A3
write_ifq+=000110
write_ifqlist+=00010F
write_ifqlist_head+=000117
wstream_start_net+=000201
wstream_starta+=000203
xdr_inopaque24+=0001BA
xdr_outopaque24+=0001BB
xrelay_reset+=00010D
ETHERNET_ARP_ARPQ_HEAD+=$01:0015F4
__buy12_bytes+=000116
__buy6_bytes+=000115
__recheck+=000118
arp_ether_reso+=000109
arp_ether_rx+=00010C
arp_ether_xmit+=00010A
connection_array+=000135
dlt_e10mb+=000107
dlt_loop+=000106
dlt_null+=000105
g_checksum+=00011D
hvsocket_close+=000137
hvsocket_readq+=000134
hvsocket_rx+=000132
hvsocket_tx+=000133
hvsocket_xbind+=000136
hvsockets_bind+=000131
if_dualport_txwrite+=000104
tcp_record+=000139
tcp_timer(1)+=00013B
tx_mib_update+=000119
xarp_ethernet+=00010B
u72tofloat+=000180
fraction6_7+=000181
madd144+=000182
floating_scale192+=000183
floating_scale+=000184
fraction3+=000185
fraction6+=000186
scale_out192+=000187
scale_out+=000188
align192+=000189
scale_integrate+=00018A
n72comp2+=00018B
reciprocal192+=000190
dayclock_ydsm_gmt+=000196
dayclock_ydsm+=000197
strlen+=000199
strlenx+=00019A
strcpy+=00019B
strcat+=00019C
read_octet_column+=00019D
__fpp+=0001A6
__fpx+=0001A7
memcat+=0001A8
ieee754_64_2float+=0001BC
float2_ieee754_64+=0001BD
xdr16_ieee754_64_2float+=0001BE
xdr16_float2_ieee754_64+=0001BF
madd_144+=0000EC
oper8+=000771
wstream_composea+=000205
ixscan+=00021E
ixscan48+=00021F
ixscan72+=000220
date_timef1+=000222
date_timef2+=000223
string_scana_sentinel+=000225
qscanquartets+=000226
oscanquartets+=000227
unget+=000228
unpack_callstring+=00022A
retrieve_callstring+=00022B
i2columns+=00022C
read_stream_start16+=00050F
write_stream_start16+=000517
read_stream_start24+=00051D
write_stream_start24+=000525
timetext_f1+=00060C
timetext_f2+=000622
timetext_f3+=000633
qstring_scana_sentinel+=000644
edit_fo+=000768
quartets+=0007F1
table+=000811
$HALT+=0001F3
__fd_zero_timeout+=0001F2
__fgets+=0001E4
__fprintf+=0001DB
__fscanf+=0001DA
__sscanf+=0001D8
appdata_share+=0001F1
appdata_vector+=000472
array$seg$load+=0001CF
claim_fob+=0001DD
close+=0001D7
dialplan_online+=0001EE
editfor+=0008FF
f_editform+=00091A
f_scanform+=00090E
fileshare_space_close+=0001E8
fs24_advance+=0001C9
fs24_bytes_written+=0001EC
fs24_lseek+=0001EB
fs24_read+=0001C8
fs24_snoop+=0001E3
fs24_window+=0001E6
fs24_words_written+=0001ED
fs_1st+=0001C0
fs_read+=0001C1
fscan_datafile+=0001EA
fspath_open+=0001C6
fsrom_da+=0001CA
fsrom_find+=0001CC
fsrom_read+=0001CB
fsync+=0001D6
iframe_load+=0001D0
lseek+=0001D5
net_scan_tcp+=0001DC
nfs_open_path+=00055E
nfs_seek+=0001E1
nfsclose+=0001E2
nfsmount+=0001DE
nfsopen+=0001DF
nfsread+=0001E0
nfswrite+=0001F0
open+=0001D2
read+=0001D3
recursive$seg$load+=0001CE
scan_tcp+=00093C
scanfor+=0008F4
speed_dial+=0001EF
write+=0001D4
$bits=000018
label1=000200,000018
absolute.txo=0<FFFFFFFF
../fs/fs.txo=1<000005
../lib/xdr_lib8.txo=1<000005
../drivers/drivers.txo=1<000005
system.txo=1<000005
../def.sys/banks.def=1<000005
../def/map1.def=1<000005
minimal.msm=0<000003
:$(00):007000:007B02 :$(01):001000:001678 :$(02):002000:003000 :$(03):003000:0056B8 :$(41):003000:0030F2 
minimal.msm: object code 202159 bytes: 0 errors: 1 undefined labels
MASMX 7r3A Build 12
3/minimald.msm
absolute.txo:$(1) 1656 words decimal from hexadecimal 001000 to 001678
absolute.txo:$(3) 9912 words decimal from hexadecimal 003000 to 0056B8
*EOF*
  :                            1 	$path		../
  :                            2: 	$include	def/map1.def
  :                            3 	$path
  :                            4 
  :                            5: 	$include,$binary	absolute	$(1, 3)
  :                            6 
  :                            7 	$store		minimald
  :                            8 
*EOF*
:$(01):001000:001678 :$(03):003000:0056B8 
minimald.msm: object code 16142 bytes: 0 errors: 0 undefined labels
2d slot1 43 banks 0 last granules 0 total 43
minimald.seg loading 43 granules
45 granules written, 19 free
2d slot1 43 banks 0 last granules 0 total 43
minimald.seg loading 43 granules
45 granules written, 19 free
MASMX 7r3A Build 12
3/adcorefs.msm
absolute.txo:$(0) 2818 words decimal from hexadecimal 007000 to 007B02
*EOF*
  :                            1 	$path	../
  :                            2: 	$include	def/map1.def
  :                            3 	$path
  :                            4 
  :                            5: 	$include,$binary absolute $(0)
  :                            6 $(32::03000)
  :                            7: 	$include,$binary corefs
  :                            8 
*EOF*
$map=:N129:P:0:000000
$SMP+=00007E
$ZETA+=00007C
$sockif+=000A1B
A$IDX+=000073
B$IDX+=000074
CACHE_NETB$+=00006C
DFRAME$+=000064
DFRAME$FREE+=000065
ENERGY$+=00007D
FILE$HANDLE+=00007B
FO$FRAME+=000079
FO$HEAP+=00007A
FREE_DEVB$+=00006E
FREE_NETB$+=000070
FREE_SOCKB$+=00006F
NET2SYM$+=000071
ON_NETB$+=00006D
TERAFRAME$+=000077
THREAD$STATE+=000072
USOCKET$+=000078
__accept+=00008F
__bind+=000082
__connect+=000083
__disconnect_free_tcp+=000095
__free_tcp_port+=000094
__net_disengage+=000091
__port_disengage+=000092
__port_disengage_udp+=000093
__route+=000088
__socket+=000081
__tcp_connect+=00008C
__tcp_socket+=000096
ack_request+=000097
agent2+=000146
app_protos+=000160
app_threads+=00015F
bind+=000085
connect+=000084
cosine192+=000175
cosine96+=000179
cotangent192+=000177
cotangent96+=00017B
cube192+=00017E
cube_root192+=00017F
far_initpool+=000099
far_q2+=00009D
far_readq+=00009C
fraction192+=000170
fraction96+=000172
frame_to_protocol+=000098
if_buy1+=00009B
if_q2ifree+=00009E
if_rx_nocheck+=00009F
if_sell1+=00009A
if_tx_nocheck+=00009F
initial_startups+=00014B
integer192+=000171
integer96+=000173
ip$sendx+=00013E
ipsend+=00008B
ipv4_4us?+=0000A0
ipv4_rxz+=0001E1
ipv4_this_host?+=0000A2
ipv4_this_if?+=0000A1
mib2ticks+=000245
mib_get+=000240
mib_getnext+=000241
mib_line+=000244
mib_set+=000242
mib_start+=000243
normal_string+=00014C
online_xqt+=000149
recv+=000089
release_udgram+=000087
run_start+=00014A
send+=00008A
sense_data+=000090
sine192+=000174
sine96+=000178
snmp_agent+=000146
square192+=00017C
square_root192+=00017D
strilw+=0002B1
subagent+=000147
subagent?+=000148
sysinfo+=00015E
tangent192+=000176
tangent96+=00017A
tcp_accept+=00008D
tcp_addx+=0000B2
tcp_hash_connection+=0000AF
tcp_hash_localsocket+=0000AE
tcp_release_rxline+=0000AD
tcp_rx+=0000B0
tcp_rx_ready+=000086
tcp_tx+=0000B1
tcpr+=0000AB
tcpz+=0000AC
udgram_acw_send_nocheck+=0000B3
udp_acw_send+=0000B7
udp_agent1+=000246
udp_agent2+=000247
udp_rtxbuffer+=0000B4
udp_send+=0000B5
udp_txbuffer+=0000B6
x72_aU+=000153
x72_anU+=000154
x72_andU+=00014E
x72_d48_48+=00015B
x72_d72_24+=00015A
x72_d72_48+=00015C
x72_d72_72+=00015D
x72_m48_24+=000155
x72_m48_48+=000157
x72_m72_24+=000156
x72_m72_48+=000158
x72_m72_72+=000159
x72_orU+=00014D
x72_sa+=000151
x72_sl+=000152
x72_xorU+=00014F
x72_xtend+=000150
xaccept+=0000A8
xdisco+=0000A9
$initial_ift1+=000102
$light_flight+=000103
$rxtx_ift1+=000101
$rxtx_lo+=000100
SUMMIT$3+=0056B8
__ifconfig+=000108
__ift2_align+=000113
__ift2_mirror+=000114
__initial_ift2+=000111
__route_config+=00010E
__rxtx_ift2+=000112
__sprintf+=0001D9
d48_48+=0001A2
date_timef3+=000224
display_quartets+=000221
fedit192a+=000210
fedita+=00020E
feditia+=00020F
fgets_datafile+=0001E5
fileshare_assign+=0001E9
fileshare_space_open+=0001E7
float2i72+=00019E
forward_callstring+=000229
fp192_add+=00018E
fp192_add_negative+=00018F
fp192_divide+=000193
fp192_load+=00018C
fp192_load_negative+=00018D
fp192_mfa+=000191
fp192_multiply+=000192
fs24_open+=0001C7
fs_dsearch+=0001C3
fs_find+=0001C2
fs_xbase+=0001C4
fscan192a+=000208
fscana+=000206
fspath+=0001C5
fsymbola+=000207
hvsocket_storage+=000130
hvsocket_write_rxq+=000138
i48_2float+=00019F
i72_divide+=000195
i72_multiply+=000194
id72_72+=0001A5
iedit48a+=000215
iedit48as+=000216
iedit48ua+=000214
iedit72a+=000218
iedit72as+=000219
iedit72ua+=000217
iedita+=000212
ieditas+=000213
ieditua+=000211
im72_72+=0001A4
iscan48a+=00020B
iscan72a+=00020C
iscan_skipa+=000209
iscana+=00020A
jumboq2+=00011C
locate_interfaces+=00011A
m48_24+=0001A0
m48_48+=0001A1
qstart+=0001D1
rasm_time+=00011E
rasmgram+=00011B
rstream_scana+=000204
rstream_start_net+=000200
rstream_starta+=000202
scanhex+=00021B
seg$load+=0001CD
textoa+=00021A
tnet_callstring+=00013A
tokena+=00020D
tripl2float+=0001A3
write_ifq+=000110
write_ifqlist+=00010F
write_ifqlist_head+=000117
wstream_start_net+=000201
wstream_starta+=000203
xdr_inopaque24+=0001BA
xdr_outopaque24+=0001BB
xrelay_reset+=00010D
__buy12_bytes+=000116
__buy6_bytes+=000115
__recheck+=000118
arp_ether_reso+=000109
arp_ether_rx+=00010C
arp_ether_xmit+=00010A
connection_array+=000135
dlt_e10mb+=000107
dlt_loop+=000106
dlt_null+=000105
g_checksum+=00011D
hvsocket_close+=000137
hvsocket_readq+=000134
hvsocket_rx+=000132
hvsocket_tx+=000133
hvsocket_xbind+=000136
hvsockets_bind+=000131
if_dualport_txwrite+=000104
tcp_record+=000139
tcp_timer(1)+=00013B
tx_mib_update+=000119
xarp_ethernet+=00010B
u72tofloat+=000180
fraction6_7+=000181
madd144+=000182
floating_scale192+=000183
floating_scale+=000184
fraction3+=000185
fraction6+=000186
scale_out192+=000187
scale_out+=000188
align192+=000189
scale_integrate+=00018A
n72comp2+=00018B
reciprocal192+=000190
dayclock_ydsm_gmt+=000196
dayclock_ydsm+=000197
strlen+=000199
strlenx+=00019A
strcpy+=00019B
strcat+=00019C
read_octet_column+=00019D
__fpp+=0001A6
__fpx+=0001A7
memcat+=0001A8
ieee754_64_2float+=0001BC
float2_ieee754_64+=0001BD
xdr16_ieee754_64_2float+=0001BE
xdr16_float2_ieee754_64+=0001BF
madd_144+=0000EC
oper8+=000771
wstream_composea+=000205
ixscan+=00021E
ixscan48+=00021F
ixscan72+=000220
date_timef1+=000222
date_timef2+=000223
string_scana_sentinel+=000225
qscanquartets+=000226
oscanquartets+=000227
unget+=000228
unpack_callstring+=00022A
retrieve_callstring+=00022B
i2columns+=00022C
read_stream_start16+=00050F
write_stream_start16+=000517
read_stream_start24+=00051D
write_stream_start24+=000525
timetext_f1+=00060C
timetext_f2+=000622
timetext_f3+=000633
qstring_scana_sentinel+=000644
edit_fo+=000768
quartets+=0007F1
table+=000811
$HALT+=0001F3
__fd_zero_timeout+=0001F2
__fgets+=0001E4
__fprintf+=0001DB
__fscanf+=0001DA
__sscanf+=0001D8
appdata_share+=0001F1
appdata_vector+=000472
array$seg$load+=0001CF
claim_fob+=0001DD
close+=0001D7
dialplan_online+=0001EE
editfor+=0008FF
f_editform+=00091A
f_scanform+=00090E
fileshare_space_close+=0001E8
fs24_advance+=0001C9
fs24_bytes_written+=0001EC
fs24_lseek+=0001EB
fs24_read+=0001C8
fs24_snoop+=0001E3
fs24_window+=0001E6
fs24_words_written+=0001ED
fs_1st+=0001C0
fs_read+=0001C1
fscan_datafile+=0001EA
fspath_open+=0001C6
fsrom_da+=0001CA
fsrom_find+=0001CC
fsrom_read+=0001CB
fsync+=0001D6
iframe_load+=0001D0
lseek+=0001D5
net_scan_tcp+=0001DC
nfs_open_path+=00055E
nfs_seek+=0001E1
nfsclose+=0001E2
nfsmount+=0001DE
nfsopen+=0001DF
nfsread+=0001E0
nfswrite+=0001F0
open+=0001D2
read+=0001D3
recursive$seg$load+=0001CE
scan_tcp+=00093C
scanfor+=0008F4
speed_dial+=0001EF
write+=0001D4
minimald+=$20:000016
$bits=000018
label1=$20:000016,000030
corefs.txo=1<000005
absolute.txo=1<000005
..//def/map1.def=1<000005
adcorefs.msm=0<000003
:$(00):007000:007B02 :$(20):000000:000B40 
adcorefs.msm: object code 206174 bytes: 0 errors: 0 undefined labels
