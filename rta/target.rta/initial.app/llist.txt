MASMX 7r3A Build 12
3/loader.msm
*EOF*
  :                            12 	$list
  :                            13 
  :                            14 $(1:01000/$1)
  :                            15 $(3:03000/$3)
  :                            16 
  :                            17 	$lit	4
  :                            18 
  :                            19 $(4:*1/$4)
  :                            20 $(0:*1/$0)
  :                            21 
  :                            22 loader*
  :                            23 	$list	2
  :                            24: 	$include	../source.app/loader
  :                            1: 	$include	../source.app/loader.def
  :                            2: 	$include	../table/lookup.def
  :                            3 
  :                            4 	$set_option	"z"
  :                            5 
  :                            6 $(3)
  :                            7 command1	$res	180/3	. application name like argv[0]
  :                            8 				. only read once ahead of commands
  :                            9 request1	$res	180/3	. entire fgets line
  :                            10 request         $res	180/3	. 1st term on input line
  :                            11 request2	$res	180/3
  :                            12 request3	$res	180/3
  :                            13 request4	$res	180/3	. potential last term last in
  :                            14 suffix		$res	180/3	. to extract *suffix
  :                            15 				. without overwriting request[2 3 4]
03:0031A4  000000              +16 arguments	0
  :                            17 new_process	$res	1
03:0031A6  000000 000000 000000 000000 000000
                              +18 loadname	0p		. 4 + trailing zero word
  :                            19 				. in case load file name is 12+ symbols
  :                            20 
  :                            21 APPS_MAXIMUM	$equ	48
03:0031AB  000000              +22 app_of_reference 0
03:0031AC  0031AE              +23 app_cache_free	+	app(1)
03:0031AD  000000              +24 apps_loaded	0
  :                            25 
03:0031AE  0031C2              +26 ?	$do	APPS_MAXIMUM,app(?)	file_image	app(?+1)
03:0031AF  000000              +26 
03:0031B0  000000 000000        +26 
03:0031B2  000000 000000        +26 
03:0031B4  000000              +26 
03:0031B5  000000              +26 
03:0031B6  000000 000000 000000 000000
                              +26 
03:0031BA  000000 000000 000000 000000
                              +26 
03:0031BE  000000 000000 000000 000000
                              +26 
03:0031C2  0031D6              +26 
03:0031C3  000000              +26 
03:0031C4  000000 000000        +26 
03:0031C6  000000 000000        +26 
03:0031C8  000000              +26 
03:0031C9  000000              +26 
03:0031CA  000000 000000 000000 000000
                              +26 
03:0031CE  000000 000000 000000 000000
                              +26 
03:0031D2  000000 000000 000000 000000
                              +26 
03:0031D6  0031EA              +26 
03:0031D7  000000              +26 
03:0031D8  000000 000000        +26 
03:0031DA  000000 000000        +26 
03:0031DC  000000              +26 
03:0031DD  000000              +26 
03:0031DE  000000 000000 000000 000000
                              +26 
03:0031E2  000000 000000 000000 000000
                              +26 
03:0031E6  000000 000000 000000 000000
                              +26 
03:0031EA  0031FE              +26 
03:0031EB  000000              +26 
03:0031EC  000000 000000        +26 
03:0031EE  000000 000000        +26 
03:0031F0  000000              +26 
03:0031F1  000000              +26 
03:0031F2  000000 000000 000000 000000
                              +26 
03:0031F6  000000 000000 000000 000000
                              +26 
03:0031FA  000000 000000 000000 000000
                              +26 
03:0031FE  003212              +26 
03:0031FF  000000              +26 
03:003200  000000 000000        +26 
03:003202  000000 000000        +26 
03:003204  000000              +26 
03:003205  000000              +26 
03:003206  000000 000000 000000 000000
                              +26 
03:00320A  000000 000000 000000 000000
                              +26 
03:00320E  000000 000000 000000 000000
                              +26 
03:003212  003226              +26 
03:003213  000000              +26 
03:003214  000000 000000        +26 
03:003216  000000 000000        +26 
03:003218  000000              +26 
03:003219  000000              +26 
03:00321A  000000 000000 000000 000000
                              +26 
03:00321E  000000 000000 000000 000000
                              +26 
03:003222  000000 000000 000000 000000
                              +26 
03:003226  00323A              +26 
03:003227  000000              +26 
03:003228  000000 000000        +26 
03:00322A  000000 000000        +26 
03:00322C  000000              +26 
03:00322D  000000              +26 
03:00322E  000000 000000 000000 000000
                              +26 
03:003232  000000 000000 000000 000000
                              +26 
03:003236  000000 000000 000000 000000
                              +26 
03:00323A  00324E              +26 
03:00323B  000000              +26 
03:00323C  000000 000000        +26 
03:00323E  000000 000000        +26 
03:003240  000000              +26 
03:003241  000000              +26 
03:003242  000000 000000 000000 000000
                              +26 
03:003246  000000 000000 000000 000000
                              +26 
03:00324A  000000 000000 000000 000000
                              +26 
03:00324E  003262              +26 
03:00324F  000000              +26 
03:003250  000000 000000        +26 
03:003252  000000 000000        +26 
03:003254  000000              +26 
03:003255  000000              +26 
03:003256  000000 000000 000000 000000
                              +26 
03:00325A  000000 000000 000000 000000
                              +26 
03:00325E  000000 000000 000000 000000
                              +26 
03:003262  003276              +26 
03:003263  000000              +26 
03:003264  000000 000000        +26 
03:003266  000000 000000        +26 
03:003268  000000              +26 
03:003269  000000              +26 
03:00326A  000000 000000 000000 000000
                              +26 
03:00326E  000000 000000 000000 000000
                              +26 
03:003272  000000 000000 000000 000000
                              +26 
03:003276  00328A              +26 
03:003277  000000              +26 
03:003278  000000 000000        +26 
03:00327A  000000 000000        +26 
03:00327C  000000              +26 
03:00327D  000000              +26 
03:00327E  000000 000000 000000 000000
                              +26 
03:003282  000000 000000 000000 000000
                              +26 
03:003286  000000 000000 000000 000000
                              +26 
03:00328A  00329E              +26 
03:00328B  000000              +26 
03:00328C  000000 000000        +26 
03:00328E  000000 000000        +26 
03:003290  000000              +26 
03:003291  000000              +26 
03:003292  000000 000000 000000 000000
                              +26 
03:003296  000000 000000 000000 000000
                              +26 
03:00329A  000000 000000 000000 000000
                              +26 
03:00329E  0032B2              +26 
03:00329F  000000              +26 
03:0032A0  000000 000000        +26 
03:0032A2  000000 000000        +26 
03:0032A4  000000              +26 
03:0032A5  000000              +26 
03:0032A6  000000 000000 000000 000000
                              +26 
03:0032AA  000000 000000 000000 000000
                              +26 
03:0032AE  000000 000000 000000 000000
                              +26 
03:0032B2  0032C6              +26 
03:0032B3  000000              +26 
03:0032B4  000000 000000        +26 
03:0032B6  000000 000000        +26 
03:0032B8  000000              +26 
03:0032B9  000000              +26 
03:0032BA  000000 000000 000000 000000
                              +26 
03:0032BE  000000 000000 000000 000000
                              +26 
03:0032C2  000000 000000 000000 000000
                              +26 
03:0032C6  0032DA              +26 
03:0032C7  000000              +26 
03:0032C8  000000 000000        +26 
03:0032CA  000000 000000        +26 
03:0032CC  000000              +26 
03:0032CD  000000              +26 
03:0032CE  000000 000000 000000 000000
                              +26 
03:0032D2  000000 000000 000000 000000
                              +26 
03:0032D6  000000 000000 000000 000000
                              +26 
03:0032DA  0032EE              +26 
03:0032DB  000000              +26 
03:0032DC  000000 000000        +26 
03:0032DE  000000 000000        +26 
03:0032E0  000000              +26 
03:0032E1  000000              +26 
03:0032E2  000000 000000 000000 000000
                              +26 
03:0032E6  000000 000000 000000 000000
                              +26 
03:0032EA  000000 000000 000000 000000
                              +26 
03:0032EE  003302              +26 
03:0032EF  000000              +26 
03:0032F0  000000 000000        +26 
03:0032F2  000000 000000        +26 
03:0032F4  000000              +26 
03:0032F5  000000              +26 
03:0032F6  000000 000000 000000 000000
                              +26 
03:0032FA  000000 000000 000000 000000
                              +26 
03:0032FE  000000 000000 000000 000000
                              +26 
03:003302  003316              +26 
03:003303  000000              +26 
03:003304  000000 000000        +26 
03:003306  000000 000000        +26 
03:003308  000000              +26 
03:003309  000000              +26 
03:00330A  000000 000000 000000 000000
                              +26 
03:00330E  000000 000000 000000 000000
                              +26 
03:003312  000000 000000 000000 000000
                              +26 
03:003316  00332A              +26 
03:003317  000000              +26 
03:003318  000000 000000        +26 
03:00331A  000000 000000        +26 
03:00331C  000000              +26 
03:00331D  000000              +26 
03:00331E  000000 000000 000000 000000
                              +26 
03:003322  000000 000000 000000 000000
                              +26 
03:003326  000000 000000 000000 000000
                              +26 
03:00332A  00333E              +26 
03:00332B  000000              +26 
03:00332C  000000 000000        +26 
03:00332E  000000 000000        +26 
03:003330  000000              +26 
03:003331  000000              +26 
03:003332  000000 000000 000000 000000
                              +26 
03:003336  000000 000000 000000 000000
                              +26 
03:00333A  000000 000000 000000 000000
                              +26 
03:00333E  003352              +26 
03:00333F  000000              +26 
03:003340  000000 000000        +26 
03:003342  000000 000000        +26 
03:003344  000000              +26 
03:003345  000000              +26 
03:003346  000000 000000 000000 000000
                              +26 
03:00334A  000000 000000 000000 000000
                              +26 
03:00334E  000000 000000 000000 000000
                              +26 
03:003352  003366              +26 
03:003353  000000              +26 
03:003354  000000 000000        +26 
03:003356  000000 000000        +26 
03:003358  000000              +26 
03:003359  000000              +26 
03:00335A  000000 000000 000000 000000
                              +26 
03:00335E  000000 000000 000000 000000
                              +26 
03:003362  000000 000000 000000 000000
                              +26 
03:003366  00337A              +26 
03:003367  000000              +26 
03:003368  000000 000000        +26 
03:00336A  000000 000000        +26 
03:00336C  000000              +26 
03:00336D  000000              +26 
03:00336E  000000 000000 000000 000000
                              +26 
03:003372  000000 000000 000000 000000
                              +26 
03:003376  000000 000000 000000 000000
                              +26 
03:00337A  00338E              +26 
03:00337B  000000              +26 
03:00337C  000000 000000        +26 
03:00337E  000000 000000        +26 
03:003380  000000              +26 
03:003381  000000              +26 
03:003382  000000 000000 000000 000000
                              +26 
03:003386  000000 000000 000000 000000
                              +26 
03:00338A  000000 000000 000000 000000
                              +26 
03:00338E  0033A2              +26 
03:00338F  000000              +26 
03:003390  000000 000000        +26 
03:003392  000000 000000        +26 
03:003394  000000              +26 
03:003395  000000              +26 
03:003396  000000 000000 000000 000000
                              +26 
03:00339A  000000 000000 000000 000000
                              +26 
03:00339E  000000 000000 000000 000000
                              +26 
03:0033A2  0033B6              +26 
03:0033A3  000000              +26 
03:0033A4  000000 000000        +26 
03:0033A6  000000 000000        +26 
03:0033A8  000000              +26 
03:0033A9  000000              +26 
03:0033AA  000000 000000 000000 000000
                              +26 
03:0033AE  000000 000000 000000 000000
                              +26 
03:0033B2  000000 000000 000000 000000
                              +26 
03:0033B6  0033CA              +26 
03:0033B7  000000              +26 
03:0033B8  000000 000000        +26 
03:0033BA  000000 000000        +26 
03:0033BC  000000              +26 
03:0033BD  000000              +26 
03:0033BE  000000 000000 000000 000000
                              +26 
03:0033C2  000000 000000 000000 000000
                              +26 
03:0033C6  000000 000000 000000 000000
                              +26 
03:0033CA  0033DE              +26 
03:0033CB  000000              +26 
03:0033CC  000000 000000        +26 
03:0033CE  000000 000000        +26 
03:0033D0  000000              +26 
03:0033D1  000000              +26 
03:0033D2  000000 000000 000000 000000
                              +26 
03:0033D6  000000 000000 000000 000000
                              +26 
03:0033DA  000000 000000 000000 000000
                              +26 
03:0033DE  0033F2              +26 
03:0033DF  000000              +26 
03:0033E0  000000 000000        +26 
03:0033E2  000000 000000        +26 
03:0033E4  000000              +26 
03:0033E5  000000              +26 
03:0033E6  000000 000000 000000 000000
                              +26 
03:0033EA  000000 000000 000000 000000
                              +26 
03:0033EE  000000 000000 000000 000000
                              +26 
03:0033F2  003406              +26 
03:0033F3  000000              +26 
03:0033F4  000000 000000        +26 
03:0033F6  000000 000000        +26 
03:0033F8  000000              +26 
03:0033F9  000000              +26 
03:0033FA  000000 000000 000000 000000
                              +26 
03:0033FE  000000 000000 000000 000000
                              +26 
03:003402  000000 000000 000000 000000
                              +26 
03:003406  00341A              +26 
03:003407  000000              +26 
03:003408  000000 000000        +26 
03:00340A  000000 000000        +26 
03:00340C  000000              +26 
03:00340D  000000              +26 
03:00340E  000000 000000 000000 000000
                              +26 
03:003412  000000 000000 000000 000000
                              +26 
03:003416  000000 000000 000000 000000
                              +26 
03:00341A  00342E              +26 
03:00341B  000000              +26 
03:00341C  000000 000000        +26 
03:00341E  000000 000000        +26 
03:003420  000000              +26 
03:003421  000000              +26 
03:003422  000000 000000 000000 000000
                              +26 
03:003426  000000 000000 000000 000000
                              +26 
03:00342A  000000 000000 000000 000000
                              +26 
03:00342E  003442              +26 
03:00342F  000000              +26 
03:003430  000000 000000        +26 
03:003432  000000 000000        +26 
03:003434  000000              +26 
03:003435  000000              +26 
03:003436  000000 000000 000000 000000
                              +26 
03:00343A  000000 000000 000000 000000
                              +26 
03:00343E  000000 000000 000000 000000
                              +26 
03:003442  003456              +26 
03:003443  000000              +26 
03:003444  000000 000000        +26 
03:003446  000000 000000        +26 
03:003448  000000              +26 
03:003449  000000              +26 
03:00344A  000000 000000 000000 000000
                              +26 
03:00344E  000000 000000 000000 000000
                              +26 
03:003452  000000 000000 000000 000000
                              +26 
03:003456  00346A              +26 
03:003457  000000              +26 
03:003458  000000 000000        +26 
03:00345A  000000 000000        +26 
03:00345C  000000              +26 
03:00345D  000000              +26 
03:00345E  000000 000000 000000 000000
                              +26 
03:003462  000000 000000 000000 000000
                              +26 
03:003466  000000 000000 000000 000000
                              +26 
03:00346A  00347E              +26 
03:00346B  000000              +26 
03:00346C  000000 000000        +26 
03:00346E  000000 000000        +26 
03:003470  000000              +26 
03:003471  000000              +26 
03:003472  000000 000000 000000 000000
                              +26 
03:003476  000000 000000 000000 000000
                              +26 
03:00347A  000000 000000 000000 000000
                              +26 
03:00347E  003492              +26 
03:00347F  000000              +26 
03:003480  000000 000000        +26 
03:003482  000000 000000        +26 
03:003484  000000              +26 
03:003485  000000              +26 
03:003486  000000 000000 000000 000000
                              +26 
03:00348A  000000 000000 000000 000000
                              +26 
03:00348E  000000 000000 000000 000000
                              +26 
03:003492  0034A6              +26 
03:003493  000000              +26 
03:003494  000000 000000        +26 
03:003496  000000 000000        +26 
03:003498  000000              +26 
03:003499  000000              +26 
03:00349A  000000 000000 000000 000000
                              +26 
03:00349E  000000 000000 000000 000000
                              +26 
03:0034A2  000000 000000 000000 000000
                              +26 
03:0034A6  0034BA              +26 
03:0034A7  000000              +26 
03:0034A8  000000 000000        +26 
03:0034AA  000000 000000        +26 
03:0034AC  000000              +26 
03:0034AD  000000              +26 
03:0034AE  000000 000000 000000 000000
                              +26 
03:0034B2  000000 000000 000000 000000
                              +26 
03:0034B6  000000 000000 000000 000000
                              +26 
03:0034BA  0034CE              +26 
03:0034BB  000000              +26 
03:0034BC  000000 000000        +26 
03:0034BE  000000 000000        +26 
03:0034C0  000000              +26 
03:0034C1  000000              +26 
03:0034C2  000000 000000 000000 000000
                              +26 
03:0034C6  000000 000000 000000 000000
                              +26 
03:0034CA  000000 000000 000000 000000
                              +26 
03:0034CE  0034E2              +26 
03:0034CF  000000              +26 
03:0034D0  000000 000000        +26 
03:0034D2  000000 000000        +26 
03:0034D4  000000              +26 
03:0034D5  000000              +26 
03:0034D6  000000 000000 000000 000000
                              +26 
03:0034DA  000000 000000 000000 000000
                              +26 
03:0034DE  000000 000000 000000 000000
                              +26 
03:0034E2  0034F6              +26 
03:0034E3  000000              +26 
03:0034E4  000000 000000        +26 
03:0034E6  000000 000000        +26 
03:0034E8  000000              +26 
03:0034E9  000000              +26 
03:0034EA  000000 000000 000000 000000
                              +26 
03:0034EE  000000 000000 000000 000000
                              +26 
03:0034F2  000000 000000 000000 000000
                              +26 
03:0034F6  00350A              +26 
03:0034F7  000000              +26 
03:0034F8  000000 000000        +26 
03:0034FA  000000 000000        +26 
03:0034FC  000000              +26 
03:0034FD  000000              +26 
03:0034FE  000000 000000 000000 000000
                              +26 
03:003502  000000 000000 000000 000000
                              +26 
03:003506  000000 000000 000000 000000
                              +26 
03:00350A  00351E              +26 
03:00350B  000000              +26 
03:00350C  000000 000000        +26 
03:00350E  000000 000000        +26 
03:003510  000000              +26 
03:003511  000000              +26 
03:003512  000000 000000 000000 000000
                              +26 
03:003516  000000 000000 000000 000000
                              +26 
03:00351A  000000 000000 000000 000000
                              +26 
03:00351E  003532              +26 
03:00351F  000000              +26 
03:003520  000000 000000        +26 
03:003522  000000 000000        +26 
03:003524  000000              +26 
03:003525  000000              +26 
03:003526  000000 000000 000000 000000
                              +26 
03:00352A  000000 000000 000000 000000
                              +26 
03:00352E  000000 000000 000000 000000
                              +26 
03:003532  003546              +26 
03:003533  000000              +26 
03:003534  000000 000000        +26 
03:003536  000000 000000        +26 
03:003538  000000              +26 
03:003539  000000              +26 
03:00353A  000000 000000 000000 000000
                              +26 
03:00353E  000000 000000 000000 000000
                              +26 
03:003542  000000 000000 000000 000000
                              +26 
03:003546  00355A              +26 
03:003547  000000              +26 
03:003548  000000 000000        +26 
03:00354A  000000 000000        +26 
03:00354C  000000              +26 
03:00354D  000000              +26 
03:00354E  000000 000000 000000 000000
                              +26 
03:003552  000000 000000 000000 000000
                              +26 
03:003556  000000 000000 000000 000000
                              +26 
03:00355A  000000              +26 
03:00355B  000000              +26 
03:00355C  000000 000000        +26 
03:00355E  000000 000000        +26 
03:003560  000000              +26 
03:003561  000000              +26 
03:003562  000000 000000 000000 000000
                              +26 
03:003566  000000 000000 000000 000000
                              +26 
03:00356A  000000 000000 000000 000000
                              +26 
  :                            27 
  :                            28 $(67::,y)
43:000000                     +29 this_app	file_image
43:000001                     +29 
43:000002                     +29 
43:000004                     +29 
43:000006                     +29 
43:000007                     +29 
43:000008                     +29 
43:00000C                     +29 
43:000010                     +29 
  :                            30 
  :                            31 $(0)
  :                            32 
00:000000  60207F              +33 	$base_d	$zenith(3)-03000 2048 2048
00:000001  340003              +33 
00:000002  64C001              +33 
00:000003  340004              +33 
(+04)0f
00:000004  600000              +33 
00:000005  75007A              +33 
00:000006  655000              +33 
00:000007  20000E              +33 
(+04)0f
00:000008  9F0001              +34 	c	(seg$load)	0,,xi	(loader_data:d),,long
00:000009  FD0000              +34 
00:00000A  FCF003              +34 
(+04)0f
00:00000B  FF0003              +34 
00:00000C  38000F              +34 
  :                            35 
  :                            36 
  :                            37 load_request
00:00000D  FD00B4              +38 	fgets	request1,,xi	180	stdin
00:00000E  FD303C              +38 
00:00000F  FD0000              +38 
00:000010  FCF003              +38 
(+04)0f
00:000011  FF0004              +38 
00:000012  38000F              +38 
00:000013  160018              +38 
00:000014  1D0018              +38 
(+00)0f
00:000015  EE0018              +38 
(+00)0f
00:000016  CE0018              +38 
00:000017  65303C              +38 
00:000018  303168              +39 	z	suffix
00:000019  303079              +40 	z	request+1	. command search is 2 words and they aren't all
                                	sscanf	request1,,xi	$3("%s %s %s %s %s":0:0),,xi	command1,,xi	;
00:00001A  FD312C              +42 				request,,xi	request2,,xi	request3,,xi	request4,,xi
00:00001B  FD30F0              +42 
00:00001C  FD30B4              +42 
00:00001D  FD3078              +42 
00:00001E  FD3000              +42 
00:00001F  FD356E              +42 
00:000020  FD303C              +42 
00:000021  FCF007              +42 
(+04)0f
00:000022  FF0005              +42 
00:000023  38000F              +42 
  :                            43 
00:000024  C5FFFF              +44 	aa	-1,,xi		. command1 doesn't count. It's the application name
(+00)0f
00:000025  E60095              +45 	jna	trial_new_prompt
(+00)0f
00:000026  C60095              +46 	jza	trial_new_prompt
00:000027  2031A4              +47 	sa	arguments
  :                            48 
00:000028  FD303C              +49 	printf	$3("loader: %s":10:0),,xi	request1,,xi
00:000029  FD3574              +49 
00:00002A  FD0001              +49 
00:00002B  FCF003              +49 
(+04)0f
00:00002C  FF0006              +49 
00:00002D  38000F              +49 
  :                            50 	
  :                            51 next_request
  :                            52 
00:00002E  603078              +53 	la	request			. it's impossible for %s to cause leading space
00:00002F  060010              +54 	sar	$word-$byte		. look at leading column of request field
  :                            55 	
00:000030  C5FF01              +56 	aa	-255,,xi		. ^D ?
(+00)0f
00:000031  C600CF              +57 	jza	eof_signalled
00:000032  C500D0              +58 	aa	255-'/',,xi		. a load path?
(+00)0f
00:000033  C60035              +59 	jza	load_by_path
(+00)0f
00:000034  B600E1              +60 	j	command
  :                            61 
  :                            62 load_by_path
00:000035  303168              +63 	z	suffix
00:000036  FD3168              +64 	sscanf	request,,xi	$3("%:*%s"),,xi	request2,,xi	suffix,,xi
00:000037  FD30B4              +64 
00:000038  FD3578              +64 
00:000039  FD3078              +64 
00:00003A  FCF004              +64 
(+04)0f
00:00003B  FF0005              +64 
00:00003C  38000F              +64 
00:00003D  FD30B4              +65 	c	(fspath)	request2,,xi
00:00003E  FCF001              +65 
(+04)0f
00:00003F  FF0007              +65 
00:000040  38000F              +65 
(+00)0f
00:000041  C600BB              +66 	jza	trialu
  :                            67 
00:000042  5831AC              +68 	ly	app_cache_free
00:000043  700003              +69 	tnz	y
(+00)0f
00:000044  B60046              +69 
(+00)0f
00:000045  B6008F              +70 	j	no_slot
  :                            71 
00:000046  40B000              +72 	lr	this_app:next
00:000047  0031AC              +73 	sr	app_cache_free
00:000048  1831AB              +74 	sy	app_of_reference
00:000049  4031AD              +75 	lr	apps_loaded
00:00004A  00B000              +76 	sr	this_app:next
00:00004B  1831AD              +77 	sy	apps_loaded
  :                            78 
00:00004C  C7B002              +79 	ds	this_app:fs_offset
00:00004D  30B001              +80 	z	this_app:user_count
  :                            81 
00:00004E  8F0008              +82 	qpush	8
00:00004F  8F0008              +83 	qpush	8
00:000050  87B010              +84 	qpop	this_app:leaf_name
00:000051  8731A6              +85 	qpop	loadname
  :                            86 
00:000052  FCB004              +87 	c	(iframe_load)	a,,long	this_app:transfer_gate,,i
00:000053  9F0004              +87 
00:000054  FCF003              +87 
(+04)0f
00:000055  FF0008              +87 
00:000056  38000F              +87 
(+00)0f
00:000057  E600C2              +88 	jna	trialy
  :                            89 
00:000058  8F0004              +90 	printf	$3("[%lx:%lx]":10:0),,xi	a,,float
00:000059  FD357A              +90 
00:00005A  FD0001              +90 
00:00005B  FCF006              +90 
(+04)0f
00:00005C  FF0006              +90 
00:00005D  38000F              +90 
  :                            91 
  :                            92 find_and?
00:00005E  703168              +93 	tz	suffix			. is there a ? token after *
(+00)0f
00:00005F  B60080              +94 	j	load_and?		. yes, it's not just load-execute
  :                            95 					. no, it's load-execute
00:000060  5831AB              +96 	ly	app_of_reference
00:000061  4FB00C              +97 	ql	this_app:launch_profile
  :                            98 
(+04)0f
00:000062  600009              +99 	la	(0800000s)
00:000063  94B004              +100 	or	this_app:transfer_gate,,i
  :                            101 
00:000064  750042              +102 	ii	SPAWN$
(+00)0f
00:000065  C600DB              +103 	jza	nonstarter
00:000066  2031A5              +104 	sa	new_process
00:000067  5831AB              +105 	ly	app_of_reference
00:000068  6CB010              +106 	lb	this_app:leaf_name,,i
00:000069  750049              +107 	ii	TAG$
  :                            108 
  :                            109 update_go
00:00006A  340020              +110 	sabr	32			. look in new process TCB
(+04)0d
00:00006B  60800A              +111 	la	*(32*/12++ABT-01000+2)	. read his vector list pointer
00:00006C  340020              +112 	sabr	32
  :                            113 
00:00006D  CF2188              +114 	dl	handle(1)		. please use my stdin stdout stderr
(+04)0d
00:00006E  C7800B              +115 	ds	*(32*/12++handle(1)-02000)
  :                            116 
00:00006F  4F218A              +117 	ql	handle(2)
(+04)0d
00:000070  47800C              +118 	qs	*(32*/12++handle(2)-02000)
  :                            119 
(+04)0f
00:000071  60000D              +120 	la	(0C00001s)
00:000072  750060              +121 	ii	XBASE$32
  :                            122 
00:000073  FD31A6              +123 	printf	$3("%x %s":10:0),,xi	new_process	loadname,,xi
00:000074  F831A5              +123 
00:000075  FD357E              +123 
00:000076  FD0001              +123 
00:000077  FCF004              +123 
(+04)0f
00:000078  FF0006              +123 
00:000079  38000F              +123 
00:00007A  750041              +124 	ii	YIELD$
  :                            125 
00:00007B  6031A5              +126 trialx	la	new_process
00:00007C  750072              +127 trialx1	ii	THREAD$STATE
(+00)0f
00:00007D  B60095              +128 	j	trial_end_detect	. concluded or stopped
  :                            129 
00:00007E  750041              +130 	ii	YIELD$			. if this were encapsulated
(+00)0f
00:00007F  B6007B              +131 	j	trialx			. its name would be waitpid()
  :                            132 
  :                            133 load_and?
00:000080  4F3168              +134 	ql	suffix
(+04)0f
00:000081  48000E              +135 	lk	(-1*/$word-$byte)
(+04)0f
00:000082  AF000F              +136 	mtane	('+'*/$word-$byte)	. load and don't execute?
(+00)0f
00:000083  B60085              +136 
(+00)0f
00:000084  B60095              +137 	j	trial_new_prompt	. it's done, ask me again
  :                            138 					. it's an application in the loaded file
00:000085  4731A6              +139 	qs	loadname
  :                            140 
00:000086  FD3168              +141 	lc	qapps	app_of_reference suffix,,xi	. group*application
00:000087  F831AB              +141 
00:000088  FCF002              +141 
(+00)0f
00:000089  3E0120              +141 
00:00008A  38000F              +141 
  :                            142 
(+00)0f
00:00008B  C600DB              +143 	jza	nonstarter
(+00)0f
00:00008C  E600D5              +144 	jna	start_error
00:00008D  2031A5              +145 	sa	new_process
(+00)0f
00:00008E  B6006A              +146 	j	update_go
  :                            147 
00:00008F  FD3581              +148 no_slot	printf	$3("maximum dynamic apps loaded\n":10:0),,xi
00:000090  FD0001              +148 
00:000091  FCF002              +148 
(+04)0f
00:000092  FF0006              +148 
00:000093  38000F              +148 
(+00)0f
00:000094  B60095              +149 	j	trial_new_prompt
  :                            150 
  :                            151 trial_end_detect
  :                            152 trial_new_prompt
  :                            153 
00:000095  FD358C              +154 	printf	$3("load>":0),,xi
00:000096  FD0001              +154 
00:000097  FCF002              +154 
(+04)0f
00:000098  FF0006              +154 
00:000099  38000F              +154 
00:00009A  FD0001              +155 	fflush	stdout
00:00009B  FCF001              +155 
(+04)0f
00:00009C  FF0010              +155 
00:00009D  38000F              +155 
00:00009E  FD00AE              +156 	fgets	request1,,i	174	stdin
00:00009F  FC303C              +156 
00:0000A0  FD0000              +156 
00:0000A1  FCF003              +156 
(+04)0f
00:0000A2  FF0004              +156 
00:0000A3  38000F              +156 
00:0000A4  160018              +156 
00:0000A5  1D0018              +156 
(+00)0f
00:0000A6  EE00A9              +156 
(+00)0f
00:0000A7  CE00A9              +156 
00:0000A8  64303C              +156 
00:0000A9  60303C              +157 	la	request1
(+00)0f
00:0000AA  C600C9              +158 	jza	data_void
00:0000AB  303079              +159 	z	request+1	. command search is 2 words and they aren't all
00:0000AC  3030B4              +160 	z	request2
00:0000AD  303078              +161 	z	request
00:0000AE  303168              +162 	z	suffix
00:0000AF  FD312C              +163 	sscanf	request1,,xi	$3("%s %s %s %s":0),,xi	request,,xi	request2,,xi	request3,,xi	request4,,xi
00:0000B0  FD30F0              +163 
00:0000B1  FD30B4              +163 
00:0000B2  FD3078              +163 
00:0000B3  FD358E              +163 
00:0000B4  FD303C              +163 
00:0000B5  FCF006              +163 
(+04)0f
00:0000B6  FF0005              +163 
00:0000B7  38000F              +163 
(+00)0f
00:0000B8  C60095              +164 	jza	trial_new_prompt
00:0000B9  2031A4              +165 	sa	arguments
(+00)0f
00:0000BA  B6002E              +166 	j	next_request	
  :                            167 
00:0000BB  FD3078              +168 trialu	printf	$3("%s not located":10:0),,xi	request,,xi
00:0000BC  FD3592              +168 
00:0000BD  FD0001              +168 
00:0000BE  FCF003              +168 
(+04)0f
00:0000BF  FF0006              +168 
00:0000C0  38000F              +168 
(+00)0f
00:0000C1  B60095              +169 	j	trial_new_prompt
  :                            170  
00:0000C2  F80004              +171 trialy	printf	$3("load error %d":10:0),,xi a
00:0000C3  FD3598              +171 
00:0000C4  FD0001              +171 
00:0000C5  FCF003              +171 
(+04)0f
00:0000C6  FF0006              +171 
00:0000C7  38000F              +171 
(+00)0f
00:0000C8  B60095              +172 	j	trial_new_prompt
  :                            173 
  :                            174 data_void
00:0000C9  FD359D              +175 	printf	$3("data void":10:0),,xi
00:0000CA  FD0001              +175 
00:0000CB  FCF002              +175 
(+04)0f
00:0000CC  FF0006              +175 
00:0000CD  38000F              +175 
(+00)0f
00:0000CE  B60119              +176 	j	trialz
  :                            177 
  :                            178 eof_signalled
00:0000CF  FD35A1              +179 	printf	$3("eof signalled":10:0),,xi
00:0000D0  FD0001              +179 
00:0000D1  FCF002              +179 
(+04)0f
00:0000D2  FF0006              +179 
00:0000D3  38000F              +179 
(+00)0f
00:0000D4  B60119              +180 	j	trialz
  :                            181 
  :                            182 start_error
00:0000D5  F80004              +183 	printf	$3("%d":10:0),,xi a
00:0000D6  FD35A6              +183 
00:0000D7  FD0001              +183 
00:0000D8  FCF003              +183 
(+04)0f
00:0000D9  FF0006              +183 
00:0000DA  38000F              +183 
  :                            184 
00:0000DB  FD35A8              +185 nonstarter printf $3("process unassigned":10:0),,xi
00:0000DC  FD0001              +185 
00:0000DD  FCF002              +185 
(+04)0f
00:0000DE  FF0006              +185 
00:0000DF  38000F              +185 
(+00)0f
00:0000E0  B60095              +186 	j	trial_new_prompt
  :                            187 
00:0000E1  6031A4              +188 command	la	arguments
(+00)0f
00:0000E2  E60095              +189 	jna	trial_new_prompt
(+00)0f
00:0000E3  C60095              +190 	jza	trial_new_prompt
  :                            191 
  :                            192 .	next the search for builtin commands
  :                            193 
00:0000E4  550006              +194 	lookup	request	@?, @eof, @run, ifsync, ifswap, @@stay
00:0000E5  85FFFF              +194 
(+04)0c
00:0000E6  60A01D              +194 
00:0000E7  CFC000              +194 
00:0000E8  DF3078              +194 
00:0000E9  900005              +194 
(+04)0c
00:0000EA  68A023              +194 
00:0000EB  C6D000              +194 
00:0000EC  700002              +194 
(+00)0f
00:0000ED  B600E5              +194 
  :                            195 
  :                            196 .	next the search for dynamic loaded programs
  :                            197 
(+00)0f
00:0000EE  3E0154              +198 	lcal	find_in_loaded_list
(+00)0f
00:0000EF  B600FE              +199 	j	notso
  :                            200 
00:0000F0  1831AB              +201 	sy	app_of_reference
  :                            202 
00:0000F1  603168              +203 	la	suffix
(+04)0f
00:0000F2  48000E              +204 	lk	(-1*/$word-$byte)
(+04)0f
00:0000F3  AF0029              +205 	mta	('-'*/$word-$byte)
(+00)0f
00:0000F4  B6005E              +206 	j	find_and?		. execute app or contained app
  :                            207 					. unless suffix is delete *-
00:0000F5  60B005              +208 	la	this_app:transfer_gate+1
(+04)0f
00:0000F6  A0002A              +209 	and	(07FFFFF)		. brush off the flag
00:0000F7  750045              +210 	ii	BANK$FREE		. return storage to kernel
  :                            211 
00:0000F8  60B000              +212 	la	this_app:next
00:0000F9  208000              +213 	sa	*r			. previous pointer
00:0000FA  6031AC              +214 	la	app_cache_free
00:0000FB  20B000              +215 	sa	this_app:next
00:0000FC  1831AC              +216 	sy	app_cache_free
  :                            217 
(+00)0f
00:0000FD  B60095              +218 	j	trial_new_prompt
  :                            219 
00:0000FE  FD3078              +220 notso	printf	$3("%s not loaded":10:0),,xi	request,,xi
00:0000FF  FD35AF              +220 
00:000100  FD0001              +220 
00:000101  FCF003              +220 
(+04)0f
00:000102  FF0006              +220 
00:000103  38000F              +220 
(+00)0f
00:000104  B60095              +221 	j	trial_new_prompt
  :                            222 
(+00)0f
00:000105  3E0143              +223 @?	lcal	list
(+00)0f
00:000106  B60095              +224 	j	trial_new_prompt
(+04)0f
00:000107  4F002B              +225 @run	ql	(runstart, 7, request2, THREAD_FP(2)q)
00:000108  750047              +226 	ii	THREAD$
(+00)0f
00:000109  B60095              +227 	j	trial_new_prompt
  :                            228 
00:00010A  550005              +229 ifsync	lx	5,,xi
00:00010B  750059              +230 	ii	KERNEL$B1_1
(+04)0f
00:00010C  FF002F              +231 	call	(__ift2_align)
00:00010D  750058              +232 	ii	B1$
(+00)0f
00:00010E  B60095              +233 	j	trial_new_prompt
  :                            234 
00:00010F  550005              +235 ifswap	lx	5,,xi
00:000110  750059              +236 	ii	KERNEL$B1_1
(+04)0f
00:000111  FF0030              +237 	call	(__ift2_mirror)
00:000112  750058              +238 	ii	B1$
(+00)0f
00:000113  B60095              +239 	j	trial_new_prompt
  :                            240 
00:000114  FD0000              +241 @@stay	c	(__fd_zero_timeout)	stdin
00:000115  FCF001              +241 
(+04)0f
00:000116  FF0031              +241 
00:000117  38000F              +241 
(+00)0f
00:000118  B60095              +242 	j	trial_new_prompt
  :                            243 
  :                            244 @eof
00:000119  750041              +245 trialz	ii	YIELD$			. let the print proceed before EXIT$
00:00011A  3D0000              +246 	fret	0
  :                            247 
  :                            248 .	asynchronous thread to run a script in background
  :                            249 
00:00011B  F80004              +250 runstart	c	(run_start)	a
00:00011C  FCF001              +250 
(+04)0f
00:00011D  FF0032              +250 
00:00011E  38000F              +250 
00:00011F  350000              +251 	lret	0			. thread exit
  :                            252 
  :                            253 .	execute an app within a file of multiple apps
  :                            254 
                                qapps	$head_near	 params(appxp,		int	;
                                				app_namep,	int )	;
                                							;
                                			scalars(startpx,	int	;
00:000120  FD0000              +259 				app_name_words,	int	)
00:000121  FD0000              +259 
  :                            260 
00:000122  F8F005              +261 	c	(strlenx)	app_namep
00:000123  FCF001              +261 
(+04)0f
00:000124  FF0033              +261 
00:000125  38000F              +261 
00:000126  28F000              +262 	sb	app_name_words
  :                            263 
00:000127  58F004              +264 	ly	appxp
00:000128  4FB008              +265 	ql	this_app:lookup_mount
00:000129  4DFFFF              +266 	lk	-1,,xi
(+04)0f
00:00012A  AF0034              +267         mta     (MOUNT$,,3)
(+00)0f
00:00012B  B6013F              +268         j       qappz		. no mount pointer, zero the result
  :                            269 
00:00012C  60B005              +270 	la	this_app:transfer_gate+1
(+04)0f
00:00012D  A0002A              +271 	and	(07FFFFF)	. start page index
00:00012E  20F001              +272 	sa	startpx
  :                            273 				. get directory block from directory descriptor
00:00012F  CF0006              +274 	dl	6		. -> descriptor word offset application_templates
00:000130  36000C              +275         dsl     12		. separate relative page / offset
00:000131  9D0020              +276         orB     32,,xi		. tag to general I/O window
00:000132  C0F001              +277         aa      startpx		. add start page index to relative index
00:000133  340020              +278         sabr    32		. open the window
00:000134  4E000C              +279         rbr     12		. normalise the pointer
00:000135  CFD002              +280         dl      2, b            . granule identifier directory block
00:000136  360006              +281         dsl     6               . -> word offset in device
  :                            282 
                                        c       (qstart)        startpx					;
                                                                a,,long					;
                                                                app_name_words				;
00:000137  F8F005              +286                                 app_namep
00:000138  F8F001              +286 
00:000139  9F0004              +286 
00:00013A  F8F005              +286 
00:00013B  FCF005              +286 
(+04)0f
00:00013C  FF0035              +286 
00:00013D  38000F              +286 
  :                            287 
(+00)0f
00:00013E  D60140              +288         jnza	qappx
  :                            289 
00:00013F  650000              +290 qappz	la	0,,xi
00:000140  FCF002              +291 qappx	$ret
00:000141  38000F              +291 
00:000142  350000              +291 
  :                            292 
00:000143  5831AD              +293 list	ly	apps_loaded
(+00)0f
00:000144  B60151              +294 	j	list?
  :                            295 
00:000145  F80003              +296 list!	push	y
00:000146  4FB010              +297 	ql	this_app:leaf_name
00:000147  4731A6              +298 	qs	loadname	. place the name before a 5th word of zero
  :                            299 
                                	printf	$3("%lx:%lx %s":10:0),,xi	this_app:transfer_gate,,float	;
00:000148  FD31A6              +301 						loadname,,xi
00:000149  8FB004              +301 
00:00014A  FD35B4              +301 
00:00014B  FD0001              +301 
00:00014C  FCF007              +301 
(+04)0f
00:00014D  FF0006              +301 
00:00014E  38000F              +301 
00:00014F  380003              +302 	pop	y
00:000150  58B000              +303 	ly	0, y
00:000151  700003              +304 list?	tz	y
(+00)0f
00:000152  B60145              +305 	j	list!
00:000153  350000              +306 	lret	0
  :                            307 
  :                            308 
  :                            309 find_in_loaded_list
00:000154  300009              +310 	z	9
00:000155  30000A              +311 	z	10
00:000156  30000B              +312 	z	11		. 4-word loaded file search argument
00:000157  303168              +313 	z	suffix		. by default no *suffix
  :                            314 
00:000158  FD3168              +315 	sscanf	request,,xi    $3("%:*%s"),,xi    8,,xi    suffix,,xi
00:000159  FD0008              +315 
00:00015A  FD3578              +315 
00:00015B  FD3078              +315 
00:00015C  FCF004              +315 
(+04)0f
00:00015D  FF0005              +315 
00:00015E  38000F              +315 
  :                            316 
00:00015F  5D31AD              +317 	ly	apps_loaded,,xi
  :                            318 
  :                            319 find_it_then
00:000160  400003              +320 	lr	y		. we need a previous if suffix *- delete
00:000161  58B000              +321 	ly	0, y
00:000162  700003              +322 	tnz	y
(+00)0f
00:000163  B60165              +322 
00:000164  350000              +323 	lret	0		. no
00:000165  4FB010              +324 	ql	this_app:leaf_name
00:000166  DF0008              +325 	dan	8
(+00)0f
00:000167  D60160              +326 	jnza	find_it_then
(+00)0f
00:000168  DE0160              +327 	jnzb	find_it_then
00:000169  CF0006              +328 	dl	6
00:00016A  DF000A              +329 	dan	10
(+00)0f
00:00016B  D60160              +330 	jnza	find_it_then
(+00)0f
00:00016C  DE0160              +331 	jnzb	find_it_then
00:00016D  4F0008              +332 	ql	8
00:00016E  4731A6              +333 	qs	loadname
00:00016F  350001              +334 	lret	1		. yes
  :                            25 
*EOF*
03:00356e+257320257320257320257320257300000000
03:003574+6C6F616465723A2025730A00
03:003578+253A2A257300
03:00357a+5B256C783A256C785D0A0000
03:00357e+25782025730A000000
03:003581+6D6178696D756D2064796E616D69632061707073206C6F61
6465645C6E0A000000
03:00358c+6C6F61643E00
03:00358e+257320257320257320257300
03:003592+2573206E6F74206C6F63617465640A000000
03:003598+6C6F6164206572726F722025640A00
03:00359d+6461746120766F69640A0000
03:0035a1+656F66207369676E616C6C65640A00
03:0035a6+25640A000000
03:0035a8+70726F6365737320756E61737369676E65640A0000
03:0035af+2573206E6F74206C6F616465640A00
03:0035b4+256C783A256C782025730A00
04:000000+[0000]18:000000
04:000001+[0001]30:000000000000
04:000003+0001CD
04:000004+0001E4
04:000005+0001D8
04:000006+0001DB
04:000007+0001C5
04:000008+0001D0
04:000009+800000
04:00000a+020042
04:00000b+020188
04:00000c+02018A
04:00000d+C00001
04:00000e+FF0000
04:00000f+2B0000
04:000010+0001D6
04:000011+403F00000000
04:000013+40656F660000
04:000015+4072756E0000
04:000017+696673796E63
04:000019+696673776170
04:00001b+404073746179
04:00001d+(04)18:000011
(04)18:000013
(04)18:000015
(04)18:000017
(04)18:000019
(04)18:00001B
04:000023+(00)18:000105
(00)18:000119
(00)18:000107
(00)18:00010A
(00)18:00010F
(00)18:000114
04:000029+2D0000
04:00002a+7FFFFF
04:00002b+(00)18*/48:00011B0000070030B4004800
04:00002f+000113
04:000030+000114
04:000031+0001F2
04:000032+00014A
04:000033+00019A
04:000034+[0002]08*/10:000003
04:000035+0001D1
:$(00):000000:000170 :$(01):001000:001000 :$(02):002000:003000 :$(03):003000:0035B8 :$(04):000000:000036 :$(43):000000:000014 
loader.msm: object code 10855 bytes: 0 errors: 3 undefined labels
